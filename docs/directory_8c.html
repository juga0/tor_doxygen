<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/directory.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">directory.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Code to send and fetch information from directory authorities and caches via HTTP.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;backtrace.h&quot;</code><br />
<code>#include &quot;<a class="el" href="bridges_8h_source.html">bridges.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buffers_8h_source.html">buffers.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitbuild_8h_source.html">circuitbuild.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="connection_8h_source.html">connection.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="connection__edge_8h_source.html">connection_edge.h</a>&quot;</code><br />
<code>#include &quot;conscache.h&quot;</code><br />
<code>#include &quot;consdiff.h&quot;</code><br />
<code>#include &quot;consdiffmgr.h&quot;</code><br />
<code>#include &quot;<a class="el" href="control_8h_source.html">control.h</a>&quot;</code><br />
<code>#include &quot;compat.h&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__rand_8h_source.html">crypto_rand.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__util_8h_source.html">crypto_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="directory_8h_source.html">directory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dirserv_8h_source.html">dirserv.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="entrynodes_8h_source.html">entrynodes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="geoip_8h_source.html">geoip.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hs__cache_8h_source.html">hs_cache.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hs__common_8h_source.html">hs_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hs__control_8h_source.html">hs_control.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hs__client_8h_source.html">hs_client.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="main_8h_source.html">main.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="microdesc_8h_source.html">microdesc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="networkstatus_8h_source.html">networkstatus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nodelist_8h_source.html">nodelist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="policies_8h_source.html">policies.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="relay_8h_source.html">relay.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendclient_8h_source.html">rendclient.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendcommon_8h_source.html">rendcommon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendservice_8h_source.html">rendservice.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rephist_8h_source.html">rephist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="router_8h_source.html">router.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerlist_8h_source.html">routerlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerparse_8h_source.html">routerparse.h</a>&quot;</code><br />
<code>#include &quot;routerset.h&quot;</code><br />
<code>#include &quot;<a class="el" href="dirvote_8h_source.html">dirauth/dirvote.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mode_8h_source.html">dirauth/mode.h</a>&quot;</code><br />
<code>#include &quot;dirauth/shared_random.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for directory.c:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2directory_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2directory_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2directory_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="1145,259,1189,285"/>
<area shape="rect" id="node6" href="compat_8h_source.html" title="compat.h" alt="" coords="1475,408,1551,435"/>
<area shape="rect" id="node13" href="backtrace_8h_source.html" title="backtrace.h" alt="" coords="409,483,500,509"/>
<area shape="rect" id="node14" href="bridges_8h.html" title="Header file for circuitbuild.c. " alt="" coords="144,109,219,136"/>
<area shape="rect" id="node15" href="buffers_8h.html" title="Header file for buffers.c. " alt="" coords="2546,259,2619,285"/>
<area shape="rect" id="node16" href="circuitbuild_8h.html" title="Header file for circuitbuild.c. " alt="" coords="294,109,389,136"/>
<area shape="rect" id="node17" href="config_8h.html" title="Header file for config.c. " alt="" coords="413,109,481,136"/>
<area shape="rect" id="node18" href="connection_8h.html" title="Header file for connection.c. " alt="" coords="3239,184,3335,211"/>
<area shape="rect" id="node19" href="connection__edge_8h.html" title="Header file for connection_edge.c. " alt="" coords="556,109,687,136"/>
<area shape="rect" id="node20" href="conscache_8h_source.html" title="conscache.h" alt="" coords="711,109,807,136"/>
<area shape="rect" id="node21" href="consdiff_8h_source.html" title="consdiff.h" alt="" coords="883,184,962,211"/>
<area shape="rect" id="node22" href="consdiffmgr_8h_source.html" title="consdiffmgr.h" alt="" coords="881,109,983,136"/>
<area shape="rect" id="node23" href="control_8h.html" title="Header file for control.c. " alt="" coords="1007,109,1079,136"/>
<area shape="rect" id="node24" href="crypto__rand_8h.html" title="Common functions for using (pseudo&#45;)random number generators. " alt="" coords="185,259,287,285"/>
<area shape="rect" id="node25" href="crypto__util_8h.html" title="Common functions for cryptographic routines. " alt="" coords="120,184,213,211"/>
<area shape="rect" id="node26" href="directory_8h.html" title="Header file for directory.c. " alt="" coords="1204,109,1287,136"/>
<area shape="rect" id="node27" href="dirserv_8h.html" title="Header file for dirserv.c. " alt="" coords="1311,109,1383,136"/>
<area shape="rect" id="node28" href="entrynodes_8h.html" title="Header file for circuitbuild.c. " alt="" coords="1407,109,1505,136"/>
<area shape="rect" id="node29" href="geoip_8h.html" title="Header file for geoip.c. " alt="" coords="1529,109,1593,136"/>
<area shape="rect" id="node30" href="hs__cache_8h.html" title="Header file for hs_cache.c. " alt="" coords="1618,109,1707,136"/>
<area shape="rect" id="node31" href="hs__common_8h.html" title="Header file containing common data for the whole HS subsytem. " alt="" coords="1191,184,1295,211"/>
<area shape="rect" id="node32" href="rendcommon_8h.html" title="Header file for rendcommon.c. " alt="" coords="1619,184,1727,211"/>
<area shape="rect" id="node33" href="hs__control_8h.html" title="Header file containing control port event related code. " alt="" coords="1833,109,1927,136"/>
<area shape="rect" id="node34" href="hs__client_8h.html" title="Header file containing client data for the HS subsytem. " alt="" coords="1951,109,2036,136"/>
<area shape="rect" id="node35" href="main_8h.html" title="Header file for main.c. " alt="" coords="2060,109,2121,136"/>
<area shape="rect" id="node36" href="microdesc_8h.html" title="Header file for microdesc.c. " alt="" coords="2145,109,2239,136"/>
<area shape="rect" id="node37" href="networkstatus_8h.html" title="Header file for networkstatus.c. " alt="" coords="2263,109,2377,136"/>
<area shape="rect" id="node38" href="nodelist_8h.html" title="Header file for nodelist.c. " alt="" coords="2402,109,2481,136"/>
<area shape="rect" id="node39" href="policies_8h.html" title="Header file for policies.c. " alt="" coords="2505,109,2583,136"/>
<area shape="rect" id="node40" href="relay_8h.html" title="Header file for relay.c. " alt="" coords="2607,109,2668,136"/>
<area shape="rect" id="node41" href="rendclient_8h.html" title="Header file for rendclient.c. " alt="" coords="2693,109,2782,136"/>
<area shape="rect" id="node42" href="rendservice_8h.html" title="Header file for rendservice.c. " alt="" coords="1066,184,1166,211"/>
<area shape="rect" id="node43" href="rephist_8h.html" title="Header file for rephist.c. " alt="" coords="2857,109,2929,136"/>
<area shape="rect" id="node44" href="router_8h.html" title="Header file for router.c. " alt="" coords="2953,109,3020,136"/>
<area shape="rect" id="node45" href="routerlist_8h.html" title="Header file for routerlist.c. " alt="" coords="3044,109,3127,136"/>
<area shape="rect" id="node46" href="routerparse_8h.html" title="Header file for routerparse.c. " alt="" coords="3151,109,3249,136"/>
<area shape="rect" id="node47" href="routerset_8h_source.html" title="routerset.h" alt="" coords="3274,109,3358,136"/>
<area shape="rect" id="node48" href="dirvote_8h.html" title="Header file for dirvote.c. " alt="" coords="3383,109,3497,136"/>
<area shape="rect" id="node49" href="mode_8h.html" title="Standalone header file for directory authority mode. " alt="" coords="3522,109,3630,136"/>
<area shape="rect" id="node50" href="shared__random_8h_source.html" title="dirauth/shared_random.h" alt="" coords="264,184,429,211"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="1282,557,1361,584"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="1325,483,1387,509"/>
<area shape="rect" id="node5" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="1713,333,1783,360"/>
<area shape="rect" id="node7" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1025,408,1138,435"/>
<area shape="rect" id="node8" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="1435,333,1498,360"/>
<area shape="rect" id="node9" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1522,333,1587,360"/>
<area shape="rect" id="node10" href="container_8h_source.html" title="container.h" alt="" coords="1162,408,1249,435"/>
<area shape="rect" id="node11" href="compress_8h.html" title="Headers for compress.c. " alt="" coords="1269,333,1360,360"/>
<area shape="rect" id="node12" href="address_8h.html" title="Headers for address.h. " alt="" coords="1166,333,1245,360"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structget__handler__args__t.html">get_handler_args_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structurl__table__ent__s.html">url_table_ent_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structparsed__consensus__request__t.html">parsed_consensus_request_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a51c955dfc00cdc86e40395c9a438f4a4"><td class="memItemLeft" align="right" valign="top"><a id="a51c955dfc00cdc86e40395c9a438f4a4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DIRECTORY_PRIVATE</b></td></tr>
<tr class="separator:a51c955dfc00cdc86e40395c9a438f4a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23c309e66997f959d52791af058b27d8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a23c309e66997f959d52791af058b27d8">ALLOW_DIRECTORY_TIME_SKEW</a>&#160;&#160;&#160;(30*60)</td></tr>
<tr class="separator:a23c309e66997f959d52791af058b27d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17971f446d7885cc2d88c7a834ac616d"><td class="memItemLeft" align="right" valign="top"><a id="a17971f446d7885cc2d88c7a834ac616d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>X_ADDRESS_HEADER</b>&#160;&#160;&#160;&quot;X-Your-Address-Is: &quot;</td></tr>
<tr class="separator:a17971f446d7885cc2d88c7a834ac616d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad086696782c6aab8fb1a6148d5d763b2"><td class="memItemLeft" align="right" valign="top"><a id="ad086696782c6aab8fb1a6148d5d763b2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>X_OR_DIFF_FROM_CONSENSUS_HEADER</b>&#160;&#160;&#160;&quot;X-Or-Diff-From-Consensus: &quot;</td></tr>
<tr class="separator:ad086696782c6aab8fb1a6148d5d763b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeae5dbd4c3ad12f7bc3ac494ea30ac3b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#aeae5dbd4c3ad12f7bc3ac494ea30ac3b">FULL_DIR_CACHE_LIFETIME</a>&#160;&#160;&#160;(60*60)</td></tr>
<tr class="separator:aeae5dbd4c3ad12f7bc3ac494ea30ac3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b3229cc1fd7e16dae40d649d70de7e0"><td class="memItemLeft" align="right" valign="top"><a id="a2b3229cc1fd7e16dae40d649d70de7e0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RUNNINGROUTERS_CACHE_LIFETIME</b>&#160;&#160;&#160;(20*60)</td></tr>
<tr class="separator:a2b3229cc1fd7e16dae40d649d70de7e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a626a8cbb47641633c597e043f030f4d9"><td class="memItemLeft" align="right" valign="top"><a id="a626a8cbb47641633c597e043f030f4d9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DIRPORTFRONTPAGE_CACHE_LIFETIME</b>&#160;&#160;&#160;(20*60)</td></tr>
<tr class="separator:a626a8cbb47641633c597e043f030f4d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a238608e7fa84b3e282c30f074a949134"><td class="memItemLeft" align="right" valign="top"><a id="a238608e7fa84b3e282c30f074a949134"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NETWORKSTATUS_CACHE_LIFETIME</b>&#160;&#160;&#160;(5*60)</td></tr>
<tr class="separator:a238608e7fa84b3e282c30f074a949134"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad533b42097da3f4718c790d47610477d"><td class="memItemLeft" align="right" valign="top"><a id="ad533b42097da3f4718c790d47610477d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ROUTERDESC_CACHE_LIFETIME</b>&#160;&#160;&#160;(30*60)</td></tr>
<tr class="separator:ad533b42097da3f4718c790d47610477d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f17cbc728dcb65279a82be83ea5d374"><td class="memItemLeft" align="right" valign="top"><a id="a3f17cbc728dcb65279a82be83ea5d374"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ROUTERDESC_BY_DIGEST_CACHE_LIFETIME</b>&#160;&#160;&#160;(48*60*60)</td></tr>
<tr class="separator:a3f17cbc728dcb65279a82be83ea5d374"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0a5e213edecd9fd27add7465a8d71d4"><td class="memItemLeft" align="right" valign="top"><a id="ab0a5e213edecd9fd27add7465a8d71d4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ROBOTS_CACHE_LIFETIME</b>&#160;&#160;&#160;(24*60*60)</td></tr>
<tr class="separator:ab0a5e213edecd9fd27add7465a8d71d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d3d4e25cc96cd2aebc573cffe52cff6"><td class="memItemLeft" align="right" valign="top"><a id="a4d3d4e25cc96cd2aebc573cffe52cff6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MICRODESC_CACHE_LIFETIME</b>&#160;&#160;&#160;(48*60*60)</td></tr>
<tr class="separator:a4d3d4e25cc96cd2aebc573cffe52cff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6369cfb669b2e78c124b461bda147f45"><td class="memItemLeft" align="right" valign="top"><a id="a6369cfb669b2e78c124b461bda147f45"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CONDITIONAL_CONSENSUS_FPR_LEN</b>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a6369cfb669b2e78c124b461bda147f45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a698bec7a6cd6eccf990a74309fa20453"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>SEND_HS_DESC_FAILED_EVENT</b>(reason)</td></tr>
<tr class="separator:a698bec7a6cd6eccf990a74309fa20453"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae94cefe68ab1ccb9a884f52955582b9a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>SEND_HS_DESC_FAILED_CONTENT</b>()</td></tr>
<tr class="separator:ae94cefe68ab1ccb9a884f52955582b9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44f58716bb3b4c1365a6047c9e0e2b6d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>SEND_HS_DESC_UPLOAD_FAILED_EVENT</b>(reason)</td></tr>
<tr class="separator:a44f58716bb3b4c1365a6047c9e0e2b6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af12592e94d1a765dfbc59cef089ce947"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#af12592e94d1a765dfbc59cef089ce947">MAX_DIRECTORY_OBJECT_SIZE</a>&#160;&#160;&#160;(10*(1&lt;&lt;20))</td></tr>
<tr class="separator:af12592e94d1a765dfbc59cef089ce947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b0a64b0ec601d74e61dc9fc7c8e4103"><td class="memItemLeft" align="right" valign="top"><a id="a7b0a64b0ec601d74e61dc9fc7c8e4103"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_VOTE_DL_SIZE</b>&#160;&#160;&#160;(<a class="el" href="directory_8c.html#af12592e94d1a765dfbc59cef089ce947">MAX_DIRECTORY_OBJECT_SIZE</a> * 5)</td></tr>
<tr class="separator:a7b0a64b0ec601d74e61dc9fc7c8e4103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ee184fcbe268a61613f8e37eac5905d"><td class="memItemLeft" align="right" valign="top"><a id="a6ee184fcbe268a61613f8e37eac5905d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOO_OLD_WARNING_INTERVAL</b>&#160;&#160;&#160;(60*60)</td></tr>
<tr class="separator:a6ee184fcbe268a61613f8e37eac5905d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a786b40c8b20290b21dc42e54f0691af3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a786b40c8b20290b21dc42e54f0691af3">FALLBACK_COMPRESS_METHOD</a>&#160;&#160;&#160;ZLIB_METHOD</td></tr>
<tr class="separator:a786b40c8b20290b21dc42e54f0691af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ad24e8866486cbc6cb9e986c747d5f0b4"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structget__handler__args__t.html">get_handler_args_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ad24e8866486cbc6cb9e986c747d5f0b4">get_handler_args_t</a></td></tr>
<tr class="separator:ad24e8866486cbc6cb9e986c747d5f0b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a696a8ba1f088d30327bf3f2ded94a66e"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structurl__table__ent__s.html">url_table_ent_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a696a8ba1f088d30327bf3f2ded94a66e">url_table_ent_t</a></td></tr>
<tr class="separator:a696a8ba1f088d30327bf3f2ded94a66e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a303b2f05c493a74b33537b47b5f00fe0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a303b2f05c493a74b33537b47b5f00fe0">purpose_needs_anonymity</a> (uint8_t dir_purpose, uint8_t router_purpose, const char *resource)</td></tr>
<tr class="separator:a303b2f05c493a74b33537b47b5f00fe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6845d69b14a9dc6d04ee5c8b333f8ece"><td class="memItemLeft" align="right" valign="top">STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a6845d69b14a9dc6d04ee5c8b333f8ece">authdir_type_to_string</a> (<a class="el" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a> auth)</td></tr>
<tr class="separator:a6845d69b14a9dc6d04ee5c8b333f8ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aabd75f035464ab0450ff60098e97d4"><td class="memItemLeft" align="right" valign="top">STATIC const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a8aabd75f035464ab0450ff60098e97d4">dir_conn_purpose_to_string</a> (int purpose)</td></tr>
<tr class="separator:a8aabd75f035464ab0450ff60098e97d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad69764afab6303ccc89d0571264db191"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ad69764afab6303ccc89d0571264db191">dir_fetch_type</a> (int dir_purpose, int router_purpose, const char *resource)</td></tr>
<tr class="separator:ad69764afab6303ccc89d0571264db191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae222b3f260cc42ea120a438c2d4efc4a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ae222b3f260cc42ea120a438c2d4efc4a">router_supports_extrainfo</a> (const char *identity_digest, int is_authority)</td></tr>
<tr class="separator:ae222b3f260cc42ea120a438c2d4efc4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4524a59d1b721804ba0cb5c0b7cf53a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ae4524a59d1b721804ba0cb5c0b7cf53a">directories_have_accepted_server_descriptor</a> (void)</td></tr>
<tr class="separator:ae4524a59d1b721804ba0cb5c0b7cf53a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aace63698f64d26bc7a14531381e2fa57"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#aace63698f64d26bc7a14531381e2fa57">directory_post_to_dirservers</a> (uint8_t dir_purpose, uint8_t router_purpose, <a class="el" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a> type, const char *payload, size_t payload_len, size_t extrainfo_len)</td></tr>
<tr class="separator:aace63698f64d26bc7a14531381e2fa57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e70476c39b897c87ee7623617f43e78"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a4e70476c39b897c87ee7623617f43e78">should_use_directory_guards</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:a4e70476c39b897c87ee7623617f43e78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dcb34e25124200a8694ef07275a50b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a2dcb34e25124200a8694ef07275a50b2">MOCK_IMPL</a> (void, directory_get_from_dirserver,(uint8_t dir_purpose, uint8_t router_purpose, const char *resource, int pds_flags, <a class="el" href="or_8h.html#a97b0a50b63539850700352c6de8a16c5">download_want_authority_t</a> want_authority))</td></tr>
<tr class="separator:a2dcb34e25124200a8694ef07275a50b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13483821c102fb862ab0d27091d7ffc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a13483821c102fb862ab0d27091d7ffc7">directory_get_from_all_authorities</a> (uint8_t dir_purpose, uint8_t router_purpose, const char *resource)</td></tr>
<tr class="separator:a13483821c102fb862ab0d27091d7ffc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5230127838f35e68b6a9ee6ded4ad8ca"><td class="memItemLeft" align="right" valign="top"><a id="a5230127838f35e68b6a9ee6ded4ad8ca"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>directory_must_use_begindir</b> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:a5230127838f35e68b6a9ee6ded4ad8ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85c888ac5ae7e9877281b1c87483cee1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a85c888ac5ae7e9877281b1c87483cee1">directory_request_new</a> (uint8_t dir_purpose)</td></tr>
<tr class="separator:a85c888ac5ae7e9877281b1c87483cee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76bf5075b1b3e4131f2c4cf5ca0f0d8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a76bf5075b1b3e4131f2c4cf5ca0f0d8b">directory_request_free_</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req)</td></tr>
<tr class="separator:a76bf5075b1b3e4131f2c4cf5ca0f0d8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fad9324c6504d8bf509247168e1b819"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a0fad9324c6504d8bf509247168e1b819">directory_request_set_or_addr_port</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, const <a class="el" href="structtor__addr__port__t.html">tor_addr_port_t</a> *p)</td></tr>
<tr class="separator:a0fad9324c6504d8bf509247168e1b819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54586f3724c9b07dc9a28da6c496f92c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a54586f3724c9b07dc9a28da6c496f92c">directory_request_set_dir_addr_port</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, const <a class="el" href="structtor__addr__port__t.html">tor_addr_port_t</a> *p)</td></tr>
<tr class="separator:a54586f3724c9b07dc9a28da6c496f92c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8e97475dd051b61e3e32585a7a3cf6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#aa8e97475dd051b61e3e32585a7a3cf6c">directory_request_set_directory_id_digest</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, const char *digest)</td></tr>
<tr class="separator:aa8e97475dd051b61e3e32585a7a3cf6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9573f64df7aa31baf290b23ca8dbcee2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a9573f64df7aa31baf290b23ca8dbcee2">directory_request_set_router_purpose</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, uint8_t router_purpose)</td></tr>
<tr class="separator:a9573f64df7aa31baf290b23ca8dbcee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73c93da738cdb4945e336e4efc37dce7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a73c93da738cdb4945e336e4efc37dce7">directory_request_set_indirection</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, <a class="el" href="directory_8h.html#a1c9628f500a2efb8bacf72a85faf121b">dir_indirection_t</a> indirection)</td></tr>
<tr class="separator:a73c93da738cdb4945e336e4efc37dce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f8877f88add95ceea302a569a095569"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a0f8877f88add95ceea302a569a095569">directory_request_set_resource</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, const char *resource)</td></tr>
<tr class="separator:a0f8877f88add95ceea302a569a095569"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2f9c30557e169548ab5871462d6ddd6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ac2f9c30557e169548ab5871462d6ddd6">directory_request_set_payload</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, const char *payload, size_t payload_len)</td></tr>
<tr class="separator:ac2f9c30557e169548ab5871462d6ddd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2378f74f545dc3bd8f37daaacbf56294"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a2378f74f545dc3bd8f37daaacbf56294">directory_request_set_if_modified_since</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, time_t if_modified_since)</td></tr>
<tr class="separator:a2378f74f545dc3bd8f37daaacbf56294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af68afba474b93d9917f8b76d739b8505"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#af68afba474b93d9917f8b76d739b8505">directory_request_add_header</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, const char *key, const char *val)</td></tr>
<tr class="separator:af68afba474b93d9917f8b76d739b8505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa038c1c27a5a5469ce9745a65fe1458e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#aa038c1c27a5a5469ce9745a65fe1458e">directory_request_set_rend_query</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, const <a class="el" href="structrend__data__t.html">rend_data_t</a> *query)</td></tr>
<tr class="separator:aa038c1c27a5a5469ce9745a65fe1458e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb1872de41e8c93f3995a3cd6de31382"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#afb1872de41e8c93f3995a3cd6de31382">directory_request_upload_set_hs_ident</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, const <a class="el" href="strucths__ident__dir__conn__t.html">hs_ident_dir_conn_t</a> *ident)</td></tr>
<tr class="separator:afb1872de41e8c93f3995a3cd6de31382"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8944f29dae81e9931e0bdef3b39e407"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ad8944f29dae81e9931e0bdef3b39e407">directory_request_fetch_set_hs_ident</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, const <a class="el" href="strucths__ident__dir__conn__t.html">hs_ident_dir_conn_t</a> *ident)</td></tr>
<tr class="separator:ad8944f29dae81e9931e0bdef3b39e407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a619df20778c681f53b681bebc9802976"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a619df20778c681f53b681bebc9802976">directory_request_set_guard_state</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, circuit_guard_state_t *state)</td></tr>
<tr class="separator:a619df20778c681f53b681bebc9802976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80d02180af0001ba29cdb088eeab3fba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a80d02180af0001ba29cdb088eeab3fba">directory_request_set_routerstatus</a> (<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *req, const <a class="el" href="structrouterstatus__t.html">routerstatus_t</a> *status)</td></tr>
<tr class="separator:a80d02180af0001ba29cdb088eeab3fba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07b76c8174544940247a2582ba1a51c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a07b76c8174544940247a2582ba1a51c2">MOCK_IMPL</a> (void, directory_initiate_request,(<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *request))</td></tr>
<tr class="separator:a07b76c8174544940247a2582ba1a51c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ea9fd0d00375fc50652182d4d35a93"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a60ea9fd0d00375fc50652182d4d35a93">connection_dir_is_encrypted</a> (const <a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn)</td></tr>
<tr class="separator:a60ea9fd0d00375fc50652182d4d35a93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab1c7dcfde852c520eb496643fdc865"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a2ab1c7dcfde852c520eb496643fdc865">parse_http_url</a> (const char *headers, char **url)</td></tr>
<tr class="separator:a2ab1c7dcfde852c520eb496643fdc865"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeaaed095405cd4aad17cf7a1197de3c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#adeaaed095405cd4aad17cf7a1197de3c">parse_http_command</a> (const char *headers, char **command_out, char **url_out)</td></tr>
<tr class="separator:adeaaed095405cd4aad17cf7a1197de3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cd94a3fa7e78209bcf82533c1128d19"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a6cd94a3fa7e78209bcf82533c1128d19">http_get_header</a> (const char *headers, const char *which)</td></tr>
<tr class="separator:a6cd94a3fa7e78209bcf82533c1128d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4786f539a53422cb5ce22c6036766c15"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a4786f539a53422cb5ce22c6036766c15">parse_http_response</a> (const char *headers, int *code, time_t *date, <a class="el" href="compress_8h.html#a97a284cf1b98eccbe7964617ed797eee">compress_method_t</a> *compression, char **reason)</td></tr>
<tr class="separator:a4786f539a53422cb5ce22c6036766c15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4af7e7ade522a1f118e7770955ff50ea"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a4af7e7ade522a1f118e7770955ff50ea">handle_response_fetch_consensus</a> (<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn, const response_handler_args_t *args)</td></tr>
<tr class="separator:a4af7e7ade522a1f118e7770955ff50ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad96202e49f49de900faee561648507fb"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ad96202e49f49de900faee561648507fb">handle_response_fetch_microdesc</a> (<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn, const response_handler_args_t *args)</td></tr>
<tr class="separator:ad96202e49f49de900faee561648507fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab711f2df049b68c03bd66a27550f3ff8"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ab711f2df049b68c03bd66a27550f3ff8">handle_response_fetch_hsdesc_v3</a> (<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn, const response_handler_args_t *args)</td></tr>
<tr class="separator:ab711f2df049b68c03bd66a27550f3ff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f61e005774a8b52467b2dea7528d2a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ad0f61e005774a8b52467b2dea7528d2a">connection_dir_reached_eof</a> (<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn)</td></tr>
<tr class="separator:ad0f61e005774a8b52467b2dea7528d2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2bfa4b827d711bd2ed6bdeb506c8b6d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#af2bfa4b827d711bd2ed6bdeb506c8b6d">connection_dir_process_inbuf</a> (<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn)</td></tr>
<tr class="separator:af2bfa4b827d711bd2ed6bdeb506c8b6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae225c64a35559d7a6e7b06d8fd5c121c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ae225c64a35559d7a6e7b06d8fd5c121c">connection_dir_about_to_close</a> (<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *dir_conn)</td></tr>
<tr class="separator:ae225c64a35559d7a6e7b06d8fd5c121c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa5000558702b2075cc3f676d87c3150"><td class="memItemLeft" align="right" valign="top">STATIC unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#aaa5000558702b2075cc3f676d87c3150">parse_accept_encoding_header</a> (const char *h)</td></tr>
<tr class="separator:aaa5000558702b2075cc3f676d87c3150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a2c89221d62ce64156e43f67f4982e0"><td class="memItemLeft" align="right" valign="top">STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a8a2c89221d62ce64156e43f67f4982e0">accept_encoding_header</a> (void)</td></tr>
<tr class="separator:a8a2c89221d62ce64156e43f67f4982e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add0e4d43f10e958101ec91c0307d9301"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="compress_8h.html#a9b39944b30ed9c4a72586a820e59b0ec">compression_level_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#add0e4d43f10e958101ec91c0307d9301">choose_compression_level</a> (ssize_t n_bytes)</td></tr>
<tr class="separator:add0e4d43f10e958101ec91c0307d9301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bceea525c4f52a46d5c7caeeb68a474"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a2bceea525c4f52a46d5c7caeeb68a474">MOCK_IMPL</a> (STATIC int, directory_handle_command_get,(<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn, const char *headers, const char *req_body, size_t req_body_len))</td></tr>
<tr class="separator:a2bceea525c4f52a46d5c7caeeb68a474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dab0ef6cef893b2dbd767e3c2a3439b"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a6dab0ef6cef893b2dbd767e3c2a3439b">allowed_anonymous_connection_compression_method</a> (<a class="el" href="compress_8h.html#a97a284cf1b98eccbe7964617ed797eee">compress_method_t</a> method)</td></tr>
<tr class="separator:a6dab0ef6cef893b2dbd767e3c2a3439b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d9dde7aa9fb33802d6fe3d97bd8a4cf"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a0d9dde7aa9fb33802d6fe3d97bd8a4cf">warn_disallowed_anonymous_compression_method</a> (<a class="el" href="compress_8h.html#a97a284cf1b98eccbe7964617ed797eee">compress_method_t</a> method)</td></tr>
<tr class="separator:a0d9dde7aa9fb33802d6fe3d97bd8a4cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47a1c51a14441dfc298cce6cc85037d3"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a47a1c51a14441dfc298cce6cc85037d3">handle_get_hs_descriptor_v3</a> (<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn, const <a class="el" href="structget__handler__args__t.html">get_handler_args_t</a> *args)</td></tr>
<tr class="separator:a47a1c51a14441dfc298cce6cc85037d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0672f451aa7446d25a41d229c5080588"><td class="memItemLeft" align="right" valign="top"><a id="a0672f451aa7446d25a41d229c5080588"></a>
STATIC int&#160;</td><td class="memItemRight" valign="bottom"><b>parse_hs_version_from_post</b> (const char *url, const char *prefix, const char **end_pos)</td></tr>
<tr class="separator:a0672f451aa7446d25a41d229c5080588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2767c0d88f0d8ca1bea788cb34d4f13"><td class="memItemLeft" align="right" valign="top"><a id="ab2767c0d88f0d8ca1bea788cb34d4f13"></a>
STATIC int&#160;</td><td class="memItemRight" valign="bottom"><b>handle_post_hs_descriptor</b> (const char *url, const char *body)</td></tr>
<tr class="separator:ab2767c0d88f0d8ca1bea788cb34d4f13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4906b52847ca3ea8ca28665abd4e67df"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a4906b52847ca3ea8ca28665abd4e67df">MOCK_IMPL</a> (STATIC int, directory_handle_command_post,(<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn, const char *headers, const char *body, size_t body_len))</td></tr>
<tr class="separator:a4906b52847ca3ea8ca28665abd4e67df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2e15267200fb185ec30e74b7d16d834"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ac2e15267200fb185ec30e74b7d16d834">directory_handle_command</a> (<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn)</td></tr>
<tr class="separator:ac2e15267200fb185ec30e74b7d16d834"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bcf7851094badfe17ac6f027f70ce2f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a1bcf7851094badfe17ac6f027f70ce2f">connection_dir_finished_flushing</a> (<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn)</td></tr>
<tr class="separator:a1bcf7851094badfe17ac6f027f70ce2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a226f54e5ed405ed992c6a8e79c63a59e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a226f54e5ed405ed992c6a8e79c63a59e">connection_dir_finished_connecting</a> (<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn)</td></tr>
<tr class="separator:a226f54e5ed405ed992c6a8e79c63a59e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5469aca4379b19e5a417cc3612e0560f"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a5469aca4379b19e5a417cc3612e0560f">find_dl_min_delay</a> (const <a class="el" href="structdownload__status__t.html">download_status_t</a> *dls, const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:a5469aca4379b19e5a417cc3612e0560f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41b1ba550eb532e4c9b89a932136a1cf"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a41b1ba550eb532e4c9b89a932136a1cf">next_random_exponential_delay_range</a> (int *low_bound_out, int *high_bound_out, int delay, int base_delay)</td></tr>
<tr class="separator:a41b1ba550eb532e4c9b89a932136a1cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2fb786289a9102d3176381cc0b23447"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#af2fb786289a9102d3176381cc0b23447">next_random_exponential_delay</a> (int delay, int base_delay)</td></tr>
<tr class="separator:af2fb786289a9102d3176381cc0b23447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a436d633af7ce1becc0d71068ed466828"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a436d633af7ce1becc0d71068ed466828">download_status_schedule_get_delay</a> (<a class="el" href="structdownload__status__t.html">download_status_t</a> *dls, int min_delay, time_t now)</td></tr>
<tr class="separator:a436d633af7ce1becc0d71068ed466828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad030aefd2edb06cac0a0477457631fab"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ad030aefd2edb06cac0a0477457631fab">download_status_increment_failure</a> (<a class="el" href="structdownload__status__t.html">download_status_t</a> *dls, int status_code, const char *item, int server, time_t now)</td></tr>
<tr class="separator:ad030aefd2edb06cac0a0477457631fab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfbbd8729f4c0f94b6080020a729bc70"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#abfbbd8729f4c0f94b6080020a729bc70">download_status_increment_attempt</a> (<a class="el" href="structdownload__status__t.html">download_status_t</a> *dls, const char *item, time_t now)</td></tr>
<tr class="separator:abfbbd8729f4c0f94b6080020a729bc70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0c46dd4ad90ff8350a03414a4d79307"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ae0c46dd4ad90ff8350a03414a4d79307">download_status_reset</a> (<a class="el" href="structdownload__status__t.html">download_status_t</a> *dls)</td></tr>
<tr class="separator:ae0c46dd4ad90ff8350a03414a4d79307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a315ee3b1551a73aceac163faecd85"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a59a315ee3b1551a73aceac163faecd85">download_status_get_n_failures</a> (const <a class="el" href="structdownload__status__t.html">download_status_t</a> *dls)</td></tr>
<tr class="separator:a59a315ee3b1551a73aceac163faecd85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a465b447ad179780a88ffb88f1aeae12e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a465b447ad179780a88ffb88f1aeae12e">download_status_get_n_attempts</a> (const <a class="el" href="structdownload__status__t.html">download_status_t</a> *dls)</td></tr>
<tr class="separator:a465b447ad179780a88ffb88f1aeae12e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfdb8594e1a676e38ca79913320dea3e"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#acfdb8594e1a676e38ca79913320dea3e">download_status_get_next_attempt_at</a> (const <a class="el" href="structdownload__status__t.html">download_status_t</a> *dls)</td></tr>
<tr class="separator:acfdb8594e1a676e38ca79913320dea3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37450cb94cd7190d5030b4429ba408c2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#a37450cb94cd7190d5030b4429ba408c2">dir_split_resource_into_fingerprint_pairs</a> (const char *res, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *pairs_out)</td></tr>
<tr class="separator:a37450cb94cd7190d5030b4429ba408c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3cd3a5081cf507805b4b01c907dd168"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ab3cd3a5081cf507805b4b01c907dd168">dir_split_resource_into_fingerprints</a> (const char *resource, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *fp_out, int *compressed_out, int flags)</td></tr>
<tr class="separator:ab3cd3a5081cf507805b4b01c907dd168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad940bd015d7ee064790d67bde5955450"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="directory_8c.html#ad940bd015d7ee064790d67bde5955450">dir_split_resource_into_spoolable</a> (const char *resource, <a class="el" href="dirserv_8h.html#aac355320fd3daf8319b7fb1839c976d3">dir_spool_source_t</a> source, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *spool_out, int *compressed_out, int flags)</td></tr>
<tr class="separator:ad940bd015d7ee064790d67bde5955450"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Code to send and fetch information from directory authorities and caches via HTTP. </p>
<p>Directory caches and authorities use <a class="el" href="dirserv_8c.html" title="Directory server core implementation. Manages directory contents and generates directories. ">dirserv.c</a> to generate the results of a query and stream them to the connection; clients use <a class="el" href="routerparse_8c.html" title="Code to parse and validate router descriptors, consenus directories, and similar objects. ">routerparse.c</a> to parse them.</p>
<p>Every directory request has a <a class="el" href="structdir__connection__t.html">dir_connection_t</a> on the client side and on the server side. In most cases, the <a class="el" href="structdir__connection__t.html">dir_connection_t</a> object is a linked connection, tunneled through an <a class="el" href="structedge__connection__t.html">edge_connection_t</a> so that it can be a stream on the Tor network. The only non-tunneled connections are those that are used to upload material (descriptors and votes) to authorities. Among tunneled connections, some use one-hop circuits, and others use multi-hop circuits for anonymity.</p>
<p>Directory requests are launched by calling directory_initiate_request(). This launch the connection, will construct an HTTP request with directory_send_command(), send the and wait for a response. The client later handles the response with connection_dir_client_reached_eof(), which passes the information received to another part of Tor.</p>
<p>On the server side, requests are read in <a class="el" href="directory_8c.html#ac2e15267200fb185ec30e74b7d16d834">directory_handle_command()</a>, which dispatches first on the request type (GET or POST), and then on the URL requested. GET requests are processed with a table-based dispatcher in url_table[]. The process of handling larger GET requests is complicated because we need to avoid allocating a copy of all the data to be sent to the client in one huge buffer. Instead, we spool the data into the buffer using logic in <a class="el" href="dirserv_8c.html#acb9b2ed7234ed40438a3a5406c823c36">connection_dirserv_flushed_some()</a> in <a class="el" href="dirserv_8c.html" title="Directory server core implementation. Manages directory contents and generates directories. ">dirserv.c</a>. (TODO: If we extended buf.c to have a zero-copy reference-based buffer type, we could remove most of that code, at the cost of a bit more reference counting.) </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a23c309e66997f959d52791af058b27d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23c309e66997f959d52791af058b27d8">&#9670;&nbsp;</a></span>ALLOW_DIRECTORY_TIME_SKEW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ALLOW_DIRECTORY_TIME_SKEW&#160;&#160;&#160;(30*60)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How far in the future do we allow a directory server to tell us it is before deciding that one of us has the wrong time? </p>

</div>
</div>
<a id="a786b40c8b20290b21dc42e54f0691af3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a786b40c8b20290b21dc42e54f0691af3">&#9670;&nbsp;</a></span>FALLBACK_COMPRESS_METHOD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FALLBACK_COMPRESS_METHOD&#160;&#160;&#160;ZLIB_METHOD</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fallback compression method. The fallback compression method is used in case a client requests a non-compressed document. We only store compressed documents, so we use this compression method to fetch the document and let the spooling system do the streaming decompression. </p>

</div>
</div>
<a id="aeae5dbd4c3ad12f7bc3ac494ea30ac3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeae5dbd4c3ad12f7bc3ac494ea30ac3b">&#9670;&nbsp;</a></span>FULL_DIR_CACHE_LIFETIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FULL_DIR_CACHE_LIFETIME&#160;&#160;&#160;(60*60)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>HTTP cache control: how long do we tell proxies they can cache each kind of document we serve? </p>

</div>
</div>
<a id="af12592e94d1a765dfbc59cef089ce947"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af12592e94d1a765dfbc59cef089ce947">&#9670;&nbsp;</a></span>MAX_DIRECTORY_OBJECT_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_DIRECTORY_OBJECT_SIZE&#160;&#160;&#160;(10*(1&lt;&lt;20))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If any directory object is arriving, and it's over 10MB large, we're getting DoS'd. (As of 0.1.2.x, raw directories are about 1MB, and we never ask for more than 96 router descriptors at a time.) </p>

</div>
</div>
<a id="ae94cefe68ab1ccb9a884f52955582b9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae94cefe68ab1ccb9a884f52955582b9a">&#9670;&nbsp;</a></span>SEND_HS_DESC_FAILED_CONTENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEND_HS_DESC_FAILED_CONTENT</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(<a class="code" href="control_8c.html#a2fc2b6b7637cc858a77a37f96129edf4">control_event_hs_descriptor_content</a>(                                 \</div><div class="line">                                rend_data_get_address(conn-&gt;rend_data), \</div><div class="line">                                conn-&gt;requested_resource,               \</div><div class="line">                                conn-&gt;identity_digest,                  \</div><div class="line">                                NULL))</div><div class="ttc" id="control_8c_html_a2fc2b6b7637cc858a77a37f96129edf4"><div class="ttname"><a href="control_8c.html#a2fc2b6b7637cc858a77a37f96129edf4">control_event_hs_descriptor_content</a></div><div class="ttdeci">void control_event_hs_descriptor_content(const char *onion_address, const char *desc_id, const char *hsdir_id_digest, const char *content)</div><div class="ttdef"><b>Definition:</b> control.c:7643</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a698bec7a6cd6eccf990a74309fa20453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a698bec7a6cd6eccf990a74309fa20453">&#9670;&nbsp;</a></span>SEND_HS_DESC_FAILED_EVENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEND_HS_DESC_FAILED_EVENT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">reason</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(<a class="code" href="control_8c.html#a7407c201dd8249d580be5eeb048a74f6">control_event_hsv2_descriptor_failed</a>(conn-&gt;rend_data,                \</div><div class="line">                                        conn-&gt;identity_digest,          \</div><div class="line">                                        reason))</div><div class="ttc" id="control_8c_html_a7407c201dd8249d580be5eeb048a74f6"><div class="ttname"><a href="control_8c.html#a7407c201dd8249d580be5eeb048a74f6">control_event_hsv2_descriptor_failed</a></div><div class="ttdeci">void control_event_hsv2_descriptor_failed(const rend_data_t *rend_data, const char *hsdir_id_digest, const char *reason)</div><div class="ttdef"><b>Definition:</b> control.c:7583</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a44f58716bb3b4c1365a6047c9e0e2b6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44f58716bb3b4c1365a6047c9e0e2b6d">&#9670;&nbsp;</a></span>SEND_HS_DESC_UPLOAD_FAILED_EVENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEND_HS_DESC_UPLOAD_FAILED_EVENT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">reason</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(<a class="code" href="control_8c.html#a3dbd4bf59a3490e0272203314f56a66c">control_event_hs_descriptor_upload_failed</a>(                         \</div><div class="line">                                conn-&gt;identity_digest,                  \</div><div class="line">                                rend_data_get_address(conn-&gt;rend_data), \</div><div class="line">                                reason))</div><div class="ttc" id="control_8c_html_a3dbd4bf59a3490e0272203314f56a66c"><div class="ttname"><a href="control_8c.html#a3dbd4bf59a3490e0272203314f56a66c">control_event_hs_descriptor_upload_failed</a></div><div class="ttdeci">void control_event_hs_descriptor_upload_failed(const char *id_digest, const char *onion_address, const char *reason)</div><div class="ttdef"><b>Definition:</b> control.c:7680</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ad24e8866486cbc6cb9e986c747d5f0b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad24e8866486cbc6cb9e986c747d5f0b4">&#9670;&nbsp;</a></span>get_handler_args_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structget__handler__args__t.html">get_handler_args_t</a>  <a class="el" href="structget__handler__args__t.html">get_handler_args_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Information passed to handle a GET request. </p>

</div>
</div>
<a id="a696a8ba1f088d30327bf3f2ded94a66e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a696a8ba1f088d30327bf3f2ded94a66e">&#9670;&nbsp;</a></span>url_table_ent_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structurl__table__ent__s.html">url_table_ent_s</a>  <a class="el" href="directory_8c.html#a696a8ba1f088d30327bf3f2ded94a66e">url_table_ent_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Entry for handling an HTTP GET request.</p>
<p>This entry matches a request if "string" is equal to the requested resource, or if "is_prefix" is true and "string" is a prefix of the requested resource.</p>
<p>The 'handler' function is called to handle the request. It receives an arguments structure, and must return 0 on success or -1 if we should close the connection. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8a2c89221d62ce64156e43f67f4982e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a2c89221d62ce64156e43f67f4982e0">&#9670;&nbsp;</a></span>accept_encoding_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC char* accept_encoding_header </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a newly allocated string containing a comma separated list of supported encodings. </p>

</div>
</div>
<a id="a6dab0ef6cef893b2dbd767e3c2a3439b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dab0ef6cef893b2dbd767e3c2a3439b">&#9670;&nbsp;</a></span>allowed_anonymous_connection_compression_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int allowed_anonymous_connection_compression_method </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="compress_8h.html#a97a284cf1b98eccbe7964617ed797eee">compress_method_t</a>&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if the given compression method is allowed for a connection that is supposed to be anonymous. Returns 1 if the compression method is allowed, otherwise 0. </p>

</div>
</div>
<a id="a6845d69b14a9dc6d04ee5c8b333f8ece"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6845d69b14a9dc6d04ee5c8b333f8ece">&#9670;&nbsp;</a></span>authdir_type_to_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC char* authdir_type_to_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a>&#160;</td>
          <td class="paramname"><em>auth</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a newly allocated string describing <b>auth</b>. Only describes authority features. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a6845d69b14a9dc6d04ee5c8b333f8ece_cgraph.png" border="0" usemap="#directory_8c_a6845d69b14a9dc6d04ee5c8b333f8ece_cgraph" alt=""/></div>
<map name="directory_8c_a6845d69b14a9dc6d04ee5c8b333f8ece_cgraph" id="directory_8c_a6845d69b14a9dc6d04ee5c8b333f8ece_cgraph">
<area shape="rect" id="node2" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="227,5,327,32"/>
<area shape="rect" id="node3" href="container_8c.html#ab865391a8cac688c51809c33dad0bfe2" title="smartlist_join_strings" alt="" coords="204,56,349,83"/>
<area shape="rect" id="node4" href="container_8c.html#aac69a4c0d462859a1a13a6eb35ab3c0a" title="smartlist_join_strings2" alt="" coords="397,56,549,83"/>
</map>
</div>

</div>
</div>
<a id="add0e4d43f10e958101ec91c0307d9301"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add0e4d43f10e958101ec91c0307d9301">&#9670;&nbsp;</a></span>choose_compression_level()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="compress_8h.html#a9b39944b30ed9c4a72586a820e59b0ec">compression_level_t</a> choose_compression_level </td>
          <td>(</td>
          <td class="paramtype">ssize_t&#160;</td>
          <td class="paramname"><em>n_bytes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the compression level we should use for sending a compressed response of size <b>n_bytes</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_add0e4d43f10e958101ec91c0307d9301_cgraph.png" border="0" usemap="#directory_8c_add0e4d43f10e958101ec91c0307d9301_cgraph" alt=""/></div>
<map name="directory_8c_add0e4d43f10e958101ec91c0307d9301_cgraph" id="directory_8c_add0e4d43f10e958101ec91c0307d9301_cgraph">
<area shape="rect" id="node2" href="relay_8c.html#a7cdcc52f9a06a285c55d5e18220325a9" title="have_been_under_memory\l_pressure" alt="" coords="199,5,377,47"/>
<area shape="rect" id="node3" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="425,13,519,39"/>
</map>
</div>

</div>
</div>
<a id="ae225c64a35559d7a6e7b06d8fd5c121c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae225c64a35559d7a6e7b06d8fd5c121c">&#9670;&nbsp;</a></span>connection_dir_about_to_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_dir_about_to_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdir__connection__t.html">dir_connection_t</a> *&#160;</td>
          <td class="paramname"><em>dir_conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we're about to finally unlink and free a directory connection: perform necessary accounting and cleanup </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_ae225c64a35559d7a6e7b06d8fd5c121c_icgraph.png" border="0" usemap="#directory_8c_ae225c64a35559d7a6e7b06d8fd5c121c_icgraph" alt=""/></div>
<map name="directory_8c_ae225c64a35559d7a6e7b06d8fd5c121c_icgraph" id="directory_8c_ae225c64a35559d7a6e7b06d8fd5c121c_icgraph">
<area shape="rect" id="node2" href="connection_8h.html#ade7f55aa182a3f727d25a510566351fd" title="connection_about_to\l_close_connection" alt="" coords="199,5,341,47"/>
</map>
</div>

</div>
</div>
<a id="a226f54e5ed405ed992c6a8e79c63a59e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a226f54e5ed405ed992c6a8e79c63a59e">&#9670;&nbsp;</a></span>connection_dir_finished_connecting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_dir_finished_connecting </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdir__connection__t.html">dir_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Connected handler for directory connections: begin sending data to the server, and return 0. Only used when connections don't immediately connect. </p>

</div>
</div>
<a id="a1bcf7851094badfe17ac6f027f70ce2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bcf7851094badfe17ac6f027f70ce2f">&#9670;&nbsp;</a></span>connection_dir_finished_flushing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_dir_finished_flushing </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdir__connection__t.html">dir_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write handler for directory connections; called when all data has been flushed. Close the connection or wait for a response as appropriate. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a1bcf7851094badfe17ac6f027f70ce2f_cgraph.png" border="0" usemap="#directory_8c_a1bcf7851094badfe17ac6f027f70ce2f_cgraph" alt=""/></div>
<map name="directory_8c_a1bcf7851094badfe17ac6f027f70ce2f_cgraph" id="directory_8c_a1bcf7851094badfe17ac6f027f70ce2f_cgraph">
<area shape="rect" id="node2" href="geoip_8c.html#a2a34cf4b056ecac0418dcc5927b03bb6" title="geoip_change_dirreq\l_state" alt="" coords="212,5,353,47"/>
</map>
</div>

</div>
</div>
<a id="a60ea9fd0d00375fc50652182d4d35a93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60ea9fd0d00375fc50652182d4d35a93">&#9670;&nbsp;</a></span>connection_dir_is_encrypted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_dir_is_encrypted </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdir__connection__t.html">dir_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff anything we say on <b>conn</b> is being encrypted before we send it to the client/server. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a60ea9fd0d00375fc50652182d4d35a93_icgraph.png" border="0" usemap="#directory_8c_a60ea9fd0d00375fc50652182d4d35a93_icgraph" alt=""/></div>
<map name="directory_8c_a60ea9fd0d00375fc50652182d4d35a93_icgraph" id="directory_8c_a60ea9fd0d00375fc50652182d4d35a93_icgraph">
<area shape="rect" id="node2" href="directory_8c.html#a47a1c51a14441dfc298cce6cc85037d3" title="handle_get_hs_descriptor_v3" alt="" coords="240,5,431,32"/>
</map>
</div>

</div>
</div>
<a id="af2bfa4b827d711bd2ed6bdeb506c8b6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2bfa4b827d711bd2ed6bdeb506c8b6d">&#9670;&nbsp;</a></span>connection_dir_process_inbuf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_dir_process_inbuf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdir__connection__t.html">dir_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read handler for directory connections. (That's connections <em>to</em> directory servers and connections <em>at</em> directory servers.) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_af2bfa4b827d711bd2ed6bdeb506c8b6d_cgraph.png" border="0" usemap="#directory_8c_af2bfa4b827d711bd2ed6bdeb506c8b6d_cgraph" alt=""/></div>
<map name="directory_8c_af2bfa4b827d711bd2ed6bdeb506c8b6d_cgraph" id="directory_8c_af2bfa4b827d711bd2ed6bdeb506c8b6d_cgraph">
<area shape="rect" id="node2" href="directory_8c.html#ac2e15267200fb185ec30e74b7d16d834" title="directory_handle_command" alt="" coords="212,13,393,39"/>
<area shape="rect" id="node3" href="connection_8c.html#a173a993b4f9bcc7522f35c56e65b615f" title="connection_fetch_from\l_buf_http" alt="" coords="441,5,596,47"/>
</map>
</div>

</div>
</div>
<a id="ad0f61e005774a8b52467b2dea7528d2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0f61e005774a8b52467b2dea7528d2a">&#9670;&nbsp;</a></span>connection_dir_reached_eof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_dir_reached_eof </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdir__connection__t.html">dir_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when a directory connection reaches EOF. </p>

</div>
</div>
<a id="a8aabd75f035464ab0450ff60098e97d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8aabd75f035464ab0450ff60098e97d4">&#9670;&nbsp;</a></span>dir_conn_purpose_to_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC const char* dir_conn_purpose_to_string </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>purpose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a string describing a given directory connection purpose. </p>

</div>
</div>
<a id="ad69764afab6303ccc89d0571264db191"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad69764afab6303ccc89d0571264db191">&#9670;&nbsp;</a></span>dir_fetch_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a> dir_fetch_type </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir_purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>router_purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the requisite directory information types. </p>

</div>
</div>
<a id="a37450cb94cd7190d5030b4429ba408c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37450cb94cd7190d5030b4429ba408c2">&#9670;&nbsp;</a></span>dir_split_resource_into_fingerprint_pairs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dir_split_resource_into_fingerprint_pairs </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>pairs_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Divide a string <b>res</b> of the form FP1-FP2+FP3-FP4...[.z], where each FP is a hex-encoded fingerprint, into a sequence of distinct sorted <a class="el" href="structfp__pair__t.html">fp_pair_t</a>. Skip malformed pairs. On success, return 0 and add those <a class="el" href="structfp__pair__t.html">fp_pair_t</a> into <b>pairs_out</b>. On failure, return -1. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a37450cb94cd7190d5030b4429ba408c2_cgraph.png" border="0" usemap="#directory_8c_a37450cb94cd7190d5030b4429ba408c2_cgraph" alt=""/></div>
<map name="directory_8c_a37450cb94cd7190d5030b4429ba408c2_cgraph" id="directory_8c_a37450cb94cd7190d5030b4429ba408c2_cgraph">
<area shape="rect" id="node2" href="container_8c.html#a1d75cac5583c66900c032ba972ffabc8" title="smartlist_split_string" alt="" coords="203,13,345,39"/>
</map>
</div>

</div>
</div>
<a id="ab3cd3a5081cf507805b4b01c907dd168"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3cd3a5081cf507805b4b01c907dd168">&#9670;&nbsp;</a></span>dir_split_resource_into_fingerprints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dir_split_resource_into_fingerprints </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>fp_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>compressed_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a directory <b>resource</b> request, containing zero or more strings separated by plus signs, followed optionally by ".z", store the strings, in order, into <b>fp_out</b>. If <b>compressed_out</b> is non-NULL, set it to 1 if the resource ends in ".z", else set it to 0.</p>
<p>If (flags &amp; DSR_HEX), then delete all elements that aren't hex digests, and decode the rest. If (flags &amp; DSR_BASE64), then use "-" rather than "+" as a separator, delete all the elements that aren't base64-encoded digests, and decode the rest. If (flags &amp; DSR_DIGEST256), these digests should be 256 bits long; else they should be 160.</p>
<p>If (flags &amp; DSR_SORT_UNIQ), then sort the list and remove all duplicates. </p>

</div>
</div>
<a id="ad940bd015d7ee064790d67bde5955450"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad940bd015d7ee064790d67bde5955450">&#9670;&nbsp;</a></span>dir_split_resource_into_spoolable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dir_split_resource_into_spoolable </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dirserv_8h.html#aac355320fd3daf8319b7fb1839c976d3">dir_spool_source_t</a>&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>spool_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>compressed_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As dir_split_resource_into_fingerprints, but instead fills <b>spool_out</b> with a list of spoolable_resource_t for the resource identified through <b>source</b>. </p>

</div>
</div>
<a id="ae4524a59d1b721804ba0cb5c0b7cf53a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4524a59d1b721804ba0cb5c0b7cf53a">&#9670;&nbsp;</a></span>directories_have_accepted_server_descriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int directories_have_accepted_server_descriptor </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff any trusted directory authority has accepted our server descriptor.</p>
<p>We consider any authority sufficient because waiting for all of them means it never happens while any authority is down; we don't go for something more complex in the middle (like &gt;1/3 or &gt;1/2 or &gt;=1/2) because that doesn't seem necessary yet. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_ae4524a59d1b721804ba0cb5c0b7cf53a_cgraph.png" border="0" usemap="#directory_8c_ae4524a59d1b721804ba0cb5c0b7cf53a_cgraph" alt=""/></div>
<map name="directory_8c_ae4524a59d1b721804ba0cb5c0b7cf53a_cgraph" id="directory_8c_ae4524a59d1b721804ba0cb5c0b7cf53a_cgraph">
<area shape="rect" id="node2" href="routerlist_8c.html#aa9b36f7b87463dc114065ea058660ac4" title="router_get_trusted\l_dir_servers" alt="" coords="231,5,357,47"/>
</map>
</div>

</div>
</div>
<a id="a13483821c102fb862ab0d27091d7ffc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13483821c102fb862ab0d27091d7ffc7">&#9670;&nbsp;</a></span>directory_get_from_all_authorities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_get_from_all_authorities </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dir_purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>router_purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As directory_get_from_dirserver, but initiates a request to <em>every</em> directory authority other than ourself. Only for use by authorities when searching for missing information while voting. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a13483821c102fb862ab0d27091d7ffc7_cgraph.png" border="0" usemap="#directory_8c_a13483821c102fb862ab0d27091d7ffc7_cgraph" alt=""/></div>
<map name="directory_8c_a13483821c102fb862ab0d27091d7ffc7_cgraph" id="directory_8c_a13483821c102fb862ab0d27091d7ffc7_cgraph">
<area shape="rect" id="node2" href="routerlist_8c.html#aa9b36f7b87463dc114065ea058660ac4" title="router_get_trusted\l_dir_servers" alt="" coords="197,5,324,47"/>
<area shape="rect" id="node3" href="router_8c.html#abeb0f38915a46f77352900604075d82f" title="router_digest_is_me" alt="" coords="191,71,330,98"/>
<area shape="rect" id="node5" href="directory_8c.html#a85c888ac5ae7e9877281b1c87483cee1" title="directory_request_new" alt="" coords="184,122,337,149"/>
<area shape="rect" id="node6" href="directory_8c.html#a80d02180af0001ba29cdb088eeab3fba" title="directory_request_set\l_routerstatus" alt="" coords="187,173,334,215"/>
<area shape="rect" id="node7" href="directory_8c.html#a9573f64df7aa31baf290b23ca8dbcee2" title="directory_request_set\l_router_purpose" alt="" coords="187,239,334,280"/>
<area shape="rect" id="node8" href="directory_8c.html#a0f8877f88add95ceea302a569a095569" title="directory_request_set\l_resource" alt="" coords="187,304,334,345"/>
<area shape="rect" id="node4" href="di__ops_8c.html#a473334ee93cca0aea10523321a444ea3" title="tor_memeq" alt="" coords="385,71,472,98"/>
</map>
</div>

</div>
</div>
<a id="ac2e15267200fb185ec30e74b7d16d834"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2e15267200fb185ec30e74b7d16d834">&#9670;&nbsp;</a></span>directory_handle_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int directory_handle_command </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdir__connection__t.html">dir_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when a dirserver receives data on a directory connection; looks for an HTTP request. If the request is complete, remove it from the inbuf, try to process it; otherwise, leave it on the buffer. Return a 0 on success, or -1 on error. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_ac2e15267200fb185ec30e74b7d16d834_cgraph.png" border="0" usemap="#directory_8c_ac2e15267200fb185ec30e74b7d16d834_cgraph" alt=""/></div>
<map name="directory_8c_ac2e15267200fb185ec30e74b7d16d834_cgraph" id="directory_8c_ac2e15267200fb185ec30e74b7d16d834_cgraph">
<area shape="rect" id="node2" href="connection_8c.html#a173a993b4f9bcc7522f35c56e65b615f" title="connection_fetch_from\l_buf_http" alt="" coords="235,5,389,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_ac2e15267200fb185ec30e74b7d16d834_icgraph.png" border="0" usemap="#directory_8c_ac2e15267200fb185ec30e74b7d16d834_icgraph" alt=""/></div>
<map name="directory_8c_ac2e15267200fb185ec30e74b7d16d834_icgraph" id="directory_8c_ac2e15267200fb185ec30e74b7d16d834_icgraph">
<area shape="rect" id="node2" href="directory_8h.html#af2bfa4b827d711bd2ed6bdeb506c8b6d" title="connection_dir_process\l_inbuf" alt="" coords="235,5,393,47"/>
</map>
</div>

</div>
</div>
<a id="aace63698f64d26bc7a14531381e2fa57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aace63698f64d26bc7a14531381e2fa57">&#9670;&nbsp;</a></span>directory_post_to_dirservers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_post_to_dirservers </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dir_purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>router_purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>payload_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>extrainfo_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Start a connection to every suitable directory authority, using connection purpose <b>dir_purpose</b> and uploading <b>payload</b> (of length <b>payload_len</b>). The dir_purpose should be one of 'DIR_PURPOSE_UPLOAD_{DIR|VOTE|SIGNATURES}'.</p>
<p><b>router_purpose</b> describes the type of descriptor we're publishing, if we're publishing a descriptor &ndash; e.g. general or bridge.</p>
<p><b>type</b> specifies what sort of dir authorities (V3, BRIDGE, etc) we should upload to.</p>
<p>If <b>extrainfo_len</b> is nonzero, the first <b>payload_len</b> bytes of <b>payload</b> hold a router descriptor, and the next <b>extrainfo_len</b> bytes of <b>payload</b> hold an extra-info document. Upload the descriptor to all authorities, and the extra-info document to all authorities that support it. </p>

</div>
</div>
<a id="af68afba474b93d9917f8b76d739b8505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af68afba474b93d9917f8b76d739b8505">&#9670;&nbsp;</a></span>directory_request_add_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_add_header </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Include a header of name <b>key</b> with content <b>val</b> in the request. Neither may include newlines or other odd characters. Their ordering is not currently guaranteed.</p>
<p>Note that, as elsewhere in this module, header keys include a trailing colon and space. </p>

</div>
</div>
<a id="ad8944f29dae81e9931e0bdef3b39e407"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8944f29dae81e9931e0bdef3b39e407">&#9670;&nbsp;</a></span>directory_request_fetch_set_hs_ident()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_fetch_set_hs_ident </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="strucths__ident__dir__conn__t.html">hs_ident_dir_conn_t</a> *&#160;</td>
          <td class="paramname"><em>ident</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set an object containing HS connection identifier to be associated with this fetch request. Note that only an alias to <b>ident</b> is stored, so the <b>ident</b> object must outlive the request. </p>

</div>
</div>
<a id="a76bf5075b1b3e4131f2c4cf5ca0f0d8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76bf5075b1b3e4131f2c4cf5ca0f0d8b">&#9670;&nbsp;</a></span>directory_request_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_free_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all resources held by <b>req</b>. </p>

</div>
</div>
<a id="a85c888ac5ae7e9877281b1c87483cee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85c888ac5ae7e9877281b1c87483cee1">&#9670;&nbsp;</a></span>directory_request_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a>* directory_request_new </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dir_purpose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create and return a new directory_request_t with purpose <b>dir_purpose</b>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a85c888ac5ae7e9877281b1c87483cee1_icgraph.png" border="0" usemap="#directory_8c_a85c888ac5ae7e9877281b1c87483cee1_icgraph" alt=""/></div>
<map name="directory_8c_a85c888ac5ae7e9877281b1c87483cee1_icgraph" id="directory_8c_a85c888ac5ae7e9877281b1c87483cee1_icgraph">
<area shape="rect" id="node2" href="directory_8h.html#a13483821c102fb862ab0d27091d7ffc7" title="directory_get_from\l_all_authorities" alt="" coords="207,5,337,47"/>
</map>
</div>

</div>
</div>
<a id="a54586f3724c9b07dc9a28da6c496f92c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54586f3724c9b07dc9a28da6c496f92c">&#9670;&nbsp;</a></span>directory_request_set_dir_addr_port()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_set_dir_addr_port </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtor__addr__port__t.html">tor_addr_port_t</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the address and dirport to use for this directory request. If there is no dirport, we'll have to connect over the OR port. (If there are both, the indirection setting determines which to use.) </p>

</div>
</div>
<a id="aa8e97475dd051b61e3e32585a7a3cf6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8e97475dd051b61e3e32585a7a3cf6c">&#9670;&nbsp;</a></span>directory_request_set_directory_id_digest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_set_directory_id_digest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>digest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the RSA identity digest of the directory to use for this directory request. </p>

</div>
</div>
<a id="a619df20778c681f53b681bebc9802976"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a619df20778c681f53b681bebc9802976">&#9670;&nbsp;</a></span>directory_request_set_guard_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_set_guard_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">circuit_guard_state_t *&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set a static circuit_guard_state_t object to affliate with the request in <b>req</b>. This object will receive notification when the attempt to connect to the guard either succeeds or fails. </p>

</div>
</div>
<a id="a2378f74f545dc3bd8f37daaacbf56294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2378f74f545dc3bd8f37daaacbf56294">&#9670;&nbsp;</a></span>directory_request_set_if_modified_since()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_set_if_modified_since </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>if_modified_since</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set an if-modified-since date to send along with the request. The default is 0 (meaning, send no if-modified-since header). </p>

</div>
</div>
<a id="a73c93da738cdb4945e336e4efc37dce7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73c93da738cdb4945e336e4efc37dce7">&#9670;&nbsp;</a></span>directory_request_set_indirection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_set_indirection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a1c9628f500a2efb8bacf72a85faf121b">dir_indirection_t</a>&#160;</td>
          <td class="paramname"><em>indirection</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the indirection to be used for the directory request. The indirection parameter configures whether to connect to a DirPort or ORPort, and whether to anonymize the connection. DIRIND_ONEHOP (use ORPort, don't anonymize) is the default. See dir_indirection_t for more information. </p>

</div>
</div>
<a id="a0fad9324c6504d8bf509247168e1b819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fad9324c6504d8bf509247168e1b819">&#9670;&nbsp;</a></span>directory_request_set_or_addr_port()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_set_or_addr_port </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtor__addr__port__t.html">tor_addr_port_t</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the address and OR port to use for this directory request. If there is no OR port, we'll have to connect over the dirport. (If there are both, the indirection setting determines which to use.) </p>

</div>
</div>
<a id="ac2f9c30557e169548ab5871462d6ddd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2f9c30557e169548ab5871462d6ddd6">&#9670;&nbsp;</a></span>directory_request_set_payload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_set_payload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>payload_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set a pointer to the payload to include with this directory request, along with its length. Note that only an alias to <b>payload</b> is stored, so the <b>payload</b> must outlive the request. </p>

</div>
</div>
<a id="aa038c1c27a5a5469ce9745a65fe1458e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa038c1c27a5a5469ce9745a65fe1458e">&#9670;&nbsp;</a></span>directory_request_set_rend_query()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_set_rend_query </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structrend__data__t.html">rend_data_t</a> *&#160;</td>
          <td class="paramname"><em>query</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set an object containing HS data to be associated with this request. Note that only an alias to <b>query</b> is stored, so the <b>query</b> object must outlive the request. </p>

</div>
</div>
<a id="a0f8877f88add95ceea302a569a095569"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f8877f88add95ceea302a569a095569">&#9670;&nbsp;</a></span>directory_request_set_resource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_set_resource </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set a pointer to the resource to request from a directory. Different request types use resources to indicate different components of their URL. Note that only an alias to <b>resource</b> is stored, so the <b>resource</b> must outlive the request. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a0f8877f88add95ceea302a569a095569_icgraph.png" border="0" usemap="#directory_8c_a0f8877f88add95ceea302a569a095569_icgraph" alt=""/></div>
<map name="directory_8c_a0f8877f88add95ceea302a569a095569_icgraph" id="directory_8c_a0f8877f88add95ceea302a569a095569_icgraph">
<area shape="rect" id="node2" href="directory_8h.html#a13483821c102fb862ab0d27091d7ffc7" title="directory_get_from\l_all_authorities" alt="" coords="200,5,331,47"/>
</map>
</div>

</div>
</div>
<a id="a9573f64df7aa31baf290b23ca8dbcee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9573f64df7aa31baf290b23ca8dbcee2">&#9670;&nbsp;</a></span>directory_request_set_router_purpose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_set_router_purpose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>router_purpose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the router purpose associated with uploaded and downloaded router descriptors and extrainfo documents in this directory request. The purpose must be one of ROUTER_PURPOSE_GENERAL (the default) or ROUTER_PURPOSE_BRIDGE. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a9573f64df7aa31baf290b23ca8dbcee2_icgraph.png" border="0" usemap="#directory_8c_a9573f64df7aa31baf290b23ca8dbcee2_icgraph" alt=""/></div>
<map name="directory_8c_a9573f64df7aa31baf290b23ca8dbcee2_icgraph" id="directory_8c_a9573f64df7aa31baf290b23ca8dbcee2_icgraph">
<area shape="rect" id="node2" href="directory_8h.html#a13483821c102fb862ab0d27091d7ffc7" title="directory_get_from\l_all_authorities" alt="" coords="200,5,331,47"/>
</map>
</div>

</div>
</div>
<a id="a80d02180af0001ba29cdb088eeab3fba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80d02180af0001ba29cdb088eeab3fba">&#9670;&nbsp;</a></span>directory_request_set_routerstatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_set_routerstatus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structrouterstatus__t.html">routerstatus_t</a> *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the routerstatus to use for the directory associated with this request. If this option is set, then no other function to set the directory's address or identity should be called. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a80d02180af0001ba29cdb088eeab3fba_icgraph.png" border="0" usemap="#directory_8c_a80d02180af0001ba29cdb088eeab3fba_icgraph" alt=""/></div>
<map name="directory_8c_a80d02180af0001ba29cdb088eeab3fba_icgraph" id="directory_8c_a80d02180af0001ba29cdb088eeab3fba_icgraph">
<area shape="rect" id="node2" href="directory_8h.html#a13483821c102fb862ab0d27091d7ffc7" title="directory_get_from\l_all_authorities" alt="" coords="200,5,331,47"/>
</map>
</div>

</div>
</div>
<a id="afb1872de41e8c93f3995a3cd6de31382"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb1872de41e8c93f3995a3cd6de31382">&#9670;&nbsp;</a></span>directory_request_upload_set_hs_ident()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_request_upload_set_hs_ident </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="strucths__ident__dir__conn__t.html">hs_ident_dir_conn_t</a> *&#160;</td>
          <td class="paramname"><em>ident</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set an object containing HS connection identifier to be associated with this request. Note that only an alias to <b>ident</b> is stored, so the <b>ident</b> object must outlive the request. </p>

</div>
</div>
<a id="a465b447ad179780a88ffb88f1aeae12e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a465b447ad179780a88ffb88f1aeae12e">&#9670;&nbsp;</a></span>download_status_get_n_attempts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int download_status_get_n_attempts </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdownload__status__t.html">download_status_t</a> *&#160;</td>
          <td class="paramname"><em>dls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of attempts to download <b>dls</b> since the last success (if any). This can differ from <a class="el" href="directory_8c.html#a59a315ee3b1551a73aceac163faecd85">download_status_get_n_failures()</a> due to outstanding concurrent attempts. </p>

</div>
</div>
<a id="a59a315ee3b1551a73aceac163faecd85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59a315ee3b1551a73aceac163faecd85">&#9670;&nbsp;</a></span>download_status_get_n_failures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int download_status_get_n_failures </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdownload__status__t.html">download_status_t</a> *&#160;</td>
          <td class="paramname"><em>dls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of failures on <b>dls</b> since the last success (if any). </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a59a315ee3b1551a73aceac163faecd85_icgraph.png" border="0" usemap="#directory_8c_a59a315ee3b1551a73aceac163faecd85_icgraph" alt=""/></div>
<map name="directory_8c_a59a315ee3b1551a73aceac163faecd85_icgraph" id="directory_8c_a59a315ee3b1551a73aceac163faecd85_icgraph">
<area shape="rect" id="node2" href="routerlist_8h.html#af0674d915ac20d064542496c8a8c2c26" title="authority_cert_dl_looks\l_uncertain" alt="" coords="199,5,355,47"/>
</map>
</div>

</div>
</div>
<a id="acfdb8594e1a676e38ca79913320dea3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfdb8594e1a676e38ca79913320dea3e">&#9670;&nbsp;</a></span>download_status_get_next_attempt_at()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t download_status_get_next_attempt_at </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdownload__status__t.html">download_status_t</a> *&#160;</td>
          <td class="paramname"><em>dls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the next time to attempt to download <b>dls</b>. </p>

</div>
</div>
<a id="abfbbd8729f4c0f94b6080020a729bc70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfbbd8729f4c0f94b6080020a729bc70">&#9670;&nbsp;</a></span>download_status_increment_attempt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t download_status_increment_attempt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdownload__status__t.html">download_status_t</a> *&#160;</td>
          <td class="paramname"><em>dls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>item</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine when the next download attempt should be made when using an attempt-based (potentially concurrent) download schedule. Called when an attempt to download <b>dls</b> is being initiated. Increment the attempt count and set <b>dls</b>-&gt;next_attempt_at to an appropriate time in the future and return it. If <b>dls-&gt;increment_on</b> is DL_SCHED_INCREMENT_FAILURE, don't increment the attempts, and return a time in the far future (to avoid launching a concurrent attempt). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_abfbbd8729f4c0f94b6080020a729bc70_cgraph.png" border="0" usemap="#directory_8c_abfbbd8729f4c0f94b6080020a729bc70_cgraph" alt=""/></div>
<map name="directory_8c_abfbbd8729f4c0f94b6080020a729bc70_cgraph" id="directory_8c_abfbbd8729f4c0f94b6080020a729bc70_cgraph">
<area shape="rect" id="node2" href="directory_8c.html#ae0c46dd4ad90ff8350a03414a4d79307" title="download_status_reset" alt="" coords="237,13,393,39"/>
</map>
</div>

</div>
</div>
<a id="ad030aefd2edb06cac0a0477457631fab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad030aefd2edb06cac0a0477457631fab">&#9670;&nbsp;</a></span>download_status_increment_failure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t download_status_increment_failure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdownload__status__t.html">download_status_t</a> *&#160;</td>
          <td class="paramname"><em>dls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>item</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>server</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine when a failed download attempt should be retried. Called when an attempt to download <b>dls</b> has failed with HTTP status <b>status_code</b>. Increment the failure count (if the code indicates a real failure, or if we're a server) and set <b>dls</b>-&gt;next_attempt_at to an appropriate time in the future and return it. If <b>dls-&gt;increment_on</b> is DL_SCHED_INCREMENT_ATTEMPT, increment the failure count, and return a time in the far future for the next attempt (to avoid an immediate retry). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_ad030aefd2edb06cac0a0477457631fab_cgraph.png" border="0" usemap="#directory_8c_ad030aefd2edb06cac0a0477457631fab_cgraph" alt=""/></div>
<map name="directory_8c_ad030aefd2edb06cac0a0477457631fab_cgraph" id="directory_8c_ad030aefd2edb06cac0a0477457631fab_cgraph">
<area shape="rect" id="node2" href="directory_8c.html#ae0c46dd4ad90ff8350a03414a4d79307" title="download_status_reset" alt="" coords="237,13,393,39"/>
</map>
</div>

</div>
</div>
<a id="ae0c46dd4ad90ff8350a03414a4d79307"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0c46dd4ad90ff8350a03414a4d79307">&#9670;&nbsp;</a></span>download_status_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void download_status_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdownload__status__t.html">download_status_t</a> *&#160;</td>
          <td class="paramname"><em>dls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reset <b>dls</b> so that it will be considered downloadable immediately, and/or to show that we don't need it anymore.</p>
<p>Must be called to initialise a download schedule, otherwise the zeroth item in the schedule will never be used.</p>
<p>(We find the zeroth element of the download schedule, and set next_attempt_at to be the appropriate offset from 'now'. In most cases this means setting it to 'now', so the item will be immediately downloadable; when using authorities with fallbacks, there is a few seconds' delay.) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_ae0c46dd4ad90ff8350a03414a4d79307_icgraph.png" border="0" usemap="#directory_8c_ae0c46dd4ad90ff8350a03414a4d79307_icgraph" alt=""/></div>
<map name="directory_8c_ae0c46dd4ad90ff8350a03414a4d79307_icgraph" id="directory_8c_ae0c46dd4ad90ff8350a03414a4d79307_icgraph">
<area shape="rect" id="node2" href="directory_8h.html#ad030aefd2edb06cac0a0477457631fab" title="download_status_increment\l_failure" alt="" coords="209,5,393,47"/>
<area shape="rect" id="node3" href="directory_8h.html#abfbbd8729f4c0f94b6080020a729bc70" title="download_status_increment\l_attempt" alt="" coords="209,71,393,112"/>
</map>
</div>

</div>
</div>
<a id="a436d633af7ce1becc0d71068ed466828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a436d633af7ce1becc0d71068ed466828">&#9670;&nbsp;</a></span>download_status_schedule_get_delay()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int download_status_schedule_get_delay </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdownload__status__t.html">download_status_t</a> *&#160;</td>
          <td class="paramname"><em>dls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>min_delay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find the current delay for dls based on min_delay.</p>
<p>This function sets dls-&gt;next_attempt_at based on now, and returns the delay. Helper for download_status_increment_failure and download_status_increment_attempt. </p>

</div>
</div>
<a id="a5469aca4379b19e5a417cc3612e0560f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5469aca4379b19e5a417cc3612e0560f">&#9670;&nbsp;</a></span>find_dl_min_delay()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int find_dl_min_delay </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdownload__status__t.html">download_status_t</a> *&#160;</td>
          <td class="paramname"><em>dls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decide which download schedule we want to use based on descriptor type in <b>dls</b> and <b>options</b>.</p>
<p>Then, return the initial delay for that download schedule, in seconds.</p>
<p>Helper function for <a class="el" href="directory_8c.html#ad030aefd2edb06cac0a0477457631fab">download_status_increment_failure()</a>, <a class="el" href="directory_8c.html#ae0c46dd4ad90ff8350a03414a4d79307">download_status_reset()</a>, and <a class="el" href="directory_8c.html#abfbbd8729f4c0f94b6080020a729bc70">download_status_increment_attempt()</a>. </p>

</div>
</div>
<a id="a47a1c51a14441dfc298cce6cc85037d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47a1c51a14441dfc298cce6cc85037d3">&#9670;&nbsp;</a></span>handle_get_hs_descriptor_v3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int handle_get_hs_descriptor_v3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdir__connection__t.html">dir_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structget__handler__args__t.html">get_handler_args_t</a> *&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function for GET /tor/hs/3/&lt;z&gt;. Only for version 3. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a47a1c51a14441dfc298cce6cc85037d3_cgraph.png" border="0" usemap="#directory_8c_a47a1c51a14441dfc298cce6cc85037d3_cgraph" alt=""/></div>
<map name="directory_8c_a47a1c51a14441dfc298cce6cc85037d3_cgraph" id="directory_8c_a47a1c51a14441dfc298cce6cc85037d3_cgraph">
<area shape="rect" id="node2" href="directory_8c.html#a60ea9fd0d00375fc50652182d4d35a93" title="connection_dir_is_encrypted" alt="" coords="244,5,431,32"/>
</map>
</div>

</div>
</div>
<a id="a4af7e7ade522a1f118e7770955ff50ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4af7e7ade522a1f118e7770955ff50ea">&#9670;&nbsp;</a></span>handle_response_fetch_consensus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int handle_response_fetch_consensus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdir__connection__t.html">dir_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const response_handler_args_t *&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handler function: processes a response to a request for a networkstatus consensus document by checking the consensus, storing it, and marking router requests as reachable. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a4af7e7ade522a1f118e7770955ff50ea_cgraph.png" border="0" usemap="#directory_8c_a4af7e7ade522a1f118e7770955ff50ea_cgraph" alt=""/></div>
<map name="directory_8c_a4af7e7ade522a1f118e7770955ff50ea_cgraph" id="directory_8c_a4af7e7ade522a1f118e7770955ff50ea_cgraph">
<area shape="rect" id="node2" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="257,5,351,32"/>
<area shape="rect" id="node3" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="273,56,335,83"/>
<area shape="rect" id="node4" href="util_8c.html#a354eb90598823d4fd6111b94c9c0ce97" title="escaped" alt="" coords="269,107,339,133"/>
<area shape="rect" id="node6" href="networkstatus_8c.html#af85567c13446bbbae84ce4199b3b2134" title="networkstatus_consensus\l_download_failed" alt="" coords="217,158,391,199"/>
<area shape="rect" id="node8" href="consdiff_8c.html#aee547e5b36f9a6e0d89d5f95980bdb55" title="looks_like_a_consensus_diff" alt="" coords="209,224,399,251"/>
<area shape="rect" id="node9" href="dirserv_8c.html#a0f07c36cfc3121034f466d7cb6d27630" title="dirserv_get_consensus" alt="" coords="226,275,382,301"/>
<area shape="rect" id="node10" href="networkstatus_8c.html#abf1e7e6cb46e4a70d63a54a42ba7d2ff" title="networkstatus_read\l_cached_consensus" alt="" coords="233,326,375,367"/>
<area shape="rect" id="node5" href="util_8c.html#ac152e18c6deb4f05823053bb2980a8e4" title="esc_for_log" alt="" coords="473,107,563,133"/>
<area shape="rect" id="node7" href="networkstatus_8c.html#a1a072f4231b410ee50501327f71d527e" title="networkstatus_parse\l_flavor_name" alt="" coords="447,242,589,283"/>
</map>
</div>

</div>
</div>
<a id="ab711f2df049b68c03bd66a27550f3ff8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab711f2df049b68c03bd66a27550f3ff8">&#9670;&nbsp;</a></span>handle_response_fetch_hsdesc_v3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int handle_response_fetch_hsdesc_v3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdir__connection__t.html">dir_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const response_handler_args_t *&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handler function: processes a response to a request for a v3 hidden service descriptor. </p>

</div>
</div>
<a id="ad96202e49f49de900faee561648507fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad96202e49f49de900faee561648507fb">&#9670;&nbsp;</a></span>handle_response_fetch_microdesc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int handle_response_fetch_microdesc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdir__connection__t.html">dir_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const response_handler_args_t *&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handler function: processes a response to a request for a group of microdescriptors </p>

</div>
</div>
<a id="a6cd94a3fa7e78209bcf82533c1128d19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cd94a3fa7e78209bcf82533c1128d19">&#9670;&nbsp;</a></span>http_get_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* http_get_header </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>headers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>which</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a copy of the first HTTP header in <b>headers</b> whose key is <b>which</b>. The key should be given with a terminating colon and space; this function copies everything after, up to but not including the following \r\n. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a6cd94a3fa7e78209bcf82533c1128d19_cgraph.png" border="0" usemap="#directory_8c_a6cd94a3fa7e78209bcf82533c1128d19_cgraph" alt=""/></div>
<map name="directory_8c_a6cd94a3fa7e78209bcf82533c1128d19_cgraph" id="directory_8c_a6cd94a3fa7e78209bcf82533c1128d19_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a1d095be5cec365a93ac90501390f70fa" title="strcasecmpstart" alt="" coords="168,5,284,32"/>
</map>
</div>

</div>
</div>
<a id="a2dcb34e25124200a8694ef07275a50b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dcb34e25124200a8694ef07275a50b2">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">directory_get_from_dirserver&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">( uint8_t dir_purpose, uint8_t router_purpose, const char *resource, int pds_flags, <a class="el" href="or_8h.html#a97b0a50b63539850700352c6de8a16c5">download_want_authority_t</a> want_authority)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Start a connection to a random running directory server, using connection purpose <b>dir_purpose</b>, intending to fetch descriptors of purpose <b>router_purpose</b>, and requesting <b>resource</b>. Use <b>pds_flags</b> as arguments to <a class="el" href="routerlist_8c.html#ace83aa582c6836e9a172a8cafa1d4047">router_pick_directory_server()</a> or <a class="el" href="routerlist_8c.html#ad96c8d565baf8a82010f5adfacb99060">router_pick_trusteddirserver()</a>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a2dcb34e25124200a8694ef07275a50b2_cgraph.png" border="0" usemap="#directory_8c_a2dcb34e25124200a8694ef07275a50b2_cgraph" alt=""/></div>
<map name="directory_8c_a2dcb34e25124200a8694ef07275a50b2_cgraph" id="directory_8c_a2dcb34e25124200a8694ef07275a50b2_cgraph">
<area shape="rect" id="node2" href="dirserv_8c.html#a0b84786e17352524036694baf1955167" title="directory_fetches_from\l_authorities" alt="" coords="153,35,308,76"/>
<area shape="rect" id="node3" href="router_8c.html#afa75de94186fffc8f373de610ae4cab3" title="should_refuse_unknown\l_exits" alt="" coords="356,5,519,47"/>
<area shape="rect" id="node4" href="router_8c.html#ab23297b12b098da9eac98126a587aa3b" title="dir_server_mode" alt="" coords="378,71,497,98"/>
</map>
</div>

</div>
</div>
<a id="a07b76c8174544940247a2582ba1a51c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07b76c8174544940247a2582ba1a51c2">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">directory_initiate_request&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(<a class="el" href="directory_8h.html#a7cb5ccaf42b2a548659cd3f3d16adcf9">directory_request_t</a> *request)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Launch the provided directory request, configured in <b>request</b>. After this function is called, you can free <b>request</b>. </p>

</div>
</div>
<a id="a2bceea525c4f52a46d5c7caeeb68a474"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bceea525c4f52a46d5c7caeeb68a474">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC&#160;</td>
          <td class="paramname"><em>int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">directory_handle_command_get&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn, const char *headers, const char *req_body, size_t req_body_len)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function: called when a dirserver gets a complete HTTP GET request. Look for a request for a directory or for a rendezvous service descriptor. On finding one, write a response into conn-&gt;outbuf. If the request is unrecognized, send a 404. Return 0 if we handled this successfully, or -1 if we need to close the connection. </p>

</div>
</div>
<a id="a4906b52847ca3ea8ca28665abd4e67df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4906b52847ca3ea8ca28665abd4e67df">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC&#160;</td>
          <td class="paramname"><em>int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">directory_handle_command_post&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(<a class="el" href="structdir__connection__t.html">dir_connection_t</a> *conn, const char *headers, const char *body, size_t body_len)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function: called when a dirserver gets a complete HTTP POST request. Look for an uploaded server descriptor or rendezvous service descriptor. On finding one, process it and write a response into conn-&gt;outbuf. If the request is unrecognized, send a</p><ol type="1">
<li>Always return 0. </li>
</ol>

</div>
</div>
<a id="af2fb786289a9102d3176381cc0b23447"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2fb786289a9102d3176381cc0b23447">&#9670;&nbsp;</a></span>next_random_exponential_delay()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int next_random_exponential_delay </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>delay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>base_delay</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance one delay step. The algorithm will generate a random delay, such that each failure is possibly (random) longer than the ones before.</p>
<p>We then clamp that value to be no larger than max_delay, and return it.</p>
<p>The <b>base_delay</b> parameter is lowest possible delay time (can't be zero); the <b>backoff_position</b> parameter is the number of times we've generated a delay; and the <b>delay</b> argument is the most recently used delay. </p>

</div>
</div>
<a id="a41b1ba550eb532e4c9b89a932136a1cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41b1ba550eb532e4c9b89a932136a1cf">&#9670;&nbsp;</a></span>next_random_exponential_delay_range()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void next_random_exponential_delay_range </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>low_bound_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>high_bound_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>delay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>base_delay</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As <a class="el" href="directory_8c.html#af2fb786289a9102d3176381cc0b23447">next_random_exponential_delay()</a> below, but does not compute a random value. Instead, compute the range of values that <a class="el" href="directory_8c.html#af2fb786289a9102d3176381cc0b23447">next_random_exponential_delay()</a> should use when computing its random value. Store the low bound into *<b>low_bound_out</b>, and the high bound into *<b>high_bound_out</b>. Guarantees that the low bound is strictly less than the high bound. </p>

</div>
</div>
<a id="aaa5000558702b2075cc3f676d87c3150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa5000558702b2075cc3f676d87c3150">&#9670;&nbsp;</a></span>parse_accept_encoding_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC unsigned parse_accept_encoding_header </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the compression methods listed in an Accept-Encoding header <b>h</b>, and convert them to a bitfield where compression method x is supported if and only if 1 &lt;&lt; x is set in the bitfield. </p>

</div>
</div>
<a id="adeaaed095405cd4aad17cf7a1197de3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeaaed095405cd4aad17cf7a1197de3c">&#9670;&nbsp;</a></span>parse_http_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_http_command </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>headers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>command_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>url_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse an HTTP request line at the start of a headers string. On failure, return -1. On success, set *<b>command_out</b> to a copy of the HTTP command ("get", "post", etc), set *<b>url_out</b> to a copy of the URL, and return 0. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_adeaaed095405cd4aad17cf7a1197de3c_cgraph.png" border="0" usemap="#directory_8c_adeaaed095405cd4aad17cf7a1197de3c_cgraph" alt=""/></div>
<map name="directory_8c_adeaaed095405cd4aad17cf7a1197de3c_cgraph" id="directory_8c_adeaaed095405cd4aad17cf7a1197de3c_cgraph">
<area shape="rect" id="node2" href="util_8c.html#ab838c820246f358bc0b99884154b2704" title="eat_whitespace_no_nl" alt="" coords="200,5,351,32"/>
<area shape="rect" id="node3" href="util_8c.html#a34984f08eb3eef95438b8e65226dff8e" title="find_whitespace" alt="" coords="217,56,333,83"/>
<area shape="rect" id="node4" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="231,107,319,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_adeaaed095405cd4aad17cf7a1197de3c_icgraph.png" border="0" usemap="#directory_8c_adeaaed095405cd4aad17cf7a1197de3c_icgraph" alt=""/></div>
<map name="directory_8c_adeaaed095405cd4aad17cf7a1197de3c_icgraph" id="directory_8c_adeaaed095405cd4aad17cf7a1197de3c_icgraph">
<area shape="rect" id="node2" href="directory_8c.html#a2ab1c7dcfde852c520eb496643fdc865" title="parse_http_url" alt="" coords="200,5,304,32"/>
</map>
</div>

</div>
</div>
<a id="a4786f539a53422cb5ce22c6036766c15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4786f539a53422cb5ce22c6036766c15">&#9670;&nbsp;</a></span>parse_http_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_http_response </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>headers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t *&#160;</td>
          <td class="paramname"><em>date</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="compress_8h.html#a97a284cf1b98eccbe7964617ed797eee">compress_method_t</a> *&#160;</td>
          <td class="paramname"><em>compression</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse an HTTP response string <b>headers</b> of the form </p><pre class="fragment">* "HTTP/1.\%d \%d\%s\r\n...".
* </pre><p>If it's well-formed, assign the status code to *<b>code</b> and return 0. Otherwise, return -1.</p>
<p>On success: If <b>date</b> is provided, set *date to the Date header in the http headers, or 0 if no such header is found. If <b>compression</b> is provided, set *<b>compression</b> to the compression method given in the Content-Encoding header, or 0 if no such header is found, or -1 if the value of the header is not recognized. If <b>reason</b> is provided, strdup the reason string into it. </p>

</div>
</div>
<a id="a2ab1c7dcfde852c520eb496643fdc865"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ab1c7dcfde852c520eb496643fdc865">&#9670;&nbsp;</a></span>parse_http_url()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int parse_http_url </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>headers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>url</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse an HTTP request string <b>headers</b> of the form </p><pre class="fragment">* "\%s [http[s]://]\%s HTTP/1..."
* </pre><p> If it's well-formed, strdup the second %s into *<b>url</b>, and nul-terminate it. If the url doesn't start with "/tor/", rewrite it so it does. Return 0. Otherwise, return -1. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="directory_8c_a2ab1c7dcfde852c520eb496643fdc865_cgraph.png" border="0" usemap="#directory_8c_a2ab1c7dcfde852c520eb496643fdc865_cgraph" alt=""/></div>
<map name="directory_8c_a2ab1c7dcfde852c520eb496643fdc865_cgraph" id="directory_8c_a2ab1c7dcfde852c520eb496643fdc865_cgraph">
<area shape="rect" id="node2" href="directory_8c.html#adeaaed095405cd4aad17cf7a1197de3c" title="parse_http_command" alt="" coords="157,56,304,83"/>
<area shape="rect" id="node5" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="383,107,471,133"/>
<area shape="rect" id="node6" href="compat_8c.html#ade97970c1d8a691241adac739c4f9b12" title="tor_asprintf" alt="" coords="187,157,274,184"/>
<area shape="rect" id="node3" href="util_8c.html#ab838c820246f358bc0b99884154b2704" title="eat_whitespace_no_nl" alt="" coords="352,5,503,32"/>
<area shape="rect" id="node4" href="util_8c.html#a34984f08eb3eef95438b8e65226dff8e" title="find_whitespace" alt="" coords="369,56,485,83"/>
<area shape="rect" id="node7" href="compat_8c.html#a5ef7a08e8b543c0d61f9ef1081d4c1ea" title="tor_vasprintf" alt="" coords="380,157,475,184"/>
</map>
</div>

</div>
</div>
<a id="a303b2f05c493a74b33537b47b5f00fe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a303b2f05c493a74b33537b47b5f00fe0">&#9670;&nbsp;</a></span>purpose_needs_anonymity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int purpose_needs_anonymity </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dir_purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>router_purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return false if the directory purpose <b>dir_purpose</b> does not require an anonymous (three-hop) connection.</p>
<p>Return true 1) by default, 2) if all directory actions have specifically been configured to be over an anonymous connection, or 3) if the router is a bridge </p>

</div>
</div>
<a id="ae222b3f260cc42ea120a438c2d4efc4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae222b3f260cc42ea120a438c2d4efc4a">&#9670;&nbsp;</a></span>router_supports_extrainfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_supports_extrainfo </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>identity_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_authority</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff <b>identity_digest</b> is the digest of a router which says that it caches extrainfos. (If <b>is_authority</b> we always believe that to be true.) </p>

</div>
</div>
<a id="a4e70476c39b897c87ee7623617f43e78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e70476c39b897c87ee7623617f43e78">&#9670;&nbsp;</a></span>should_use_directory_guards()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int should_use_directory_guards </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff, according to the values in <b>options</b>, we should be using directory guards for direct downloads of directory information. </p>

</div>
</div>
<a id="a0d9dde7aa9fb33802d6fe3d97bd8a4cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d9dde7aa9fb33802d6fe3d97bd8a4cf">&#9670;&nbsp;</a></span>warn_disallowed_anonymous_compression_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void warn_disallowed_anonymous_compression_method </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="compress_8h.html#a97a284cf1b98eccbe7964617ed797eee">compress_method_t</a>&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log a warning when a remote server has sent us a document using a compression method that is not allowed for anonymous directory requests. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
