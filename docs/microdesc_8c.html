<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/microdesc.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">microdesc.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements microdescriptors &ndash; an abbreviated description of less-frequently-changing router information.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitbuild_8h_source.html">circuitbuild.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="directory_8h_source.html">directory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dirserv_8h_source.html">dirserv.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="entrynodes_8h_source.html">entrynodes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="microdesc_8h_source.html">microdesc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="networkstatus_8h_source.html">networkstatus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nodelist_8h_source.html">nodelist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="policies_8h_source.html">policies.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="router_8h_source.html">router.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerlist_8h_source.html">routerlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerparse_8h_source.html">routerparse.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for microdesc.c:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2microdesc_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2microdesc_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2microdesc_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="1406,109,1450,136"/>
<area shape="rect" id="node34" href="circuitbuild_8h.html" title="Header file for circuitbuild.c. " alt="" coords="1799,109,1894,136"/>
<area shape="rect" id="node35" href="config_8h.html" title="Header file for config.c. " alt="" coords="1961,259,2029,285"/>
<area shape="rect" id="node36" href="directory_8h.html" title="Header file for directory.c. " alt="" coords="1969,109,2052,136"/>
<area shape="rect" id="node37" href="dirserv_8h.html" title="Header file for dirserv.c. " alt="" coords="2053,259,2125,285"/>
<area shape="rect" id="node38" href="entrynodes_8h.html" title="Header file for circuitbuild.c. " alt="" coords="2127,109,2225,136"/>
<area shape="rect" id="node39" href="microdesc_8h.html" title="Header file for microdesc.c. " alt="" coords="2249,109,2343,136"/>
<area shape="rect" id="node40" href="networkstatus_8h.html" title="Header file for networkstatus.c. " alt="" coords="2236,259,2351,285"/>
<area shape="rect" id="node41" href="nodelist_8h.html" title="Header file for nodelist.c. " alt="" coords="2418,109,2497,136"/>
<area shape="rect" id="node42" href="policies_8h.html" title="Header file for policies.c. " alt="" coords="2521,109,2599,136"/>
<area shape="rect" id="node43" href="router_8h.html" title="Header file for router.c. " alt="" coords="2348,333,2415,360"/>
<area shape="rect" id="node44" href="routerlist_8h.html" title="Header file for routerlist.c. " alt="" coords="2404,483,2487,509"/>
<area shape="rect" id="node45" href="routerparse_8h.html" title="Header file for routerparse.c. " alt="" coords="2724,109,2823,136"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="265,707,343,733"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="850,632,913,659"/>
<area shape="rect" id="node5" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="924,408,993,435"/>
<area shape="rect" id="node13" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1619,408,1733,435"/>
<area shape="rect" id="node14" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="1456,483,1581,509"/>
<area shape="rect" id="node15" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="1489,557,1631,584"/>
<area shape="rect" id="node16" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="1042,333,1105,360"/>
<area shape="rect" id="node19" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1478,408,1543,435"/>
<area shape="rect" id="node20" href="container_8h_source.html" title="container.h" alt="" coords="561,259,647,285"/>
<area shape="rect" id="node26" href="torgzip_8h.html" title="Headers for torgzip.h. " alt="" coords="1111,184,1183,211"/>
<area shape="rect" id="node27" href="address_8h.html" title="Headers for address.h. " alt="" coords="229,184,307,211"/>
<area shape="rect" id="node28" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="2213,557,2341,584"/>
<area shape="rect" id="node30" href="ht_8h_source.html" title="ht.h" alt="" coords="1309,184,1353,211"/>
<area shape="rect" id="node31" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="1377,184,1479,211"/>
<area shape="rect" id="node32" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="1504,184,1595,211"/>
<area shape="rect" id="node33" href="util__format_8h_source.html" title="util_format.h" alt="" coords="1065,557,1159,584"/>
<area shape="rect" id="node7" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="1671,632,1769,659"/>
<area shape="rect" id="node8" href="compat_8h_source.html" title="compat.h" alt="" coords="650,483,726,509"/>
<area shape="rect" id="node10" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="342,632,450,659"/>
<area shape="rect" id="node12" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="726,557,853,584"/>
<area shape="rect" id="node17" href="compat__openssl_8h.html" title="compatability definitions for working with different openssl forks " alt="" coords="1033,408,1161,435"/>
<area shape="rect" id="node21" href="util_8h.html" title="Headers for util.c. " alt="" coords="624,333,675,360"/>
<area shape="rect" id="node25" href="siphash_8h_source.html" title="siphash.h" alt="" coords="521,333,599,360"/>
<area shape="rect" id="node22" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="145,557,215,584"/>
<area shape="rect" id="node24" href="util__bug_8h.html" title="util_bug.h" alt="" coords="571,408,650,435"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa7d597a3bfee3205a02abef2147b2786"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#aa7d597a3bfee3205a02abef2147b2786">TOLERATE_MICRODESC_AGE</a>&#160;&#160;&#160;(7*24*60*60)</td></tr>
<tr class="separator:aa7d597a3bfee3205a02abef2147b2786"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9fe77ada8ce4bf8e0e4e1e19b8dcc090"><td class="memItemLeft" align="right" valign="top"><a id="a9fe77ada8ce4bf8e0e4e1e19b8dcc090"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>HT_PROTOTYPE</b> (<a class="el" href="nodelist_8c.html#ab29f8b81bcf05c59f16fb5b42ec36879">HT_GENERATE2</a>(microdesc_map, <a class="el" href="nodelist_8c.html#ab29f8b81bcf05c59f16fb5b42ec36879">HT_GENERATE2</a>(<a class="el" href="structmicrodesc__t.html">microdesc_t</a>, <a class="el" href="nodelist_8c.html#ab29f8b81bcf05c59f16fb5b42ec36879">HT_GENERATE2</a>(node, <a class="el" href="nodelist_8c.html#ab29f8b81bcf05c59f16fb5b42ec36879">HT_GENERATE2</a>(microdesc_hash_, <a class="el" href="nodelist_8c.html#ab29f8b81bcf05c59f16fb5b42ec36879">HT_GENERATE2</a>(microdesc_eq_)</td></tr>
<tr class="separator:a9fe77ada8ce4bf8e0e4e1e19b8dcc090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa39bb77fb19ca888eb8d2bedac93c75d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#aa39bb77fb19ca888eb8d2bedac93c75d">get_microdesc_cache</a> (void)</td></tr>
<tr class="separator:aa39bb77fb19ca888eb8d2bedac93c75d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c94ac08f79487c605faf8e543fc3057"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a8c94ac08f79487c605faf8e543fc3057">microdescs_add_to_cache</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache, const char *s, const char *eos, <a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a> where, int no_save, time_t listed_at, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *requested_digests256)</td></tr>
<tr class="separator:a8c94ac08f79487c605faf8e543fc3057"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4492613165472890582c336f6e9e0c65"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a4492613165472890582c336f6e9e0c65">microdescs_add_list_to_cache</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *descriptors, <a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a> where, int no_save)</td></tr>
<tr class="separator:a4492613165472890582c336f6e9e0c65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6328b92665f9f78a482248609cdb2f5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a6328b92665f9f78a482248609cdb2f5a">microdesc_cache_clear</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache)</td></tr>
<tr class="separator:a6328b92665f9f78a482248609cdb2f5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7955c20e8710e1f0b377d61eaba416b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a7955c20e8710e1f0b377d61eaba416b1">microdesc_cache_reload</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache)</td></tr>
<tr class="separator:a7955c20e8710e1f0b377d61eaba416b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6dd60dcd4d473a6b0c9fce9f0f3c1c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#af6dd60dcd4d473a6b0c9fce9f0f3c1c3">microdesc_cache_clean</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache, time_t cutoff, int force)</td></tr>
<tr class="separator:af6dd60dcd4d473a6b0c9fce9f0f3c1c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55a7108c2c7b945bacfdec0edf70fbe4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a55a7108c2c7b945bacfdec0edf70fbe4">microdesc_cache_rebuild</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache, int force)</td></tr>
<tr class="separator:a55a7108c2c7b945bacfdec0edf70fbe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51c02e45cc53c9e72c6b7b5a1fffd013"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a51c02e45cc53c9e72c6b7b5a1fffd013">microdesc_check_counts</a> (void)</td></tr>
<tr class="separator:a51c02e45cc53c9e72c6b7b5a1fffd013"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05e77e5562c68a36292cf8b267a1182a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a05e77e5562c68a36292cf8b267a1182a">microdesc_free_</a> (<a class="el" href="structmicrodesc__t.html">microdesc_t</a> *md, const char *fname, int lineno)</td></tr>
<tr class="separator:a05e77e5562c68a36292cf8b267a1182a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c23e8a71ff24b72d4dcfbda3ae39688"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a1c23e8a71ff24b72d4dcfbda3ae39688">microdesc_free_all</a> (void)</td></tr>
<tr class="separator:a1c23e8a71ff24b72d4dcfbda3ae39688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c169d48c50e48e8fe1306765f319b61"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmicrodesc__t.html">microdesc_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a7c169d48c50e48e8fe1306765f319b61">microdesc_cache_lookup_by_digest256</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache, const char *d)</td></tr>
<tr class="separator:a7c169d48c50e48e8fe1306765f319b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ed7132c4abf5af5ba74ec1cd090878d"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a9ed7132c4abf5af5ba74ec1cd090878d">microdesc_average_size</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache)</td></tr>
<tr class="separator:a9ed7132c4abf5af5ba74ec1cd090878d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73c847c43e1a2bfd711718dd113261e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a73c847c43e1a2bfd711718dd113261e5">microdesc_list_missing_digest256</a> (<a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *ns, <a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache, int downloadable_only, digest256map_t *skip)</td></tr>
<tr class="separator:a73c847c43e1a2bfd711718dd113261e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad7f413d899b72e58bed8efc0162d8bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#aad7f413d899b72e58bed8efc0162d8bd">update_microdesc_downloads</a> (time_t now)</td></tr>
<tr class="separator:aad7f413d899b72e58bed8efc0162d8bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad388d518c6750dce831b4d375e0efe5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#ad388d518c6750dce831b4d375e0efe5c">update_microdescs_from_networkstatus</a> (time_t now)</td></tr>
<tr class="separator:ad388d518c6750dce831b4d375e0efe5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeff3a88aa40b67ab6407bda5c941910"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#adeff3a88aa40b67ab6407bda5c941910">we_use_microdescriptors_for_circuits</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:adeff3a88aa40b67ab6407bda5c941910"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9c983a76a2f31a6a843f4df9be7de1d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#ad9c983a76a2f31a6a843f4df9be7de1d">we_fetch_microdescriptors</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:ad9c983a76a2f31a6a843f4df9be7de1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2667d23ef05f514b5bf916791b4a6bbd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a2667d23ef05f514b5bf916791b4a6bbd">we_fetch_router_descriptors</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:a2667d23ef05f514b5bf916791b4a6bbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01ac96e92e27b924141e47289fc633b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8c.html#a01ac96e92e27b924141e47289fc633b2">MOCK_IMPL</a> (int, usable_consensus_flavor,(void))</td></tr>
<tr class="separator:a01ac96e92e27b924141e47289fc633b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements microdescriptors &ndash; an abbreviated description of less-frequently-changing router information. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aa7d597a3bfee3205a02abef2147b2786"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7d597a3bfee3205a02abef2147b2786">&#9670;&nbsp;</a></span>TOLERATE_MICRODESC_AGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOLERATE_MICRODESC_AGE&#160;&#160;&#160;(7*24*60*60)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>By default, we remove any microdescriptors that have gone at least this long without appearing in a current consensus. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa39bb77fb19ca888eb8d2bedac93c75d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa39bb77fb19ca888eb8d2bedac93c75d">&#9670;&nbsp;</a></span>get_microdesc_cache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a>* get_microdesc_cache </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a pointer to the microdescriptor cache, loading it if necessary. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_aa39bb77fb19ca888eb8d2bedac93c75d_icgraph.png" border="0" usemap="#microdesc_8c_aa39bb77fb19ca888eb8d2bedac93c75d_icgraph" alt=""/></div>
<map name="microdesc_8c_aa39bb77fb19ca888eb8d2bedac93c75d_icgraph" id="microdesc_8c_aa39bb77fb19ca888eb8d2bedac93c75d_icgraph">
<area shape="rect" id="node2" href="dirserv_8h.html#a89dcb27b45f04c12e789dee837b90fdc" title="dirserv_have_any_microdesc" alt="" coords="433,11,623,37"/>
<area shape="rect" id="node3" href="microdesc_8h.html#a7c169d48c50e48e8fe1306765f319b61" title="microdesc_cache_lookup\l_by_digest256" alt="" coords="203,33,372,74"/>
<area shape="rect" id="node4" href="microdesc_8h.html#a9ed7132c4abf5af5ba74ec1cd090878d" title="microdesc_average_size" alt="" coords="204,99,371,125"/>
<area shape="rect" id="node6" href="microdesc_8h.html#ad388d518c6750dce831b4d375e0efe5c" title="update_microdescs_from\l_networkstatus" alt="" coords="203,150,371,191"/>
<area shape="rect" id="node5" href="dirserv_8h.html#a48cee7ff92f2da41f67b8f2a332ffa5a" title="dirserv_estimate_microdesc_size" alt="" coords="420,99,636,125"/>
</map>
</div>

</div>
</div>
<a id="a9ed7132c4abf5af5ba74ec1cd090878d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ed7132c4abf5af5ba74ec1cd090878d">&#9670;&nbsp;</a></span>microdesc_average_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t microdesc_average_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the mean size of decriptors added to <b>cache</b> since it was last cleared. Used to estimate the size of large downloads. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_a9ed7132c4abf5af5ba74ec1cd090878d_cgraph.png" border="0" usemap="#microdesc_8c_a9ed7132c4abf5af5ba74ec1cd090878d_cgraph" alt=""/></div>
<map name="microdesc_8c_a9ed7132c4abf5af5ba74ec1cd090878d_cgraph" id="microdesc_8c_a9ed7132c4abf5af5ba74ec1cd090878d_cgraph">
<area shape="rect" id="node2" href="microdesc_8c.html#aa39bb77fb19ca888eb8d2bedac93c75d" title="get_microdesc_cache" alt="" coords="220,5,369,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_a9ed7132c4abf5af5ba74ec1cd090878d_icgraph.png" border="0" usemap="#microdesc_8c_a9ed7132c4abf5af5ba74ec1cd090878d_icgraph" alt=""/></div>
<map name="microdesc_8c_a9ed7132c4abf5af5ba74ec1cd090878d_icgraph" id="microdesc_8c_a9ed7132c4abf5af5ba74ec1cd090878d_icgraph">
<area shape="rect" id="node2" href="dirserv_8h.html#a48cee7ff92f2da41f67b8f2a332ffa5a" title="dirserv_estimate_microdesc_size" alt="" coords="220,5,436,32"/>
</map>
</div>

</div>
</div>
<a id="af6dd60dcd4d473a6b0c9fce9f0f3c1c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6dd60dcd4d473a6b0c9fce9f0f3c1c3">&#9670;&nbsp;</a></span>microdesc_cache_clean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void microdesc_cache_clean </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>cutoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>force</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove all microdescriptors from <b>cache</b> that haven't been listed for a long time. Does not rebuild the cache on disk. If <b>cutoff</b> is positive, specifically remove microdescriptors that have been unlisted since <b>cutoff</b>. If <b>force</b> is true, remove microdescriptors even if we have no current live microdescriptor consensus. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_af6dd60dcd4d473a6b0c9fce9f0f3c1c3_cgraph.png" border="0" usemap="#microdesc_8c_af6dd60dcd4d473a6b0c9fce9f0f3c1c3_cgraph" alt=""/></div>
<map name="microdesc_8c_af6dd60dcd4d473a6b0c9fce9f0f3c1c3_cgraph" id="microdesc_8c_af6dd60dcd4d473a6b0c9fce9f0f3c1c3_cgraph">
<area shape="rect" id="node2" href="networkstatus_8c.html#a44accdf47b7f9f40b25c45daf2c31475" title="networkstatus_get_reasonably\l_live_consensus" alt="" coords="216,5,415,47"/>
</map>
</div>

</div>
</div>
<a id="a6328b92665f9f78a482248609cdb2f5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6328b92665f9f78a482248609cdb2f5a">&#9670;&nbsp;</a></span>microdesc_cache_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void microdesc_cache_clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove every microdescriptor in <b>cache</b>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_a6328b92665f9f78a482248609cdb2f5a_icgraph.png" border="0" usemap="#microdesc_8c_a6328b92665f9f78a482248609cdb2f5a_icgraph" alt=""/></div>
<map name="microdesc_8c_a6328b92665f9f78a482248609cdb2f5a_icgraph" id="microdesc_8c_a6328b92665f9f78a482248609cdb2f5a_icgraph">
<area shape="rect" id="node2" href="microdesc_8h.html#a7955c20e8710e1f0b377d61eaba416b1" title="microdesc_cache_reload" alt="" coords="212,5,379,32"/>
<area shape="rect" id="node3" href="microdesc_8h.html#a1c23e8a71ff24b72d4dcfbda3ae39688" title="microdesc_free_all" alt="" coords="230,56,361,83"/>
</map>
</div>

</div>
</div>
<a id="a7c169d48c50e48e8fe1306765f319b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c169d48c50e48e8fe1306765f319b61">&#9670;&nbsp;</a></span>microdesc_cache_lookup_by_digest256()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmicrodesc__t.html">microdesc_t</a>* microdesc_cache_lookup_by_digest256 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If there is a microdescriptor in <b>cache</b> whose sha256 digest is <b>d</b>, return it. Otherwise return NULL. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_a7c169d48c50e48e8fe1306765f319b61_cgraph.png" border="0" usemap="#microdesc_8c_a7c169d48c50e48e8fe1306765f319b61_cgraph" alt=""/></div>
<map name="microdesc_8c_a7c169d48c50e48e8fe1306765f319b61_cgraph" id="microdesc_8c_a7c169d48c50e48e8fe1306765f319b61_cgraph">
<area shape="rect" id="node2" href="microdesc_8c.html#aa39bb77fb19ca888eb8d2bedac93c75d" title="get_microdesc_cache" alt="" coords="223,13,372,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_a7c169d48c50e48e8fe1306765f319b61_icgraph.png" border="0" usemap="#microdesc_8c_a7c169d48c50e48e8fe1306765f319b61_icgraph" alt=""/></div>
<map name="microdesc_8c_a7c169d48c50e48e8fe1306765f319b61_icgraph" id="microdesc_8c_a7c169d48c50e48e8fe1306765f319b61_icgraph">
<area shape="rect" id="node2" href="dirserv_8h.html#a89dcb27b45f04c12e789dee837b90fdc" title="dirserv_have_any_microdesc" alt="" coords="223,13,413,39"/>
</map>
</div>

</div>
</div>
<a id="a55a7108c2c7b945bacfdec0edf70fbe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55a7108c2c7b945bacfdec0edf70fbe4">&#9670;&nbsp;</a></span>microdesc_cache_rebuild()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int microdesc_cache_rebuild </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>force</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Regenerate the main cache file for <b>cache</b>, clear the journal file, and update every <a class="el" href="structmicrodesc__t.html">microdesc_t</a> in the cache with pointers to its new location. If <b>force</b> is true, do this unconditionally. If <b>force</b> is false, do it only if we expect to save space on disk. </p>

</div>
</div>
<a id="a7955c20e8710e1f0b377d61eaba416b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7955c20e8710e1f0b377d61eaba416b1">&#9670;&nbsp;</a></span>microdesc_cache_reload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int microdesc_cache_reload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reload the contents of <b>cache</b> from disk. If it is empty, load it for the first time. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_a7955c20e8710e1f0b377d61eaba416b1_cgraph.png" border="0" usemap="#microdesc_8c_a7955c20e8710e1f0b377d61eaba416b1_cgraph" alt=""/></div>
<map name="microdesc_8c_a7955c20e8710e1f0b377d61eaba416b1_cgraph" id="microdesc_8c_a7955c20e8710e1f0b377d61eaba416b1_cgraph">
<area shape="rect" id="node2" href="microdesc_8c.html#a6328b92665f9f78a482248609cdb2f5a" title="microdesc_cache_clear" alt="" coords="220,5,379,32"/>
</map>
</div>

</div>
</div>
<a id="a51c02e45cc53c9e72c6b7b5a1fffd013"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51c02e45cc53c9e72c6b7b5a1fffd013">&#9670;&nbsp;</a></span>microdesc_check_counts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void microdesc_check_counts </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make sure that the reference count of every microdescriptor in cache is accurate. </p>

</div>
</div>
<a id="a05e77e5562c68a36292cf8b267a1182a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05e77e5562c68a36292cf8b267a1182a">&#9670;&nbsp;</a></span>microdesc_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void microdesc_free_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__t.html">microdesc_t</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lineno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deallocate a single microdescriptor. Note: the microdescriptor MUST have previously been removed from the cache if it had ever been inserted. </p>

</div>
</div>
<a id="a1c23e8a71ff24b72d4dcfbda3ae39688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c23e8a71ff24b72d4dcfbda3ae39688">&#9670;&nbsp;</a></span>microdesc_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void microdesc_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all storage held in the <a class="el" href="microdesc_8c.html" title="Implements microdescriptors – an abbreviated description of less-frequently-changing router informat...">microdesc.c</a> module. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_a1c23e8a71ff24b72d4dcfbda3ae39688_cgraph.png" border="0" usemap="#microdesc_8c_a1c23e8a71ff24b72d4dcfbda3ae39688_cgraph" alt=""/></div>
<map name="microdesc_8c_a1c23e8a71ff24b72d4dcfbda3ae39688_cgraph" id="microdesc_8c_a1c23e8a71ff24b72d4dcfbda3ae39688_cgraph">
<area shape="rect" id="node2" href="microdesc_8c.html#a6328b92665f9f78a482248609cdb2f5a" title="microdesc_cache_clear" alt="" coords="184,5,343,32"/>
</map>
</div>

</div>
</div>
<a id="a73c847c43e1a2bfd711718dd113261e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73c847c43e1a2bfd711718dd113261e5">&#9670;&nbsp;</a></span>microdesc_list_missing_digest256()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsmartlist__t.html">smartlist_t</a>* microdesc_list_missing_digest256 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>downloadable_only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">digest256map_t *&#160;</td>
          <td class="paramname"><em>skip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a smartlist of all the sha256 digest of the microdescriptors that are listed in <b>ns</b> but not present in <b>cache</b>. Returns pointers to internals of <b>ns</b>; you should not free the members of the resulting smartlist. Omit all microdescriptors whose digest appear in <b>skip</b>. </p>

</div>
</div>
<a id="a4492613165472890582c336f6e9e0c65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4492613165472890582c336f6e9e0c65">&#9670;&nbsp;</a></span>microdescs_add_list_to_cache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsmartlist__t.html">smartlist_t</a>* microdescs_add_list_to_cache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>descriptors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a>&#160;</td>
          <td class="paramname"><em>where</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>no_save</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As microdescs_add_to_cache, but takes a list of microdescriptors instead of a string to decode. Frees any members of <b>descriptors</b> that it does not add. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_a4492613165472890582c336f6e9e0c65_cgraph.png" border="0" usemap="#microdesc_8c_a4492613165472890582c336f6e9e0c65_cgraph" alt=""/></div>
<map name="microdesc_8c_a4492613165472890582c336f6e9e0c65_cgraph" id="microdesc_8c_a4492613165472890582c336f6e9e0c65_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a5f3fb0bdeb712732f51d0f9e3b0c849c" title="start_writing_to_file" alt="" coords="195,13,329,39"/>
</map>
</div>

</div>
</div>
<a id="a8c94ac08f79487c605faf8e543fc3057"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c94ac08f79487c605faf8e543fc3057">&#9670;&nbsp;</a></span>microdescs_add_to_cache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsmartlist__t.html">smartlist_t</a>* microdescs_add_to_cache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>eos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a>&#160;</td>
          <td class="paramname"><em>where</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>no_save</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>listed_at</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>requested_digests256</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decode the microdescriptors from the string starting at <b>s</b> and ending at <b>eos</b>, and store them in <b>cache</b>. If <b>no_save</b>, mark them as non-writable to disk. If <b>where</b> is SAVED_IN_CACHE, leave their bodies as pointers to the mmap'd cache. If where is <b>SAVED_NOWHERE</b>, do not allow annotations. If listed_at is not -1, set the last_listed field of every microdesc to listed_at. If requested_digests is non-null, then it contains a list of digests we mean to allow, so we should reject any non-requested microdesc with a different digest, and alter the list to contain only the digests of those microdescs we didn't find. Return a newly allocated list of the added microdescriptors, or NULL </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_a8c94ac08f79487c605faf8e543fc3057_cgraph.png" border="0" usemap="#microdesc_8c_a8c94ac08f79487c605faf8e543fc3057_cgraph" alt=""/></div>
<map name="microdesc_8c_a8c94ac08f79487c605faf8e543fc3057_cgraph" id="microdesc_8c_a8c94ac08f79487c605faf8e543fc3057_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#abfc52ced95cf906593bbdab812e1cd8e" title="microdescs_parse_from\l_string" alt="" coords="231,5,392,47"/>
</map>
</div>

</div>
</div>
<a id="a01ac96e92e27b924141e47289fc633b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01ac96e92e27b924141e47289fc633b2">&#9670;&nbsp;</a></span>MOCK_IMPL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">usable_consensus_flavor&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(void)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the consensus flavor we actually want to use to build circuits. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_a01ac96e92e27b924141e47289fc633b2_cgraph.png" border="0" usemap="#microdesc_8c_a01ac96e92e27b924141e47289fc633b2_cgraph" alt=""/></div>
<map name="microdesc_8c_a01ac96e92e27b924141e47289fc633b2_cgraph" id="microdesc_8c_a01ac96e92e27b924141e47289fc633b2_cgraph">
<area shape="rect" id="node2" href="microdesc_8c.html#adeff3a88aa40b67ab6407bda5c941910" title="we_use_microdescriptors\l_for_circuits" alt="" coords="153,5,324,47"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#aec3f497d942ccb88742194e3fe973a49" title="any_bridge_supports\l_microdescriptors" alt="" coords="372,5,515,47"/>
</map>
</div>

</div>
</div>
<a id="aad7f413d899b72e58bed8efc0162d8bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad7f413d899b72e58bed8efc0162d8bd">&#9670;&nbsp;</a></span>update_microdesc_downloads()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_microdesc_downloads </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Launch download requests for microdescriptors as appropriate.</p>
<p>Specifically, we should launch download requests if we are configured to download mirodescriptors, and there are some microdescriptors listed in the current microdesc consensus that we don't have, and either we never asked for them, or we failed to download them but we're willing to retry. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_aad7f413d899b72e58bed8efc0162d8bd_cgraph.png" border="0" usemap="#microdesc_8c_aad7f413d899b72e58bed8efc0162d8bd_cgraph" alt=""/></div>
<map name="microdesc_8c_aad7f413d899b72e58bed8efc0162d8bd_cgraph" id="microdesc_8c_aad7f413d899b72e58bed8efc0162d8bd_cgraph">
<area shape="rect" id="node2" href="networkstatus_8c.html#aa278011afd1917ef43cc44fac287f7bf" title="should_delay_dir_fetches" alt="" coords="265,64,435,91"/>
<area shape="rect" id="node3" href="dirserv_8c.html#a2c5edbbd6883a33af3d72bfead4033db" title="directory_too_idle\l_to_fetch_descriptors" alt="" coords="277,115,423,157"/>
<area shape="rect" id="node13" href="networkstatus_8c.html#a44accdf47b7f9f40b25c45daf2c31475" title="networkstatus_get_reasonably\l_live_consensus" alt="" coords="251,181,449,222"/>
<area shape="rect" id="node4" href="dirserv_8c.html#a57e2ff1ad2ea65abe9b969ad3d76a418" title="directory_caches_dir_info" alt="" coords="497,64,668,91"/>
<area shape="rect" id="node8" href="rephist_8c.html#a890009e83c2e90292a435526b8111727" title="rep_hist_circbuilding\l_dormant" alt="" coords="513,174,653,215"/>
<area shape="rect" id="node5" href="router_8c.html#ab23297b12b098da9eac98126a587aa3b" title="dir_server_mode" alt="" coords="738,5,857,32"/>
<area shape="rect" id="node6" href="router_8c.html#afa75de94186fffc8f373de610ae4cab3" title="should_refuse_unknown\l_exits" alt="" coords="716,57,879,98"/>
<area shape="rect" id="node7" href="networkstatus_8c.html#aba1790be4b1cea243c3dac989ad1b05c" title="networkstatus_get_param" alt="" coords="927,64,1099,91"/>
<area shape="rect" id="node9" href="rephist_8c.html#ae234f5b5dcf88ea65ef20ff5c3512327" title="any_predicted_circuits" alt="" coords="721,123,873,149"/>
<area shape="rect" id="node10" href="router_8c.html#a8b917b11fb2945b314286a6a567e34c3" title="check_whether_orport\l_reachable" alt="" coords="722,174,873,215"/>
<area shape="rect" id="node11" href="circuituse_8c.html#ac6c1a2c715351d85ef6747ca1a4db958" title="circuit_enough_testing\l_circs" alt="" coords="721,239,873,281"/>
<area shape="rect" id="node12" href="router_8c.html#a98317a030cb30700f60c8444d676087b" title="check_whether_dirport\l_reachable" alt="" coords="721,305,874,346"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_aad7f413d899b72e58bed8efc0162d8bd_icgraph.png" border="0" usemap="#microdesc_8c_aad7f413d899b72e58bed8efc0162d8bd_icgraph" alt=""/></div>
<map name="microdesc_8c_aad7f413d899b72e58bed8efc0162d8bd_icgraph" id="microdesc_8c_aad7f413d899b72e58bed8efc0162d8bd_icgraph">
<area shape="rect" id="node2" href="routerlist_8h.html#afe7f2c6bcc3135272bc6aa66ec09cd76" title="update_all_descriptor\l_downloads" alt="" coords="251,5,396,47"/>
<area shape="rect" id="node3" href="main_8h.html#ac64189cc036980dc5785f76d85db9fa6" title="directory_info_has\l_arrived" alt="" coords="444,5,572,47"/>
</map>
</div>

</div>
</div>
<a id="ad388d518c6750dce831b4d375e0efe5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad388d518c6750dce831b4d375e0efe5c">&#9670;&nbsp;</a></span>update_microdescs_from_networkstatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_microdescs_from_networkstatus </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For every microdescriptor listed in the current microdecriptor consensus, update its last_listed field to be at least as recent as the publication time of the current microdescriptor consensus. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_ad388d518c6750dce831b4d375e0efe5c_cgraph.png" border="0" usemap="#microdesc_8c_ad388d518c6750dce831b4d375e0efe5c_cgraph" alt=""/></div>
<map name="microdesc_8c_ad388d518c6750dce831b4d375e0efe5c_cgraph" id="microdesc_8c_ad388d518c6750dce831b4d375e0efe5c_cgraph">
<area shape="rect" id="node2" href="microdesc_8c.html#aa39bb77fb19ca888eb8d2bedac93c75d" title="get_microdesc_cache" alt="" coords="246,5,395,32"/>
<area shape="rect" id="node3" href="networkstatus_8c.html#a44accdf47b7f9f40b25c45daf2c31475" title="networkstatus_get_reasonably\l_live_consensus" alt="" coords="221,57,420,98"/>
</map>
</div>

</div>
</div>
<a id="ad9c983a76a2f31a6a843f4df9be7de1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9c983a76a2f31a6a843f4df9be7de1d">&#9670;&nbsp;</a></span>we_fetch_microdescriptors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int we_fetch_microdescriptors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff we should try to download microdescriptors at all. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_ad9c983a76a2f31a6a843f4df9be7de1d_cgraph.png" border="0" usemap="#microdesc_8c_ad9c983a76a2f31a6a843f4df9be7de1d_cgraph" alt=""/></div>
<map name="microdesc_8c_ad9c983a76a2f31a6a843f4df9be7de1d_cgraph" id="microdesc_8c_ad9c983a76a2f31a6a843f4df9be7de1d_cgraph">
<area shape="rect" id="node2" href="dirserv_8c.html#a57e2ff1ad2ea65abe9b969ad3d76a418" title="directory_caches_dir_info" alt="" coords="232,64,403,91"/>
<area shape="rect" id="node6" href="microdesc_8c.html#adeff3a88aa40b67ab6407bda5c941910" title="we_use_microdescriptors\l_for_circuits" alt="" coords="232,118,403,159"/>
<area shape="rect" id="node3" href="router_8c.html#ab23297b12b098da9eac98126a587aa3b" title="dir_server_mode" alt="" coords="473,5,591,32"/>
<area shape="rect" id="node4" href="router_8c.html#afa75de94186fffc8f373de610ae4cab3" title="should_refuse_unknown\l_exits" alt="" coords="451,57,613,98"/>
<area shape="rect" id="node5" href="networkstatus_8c.html#aba1790be4b1cea243c3dac989ad1b05c" title="networkstatus_get_param" alt="" coords="661,64,833,91"/>
<area shape="rect" id="node7" href="entrynodes_8c.html#aec3f497d942ccb88742194e3fe973a49" title="any_bridge_supports\l_microdescriptors" alt="" coords="461,122,603,163"/>
</map>
</div>

</div>
</div>
<a id="a2667d23ef05f514b5bf916791b4a6bbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2667d23ef05f514b5bf916791b4a6bbd">&#9670;&nbsp;</a></span>we_fetch_router_descriptors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int we_fetch_router_descriptors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff we should try to download router descriptors at all. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_a2667d23ef05f514b5bf916791b4a6bbd_cgraph.png" border="0" usemap="#microdesc_8c_a2667d23ef05f514b5bf916791b4a6bbd_cgraph" alt=""/></div>
<map name="microdesc_8c_a2667d23ef05f514b5bf916791b4a6bbd_cgraph" id="microdesc_8c_a2667d23ef05f514b5bf916791b4a6bbd_cgraph">
<area shape="rect" id="node2" href="dirserv_8c.html#a57e2ff1ad2ea65abe9b969ad3d76a418" title="directory_caches_dir_info" alt="" coords="240,64,411,91"/>
<area shape="rect" id="node6" href="microdesc_8c.html#adeff3a88aa40b67ab6407bda5c941910" title="we_use_microdescriptors\l_for_circuits" alt="" coords="240,118,411,159"/>
<area shape="rect" id="node3" href="router_8c.html#ab23297b12b098da9eac98126a587aa3b" title="dir_server_mode" alt="" coords="481,5,599,32"/>
<area shape="rect" id="node4" href="router_8c.html#afa75de94186fffc8f373de610ae4cab3" title="should_refuse_unknown\l_exits" alt="" coords="459,57,621,98"/>
<area shape="rect" id="node5" href="networkstatus_8c.html#aba1790be4b1cea243c3dac989ad1b05c" title="networkstatus_get_param" alt="" coords="669,64,841,91"/>
<area shape="rect" id="node7" href="entrynodes_8c.html#aec3f497d942ccb88742194e3fe973a49" title="any_bridge_supports\l_microdescriptors" alt="" coords="469,122,611,163"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_a2667d23ef05f514b5bf916791b4a6bbd_icgraph.png" border="0" usemap="#microdesc_8c_a2667d23ef05f514b5bf916791b4a6bbd_icgraph" alt=""/></div>
<map name="microdesc_8c_a2667d23ef05f514b5bf916791b4a6bbd_icgraph" id="microdesc_8c_a2667d23ef05f514b5bf916791b4a6bbd_icgraph">
<area shape="rect" id="node2" href="routerlist_8h.html#a8b67f737b9ea614297414b26eb3b784c" title="update_router_descriptor\l_downloads" alt="" coords="240,5,405,47"/>
<area shape="rect" id="node3" href="routerlist_8h.html#afe7f2c6bcc3135272bc6aa66ec09cd76" title="update_all_descriptor\l_downloads" alt="" coords="453,5,599,47"/>
<area shape="rect" id="node4" href="main_8h.html#ac64189cc036980dc5785f76d85db9fa6" title="directory_info_has\l_arrived" alt="" coords="647,5,775,47"/>
</map>
</div>

</div>
</div>
<a id="adeff3a88aa40b67ab6407bda5c941910"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeff3a88aa40b67ab6407bda5c941910">&#9670;&nbsp;</a></span>we_use_microdescriptors_for_circuits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int we_use_microdescriptors_for_circuits </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff we should prefer to use microdescriptors rather than routerdescs for building circuits. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_adeff3a88aa40b67ab6407bda5c941910_cgraph.png" border="0" usemap="#microdesc_8c_adeff3a88aa40b67ab6407bda5c941910_cgraph" alt=""/></div>
<map name="microdesc_8c_adeff3a88aa40b67ab6407bda5c941910_cgraph" id="microdesc_8c_adeff3a88aa40b67ab6407bda5c941910_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#aec3f497d942ccb88742194e3fe973a49" title="any_bridge_supports\l_microdescriptors" alt="" coords="224,5,367,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8c_adeff3a88aa40b67ab6407bda5c941910_icgraph.png" border="0" usemap="#microdesc_8c_adeff3a88aa40b67ab6407bda5c941910_icgraph" alt=""/></div>
<map name="microdesc_8c_adeff3a88aa40b67ab6407bda5c941910_icgraph" id="microdesc_8c_adeff3a88aa40b67ab6407bda5c941910_icgraph">
<area shape="rect" id="node2" href="microdesc_8h.html#ad9c983a76a2f31a6a843f4df9be7de1d" title="we_fetch_microdescriptors" alt="" coords="228,5,407,32"/>
<area shape="rect" id="node3" href="microdesc_8h.html#a2667d23ef05f514b5bf916791b4a6bbd" title="we_fetch_router_descriptors" alt="" coords="224,56,411,83"/>
<area shape="rect" id="node7" href="microdesc_8c.html#a01ac96e92e27b924141e47289fc633b2" title="MOCK_IMPL" alt="" coords="267,107,367,133"/>
<area shape="rect" id="node4" href="routerlist_8h.html#a8b67f737b9ea614297414b26eb3b784c" title="update_router_descriptor\l_downloads" alt="" coords="459,49,624,90"/>
<area shape="rect" id="node5" href="routerlist_8h.html#afe7f2c6bcc3135272bc6aa66ec09cd76" title="update_all_descriptor\l_downloads" alt="" coords="672,49,817,90"/>
<area shape="rect" id="node6" href="main_8h.html#ac64189cc036980dc5785f76d85db9fa6" title="directory_info_has\l_arrived" alt="" coords="865,49,993,90"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
