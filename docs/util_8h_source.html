<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/common/util.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_b7e1585941a202f53e5249c42015d573.html">common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">util.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="util_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* Copyright (c) 2003-2004, Roger Dingledine</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2004-2006, Roger Dingledine, Nick Mathewson.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (c) 2007-2016, The Tor Project, Inc. */</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* See LICENSE for licensing information */</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#ifndef TOR_UTIL_H</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#define TOR_UTIL_H</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;orconfig.h&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="torint_8h.html">torint.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;compat.h&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="di__ops_8h.html">di_ops.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;testsupport.h&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/* for the correct alias to struct stat */</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="util__bug_8h.html">util_bug.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifndef O_BINARY</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#define O_BINARY 0</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#ifndef O_TEXT</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#define O_TEXT 0</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#ifndef O_NOFOLLOW</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#define O_NOFOLLOW 0</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/* If we&#39;re building with dmalloc, we want all of our memory allocation</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> * functions to take an extra file/line pair of arguments.  If not, not.</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> * We define DMALLOC_PARAMS to the extra parameters to insert in the</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> * function prototypes, and DMALLOC_ARGS to the extra arguments to add</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> * to calls. */</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#ifdef USE_DMALLOC</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#define DMALLOC_PARAMS , const char *file, const int line</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#define DMALLOC_ARGS , SHORT_FILE__, __LINE__</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#define DMALLOC_PARAMS</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#define DMALLOC_ARGS</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">/* Memory management */</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keywordtype">void</span> *<a class="code" href="util_8h.html#a9abe40033cbac958b0740567841da975">tor_malloc_</a>(<span class="keywordtype">size_t</span> size DMALLOC_PARAMS) ATTR_MALLOC;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordtype">void</span> *<a class="code" href="util_8h.html#a1fe038f20a5b4c4a646e00c5b5434465">tor_malloc_zero_</a>(<span class="keywordtype">size_t</span> size DMALLOC_PARAMS) ATTR_MALLOC;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keywordtype">void</span> *<a class="code" href="util_8h.html#acccef56e2025d059043fcec01d038f6b">tor_calloc_</a>(<span class="keywordtype">size_t</span> nmemb, <span class="keywordtype">size_t</span> size DMALLOC_PARAMS) ATTR_MALLOC;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordtype">void</span> *<a class="code" href="util_8h.html#a3d169aae56af8034ded171839c8a5c4a">tor_realloc_</a>(<span class="keywordtype">void</span> *ptr, <span class="keywordtype">size_t</span> size DMALLOC_PARAMS);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordtype">void</span> *<a class="code" href="util_8c.html#a882356feb0fa2fe4001c5298015862a3">tor_reallocarray_</a>(<span class="keywordtype">void</span> *ptr, <span class="keywordtype">size_t</span> size1, <span class="keywordtype">size_t</span> size2 DMALLOC_PARAMS);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a458f8625bc6faf79b6c8f52c878bc28a">tor_strdup_</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s DMALLOC_PARAMS) ATTR_MALLOC ATTR_NONNULL((1));</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a060088cb8d827dceb15e56a0e4c04a29">tor_strndup_</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keywordtype">size_t</span> n DMALLOC_PARAMS)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  ATTR_MALLOC ATTR_NONNULL((1));</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordtype">void</span> *<a class="code" href="util_8h.html#ab0b84a4f34827ed0648081554082d084">tor_memdup_</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *mem, <span class="keywordtype">size_t</span> len DMALLOC_PARAMS)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  ATTR_MALLOC ATTR_NONNULL((1));</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordtype">void</span> *<a class="code" href="util_8h.html#a6c86cfa147080a762691fe23882e4178">tor_memdup_nulterm_</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *mem, <span class="keywordtype">size_t</span> len DMALLOC_PARAMS)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  ATTR_MALLOC ATTR_NONNULL((1));</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#a40d94cc20afc38582c65aa418919ebed">tor_free_</a>(<span class="keywordtype">void</span> *mem);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;uint64_t <a class="code" href="util_8h.html#ae251b57349c0a4bf306bd47653d3ca16">tor_htonll</a>(uint64_t a);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;uint64_t <a class="code" href="util_8h.html#a4959f0aba8a681ab08cfdccfbe16ffc2">tor_ntohll</a>(uint64_t a);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#ifdef USE_DMALLOC</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> dmalloc_free(<span class="keyword">const</span> <span class="keywordtype">char</span> *file, <span class="keyword">const</span> <span class="keywordtype">int</span> line, <span class="keywordtype">void</span> *pnt,</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">int</span> func_id);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#define tor_free(p) STMT_BEGIN \</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">    if (PREDICT_LIKELY((p)!=NULL)) {                \</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">      dmalloc_free(SHORT_FILE__, __LINE__, (p), 0); \</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">      (p)=NULL;                                     \</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">    }                                               \</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">  STMT_END</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="util_8h.html#a444bab1e00cee1f986af3b16e0493854">   83</a></span>&#160;<span class="preprocessor">#define tor_free(p) STMT_BEGIN                                 \</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">    if (PREDICT_LIKELY((p)!=NULL)) {                           \</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">      raw_free(p);                                             \</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">      (p)=NULL;                                                \</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">    }                                                          \</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">  STMT_END</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#define tor_malloc(size)       tor_malloc_(size DMALLOC_ARGS)</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#define tor_malloc_zero(size)  tor_malloc_zero_(size DMALLOC_ARGS)</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#define tor_calloc(nmemb,size) tor_calloc_(nmemb, size DMALLOC_ARGS)</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#define tor_realloc(ptr, size) tor_realloc_(ptr, size DMALLOC_ARGS)</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#define tor_reallocarray(ptr, sz1, sz2) \</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">  tor_reallocarray_((ptr), (sz1), (sz2) DMALLOC_ARGS)</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#define tor_strdup(s)          tor_strdup_(s DMALLOC_ARGS)</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#define tor_strndup(s, n)      tor_strndup_(s, n DMALLOC_ARGS)</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#define tor_memdup(s, n)       tor_memdup_(s, n DMALLOC_ARGS)</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#define tor_memdup_nulterm(s, n)       tor_memdup_nulterm_(s, n DMALLOC_ARGS)</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">/* Aliases for the underlying system malloc/realloc/free. Only use</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"> * them to indicate &quot;I really want the underlying system function, I know</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"> * what I&#39;m doing.&quot; */</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#define raw_malloc  malloc</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#define raw_realloc realloc</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#define raw_free    free</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#define raw_strdup  strdup</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#af16b9ea01680fc8d8adb247d1549c00c">tor_log_mallinfo</a>(<span class="keywordtype">int</span> severity);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#if defined(__GNUC__) &amp;&amp; __GNUC__ &gt; 3</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#define STRUCT_OFFSET(tp, member) __builtin_offsetof(tp, member)</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="util_8h.html#a34bb1d41c655823d71f9ce54196bcfd9">  116</a></span>&#160;<span class="preprocessor"> #define STRUCT_OFFSET(tp, member) \</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">   ((off_t) (((char*)&amp;((tp*)0)-&gt;member)-(char*)0))</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="util_8h.html#afd2585581bad93fbde937e13a4323951">  129</a></span>&#160;<span class="preprocessor">#define STRUCT_VAR_P(st, off) ((void*) ( ((char*)(st)) + (off) ) )</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="util_8h.html#a5a2dfe2cd5b62ce52e3a9da194612903">  140</a></span>&#160;<span class="preprocessor">#define SUBTYPE_P(p, subtype, basemember) \</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">  ((void*) ( ((char*)(p)) - STRUCT_OFFSET(subtype, basemember) ))</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">/* Logic */</span></div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="util_8h.html#adcad879e6e78bb1d0d8c75f20a9d9f17">  145</a></span>&#160;<span class="preprocessor">#define bool_eq(a,b) (!(a)==!(b))</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="util_8h.html#a90ad76034a7b1ca3948d5cf54de6d521">  147</a></span>&#160;<span class="preprocessor">#define bool_neq(a,b) (!(a)!=!(b))</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">/* Math functions */</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordtype">double</span> <a class="code" href="util_8h.html#a5c13e53b335279a9609de90a2dd4c770">tor_mathlog</a>(<span class="keywordtype">double</span> <a class="code" href="namespaced.html">d</a>) ATTR_CONST;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keywordtype">long</span> <a class="code" href="util_8h.html#a2847abc06f048c1d29b33a8c757c27c0">tor_lround</a>(<span class="keywordtype">double</span> <a class="code" href="namespaced.html">d</a>) ATTR_CONST;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;int64_t <a class="code" href="util_8h.html#ac11b622d1227814333323afcc81b2e82">tor_llround</a>(<span class="keywordtype">double</span> <a class="code" href="namespaced.html">d</a>) ATTR_CONST;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a2d41bec85f718e65fc058be330d7e739">tor_log2</a>(uint64_t u64) ATTR_CONST;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;uint64_t <a class="code" href="util_8h.html#ae44cd05245deb753551a05b5b4ad271f">round_to_power_of_2</a>(uint64_t u64);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="util_8h.html#a8d370e39e1dfeb9c6436bd7879c04ce2">round_to_next_multiple_of</a>(<span class="keywordtype">unsigned</span> number, <span class="keywordtype">unsigned</span> divisor);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;uint32_t <a class="code" href="util_8h.html#a8736099b0ade1d9bfdcca508257fc0f5">round_uint32_to_next_multiple_of</a>(uint32_t number, uint32_t divisor);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;uint64_t <a class="code" href="util_8h.html#af988d4e0eccfc51ee92e983170091b37">round_uint64_to_next_multiple_of</a>(uint64_t number, uint64_t divisor);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;int64_t <a class="code" href="util_8h.html#a7a71fe4811768a82c3060e8946ee62b4">sample_laplace_distribution</a>(<span class="keywordtype">double</span> mu, <span class="keywordtype">double</span> b, <span class="keywordtype">double</span> p);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;int64_t <a class="code" href="util_8h.html#a1002800a4c79695b35032f8db18bf89b">add_laplace_noise</a>(int64_t signal, <span class="keywordtype">double</span> random, <span class="keywordtype">double</span> delta_f,</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                          <span class="keywordtype">double</span> epsilon);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a13961bf3ef2587508876b5ee616222fc">n_bits_set_u8</a>(uint8_t v);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;int64_t <a class="code" href="util_8h.html#a75c02e9ab5f17f8c5e9c68ee0833ac65">clamp_double_to_int64</a>(<span class="keywordtype">double</span> number);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keywordtype">void</span> simplify_fraction64(uint64_t *numer, uint64_t *denom);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">/* Compute the CEIL of &lt;b&gt;a&lt;/b&gt; divided by &lt;b&gt;b&lt;/b&gt;, for nonnegative &lt;b&gt;a&lt;/b&gt;</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> * and positive &lt;b&gt;b&lt;/b&gt;.  Works on integer types only. Not defined if a+b can</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> * overflow. */</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">#define CEIL_DIV(a,b) (((a)+(b)-1)/(b))</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">/* Return &lt;b&gt;v&lt;/b&gt; if it&#39;s between &lt;b&gt;min&lt;/b&gt; and &lt;b&gt;max&lt;/b&gt;.  Otherwise</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> * return &lt;b&gt;min&lt;/b&gt; if &lt;b&gt;v&lt;/b&gt; is smaller than &lt;b&gt;min&lt;/b&gt;, or &lt;b&gt;max&lt;/b&gt; if</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> * &lt;b&gt;b&lt;/b&gt; is larger than &lt;b&gt;max&lt;/b&gt;.</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"> * Requires that &lt;b&gt;min&lt;/b&gt; is no more than &lt;b&gt;max&lt;/b&gt;. May evaluate any of</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"> * its arguments more than once! */</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#define CLAMP(min,v,max)                        \</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor">  ( ((v) &lt; (min)) ? (min) :                     \</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">    ((v) &gt; (max)) ? (max) :                     \</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">    (v) )</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">/* String manipulation */</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="util_8h.html#ac7ac40e40b147027a87bab477eee3437">  184</a></span>&#160;<span class="preprocessor">#define HEX_CHARACTERS &quot;0123456789ABCDEFabcdef&quot;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#a44accacd9eb3598784c3093af877f9e9">tor_strlower</a>(<span class="keywordtype">char</span> *s) ATTR_NONNULL((1));</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#a95a7f768fd014b99df070ba40825a30e">tor_strupper</a>(<span class="keywordtype">char</span> *s) ATTR_NONNULL((1));</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#ae3f02068770f8719f1f470ede094cb6c">tor_strisprint</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s) ATTR_NONNULL((1));</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a96401bc748d267ac93032a31b48b95bd">tor_strisnonupper</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s) ATTR_NONNULL((1));</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a66dfc160abb620a3fccaf54d563e5725">strcmp_opt</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s1, <span class="keyword">const</span> <span class="keywordtype">char</span> *s2);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d">strcmpstart</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s1, <span class="keyword">const</span> <span class="keywordtype">char</span> *s2) ATTR_NONNULL((1,2));</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8c.html#a96a2ca528cbd3f30a7a22d2ae2c82594">strcmp_len</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s1, <span class="keyword">const</span> <span class="keywordtype">char</span> *s2, <span class="keywordtype">size_t</span> len) ATTR_NONNULL((1,2));</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8c.html#a1d095be5cec365a93ac90501390f70fa">strcasecmpstart</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s1, <span class="keyword">const</span> <span class="keywordtype">char</span> *s2) ATTR_NONNULL((1,2));</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8c.html#a28445ce92bb84e6413d5437428dae850">strcmpend</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s1, <span class="keyword">const</span> <span class="keywordtype">char</span> *s2) ATTR_NONNULL((1,2));</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8c.html#a595e5e722adc3f46c2d27bced61a8a18">strcasecmpend</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s1, <span class="keyword">const</span> <span class="keywordtype">char</span> *s2) ATTR_NONNULL((1,2));</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a66ec527143a1add05912e302c0f68b93">fast_memcmpstart</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *mem, <span class="keywordtype">size_t</span> memlen, <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8c.html#a96e40a3f8c0df5e234fc7640796fe539">tor_strstrip</a>(<span class="keywordtype">char</span> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *strip) ATTR_NONNULL((1,2));</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keywordtype">long</span> <a class="code" href="util_8h.html#ae96270f5e46701de9220bc7709ad24f4">tor_parse_long</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keywordtype">int</span> <a class="code" href="namespacebase.html">base</a>, <span class="keywordtype">long</span> min,</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    <span class="keywordtype">long</span> max, <span class="keywordtype">int</span> *ok, <span class="keywordtype">char</span> **next);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="util_8h.html#a8c315755a2fb518d47d7397a14e506de">tor_parse_ulong</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keywordtype">int</span> <a class="code" href="namespacebase.html">base</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> min,</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                              <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> max, <span class="keywordtype">int</span> *ok, <span class="keywordtype">char</span> **next);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordtype">double</span> <a class="code" href="util_8h.html#ab465dbfbc9e54d89b7cada4bcb3c83cb">tor_parse_double</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keywordtype">double</span> min, <span class="keywordtype">double</span> max, <span class="keywordtype">int</span> *ok,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                        <span class="keywordtype">char</span> **next);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;uint64_t <a class="code" href="util_8h.html#a0fa6261bbc231af861f420e8411e0f03">tor_parse_uint64</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keywordtype">int</span> <a class="code" href="namespacebase.html">base</a>, uint64_t min,</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                         uint64_t max, <span class="keywordtype">int</span> *ok, <span class="keywordtype">char</span> **next);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a343c89702d7d04adc7739b5d668a16cf">hex_str</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *from, <span class="keywordtype">size_t</span> fromlen) ATTR_NONNULL((1));</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a69faf166aa0aa9164d2134419c81ba1b">eat_whitespace</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a6131c8f51e7c98072a0697c68be9bed9">eat_whitespace_eos</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *eos);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8h.html#ab838c820246f358bc0b99884154b2704">eat_whitespace_no_nl</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a0bb1364a2d99b1af1fa75dd87c1912d2">eat_whitespace_eos_no_nl</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *eos);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a34984f08eb3eef95438b8e65226dff8e">find_whitespace</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a2b8d1db012eaaff2542537dee3c644a3">find_whitespace_eos</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *eos);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8h.html#acb59ba844f26d47f1cf42a2c0b324db8">find_str_at_start_of_line</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *haystack,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *needle);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a936fd5dfa0ccd9b836df432640cbfe88">string_is_C_identifier</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a4fb7293a905e61c3a9ba683a8ed9ad99">string_is_key_value</a>(<span class="keywordtype">int</span> severity, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a6e86f3506694e8592bb7f926af588b07">string_is_valid_hostname</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a307d12f617bd1f5606b8f971733e4c48">string_is_valid_ipv4_address</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a06c31f983cd56699cca308532a09a14c">string_is_valid_ipv6_address</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a7c5079074e649dc0369225eca3073f7d">tor_mem_is_zero</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *mem, <span class="keywordtype">size_t</span> len);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#add0703747195c2abd042572426e80266">tor_digest_is_zero</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *digest);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a714ca710c1b7d56d6633bf2d1f550cad">tor_digest256_is_zero</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *digest);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a0c64e97acc0df47b6c86b1df1d1d93de">esc_for_log</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>) ATTR_MALLOC;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a76c884069e4448d4e4427901f04a85a0">esc_for_log_len</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *chars, <span class="keywordtype">size_t</span> n) ATTR_MALLOC;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8h.html#aea75d86d98077dca32127a8cb0fe97dc">escaped</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a70a007f8fc912d371f5789fdb6d82616">tor_escape_str_for_pt_args</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>,</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">char</span> *chars_to_escape);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keyword">struct </span><a class="code" href="structsmartlist__t.html">smartlist_t</a>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8c.html#a90e57e8764505012f016303eab3e4180">tor_vsscanf</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *buf, <span class="keyword">const</span> <span class="keywordtype">char</span> *pattern, va_list ap) \</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  CHECK_SCANF(2, 0);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8c.html#a58eee4159dfe33194147f2146f0dbc2f">tor_sscanf</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *buf, <span class="keyword">const</span> <span class="keywordtype">char</span> *pattern, ...)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  CHECK_SCANF(2, 3);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8c.html#a68cb44a66a7446022122c93590b6d179">smartlist_add_asprintf</a>(struct <a class="code" href="structsmartlist__t.html">smartlist_t</a> *sl, const <span class="keywordtype">char</span> *pattern, ...)</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  CHECK_PRINTF(2, 3);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8c.html#a4fee2abf83af3a8b8a18b245daf4083b">smartlist_add_vasprintf</a>(struct <a class="code" href="structsmartlist__t.html">smartlist_t</a> *sl, const <span class="keywordtype">char</span> *pattern,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                             va_list args)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  CHECK_PRINTF(2, 0);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">/* Time helpers */</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keywordtype">long</span> <a class="code" href="util_8h.html#a1821d5dd71d3d6566e21363cc287d0dd">tv_udiff</a>(const struct <a class="code" href="structtimeval.html">timeval</a> *start, const struct <a class="code" href="structtimeval.html">timeval</a> *end);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="keywordtype">long</span> <a class="code" href="util_8h.html#aa86d039278659b0bcd070908fb5e5218">tv_mdiff</a>(const struct <a class="code" href="structtimeval.html">timeval</a> *start, const struct <a class="code" href="structtimeval.html">timeval</a> *end);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;int64_t <a class="code" href="util_8h.html#a3b535fd3c14d8db8e53d43cc9c4a9770">tv_to_msec</a>(const struct <a class="code" href="structtimeval.html">timeval</a> *tv);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a966c4dd39a43f89fd5207aebb4756654">tor_timegm</a>(const struct tm *tm, time_t *time_out);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#define RFC1123_TIME_LEN 29</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#a0e1e4c423a6ba1306a9c3b2565e99391">format_rfc1123_time</a>(<span class="keywordtype">char</span> *buf, time_t t);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a4968664a12def8a77e2eefd8f38f7217">parse_rfc1123_time</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *buf, time_t *t);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor">#define ISO_TIME_LEN 19</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">#define ISO_TIME_USEC_LEN (ISO_TIME_LEN+7)</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#a6ea588248ddc24be41620939146e356b">format_local_iso_time</a>(<span class="keywordtype">char</span> *buf, time_t t);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#a270ca9db337eb4621f623a69c0faeb64">format_iso_time</a>(<span class="keywordtype">char</span> *buf, time_t t);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#a0d7e19b54b49c88b434adaaf7d9b4f85">format_iso_time_nospace</a>(<span class="keywordtype">char</span> *buf, time_t t);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#a198d1f011891d6d369bab39eaeecd275">format_iso_time_nospace_usec</a>(<span class="keywordtype">char</span> *buf, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtimeval.html">timeval</a> *tv);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a1b3dda16e5097d60dd0a43815cc84fa8">parse_iso_time_</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *cp, time_t *t, <span class="keywordtype">int</span> strict);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a8d4de39a48bc02621960c1d162478c63">parse_iso_time</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *buf, time_t *t);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a01ef63d549917f359c58e5b9261a1bcb">parse_http_time</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *buf, <span class="keyword">struct</span> tm *tm);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a9a88be72c2d4775622cedbda5d76f833">format_time_interval</a>(<span class="keywordtype">char</span> *out, <span class="keywordtype">size_t</span> out_len, <span class="keywordtype">long</span> interval);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">/* Cached time */</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">#ifdef TIME_IS_FAST</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor">#define approx_time() time(NULL)</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor">#define update_approx_time(t) STMT_NIL</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;time_t <a class="code" href="util_8h.html#aca03d8cb6a22d540b13b92ea5945df33">approx_time</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#a866d4c80bbdc37a0279c2bd02f4b2bde">update_approx_time</a>(time_t now);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">/* Rate-limiter */</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="structratelim__t.html">  297</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structratelim__t.html">ratelim_t</a> {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordtype">int</span> rate;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  time_t last_allowed;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordtype">int</span> n_calls_since_last_time;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;} <a class="code" href="util_8h.html#a9098e9a0fbd29020d63e79142f0fa486">ratelim_t</a>;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">#define RATELIM_INIT(r) { (r), 0, 0 }</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="preprocessor">#define RATELIM_TOOMANY (16*1000*1000)</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a7b6ade9f7a0036f23e62eb950b4bd54f">rate_limit_log</a>(<a class="code" href="structratelim__t.html">ratelim_t</a> *lim, time_t now);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">/* File helpers */</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;ssize_t <a class="code" href="util_8h.html#a0eb16940d73c3b4012f2f810f3ecbecd">write_all</a>(tor_socket_t fd, <span class="keyword">const</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> count,<span class="keywordtype">int</span> isSocket);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;ssize_t <a class="code" href="util_8h.html#a7f7ba7abeacdd02663350b7278098d44">read_all</a>(tor_socket_t fd, <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> count, <span class="keywordtype">int</span> isSocket);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="util_8h.html#a5d31dda277e56fa17f61ee4d92881e34">  313</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="util_8h.html#a5d31dda277e56fa17f61ee4d92881e34">stream_status</a> {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  IO_STREAM_OKAY,</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  IO_STREAM_EAGAIN,</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  IO_STREAM_TERM,</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  IO_STREAM_CLOSED</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;};</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a50a277d6cece483ae49a0bf173a0529a">stream_status_to_string</a>(<span class="keyword">enum</span> <a class="code" href="util_8h.html#a5d31dda277e56fa17f61ee4d92881e34">stream_status</a> <a class="code" href="util_8h.html#a5d31dda277e56fa17f61ee4d92881e34">stream_status</a>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keyword">enum</span> stream_status <a class="code" href="util_8h.html#a6516b5e2e61dac21effa077c405f8703">get_string_from_pipe</a>(FILE *stream, <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> count);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;MOCK_DECL(<span class="keywordtype">int</span>,tor_unlink,(<span class="keyword">const</span> <span class="keywordtype">char</span> *pathname));</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="util_8h.html#a83a53fbc2832eca17cafe21fd209420c">  328</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> { FN_ERROR, FN_NOENT, FN_FILE, FN_DIR, FN_EMPTY } <a class="code" href="util_8h.html#a83a53fbc2832eca17cafe21fd209420c">file_status_t</a>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;file_status_t <a class="code" href="util_8h.html#a2e7a428898dbe56b00df335904bd8ea2">file_status</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="util_8h.html#a5de34b7fb58161640f7254a4c14119f7">  333</a></span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="util_8h.html#a5de34b7fb58161640f7254a4c14119f7">cpd_check_t</a>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor">#define CPD_NONE                 0</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor">#define CPD_CREATE               (1u &lt;&lt; 0)</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="preprocessor">#define CPD_CHECK                (1u &lt;&lt; 1)</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="preprocessor">#define CPD_GROUP_OK             (1u &lt;&lt; 2)</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="preprocessor">#define CPD_GROUP_READ           (1u &lt;&lt; 3)</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">#define CPD_CHECK_MODE_ONLY      (1u &lt;&lt; 4)</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="preprocessor">#define CPD_RELAX_DIRMODE_CHECK  (1u &lt;&lt; 5)</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;MOCK_DECL(<span class="keywordtype">int</span>, check_private_dir,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    (<span class="keyword">const</span> <span class="keywordtype">char</span> *dirname, cpd_check_t check,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">char</span> *effective_user));</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#define OPEN_FLAGS_REPLACE (O_WRONLY|O_CREAT|O_TRUNC)</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="preprocessor">#define OPEN_FLAGS_APPEND (O_WRONLY|O_CREAT|O_APPEND)</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#define OPEN_FLAGS_DONT_REPLACE (O_CREAT|O_EXCL|O_APPEND|O_WRONLY)</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structopen__file__t.html">open_file_t</a> <a class="code" href="structopen__file__t.html">open_file_t</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a5f3fb0bdeb712732f51d0f9e3b0c849c">start_writing_to_file</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname, <span class="keywordtype">int</span> open_flags, <span class="keywordtype">int</span> mode,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                          <a class="code" href="structopen__file__t.html">open_file_t</a> **data_out);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;FILE *<a class="code" href="util_8h.html#aa4a3fe13e93e542ee9b598d865f2647c">start_writing_to_stdio_file</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname, <span class="keywordtype">int</span> open_flags, <span class="keywordtype">int</span> mode,</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                  <a class="code" href="structopen__file__t.html">open_file_t</a> **data_out);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;FILE *<a class="code" href="util_8h.html#ac0cbd74a7fe81a4aa5efab4d87628ea0">fdopen_file</a>(<a class="code" href="structopen__file__t.html">open_file_t</a> *file_data);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a34dff6b01b03f9d8609c93fec5fffc17">finish_writing_to_file</a>(<a class="code" href="structopen__file__t.html">open_file_t</a> *file_data);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#ac55ed8b7b00f14493effd493a957ddf1">abort_writing_to_file</a>(<a class="code" href="structopen__file__t.html">open_file_t</a> *file_data);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;MOCK_DECL(<span class="keywordtype">int</span>,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;write_str_to_file,(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname, <span class="keyword">const</span> <span class="keywordtype">char</span> *str, <span class="keywordtype">int</span> bin));</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;MOCK_DECL(<span class="keywordtype">int</span>,</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;write_bytes_to_file,(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname, <span class="keyword">const</span> <span class="keywordtype">char</span> *str, <span class="keywordtype">size_t</span> len,</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                     <span class="keywordtype">int</span> bin));</div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="structsized__chunk__t.html">  363</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsized__chunk__t.html">sized_chunk_t</a> {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *bytes;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordtype">size_t</span> len;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;} <a class="code" href="util_8h.html#add7c7d604e585e84ffa60896fcc8996b">sized_chunk_t</a>;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8c.html#ae01530967d53afcfefa8227c98072e83">write_chunks_to_file</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *chunks,</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                         <span class="keywordtype">int</span> bin, <span class="keywordtype">int</span> no_tempfile);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a8623147f8fba9a3c98c906f554601f35">append_bytes_to_file</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname, <span class="keyword">const</span> <span class="keywordtype">char</span> *str, <span class="keywordtype">size_t</span> len,</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                         <span class="keywordtype">int</span> bin);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a38d75b2709a797a91881a298dea484c7">write_bytes_to_new_file</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname, <span class="keyword">const</span> <span class="keywordtype">char</span> *str, <span class="keywordtype">size_t</span> len,</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                            <span class="keywordtype">int</span> bin);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="util_8h.html#ad5fbc1ee5ce95defc3f454d6a65ac83e">  375</a></span>&#160;<span class="preprocessor">#define RFTS_BIN            1</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="util_8h.html#a2b9d618f29aa45e447cac9fd943d50b3">  377</a></span>&#160;<span class="preprocessor">#define RFTS_IGNORE_MISSING 2</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="preprocessor">#ifndef _WIN32</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keyword">struct </span>stat;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;MOCK_DECL_ATTR(<span class="keywordtype">char</span> *, read_file_to_str,</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;               (<span class="keyword">const</span> <span class="keywordtype">char</span> *filename, <span class="keywordtype">int</span> flags, <span class="keyword">struct</span> stat *stat_out),</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;               ATTR_MALLOC);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a7b3cac27558cc7f26bd0794f5996e0ef">read_file_to_str_until_eof</a>(<span class="keywordtype">int</span> fd, <span class="keywordtype">size_t</span> max_bytes_to_read,</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                 <span class="keywordtype">size_t</span> *sz_out)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  ATTR_MALLOC;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a8e4d578a2bb5f75e1cd2d1b523d94c92">unescape_string</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keywordtype">char</span> **result, <span class="keywordtype">size_t</span> *size_out);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="util_8h.html#aabb29a0799fb54c87b3f6a4e7c252cb1">parse_config_line_from_str_verbose</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *line,</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                                       <span class="keywordtype">char</span> **key_out, <span class="keywordtype">char</span> **value_out,</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">char</span> **err_out);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="util_8h.html#a89a3242e83d59f2ccb9bb662e9a94134">expand_filename</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;MOCK_DECL(<span class="keyword">struct</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *, tor_listdir, (<span class="keyword">const</span> <span class="keywordtype">char</span> *dirname));</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#aba3030cb2c1b5c587301c81b37243404">path_is_relative</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">/* Process helpers */</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#a9ce5e8df63b6d2ae9cb31a301fecb350">start_daemon</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#acc27414998a66c3602c4199b8316ec29">finish_daemon</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *desired_cwd);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#acfd840af6560e9723b41fb936d6935ed">write_pidfile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">/* Port forwarding */</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#a2d2435fe92af51926be0fd3abe9f938d">tor_check_port_forwarding</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                               <span class="keyword">struct</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *ports_to_forward,</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                               time_t now);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>process_handle_t process_handle_t;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structprocess__environment__t.html">process_environment_t</a> <a class="code" href="structprocess__environment__t.html">process_environment_t</a>;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a314f05865bf730672a42dd9da355f884">tor_spawn_background</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> filename, <span class="keyword">const</span> <span class="keywordtype">char</span> **argv,</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                         <a class="code" href="structprocess__environment__t.html">process_environment_t</a> *env,</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                         process_handle_t **process_handle_out);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">#define SPAWN_ERROR_MESSAGE &quot;ERR: Failed to spawn background process - code &quot;</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;HANDLE load_windows_system_library(<span class="keyword">const</span> TCHAR *library_name);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a584e4996b64ee5bce8e33d46812388bc">environment_variable_names_equal</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s1, <span class="keyword">const</span> <span class="keywordtype">char</span> *s2);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">/* DOCDOC process_environment_t */</span></div><div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="structprocess__environment__t.html">  421</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structprocess__environment__t.html">process_environment_t</a> {</div><div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="structprocess__environment__t.html#ab1d4bfaf4fddf5f0f63adfa67c619554">  424</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="structprocess__environment__t.html#ab1d4bfaf4fddf5f0f63adfa67c619554">windows_environment_block</a>;</div><div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="structprocess__environment__t.html#af5e77c8abc7f1c4272c6fede7f6c1235">  427</a></span>&#160;  <span class="keywordtype">char</span> **<a class="code" href="structprocess__environment__t.html#af5e77c8abc7f1c4272c6fede7f6c1235">unixoid_environment_block</a>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;};</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<a class="code" href="structprocess__environment__t.html">process_environment_t</a> *<a class="code" href="util_8h.html#a575120f4319acc1717c0592c4bf3e95a">process_environment_make</a>(<span class="keyword">struct</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *env_vars);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#a85b13f9b761bab5b056bca836fbed32c">process_environment_free</a>(<a class="code" href="structprocess__environment__t.html">process_environment_t</a> *env);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keyword">struct </span><a class="code" href="structsmartlist__t.html">smartlist_t</a> *<a class="code" href="util_8h.html#a98f5785d540bfcd4822ebbcbe61685cd">get_current_process_environment_variables</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#ae3b38763d1dc04eff42f596c14efb1c9">set_environment_variable_in_smartlist</a>(<span class="keyword">struct</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *env_vars,</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">char</span> *new_var,</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                           <span class="keywordtype">void</span> (*free_old)(<span class="keywordtype">void</span>*),</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                           <span class="keywordtype">int</span> free_p);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">/* Values of process_handle_t.status. PROCESS_STATUS_NOTRUNNING must be</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"> * 0 because tor_check_port_forwarding depends on this being the initial</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"> * statue of the static instance of process_handle_t */</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="preprocessor">#define PROCESS_STATUS_NOTRUNNING 0</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="preprocessor">#define PROCESS_STATUS_RUNNING 1</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">#define PROCESS_STATUS_ERROR -1</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#ifdef UTIL_PRIVATE</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keyword">struct </span><a class="code" href="structwaitpid__callback__t.html">waitpid_callback_t</a>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="keyword">struct </span>process_handle_t {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordtype">int</span> status;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  HANDLE stdin_pipe;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  HANDLE stdout_pipe;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  HANDLE stderr_pipe;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  PROCESS_INFORMATION pid;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordtype">int</span> stdin_pipe;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordtype">int</span> stdout_pipe;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordtype">int</span> stderr_pipe;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  FILE *stdin_handle;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  FILE *stdout_handle;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  FILE *stderr_handle;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  pid_t pid;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keyword">struct </span><a class="code" href="structwaitpid__callback__t.html">waitpid_callback_t</a> *waitpid_cb;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordtype">int</span> waitpid_exit_status;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="preprocessor">#endif // _WIN32</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;};</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">/* Return values of tor_get_exit_code() */</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">#define PROCESS_EXIT_RUNNING 1</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor">#define PROCESS_EXIT_EXITED 0</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="preprocessor">#define PROCESS_EXIT_ERROR -1</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#aae5b7e7e99ea4705673069cf581ab70b">tor_get_exit_code</a>(process_handle_t *process_handle,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                      <span class="keywordtype">int</span> block, <span class="keywordtype">int</span> *exit_code);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#afb786cd2adb671797e2afdb997153864">tor_split_lines</a>(<span class="keyword">struct</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *sl, <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> len);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;ssize_t <a class="code" href="util_8h.html#a78fd132b1188cdc0ac5e225dc160194f">tor_read_all_handle</a>(HANDLE h, <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> count,</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                            <span class="keyword">const</span> process_handle_t *process);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;ssize_t <a class="code" href="util_8h.html#a78fd132b1188cdc0ac5e225dc160194f">tor_read_all_handle</a>(FILE *h, <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> count,</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                            <span class="keyword">const</span> process_handle_t *process,</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                            <span class="keywordtype">int</span> *eof);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;ssize_t <a class="code" href="util_8h.html#a793d72f9aa9b10762da2d74f414f14e4">tor_read_all_from_process_stdout</a>(</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keyword">const</span> process_handle_t *process_handle, <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> count);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;ssize_t <a class="code" href="util_8h.html#a5512823a9379c4bc5f60c956600d00b6">tor_read_all_from_process_stderr</a>(</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keyword">const</span> process_handle_t *process_handle, <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> count);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="util_8h.html#abf5a920e5066e56d3267e95ab675bdc0">tor_join_win_cmdline</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *argv[]);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a4ffe4b25d88ed9e9fe0024efd0bcfd36">tor_process_get_pid</a>(process_handle_t *process_handle);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;HANDLE tor_process_get_stdout_pipe(process_handle_t *process_handle);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;FILE *tor_process_get_stdout_pipe(process_handle_t *process_handle);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;MOCK_DECL(<span class="keyword">struct</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *,</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;tor_get_lines_from_handle,(HANDLE *handle,</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                           <span class="keyword">enum</span> stream_status *stream_status));</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;MOCK_DECL(<span class="keyword">struct</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *,</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;tor_get_lines_from_handle,(FILE *handle,</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                           <span class="keyword">enum</span> stream_status *stream_status));</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<a class="code" href="util_8h.html#a5189d0a5ffdf1ce3ac328aef77a32496">tor_terminate_process</a>(process_handle_t *process_handle);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;MOCK_DECL(<span class="keywordtype">void</span>,</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;tor_process_handle_destroy,(process_handle_t *process_handle,</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                            <span class="keywordtype">int</span> also_terminate_process));</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">/* ===== Insecure rng */</span></div><div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="structtor__weak__rng__t.html">  523</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structtor__weak__rng__t.html">tor_weak_rng_t</a> {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  uint32_t state;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;} <a class="code" href="structtor__weak__rng__t.html">tor_weak_rng_t</a>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="preprocessor">#define TOR_WEAK_RNG_INIT {383745623}</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor">#define TOR_WEAK_RANDOM_MAX (INT_MAX)</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="keywordtype">void</span> <a class="code" href="util_8h.html#aafa53729b0b1a866ab30872b51f3a54e">tor_init_weak_random</a>(<a class="code" href="structtor__weak__rng__t.html">tor_weak_rng_t</a> *weak_rng, <span class="keywordtype">unsigned</span> seed);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;int32_t <a class="code" href="util_8h.html#a74f547603445427e06899d24b1bea3f0">tor_weak_random</a>(<a class="code" href="structtor__weak__rng__t.html">tor_weak_rng_t</a> *weak_rng);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;int32_t <a class="code" href="util_8h.html#a6a156db0f5951592099e3bc646de2416">tor_weak_random_range</a>(<a class="code" href="structtor__weak__rng__t.html">tor_weak_rng_t</a> *rng, int32_t top);</div><div class="line"><a name="l00534"></a><span class="lineno"><a class="line" href="util_8h.html#a76aca07fee948371043e33802a183c16">  534</a></span>&#160;<span class="preprocessor">#define tor_weak_random_one_in_n(rng, n) (0==tor_weak_random_range((rng),(n)))</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#ab4e6e34a36aead42e2577a68dd0e86e8">format_hex_number_sigsafe</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> x, <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> max_len);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="keywordtype">int</span> <a class="code" href="util_8h.html#a21ebd7bd52d9589ad16b84df4a6b62e9">format_dec_number_sigsafe</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> x, <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> max_len);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="preprocessor">#ifdef UTIL_PRIVATE</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">/* Prototypes for private functions only used by util.c (and unit tests) */</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="preprocessor">#ifndef _WIN32</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;STATIC <span class="keywordtype">int</span> <a class="code" href="util_8c.html#acd19d8da6d9f5237a8815199361c37b7">format_helper_exit_status</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> child_state,</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                              <span class="keywordtype">int</span> saved_errno, <span class="keywordtype">char</span> *hex_errno);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">/* Space for hex values of child state, a slash, saved_errno (with</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">   leading minus) and newline (no null) */</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="preprocessor">#define HEX_ERRNO_SIZE (sizeof(char) * 2 + 1 + \</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="preprocessor">                        1 + sizeof(int) * 2 + 1)</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="preprocessor">#ifdef TOR_UNIT_TESTS</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keywordtype">int</span> size_mul_check__(<span class="keyword">const</span> <span class="keywordtype">size_t</span> x, <span class="keyword">const</span> <span class="keywordtype">size_t</span> y);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor">#define ARRAY_LENGTH(x) ((sizeof(x)) / sizeof(x[0]))</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="ttc" id="util_8h_html_a85b13f9b761bab5b056bca836fbed32c"><div class="ttname"><a href="util_8h.html#a85b13f9b761bab5b056bca836fbed32c">process_environment_free</a></div><div class="ttdeci">void process_environment_free(process_environment_t *env)</div><div class="ttdef"><b>Definition:</b> util.c:4754</div></div>
<div class="ttc" id="util_8h_html_af988d4e0eccfc51ee92e983170091b37"><div class="ttname"><a href="util_8h.html#af988d4e0eccfc51ee92e983170091b37">round_uint64_to_next_multiple_of</a></div><div class="ttdeci">uint64_t round_uint64_to_next_multiple_of(uint64_t number, uint64_t divisor)</div><div class="ttdef"><b>Definition:</b> util.c:519</div></div>
<div class="ttc" id="util_8h_html_a38d75b2709a797a91881a298dea484c7"><div class="ttname"><a href="util_8h.html#a38d75b2709a797a91881a298dea484c7">write_bytes_to_new_file</a></div><div class="ttdeci">int write_bytes_to_new_file(const char *fname, const char *str, size_t len, int bin)</div><div class="ttdef"><b>Definition:</b> util.c:2732</div></div>
<div class="ttc" id="util_8h_html_a8d4de39a48bc02621960c1d162478c63"><div class="ttname"><a href="util_8h.html#a8d4de39a48bc02621960c1d162478c63">parse_iso_time</a></div><div class="ttdeci">int parse_iso_time(const char *buf, time_t *t)</div><div class="ttdef"><b>Definition:</b> util.c:1856</div></div>
<div class="ttc" id="util_8h_html_ae3b38763d1dc04eff42f596c14efb1c9"><div class="ttname"><a href="util_8h.html#ae3b38763d1dc04eff42f596c14efb1c9">set_environment_variable_in_smartlist</a></div><div class="ttdeci">void set_environment_variable_in_smartlist(struct smartlist_t *env_vars, const char *new_var, void(*free_old)(void *), int free_p)</div><div class="ttdef"><b>Definition:</b> util.c:4878</div></div>
<div class="ttc" id="util_8h_html_a9a88be72c2d4775622cedbda5d76f833"><div class="ttname"><a href="util_8h.html#a9a88be72c2d4775622cedbda5d76f833">format_time_interval</a></div><div class="ttdeci">int format_time_interval(char *out, size_t out_len, long interval)</div><div class="ttdef"><b>Definition:</b> util.c:1936</div></div>
<div class="ttc" id="util_8h_html_a96401bc748d267ac93032a31b48b95bd"><div class="ttname"><a href="util_8h.html#a96401bc748d267ac93032a31b48b95bd">tor_strisnonupper</a></div><div class="ttdeci">int tor_strisnonupper(const char *s) ATTR_NONNULL((1))</div><div class="ttdef"><b>Definition:</b> util.c:705</div></div>
<div class="ttc" id="structprocess__environment__t_html_ab1d4bfaf4fddf5f0f63adfa67c619554"><div class="ttname"><a href="structprocess__environment__t.html#ab1d4bfaf4fddf5f0f63adfa67c619554">process_environment_t::windows_environment_block</a></div><div class="ttdeci">char * windows_environment_block</div><div class="ttdef"><b>Definition:</b> util.h:424</div></div>
<div class="ttc" id="util_8h_html_a2d2435fe92af51926be0fd3abe9f938d"><div class="ttname"><a href="util_8h.html#a2d2435fe92af51926be0fd3abe9f938d">tor_check_port_forwarding</a></div><div class="ttdeci">void tor_check_port_forwarding(const char *filename, struct smartlist_t *ports_to_forward, time_t now)</div><div class="ttdef"><b>Definition:</b> util.c:5496</div></div>
<div class="ttc" id="util_8h_html_a66dfc160abb620a3fccaf54d563e5725"><div class="ttname"><a href="util_8h.html#a66dfc160abb620a3fccaf54d563e5725">strcmp_opt</a></div><div class="ttdeci">int strcmp_opt(const char *s1, const char *s2)</div><div class="ttdef"><b>Definition:</b> util.c:718</div></div>
<div class="ttc" id="util_8h_html_a1821d5dd71d3d6566e21363cc287d0dd"><div class="ttname"><a href="util_8h.html#a1821d5dd71d3d6566e21363cc287d0dd">tv_udiff</a></div><div class="ttdeci">int int void void long tv_udiff(const struct timeval *start, const struct timeval *end)</div><div class="ttdef"><b>Definition:</b> util.c:1443</div></div>
<div class="ttc" id="structprocess__environment__t_html_af5e77c8abc7f1c4272c6fede7f6c1235"><div class="ttname"><a href="structprocess__environment__t.html#af5e77c8abc7f1c4272c6fede7f6c1235">process_environment_t::unixoid_environment_block</a></div><div class="ttdeci">char ** unixoid_environment_block</div><div class="ttdef"><b>Definition:</b> util.h:427</div></div>
<div class="ttc" id="structwaitpid__callback__t_html"><div class="ttname"><a href="structwaitpid__callback__t.html">waitpid_callback_t</a></div><div class="ttdef"><b>Definition:</b> util_process.c:38</div></div>
<div class="ttc" id="util_8h_html_a7a71fe4811768a82c3060e8946ee62b4"><div class="ttname"><a href="util_8h.html#a7a71fe4811768a82c3060e8946ee62b4">sample_laplace_distribution</a></div><div class="ttdeci">int64_t sample_laplace_distribution(double mu, double b, double p)</div><div class="ttdef"><b>Definition:</b> util.c:534</div></div>
<div class="ttc" id="util_8h_html_a7b6ade9f7a0036f23e62eb950b4bd54f"><div class="ttname"><a href="util_8h.html#a7b6ade9f7a0036f23e62eb950b4bd54f">rate_limit_log</a></div><div class="ttdeci">char * rate_limit_log(ratelim_t *lim, time_t now)</div><div class="ttdef"><b>Definition:</b> util.c:2034</div></div>
<div class="ttc" id="util_8h_html_a5f3fb0bdeb712732f51d0f9e3b0c849c"><div class="ttname"><a href="util_8h.html#a5f3fb0bdeb712732f51d0f9e3b0c849c">start_writing_to_file</a></div><div class="ttdeci">int start_writing_to_file(const char *fname, int open_flags, int mode, open_file_t **data_out)</div><div class="ttdef"><b>Definition:</b> util.c:2486</div></div>
<div class="ttc" id="util_8h_html_a40d94cc20afc38582c65aa418919ebed"><div class="ttname"><a href="util_8h.html#a40d94cc20afc38582c65aa418919ebed">tor_free_</a></div><div class="ttdeci">void tor_free_(void *mem)</div><div class="ttdef"><b>Definition:</b> util.c:351</div></div>
<div class="ttc" id="di__ops_8h_html"><div class="ttname"><a href="di__ops_8h.html">di_ops.h</a></div><div class="ttdoc">Headers for di_ops.c. </div></div>
<div class="ttc" id="util_8h_html_ab465dbfbc9e54d89b7cada4bcb3c83cb"><div class="ttname"><a href="util_8h.html#ab465dbfbc9e54d89b7cada4bcb3c83cb">tor_parse_double</a></div><div class="ttdeci">double tor_parse_double(const char *s, double min, double max, int *ok, char **next)</div><div class="ttdef"><b>Definition:</b> util.c:1202</div></div>
<div class="ttc" id="util_8h_html_acb59ba844f26d47f1cf42a2c0b324db8"><div class="ttname"><a href="util_8h.html#acb59ba844f26d47f1cf42a2c0b324db8">find_str_at_start_of_line</a></div><div class="ttdeci">const char * find_str_at_start_of_line(const char *haystack, const char *needle)</div><div class="ttdef"><b>Definition:</b> util.c:936</div></div>
<div class="ttc" id="util_8h_html_ac11b622d1227814333323afcc81b2e82"><div class="ttname"><a href="util_8h.html#ac11b622d1227814333323afcc81b2e82">tor_llround</a></div><div class="ttdeci">int64_t tor_llround(double d) ATTR_CONST</div><div class="ttdef"><b>Definition:</b> util.c:419</div></div>
<div class="ttc" id="util_8c_html_ae01530967d53afcfefa8227c98072e83"><div class="ttname"><a href="util_8c.html#ae01530967d53afcfefa8227c98072e83">write_chunks_to_file</a></div><div class="ttdeci">int write_chunks_to_file(const char *fname, const smartlist_t *chunks, int bin, int no_tempfile)</div><div class="ttdef"><b>Definition:</b> util.c:2682</div></div>
<div class="ttc" id="util_8h_html_ae44cd05245deb753551a05b5b4ad271f"><div class="ttname"><a href="util_8h.html#ae44cd05245deb753551a05b5b4ad271f">round_to_power_of_2</a></div><div class="ttdeci">uint64_t round_to_power_of_2(uint64_t u64)</div><div class="ttdef"><b>Definition:</b> util.c:465</div></div>
<div class="ttc" id="util_8h_html_ae3f02068770f8719f1f470ede094cb6c"><div class="ttname"><a href="util_8h.html#ae3f02068770f8719f1f470ede094cb6c">tor_strisprint</a></div><div class="ttdeci">int tor_strisprint(const char *s) ATTR_NONNULL((1))</div><div class="ttdef"><b>Definition:</b> util.c:692</div></div>
<div class="ttc" id="util_8c_html_a96e40a3f8c0df5e234fc7640796fe539"><div class="ttname"><a href="util_8c.html#a96e40a3f8c0df5e234fc7640796fe539">tor_strstrip</a></div><div class="ttdeci">void tor_strstrip(char *s, const char *strip)</div><div class="ttdef"><b>Definition:</b> util.c:639</div></div>
<div class="ttc" id="util_8h_html_ab4e6e34a36aead42e2577a68dd0e86e8"><div class="ttname"><a href="util_8h.html#ab4e6e34a36aead42e2577a68dd0e86e8">format_hex_number_sigsafe</a></div><div class="ttdeci">int format_hex_number_sigsafe(unsigned long x, char *buf, int max_len)</div><div class="ttdef"><b>Definition:</b> util.c:3960</div></div>
<div class="ttc" id="util_8h_html_a8e4d578a2bb5f75e1cd2d1b523d94c92"><div class="ttname"><a href="util_8h.html#a8e4d578a2bb5f75e1cd2d1b523d94c92">unescape_string</a></div><div class="ttdeci">const char * unescape_string(const char *s, char **result, size_t *size_out)</div><div class="ttdef"><b>Definition:</b> util.c:2912</div></div>
<div class="ttc" id="util_8h_html_a01ef63d549917f359c58e5b9261a1bcb"><div class="ttname"><a href="util_8h.html#a01ef63d549917f359c58e5b9261a1bcb">parse_http_time</a></div><div class="ttdeci">int parse_http_time(const char *buf, struct tm *tm)</div><div class="ttdef"><b>Definition:</b> util.c:1864</div></div>
<div class="ttc" id="util_8h_html_a866d4c80bbdc37a0279c2bd02f4b2bde"><div class="ttname"><a href="util_8h.html#a866d4c80bbdc37a0279c2bd02f4b2bde">update_approx_time</a></div><div class="ttdeci">void update_approx_time(time_t now)</div><div class="ttdef"><b>Definition:</b> util.c:1998</div></div>
<div class="ttc" id="util_8h_html_acc27414998a66c3602c4199b8316ec29"><div class="ttname"><a href="util_8h.html#acc27414998a66c3602c4199b8316ec29">finish_daemon</a></div><div class="ttdeci">void finish_daemon(const char *desired_cwd)</div><div class="ttdef"><b>Definition:</b> util.c:3700</div></div>
<div class="ttc" id="util_8h_html_a6c86cfa147080a762691fe23882e4178"><div class="ttname"><a href="util_8h.html#a6c86cfa147080a762691fe23882e4178">tor_memdup_nulterm_</a></div><div class="ttdeci">void * tor_memdup_nulterm_(const void *mem, size_t len DMALLOC_PARAMS) ATTR_MALLOC ATTR_NONNULL((1))</div><div class="ttdef"><b>Definition:</b> util.c:337</div></div>
<div class="ttc" id="util_8h_html_a5d31dda277e56fa17f61ee4d92881e34"><div class="ttname"><a href="util_8h.html#a5d31dda277e56fa17f61ee4d92881e34">stream_status</a></div><div class="ttdeci">stream_status</div><div class="ttdef"><b>Definition:</b> util.h:313</div></div>
<div class="ttc" id="util_8h_html_a13961bf3ef2587508876b5ee616222fc"><div class="ttname"><a href="util_8h.html#a13961bf3ef2587508876b5ee616222fc">n_bits_set_u8</a></div><div class="ttdeci">int n_bits_set_u8(uint8_t v)</div><div class="ttdef"><b>Definition:</b> util.c:608</div></div>
<div class="ttc" id="util_8h_html_a343c89702d7d04adc7739b5d668a16cf"><div class="ttname"><a href="util_8h.html#a343c89702d7d04adc7739b5d668a16cf">hex_str</a></div><div class="ttdeci">const char * hex_str(const char *from, size_t fromlen) ATTR_NONNULL((1))</div><div class="ttdef"><b>Definition:</b> util.c:658</div></div>
<div class="ttc" id="util_8h_html_a6131c8f51e7c98072a0697c68be9bed9"><div class="ttname"><a href="util_8h.html#a6131c8f51e7c98072a0697c68be9bed9">eat_whitespace_eos</a></div><div class="ttdeci">const char * eat_whitespace_eos(const char *s, const char *eos)</div><div class="ttdef"><b>Definition:</b> util.c:840</div></div>
<div class="ttc" id="util_8h_html_a44accacd9eb3598784c3093af877f9e9"><div class="ttname"><a href="util_8h.html#a44accacd9eb3598784c3093af877f9e9">tor_strlower</a></div><div class="ttdeci">void tor_strlower(char *s) ATTR_NONNULL((1))</div><div class="ttdef"><b>Definition:</b> util.c:670</div></div>
<div class="ttc" id="util_8h_html_a575120f4319acc1717c0592c4bf3e95a"><div class="ttname"><a href="util_8h.html#a575120f4319acc1717c0592c4bf3e95a">process_environment_make</a></div><div class="ttdeci">process_environment_t * process_environment_make(struct smartlist_t *env_vars)</div><div class="ttdef"><b>Definition:</b> util.c:4773</div></div>
<div class="ttc" id="structprocess__environment__t_html"><div class="ttname"><a href="structprocess__environment__t.html">process_environment_t</a></div><div class="ttdef"><b>Definition:</b> util.h:421</div></div>
<div class="ttc" id="util_8h_html_a8736099b0ade1d9bfdcca508257fc0f5"><div class="ttname"><a href="util_8h.html#a8736099b0ade1d9bfdcca508257fc0f5">round_uint32_to_next_multiple_of</a></div><div class="ttdeci">uint32_t round_uint32_to_next_multiple_of(uint32_t number, uint32_t divisor)</div><div class="ttdef"><b>Definition:</b> util.c:504</div></div>
<div class="ttc" id="util_8h_html_add0703747195c2abd042572426e80266"><div class="ttname"><a href="util_8h.html#add0703747195c2abd042572426e80266">tor_digest_is_zero</a></div><div class="ttdeci">int tor_digest_is_zero(const char *digest)</div><div class="ttdef"><b>Definition:</b> util.c:1006</div></div>
<div class="ttc" id="structsmartlist__t_html"><div class="ttname"><a href="structsmartlist__t.html">smartlist_t</a></div><div class="ttdef"><b>Definition:</b> container.h:18</div></div>
<div class="ttc" id="util_8c_html_a245aaefd9d8715af06ce0f7b7355fd0d"><div class="ttname"><a href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d">strcmpstart</a></div><div class="ttdeci">int strcmpstart(const char *s1, const char *s2)</div><div class="ttdef"><b>Definition:</b> util.c:736</div></div>
<div class="ttc" id="torint_8h_html"><div class="ttname"><a href="torint_8h.html">torint.h</a></div><div class="ttdoc">Header file to define uint32_t and friends. </div></div>
<div class="ttc" id="namespaced_html"><div class="ttname"><a href="namespaced.html">d</a></div><div class="ttdef"><b>Definition:</b> d.py:1</div></div>
<div class="ttc" id="util_8h_html_a936fd5dfa0ccd9b836df432640cbfe88"><div class="ttname"><a href="util_8h.html#a936fd5dfa0ccd9b836df432640cbfe88">string_is_C_identifier</a></div><div class="ttdeci">int string_is_C_identifier(const char *string)</div><div class="ttdef"><b>Definition:</b> util.c:959</div></div>
<div class="ttc" id="util_8h_html_a6ea588248ddc24be41620939146e356b"><div class="ttname"><a href="util_8h.html#a6ea588248ddc24be41620939146e356b">format_local_iso_time</a></div><div class="ttdeci">void format_local_iso_time(char *buf, time_t t)</div><div class="ttdef"><b>Definition:</b> util.c:1767</div></div>
<div class="ttc" id="util_8h_html_aa86d039278659b0bcd070908fb5e5218"><div class="ttname"><a href="util_8h.html#aa86d039278659b0bcd070908fb5e5218">tv_mdiff</a></div><div class="ttdeci">long tv_mdiff(const struct timeval *start, const struct timeval *end)</div><div class="ttdef"><b>Definition:</b> util.c:1492</div></div>
<div class="ttc" id="util_8h_html_a458f8625bc6faf79b6c8f52c878bc28a"><div class="ttname"><a href="util_8h.html#a458f8625bc6faf79b6c8f52c878bc28a">tor_strdup_</a></div><div class="ttdeci">char * tor_strdup_(const char *s DMALLOC_PARAMS) ATTR_MALLOC ATTR_NONNULL((1))</div><div class="ttdef"><b>Definition:</b> util.c:280</div></div>
<div class="ttc" id="util_8h_html_a4ffe4b25d88ed9e9fe0024efd0bcfd36"><div class="ttname"><a href="util_8h.html#a4ffe4b25d88ed9e9fe0024efd0bcfd36">tor_process_get_pid</a></div><div class="ttdeci">int tor_process_get_pid(process_handle_t *process_handle)</div><div class="ttdef"><b>Definition:</b> util.c:4122</div></div>
<div class="ttc" id="util_8h_html_a793d72f9aa9b10762da2d74f414f14e4"><div class="ttname"><a href="util_8h.html#a793d72f9aa9b10762da2d74f414f14e4">tor_read_all_from_process_stdout</a></div><div class="ttdeci">ssize_t tor_read_all_from_process_stdout(const process_handle_t *process_handle, char *buf, size_t count)</div><div class="ttdef"><b>Definition:</b> util.c:5016</div></div>
<div class="ttc" id="util_8h_html_a74f547603445427e06899d24b1bea3f0"><div class="ttname"><a href="util_8h.html#a74f547603445427e06899d24b1bea3f0">tor_weak_random</a></div><div class="ttdeci">int32_t tor_weak_random(tor_weak_rng_t *weak_rng)</div><div class="ttdef"><b>Definition:</b> util.c:5660</div></div>
<div class="ttc" id="util_8h_html_a198d1f011891d6d369bab39eaeecd275"><div class="ttname"><a href="util_8h.html#a198d1f011891d6d369bab39eaeecd275">format_iso_time_nospace_usec</a></div><div class="ttdeci">void format_iso_time_nospace_usec(char *buf, const struct timeval *tv)</div><div class="ttdef"><b>Definition:</b> util.c:1796</div></div>
<div class="ttc" id="structopen__file__t_html"><div class="ttname"><a href="structopen__file__t.html">open_file_t</a></div><div class="ttdef"><b>Definition:</b> util.c:2458</div></div>
<div class="ttc" id="util_8h_html_a8c315755a2fb518d47d7397a14e506de"><div class="ttname"><a href="util_8h.html#a8c315755a2fb518d47d7397a14e506de">tor_parse_ulong</a></div><div class="ttdeci">unsigned long tor_parse_ulong(const char *s, int base, unsigned long min, unsigned long max, int *ok, char **next)</div><div class="ttdef"><b>Definition:</b> util.c:1183</div></div>
<div class="ttc" id="util_8h_html_a5de34b7fb58161640f7254a4c14119f7"><div class="ttname"><a href="util_8h.html#a5de34b7fb58161640f7254a4c14119f7">cpd_check_t</a></div><div class="ttdeci">unsigned int cpd_check_t</div><div class="ttdef"><b>Definition:</b> util.h:333</div></div>
<div class="ttc" id="util_8h_html_ae251b57349c0a4bf306bd47653d3ca16"><div class="ttname"><a href="util_8h.html#ae251b57349c0a4bf306bd47653d3ca16">tor_htonll</a></div><div class="ttdeci">uint64_t tor_htonll(uint64_t a)</div><div class="ttdef"><b>Definition:</b> util.c:5756</div></div>
<div class="ttc" id="util_8h_html_a714ca710c1b7d56d6633bf2d1f550cad"><div class="ttname"><a href="util_8h.html#a714ca710c1b7d56d6633bf2d1f550cad">tor_digest256_is_zero</a></div><div class="ttdeci">int tor_digest256_is_zero(const char *digest)</div><div class="ttdef"><b>Definition:</b> util.c:1120</div></div>
<div class="ttc" id="util_8h_html_a8d370e39e1dfeb9c6436bd7879c04ce2"><div class="ttname"><a href="util_8h.html#a8d370e39e1dfeb9c6436bd7879c04ce2">round_to_next_multiple_of</a></div><div class="ttdeci">unsigned round_to_next_multiple_of(unsigned number, unsigned divisor)</div><div class="ttdef"><b>Definition:</b> util.c:490</div></div>
<div class="ttc" id="util_8h_html_ab0b84a4f34827ed0648081554082d084"><div class="ttname"><a href="util_8h.html#ab0b84a4f34827ed0648081554082d084">tor_memdup_</a></div><div class="ttdeci">void * tor_memdup_(const void *mem, size_t len DMALLOC_PARAMS) ATTR_MALLOC ATTR_NONNULL((1))</div><div class="ttdef"><b>Definition:</b> util.c:324</div></div>
<div class="ttc" id="util_8h_html_a1fe038f20a5b4c4a646e00c5b5434465"><div class="ttname"><a href="util_8h.html#a1fe038f20a5b4c4a646e00c5b5434465">tor_malloc_zero_</a></div><div class="ttdeci">void * tor_malloc_zero_(size_t size DMALLOC_PARAMS) ATTR_MALLOC</div><div class="ttdef"><b>Definition:</b> util.c:170</div></div>
<div class="ttc" id="util_8h_html_a060088cb8d827dceb15e56a0e4c04a29"><div class="ttname"><a href="util_8h.html#a060088cb8d827dceb15e56a0e4c04a29">tor_strndup_</a></div><div class="ttdeci">char * tor_strndup_(const char *s, size_t n DMALLOC_PARAMS) ATTR_MALLOC ATTR_NONNULL((1))</div><div class="ttdef"><b>Definition:</b> util.c:306</div></div>
<div class="ttc" id="util_8h_html_a9abe40033cbac958b0740567841da975"><div class="ttname"><a href="util_8h.html#a9abe40033cbac958b0740567841da975">tor_malloc_</a></div><div class="ttdeci">void * tor_malloc_(size_t size DMALLOC_PARAMS) ATTR_MALLOC</div><div class="ttdef"><b>Definition:</b> util.c:134</div></div>
<div class="ttc" id="util_8h_html_add7c7d604e585e84ffa60896fcc8996b"><div class="ttname"><a href="util_8h.html#add7c7d604e585e84ffa60896fcc8996b">sized_chunk_t</a></div><div class="ttdeci">struct sized_chunk_t sized_chunk_t</div></div>
<div class="ttc" id="util_8h_html_a314f05865bf730672a42dd9da355f884"><div class="ttname"><a href="util_8h.html#a314f05865bf730672a42dd9da355f884">tor_spawn_background</a></div><div class="ttdeci">int tor_spawn_background(const char *const filename, const char **argv, process_environment_t *env, process_handle_t **process_handle_out)</div><div class="ttdef"><b>Definition:</b> util.c:4222</div></div>
<div class="ttc" id="util_8h_html_a66ec527143a1add05912e302c0f68b93"><div class="ttname"><a href="util_8h.html#a66ec527143a1add05912e302c0f68b93">fast_memcmpstart</a></div><div class="ttdeci">int int int int int int fast_memcmpstart(const void *mem, size_t memlen, const char *prefix)</div><div class="ttdef"><b>Definition:</b> util.c:800</div></div>
<div class="ttc" id="util_8h_html_a8623147f8fba9a3c98c906f554601f35"><div class="ttname"><a href="util_8h.html#a8623147f8fba9a3c98c906f554601f35">append_bytes_to_file</a></div><div class="ttdeci">int append_bytes_to_file(const char *fname, const char *str, size_t len, int bin)</div><div class="ttdef"><b>Definition:</b> util.c:2722</div></div>
<div class="ttc" id="util_8h_html_a2e7a428898dbe56b00df335904bd8ea2"><div class="ttname"><a href="util_8h.html#a2e7a428898dbe56b00df335904bd8ea2">file_status</a></div><div class="ttdeci">file_status_t file_status(const char *filename)</div><div class="ttdef"><b>Definition:</b> util.c:2156</div></div>
<div class="ttc" id="util_8h_html_a50a277d6cece483ae49a0bf173a0529a"><div class="ttname"><a href="util_8h.html#a50a277d6cece483ae49a0bf173a0529a">stream_status_to_string</a></div><div class="ttdeci">const char * stream_status_to_string(enum stream_status stream_status)</div><div class="ttdef"><b>Definition:</b> util.c:5097</div></div>
<div class="ttc" id="util_8h_html_a2b8d1db012eaaff2542537dee3c644a3"><div class="ttname"><a href="util_8h.html#a2b8d1db012eaaff2542537dee3c644a3">find_whitespace_eos</a></div><div class="ttdeci">const char * find_whitespace_eos(const char *s, const char *eos)</div><div class="ttdef"><b>Definition:</b> util.c:911</div></div>
<div class="ttc" id="util_8h_html_a1b3dda16e5097d60dd0a43815cc84fa8"><div class="ttname"><a href="util_8h.html#a1b3dda16e5097d60dd0a43815cc84fa8">parse_iso_time_</a></div><div class="ttdeci">int parse_iso_time_(const char *cp, time_t *t, int strict)</div><div class="ttdef"><b>Definition:</b> util.c:1808</div></div>
<div class="ttc" id="util_8h_html_a06c31f983cd56699cca308532a09a14c"><div class="ttname"><a href="util_8h.html#a06c31f983cd56699cca308532a09a14c">string_is_valid_ipv6_address</a></div><div class="ttdeci">int string_is_valid_ipv6_address(const char *string)</div><div class="ttdef"><b>Definition:</b> util.c:1062</div></div>
<div class="ttc" id="util_8h_html_a0eb16940d73c3b4012f2f810f3ecbecd"><div class="ttname"><a href="util_8h.html#a0eb16940d73c3b4012f2f810f3ecbecd">write_all</a></div><div class="ttdeci">ssize_t write_all(tor_socket_t fd, const char *buf, size_t count, int isSocket)</div><div class="ttdef"><b>Definition:</b> util.c:2064</div></div>
<div class="ttc" id="util_8h_html_a0fa6261bbc231af861f420e8411e0f03"><div class="ttname"><a href="util_8h.html#a0fa6261bbc231af861f420e8411e0f03">tor_parse_uint64</a></div><div class="ttdeci">uint64_t tor_parse_uint64(const char *s, int base, uint64_t min, uint64_t max, int *ok, char **next)</div><div class="ttdef"><b>Definition:</b> util.c:1215</div></div>
<div class="ttc" id="util_8c_html_a58eee4159dfe33194147f2146f0dbc2f"><div class="ttname"><a href="util_8c.html#a58eee4159dfe33194147f2146f0dbc2f">tor_sscanf</a></div><div class="ttdeci">int tor_sscanf(const char *buf, const char *pattern,...)</div><div class="ttdef"><b>Definition:</b> util.c:3503</div></div>
<div class="ttc" id="util_8h_html_aa4a3fe13e93e542ee9b598d865f2647c"><div class="ttname"><a href="util_8h.html#aa4a3fe13e93e542ee9b598d865f2647c">start_writing_to_stdio_file</a></div><div class="ttdeci">FILE * start_writing_to_stdio_file(const char *fname, int open_flags, int mode, open_file_t **data_out)</div><div class="ttdef"><b>Definition:</b> util.c:2567</div></div>
<div class="ttc" id="util_8h_html_a5512823a9379c4bc5f60c956600d00b6"><div class="ttname"><a href="util_8h.html#a5512823a9379c4bc5f60c956600d00b6">tor_read_all_from_process_stderr</a></div><div class="ttdeci">ssize_t tor_read_all_from_process_stderr(const process_handle_t *process_handle, char *buf, size_t count)</div><div class="ttdef"><b>Definition:</b> util.c:5030</div></div>
<div class="ttc" id="util_8c_html_a595e5e722adc3f46c2d27bced61a8a18"><div class="ttname"><a href="util_8c.html#a595e5e722adc3f46c2d27bced61a8a18">strcasecmpend</a></div><div class="ttdeci">int strcasecmpend(const char *s1, const char *s2)</div><div class="ttdef"><b>Definition:</b> util.c:784</div></div>
<div class="ttc" id="util_8h_html_a98f5785d540bfcd4822ebbcbe61685cd"><div class="ttname"><a href="util_8h.html#a98f5785d540bfcd4822ebbcbe61685cd">get_current_process_environment_variables</a></div><div class="ttdeci">struct smartlist_t * get_current_process_environment_variables(void)</div><div class="ttdef"><b>Definition:</b> util.c:4861</div></div>
<div class="ttc" id="util_8h_html_a69faf166aa0aa9164d2134419c81ba1b"><div class="ttname"><a href="util_8h.html#a69faf166aa0aa9164d2134419c81ba1b">eat_whitespace</a></div><div class="ttdeci">const char * eat_whitespace(const char *s)</div><div class="ttdef"><b>Definition:</b> util.c:813</div></div>
<div class="ttc" id="util_8h_html_a966c4dd39a43f89fd5207aebb4756654"><div class="ttname"><a href="util_8h.html#a966c4dd39a43f89fd5207aebb4756654">tor_timegm</a></div><div class="ttdeci">int tor_timegm(const struct tm *tm, time_t *time_out)</div><div class="ttdef"><b>Definition:</b> util.c:1578</div></div>
<div class="ttc" id="util_8h_html_a2847abc06f048c1d29b33a8c757c27c0"><div class="ttname"><a href="util_8h.html#a2847abc06f048c1d29b33a8c757c27c0">tor_lround</a></div><div class="ttdeci">long tor_lround(double d) ATTR_CONST</div><div class="ttdef"><b>Definition:</b> util.c:404</div></div>
<div class="ttc" id="util_8h_html_a76c884069e4448d4e4427901f04a85a0"><div class="ttname"><a href="util_8h.html#a76c884069e4448d4e4427901f04a85a0">esc_for_log_len</a></div><div class="ttdeci">char * esc_for_log_len(const char *chars, size_t n) ATTR_MALLOC</div><div class="ttdef"><b>Definition:</b> util.c:1342</div></div>
<div class="ttc" id="util_8h_html_ab838c820246f358bc0b99884154b2704"><div class="ttname"><a href="util_8h.html#ab838c820246f358bc0b99884154b2704">eat_whitespace_no_nl</a></div><div class="ttdeci">const char * eat_whitespace_no_nl(const char *s)</div><div class="ttdef"><b>Definition:</b> util.c:868</div></div>
<div class="ttc" id="util_8h_html_a34984f08eb3eef95438b8e65226dff8e"><div class="ttname"><a href="util_8h.html#a34984f08eb3eef95438b8e65226dff8e">find_whitespace</a></div><div class="ttdeci">const char * find_whitespace(const char *s)</div><div class="ttdef"><b>Definition:</b> util.c:889</div></div>
<div class="ttc" id="util_8c_html_a882356feb0fa2fe4001c5298015862a3"><div class="ttname"><a href="util_8c.html#a882356feb0fa2fe4001c5298015862a3">tor_reallocarray_</a></div><div class="ttdeci">void * tor_reallocarray_(void *ptr, size_t sz1, size_t sz2 DMALLOC_PARAMS)</div><div class="ttdef"><b>Definition:</b> util.c:266</div></div>
<div class="ttc" id="util_8h_html_a9ce5e8df63b6d2ae9cb31a301fecb350"><div class="ttname"><a href="util_8h.html#a9ce5e8df63b6d2ae9cb31a301fecb350">start_daemon</a></div><div class="ttdeci">void start_daemon(void)</div><div class="ttdef"><b>Definition:</b> util.c:3639</div></div>
<div class="ttc" id="structtimeval_html"><div class="ttname"><a href="structtimeval.html">timeval</a></div><div class="ttdef"><b>Definition:</b> compat_time.h:33</div></div>
<div class="ttc" id="util_8h_html_a6a156db0f5951592099e3bc646de2416"><div class="ttname"><a href="util_8h.html#a6a156db0f5951592099e3bc646de2416">tor_weak_random_range</a></div><div class="ttdeci">int32_t tor_weak_random_range(tor_weak_rng_t *rng, int32_t top)</div><div class="ttdef"><b>Definition:</b> util.c:5676</div></div>
<div class="ttc" id="util_8h_html_af16b9ea01680fc8d8adb247d1549c00c"><div class="ttname"><a href="util_8h.html#af16b9ea01680fc8d8adb247d1549c00c">tor_log_mallinfo</a></div><div class="ttdeci">void tor_log_mallinfo(int severity)</div><div class="ttdef"><b>Definition:</b> util.c:360</div></div>
<div class="ttc" id="util_8h_html_a1002800a4c79695b35032f8db18bf89b"><div class="ttname"><a href="util_8h.html#a1002800a4c79695b35032f8db18bf89b">add_laplace_noise</a></div><div class="ttdeci">int64_t add_laplace_noise(int64_t signal, double random, double delta_f, double epsilon)</div><div class="ttdef"><b>Definition:</b> util.c:559</div></div>
<div class="ttc" id="util_8h_html_a9098e9a0fbd29020d63e79142f0fa486"><div class="ttname"><a href="util_8h.html#a9098e9a0fbd29020d63e79142f0fa486">ratelim_t</a></div><div class="ttdeci">struct ratelim_t ratelim_t</div></div>
<div class="ttc" id="util_8h_html_acccef56e2025d059043fcec01d038f6b"><div class="ttname"><a href="util_8h.html#acccef56e2025d059043fcec01d038f6b">tor_calloc_</a></div><div class="ttdeci">void * tor_calloc_(size_t nmemb, size_t size DMALLOC_PARAMS) ATTR_MALLOC</div><div class="ttdef"><b>Definition:</b> util.c:222</div></div>
<div class="ttc" id="util_8h_html_a6e86f3506694e8592bb7f926af588b07"><div class="ttname"><a href="util_8h.html#a6e86f3506694e8592bb7f926af588b07">string_is_valid_hostname</a></div><div class="ttdeci">int string_is_valid_hostname(const char *string)</div><div class="ttdef"><b>Definition:</b> util.c:1076</div></div>
<div class="ttc" id="util_8c_html_a68cb44a66a7446022122c93590b6d179"><div class="ttname"><a href="util_8c.html#a68cb44a66a7446022122c93590b6d179">smartlist_add_asprintf</a></div><div class="ttdeci">void smartlist_add_asprintf(struct smartlist_t *sl, const char *pattern,...)</div><div class="ttdef"><b>Definition:</b> util.c:3516</div></div>
<div class="ttc" id="util_8h_html_ac0cbd74a7fe81a4aa5efab4d87628ea0"><div class="ttname"><a href="util_8h.html#ac0cbd74a7fe81a4aa5efab4d87628ea0">fdopen_file</a></div><div class="ttdeci">FILE * fdopen_file(open_file_t *file_data)</div><div class="ttdef"><b>Definition:</b> util.c:2550</div></div>
<div class="ttc" id="util_8h_html_a2d41bec85f718e65fc058be330d7e739"><div class="ttname"><a href="util_8h.html#a2d41bec85f718e65fc058be330d7e739">tor_log2</a></div><div class="ttdeci">int tor_log2(uint64_t u64) ATTR_CONST</div><div class="ttdef"><b>Definition:</b> util.c:432</div></div>
<div class="ttc" id="util_8c_html_a90e57e8764505012f016303eab3e4180"><div class="ttname"><a href="util_8c.html#a90e57e8764505012f016303eab3e4180">tor_vsscanf</a></div><div class="ttdeci">int tor_vsscanf(const char *buf, const char *pattern, va_list ap)</div><div class="ttdef"><b>Definition:</b> util.c:3373</div></div>
<div class="ttc" id="util_8c_html_a28445ce92bb84e6413d5437428dae850"><div class="ttname"><a href="util_8c.html#a28445ce92bb84e6413d5437428dae850">strcmpend</a></div><div class="ttdeci">int strcmpend(const char *s1, const char *s2)</div><div class="ttdef"><b>Definition:</b> util.c:771</div></div>
<div class="ttc" id="util_8h_html_ae96270f5e46701de9220bc7709ad24f4"><div class="ttname"><a href="util_8h.html#ae96270f5e46701de9220bc7709ad24f4">tor_parse_long</a></div><div class="ttdeci">void long tor_parse_long(const char *s, int base, long min, long max, int *ok, char **next)</div><div class="ttdef"><b>Definition:</b> util.c:1164</div></div>
<div class="ttc" id="namespacebase_html"><div class="ttname"><a href="namespacebase.html">base</a></div><div class="ttdef"><b>Definition:</b> base.py:1</div></div>
<div class="ttc" id="util_8h_html_a0bb1364a2d99b1af1fa75dd87c1912d2"><div class="ttname"><a href="util_8h.html#a0bb1364a2d99b1af1fa75dd87c1912d2">eat_whitespace_eos_no_nl</a></div><div class="ttdeci">const char * eat_whitespace_eos_no_nl(const char *s, const char *eos)</div><div class="ttdef"><b>Definition:</b> util.c:878</div></div>
<div class="ttc" id="util_8h_html_a6516b5e2e61dac21effa077c405f8703"><div class="ttname"><a href="util_8h.html#a6516b5e2e61dac21effa077c405f8703">get_string_from_pipe</a></div><div class="ttdeci">enum stream_status get_string_from_pipe(FILE *stream, char *buf, size_t count)</div><div class="ttdef"><b>Definition:</b> util.c:5312</div></div>
<div class="ttc" id="util_8c_html_acd19d8da6d9f5237a8815199361c37b7"><div class="ttname"><a href="util_8c.html#acd19d8da6d9f5237a8815199361c37b7">format_helper_exit_status</a></div><div class="ttdeci">STATIC int format_helper_exit_status(unsigned char child_state, int saved_errno, char *hex_errno)</div><div class="ttdef"><b>Definition:</b> util.c:3989</div></div>
<div class="ttc" id="util_8h_html_a307d12f617bd1f5606b8f971733e4c48"><div class="ttname"><a href="util_8h.html#a307d12f617bd1f5606b8f971733e4c48">string_is_valid_ipv4_address</a></div><div class="ttdeci">int string_is_valid_ipv4_address(const char *string)</div><div class="ttdef"><b>Definition:</b> util.c:1051</div></div>
<div class="ttc" id="util_8h_html_abf5a920e5066e56d3267e95ab675bdc0"><div class="ttname"><a href="util_8h.html#abf5a920e5066e56d3267e95ab675bdc0">tor_join_win_cmdline</a></div><div class="ttdeci">char * tor_join_win_cmdline(const char *argv[])</div><div class="ttdef"><b>Definition:</b> util.c:3868</div></div>
<div class="ttc" id="util_8h_html_aea75d86d98077dca32127a8cb0fe97dc"><div class="ttname"><a href="util_8h.html#aea75d86d98077dca32127a8cb0fe97dc">escaped</a></div><div class="ttdeci">const char * escaped(const char *string)</div><div class="ttdef"><b>Definition:</b> util.c:1358</div></div>
<div class="ttc" id="util_8h_html_a95a7f768fd014b99df070ba40825a30e"><div class="ttname"><a href="util_8h.html#a95a7f768fd014b99df070ba40825a30e">tor_strupper</a></div><div class="ttdeci">void tor_strupper(char *s) ATTR_NONNULL((1))</div><div class="ttdef"><b>Definition:</b> util.c:681</div></div>
<div class="ttc" id="util_8h_html_a4fb7293a905e61c3a9ba683a8ed9ad99"><div class="ttname"><a href="util_8h.html#a4fb7293a905e61c3a9ba683a8ed9ad99">string_is_key_value</a></div><div class="ttdeci">int string_is_key_value(int severity, const char *string)</div><div class="ttdef"><b>Definition:</b> util.c:1018</div></div>
<div class="ttc" id="util_8c_html_a1d095be5cec365a93ac90501390f70fa"><div class="ttname"><a href="util_8c.html#a1d095be5cec365a93ac90501390f70fa">strcasecmpstart</a></div><div class="ttdeci">int strcasecmpstart(const char *s1, const char *s2)</div><div class="ttdef"><b>Definition:</b> util.c:761</div></div>
<div class="ttc" id="util_8h_html_a34dff6b01b03f9d8609c93fec5fffc17"><div class="ttname"><a href="util_8h.html#a34dff6b01b03f9d8609c93fec5fffc17">finish_writing_to_file</a></div><div class="ttdeci">int finish_writing_to_file(open_file_t *file_data)</div><div class="ttdef"><b>Definition:</b> util.c:2633</div></div>
<div class="ttc" id="util_8h_html_a78fd132b1188cdc0ac5e225dc160194f"><div class="ttname"><a href="util_8h.html#a78fd132b1188cdc0ac5e225dc160194f">tor_read_all_handle</a></div><div class="ttdeci">ssize_t tor_read_all_handle(FILE *h, char *buf, size_t count, const process_handle_t *process, int *eof)</div><div class="ttdef"><b>Definition:</b> util.c:4969</div></div>
<div class="ttc" id="util_8h_html_a584e4996b64ee5bce8e33d46812388bc"><div class="ttname"><a href="util_8h.html#a584e4996b64ee5bce8e33d46812388bc">environment_variable_names_equal</a></div><div class="ttdeci">int environment_variable_names_equal(const char *s1, const char *s2)</div><div class="ttdef"><b>Definition:</b> util.c:4742</div></div>
<div class="ttc" id="util_8h_html_a4959f0aba8a681ab08cfdccfbe16ffc2"><div class="ttname"><a href="util_8h.html#a4959f0aba8a681ab08cfdccfbe16ffc2">tor_ntohll</a></div><div class="ttdeci">uint64_t tor_ntohll(uint64_t a)</div><div class="ttdef"><b>Definition:</b> util.c:5770</div></div>
<div class="ttc" id="util_8h_html_a89a3242e83d59f2ccb9bb662e9a94134"><div class="ttname"><a href="util_8h.html#a89a3242e83d59f2ccb9bb662e9a94134">expand_filename</a></div><div class="ttdeci">char * expand_filename(const char *filename)</div><div class="ttdef"><b>Definition:</b> util.c:3154</div></div>
<div class="ttc" id="util_8h_html_a4968664a12def8a77e2eefd8f38f7217"><div class="ttname"><a href="util_8h.html#a4968664a12def8a77e2eefd8f38f7217">parse_rfc1123_time</a></div><div class="ttdeci">int parse_rfc1123_time(const char *buf, time_t *t)</div><div class="ttdef"><b>Definition:</b> util.c:1688</div></div>
<div class="ttc" id="structratelim__t_html"><div class="ttname"><a href="structratelim__t.html">ratelim_t</a></div><div class="ttdef"><b>Definition:</b> util.h:297</div></div>
<div class="ttc" id="util_8h_html_afb786cd2adb671797e2afdb997153864"><div class="ttname"><a href="util_8h.html#afb786cd2adb671797e2afdb997153864">tor_split_lines</a></div><div class="ttdeci">int tor_split_lines(struct smartlist_t *sl, char *buf, int len)</div><div class="ttdef"><b>Definition:</b> util.c:5048</div></div>
<div class="ttc" id="util_8h_html_acfd840af6560e9723b41fb936d6935ed"><div class="ttname"><a href="util_8h.html#acfd840af6560e9723b41fb936d6935ed">write_pidfile</a></div><div class="ttdeci">void write_pidfile(const char *filename)</div><div class="ttdef"><b>Definition:</b> util.c:3761</div></div>
<div class="ttc" id="structtor__weak__rng__t_html"><div class="ttname"><a href="structtor__weak__rng__t.html">tor_weak_rng_t</a></div><div class="ttdef"><b>Definition:</b> util.h:523</div></div>
<div class="ttc" id="util_8h_html_a0d7e19b54b49c88b434adaaf7d9b4f85"><div class="ttname"><a href="util_8h.html#a0d7e19b54b49c88b434adaaf7d9b4f85">format_iso_time_nospace</a></div><div class="ttdeci">void format_iso_time_nospace(char *buf, time_t t)</div><div class="ttdef"><b>Definition:</b> util.c:1786</div></div>
<div class="ttc" id="util_8h_html_a7c5079074e649dc0369225eca3073f7d"><div class="ttname"><a href="util_8h.html#a7c5079074e649dc0369225eca3073f7d">tor_mem_is_zero</a></div><div class="ttdeci">int tor_mem_is_zero(const char *mem, size_t len)</div><div class="ttdef"><b>Definition:</b> util.c:984</div></div>
<div class="ttc" id="util_8h_html_a7b3cac27558cc7f26bd0794f5996e0ef"><div class="ttname"><a href="util_8h.html#a7b3cac27558cc7f26bd0794f5996e0ef">read_file_to_str_until_eof</a></div><div class="ttdeci">char * read_file_to_str_until_eof(int fd, size_t max_bytes_to_read, size_t *sz_out) ATTR_MALLOC</div><div class="ttdef"><b>Definition:</b> util.c:2748</div></div>
<div class="ttc" id="util_8h_html_a70a007f8fc912d371f5789fdb6d82616"><div class="ttname"><a href="util_8h.html#a70a007f8fc912d371f5789fdb6d82616">tor_escape_str_for_pt_args</a></div><div class="ttdeci">char * tor_escape_str_for_pt_args(const char *string, const char *chars_to_escape)</div><div class="ttdef"><b>Definition:</b> util.c:1374</div></div>
<div class="ttc" id="util_8h_html_aabb29a0799fb54c87b3f6a4e7c252cb1"><div class="ttname"><a href="util_8h.html#aabb29a0799fb54c87b3f6a4e7c252cb1">parse_config_line_from_str_verbose</a></div><div class="ttdeci">const char * parse_config_line_from_str_verbose(const char *line, char **key_out, char **value_out, const char **err_out)</div><div class="ttdef"><b>Definition:</b> util.c:3030</div></div>
<div class="ttc" id="util_8c_html_a4fee2abf83af3a8b8a18b245daf4083b"><div class="ttname"><a href="util_8c.html#a4fee2abf83af3a8b8a18b245daf4083b">smartlist_add_vasprintf</a></div><div class="ttdeci">void smartlist_add_vasprintf(struct smartlist_t *sl, const char *pattern, va_list args)</div><div class="ttdef"><b>Definition:</b> util.c:3526</div></div>
<div class="ttc" id="util_8h_html_a3b535fd3c14d8db8e53d43cc9c4a9770"><div class="ttname"><a href="util_8h.html#a3b535fd3c14d8db8e53d43cc9c4a9770">tv_to_msec</a></div><div class="ttdeci">int64_t tv_to_msec(const struct timeval *tv)</div><div class="ttdef"><b>Definition:</b> util.c:1550</div></div>
<div class="ttc" id="util_8h_html_a21ebd7bd52d9589ad16b84df4a6b62e9"><div class="ttname"><a href="util_8h.html#a21ebd7bd52d9589ad16b84df4a6b62e9">format_dec_number_sigsafe</a></div><div class="ttdeci">int format_dec_number_sigsafe(unsigned long x, char *buf, int max_len)</div><div class="ttdef"><b>Definition:</b> util.c:3967</div></div>
<div class="ttc" id="util_8c_html_a96a2ca528cbd3f30a7a22d2ae2c82594"><div class="ttname"><a href="util_8c.html#a96a2ca528cbd3f30a7a22d2ae2c82594">strcmp_len</a></div><div class="ttdeci">int strcmp_len(const char *s1, const char *s2, size_t s1_len)</div><div class="ttdef"><b>Definition:</b> util.c:747</div></div>
<div class="ttc" id="util_8h_html_aca03d8cb6a22d540b13b92ea5945df33"><div class="ttname"><a href="util_8h.html#aca03d8cb6a22d540b13b92ea5945df33">approx_time</a></div><div class="ttdeci">time_t approx_time(void)</div><div class="ttdef"><b>Definition:</b> util.c:1989</div></div>
<div class="ttc" id="util_8h_html_aba3030cb2c1b5c587301c81b37243404"><div class="ttname"><a href="util_8h.html#aba3030cb2c1b5c587301c81b37243404">path_is_relative</a></div><div class="ttdeci">int path_is_relative(const char *filename)</div><div class="ttdef"><b>Definition:</b> util.c:3605</div></div>
<div class="ttc" id="util_8h_html_ac55ed8b7b00f14493effd493a957ddf1"><div class="ttname"><a href="util_8h.html#ac55ed8b7b00f14493effd493a957ddf1">abort_writing_to_file</a></div><div class="ttdeci">int abort_writing_to_file(open_file_t *file_data)</div><div class="ttdef"><b>Definition:</b> util.c:2641</div></div>
<div class="ttc" id="util_8h_html_aafa53729b0b1a866ab30872b51f3a54e"><div class="ttname"><a href="util_8h.html#aafa53729b0b1a866ab30872b51f3a54e">tor_init_weak_random</a></div><div class="ttdeci">void tor_init_weak_random(tor_weak_rng_t *weak_rng, unsigned seed)</div><div class="ttdef"><b>Definition:</b> util.c:5650</div></div>
<div class="ttc" id="util_8h_html_a0c64e97acc0df47b6c86b1df1d1d93de"><div class="ttname"><a href="util_8h.html#a0c64e97acc0df47b6c86b1df1d1d93de">esc_for_log</a></div><div class="ttdeci">char * esc_for_log(const char *string) ATTR_MALLOC</div><div class="ttdef"><b>Definition:</b> util.c:1262</div></div>
<div class="ttc" id="structsized__chunk__t_html"><div class="ttname"><a href="structsized__chunk__t.html">sized_chunk_t</a></div><div class="ttdef"><b>Definition:</b> util.h:363</div></div>
<div class="ttc" id="util_8h_html_aae5b7e7e99ea4705673069cf581ab70b"><div class="ttname"><a href="util_8h.html#aae5b7e7e99ea4705673069cf581ab70b">tor_get_exit_code</a></div><div class="ttdeci">int tor_get_exit_code(process_handle_t *process_handle, int block, int *exit_code)</div><div class="ttdef"><b>Definition:</b> util.c:4650</div></div>
<div class="ttc" id="util_8h_html_a270ca9db337eb4621f623a69c0faeb64"><div class="ttname"><a href="util_8h.html#a270ca9db337eb4621f623a69c0faeb64">format_iso_time</a></div><div class="ttdeci">void format_iso_time(char *buf, time_t t)</div><div class="ttdef"><b>Definition:</b> util.c:1777</div></div>
<div class="ttc" id="util_8h_html_a7f7ba7abeacdd02663350b7278098d44"><div class="ttname"><a href="util_8h.html#a7f7ba7abeacdd02663350b7278098d44">read_all</a></div><div class="ttdeci">ssize_t read_all(tor_socket_t fd, char *buf, size_t count, int isSocket)</div><div class="ttdef"><b>Definition:</b> util.c:2088</div></div>
<div class="ttc" id="util__bug_8h_html"><div class="ttname"><a href="util__bug_8h.html">util_bug.h</a></div></div>
<div class="ttc" id="util_8h_html_a83a53fbc2832eca17cafe21fd209420c"><div class="ttname"><a href="util_8h.html#a83a53fbc2832eca17cafe21fd209420c">file_status_t</a></div><div class="ttdeci">file_status_t</div><div class="ttdef"><b>Definition:</b> util.h:328</div></div>
<div class="ttc" id="util_8h_html_a5c13e53b335279a9609de90a2dd4c770"><div class="ttname"><a href="util_8h.html#a5c13e53b335279a9609de90a2dd4c770">tor_mathlog</a></div><div class="ttdeci">double tor_mathlog(double d) ATTR_CONST</div><div class="ttdef"><b>Definition:</b> util.c:395</div></div>
<div class="ttc" id="util_8h_html_a75c02e9ab5f17f8c5e9c68ee0833ac65"><div class="ttname"><a href="util_8h.html#a75c02e9ab5f17f8c5e9c68ee0833ac65">clamp_double_to_int64</a></div><div class="ttdeci">int64_t clamp_double_to_int64(double number)</div><div class="ttdef"><b>Definition:</b> util.c:5694</div></div>
<div class="ttc" id="util_8h_html_a0e1e4c423a6ba1306a9c3b2565e99391"><div class="ttname"><a href="util_8h.html#a0e1e4c423a6ba1306a9c3b2565e99391">format_rfc1123_time</a></div><div class="ttdeci">void format_rfc1123_time(char *buf, time_t t)</div><div class="ttdef"><b>Definition:</b> util.c:1664</div></div>
<div class="ttc" id="util_8h_html_a3d169aae56af8034ded171839c8a5c4a"><div class="ttname"><a href="util_8h.html#a3d169aae56af8034ded171839c8a5c4a">tor_realloc_</a></div><div class="ttdeci">void * tor_realloc_(void *ptr, size_t size DMALLOC_PARAMS)</div><div class="ttdef"><b>Definition:</b> util.c:233</div></div>
<div class="ttc" id="util_8h_html_a5189d0a5ffdf1ce3ac328aef77a32496"><div class="ttname"><a href="util_8h.html#a5189d0a5ffdf1ce3ac328aef77a32496">tor_terminate_process</a></div><div class="ttdeci">int tor_terminate_process(process_handle_t *process_handle)</div><div class="ttdef"><b>Definition:</b> util.c:4099</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
