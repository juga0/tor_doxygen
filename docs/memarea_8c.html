<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/common/memarea.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_b7e1585941a202f53e5249c42015d573.html">common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">memarea.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation for <a class="el" href="structmemarea__t.html">memarea_t</a>, an allocator for allocating lots of small objects that will be freed all at once.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;orconfig.h&quot;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;memarea.h&quot;</code><br />
<code>#include &quot;<a class="el" href="util_8h_source.html">util.h</a>&quot;</code><br />
<code>#include &quot;compat.h&quot;</code><br />
<code>#include &quot;<a class="el" href="torlog_8h_source.html">torlog.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for memarea.c:</div>
<div class="dyncontent">
<div class="center"><img src="memarea_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2memarea_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2memarea_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2memarea_8c">
<area shape="rect" id="node2" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="417,483,495,509"/>
<area shape="rect" id="node4" href="memarea_8h_source.html" title="memarea.h" alt="" coords="862,109,949,136"/>
<area shape="rect" id="node5" href="util_8h.html" title="Headers for util.c. " alt="" coords="347,109,397,136"/>
<area shape="rect" id="node7" href="compat_8h_source.html" title="compat.h" alt="" coords="605,259,681,285"/>
<area shape="rect" id="node16" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1025,184,1090,211"/>
<area shape="rect" id="node6" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="390,408,453,435"/>
<area shape="rect" id="node8" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="927,408,1025,435"/>
<area shape="rect" id="node14" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="145,333,215,360"/>
<area shape="rect" id="node15" href="util__bug_8h.html" title="util_bug.h" alt="" coords="426,184,505,211"/>
<area shape="rect" id="node10" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="622,408,730,435"/>
<area shape="rect" id="node13" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="529,333,655,360"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmemarea__chunk__t.html">memarea_chunk_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmemarea__t.html">memarea_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7a0e98816d3ad0a1cde454b2f2613726"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#a7a0e98816d3ad0a1cde454b2f2613726">USE_SENTINELS</a></td></tr>
<tr class="separator:a7a0e98816d3ad0a1cde454b2f2613726"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b251b77d759455e8e05b32347119d61"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#a6b251b77d759455e8e05b32347119d61">MEMAREA_ALIGN</a>&#160;&#160;&#160;SIZEOF_VOID_P</td></tr>
<tr class="separator:a6b251b77d759455e8e05b32347119d61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af96d1d28bccb39de30d440280b514f1e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#af96d1d28bccb39de30d440280b514f1e">U_MEM</a>&#160;&#160;&#160;u.mem</td></tr>
<tr class="separator:af96d1d28bccb39de30d440280b514f1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58c271488a8c1c693556e5667e010202"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#a58c271488a8c1c693556e5667e010202">SENTINEL_VAL</a>&#160;&#160;&#160;0x90806622u</td></tr>
<tr class="separator:a58c271488a8c1c693556e5667e010202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69f1f8604b267fe6aab1ffbdd83a0702"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#a69f1f8604b267fe6aab1ffbdd83a0702">SENTINEL_LEN</a>&#160;&#160;&#160;sizeof(uint32_t)</td></tr>
<tr class="separator:a69f1f8604b267fe6aab1ffbdd83a0702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ef78a9c6bb3beb86bc306c2d9bd2248"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#a0ef78a9c6bb3beb86bc306c2d9bd2248">SET_SENTINEL</a>(chunk)</td></tr>
<tr class="separator:a0ef78a9c6bb3beb86bc306c2d9bd2248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa1ac21aabb74c4e3a74cab2df8d9aa9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#afa1ac21aabb74c4e3a74cab2df8d9aa9">CHECK_SENTINEL</a>(chunk)</td></tr>
<tr class="separator:afa1ac21aabb74c4e3a74cab2df8d9aa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a518cb52278b69a6502ce7ac8cf49f2cf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#a518cb52278b69a6502ce7ac8cf49f2cf">CHUNK_HEADER_SIZE</a>&#160;&#160;&#160;<a class="el" href="util_8h.html#a34bb1d41c655823d71f9ce54196bcfd9">STRUCT_OFFSET</a>(<a class="el" href="structmemarea__chunk__t.html">memarea_chunk_t</a>, <a class="el" href="memarea_8c.html#af96d1d28bccb39de30d440280b514f1e">U_MEM</a>)</td></tr>
<tr class="separator:a518cb52278b69a6502ce7ac8cf49f2cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea3cfda4f3a9f978ec759f206cf186fe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#aea3cfda4f3a9f978ec759f206cf186fe">CHUNK_SIZE</a>&#160;&#160;&#160;4096</td></tr>
<tr class="separator:aea3cfda4f3a9f978ec759f206cf186fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aa81b19371d17d03cba8eb22234d48300"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structmemarea__chunk__t.html">memarea_chunk_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#aa81b19371d17d03cba8eb22234d48300">memarea_chunk_t</a></td></tr>
<tr class="separator:aa81b19371d17d03cba8eb22234d48300"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9bc481c5060ff6280cfb1e5eaaa915f4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmemarea__t.html">memarea_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#a9bc481c5060ff6280cfb1e5eaaa915f4">memarea_new</a> (void)</td></tr>
<tr class="separator:a9bc481c5060ff6280cfb1e5eaaa915f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaa462dd0af2198fd6fa88370ef5e5d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#afaa462dd0af2198fd6fa88370ef5e5d6">memarea_drop_all</a> (<a class="el" href="structmemarea__t.html">memarea_t</a> *area)</td></tr>
<tr class="separator:afaa462dd0af2198fd6fa88370ef5e5d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98079351167b7e4a7e189045d8534dc8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#a98079351167b7e4a7e189045d8534dc8">memarea_clear</a> (<a class="el" href="structmemarea__t.html">memarea_t</a> *area)</td></tr>
<tr class="separator:a98079351167b7e4a7e189045d8534dc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ab8e82f0c894120c51349c4e5059365"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#a8ab8e82f0c894120c51349c4e5059365">memarea_owns_ptr</a> (const <a class="el" href="structmemarea__t.html">memarea_t</a> *area, const void *p)</td></tr>
<tr class="separator:a8ab8e82f0c894120c51349c4e5059365"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab03a77a8bbd935b4b33bb1016079c3a3"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#ab03a77a8bbd935b4b33bb1016079c3a3">memarea_alloc</a> (<a class="el" href="structmemarea__t.html">memarea_t</a> *area, size_t sz)</td></tr>
<tr class="separator:ab03a77a8bbd935b4b33bb1016079c3a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe8736114c98d9206a3705919a9e231b"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#afe8736114c98d9206a3705919a9e231b">memarea_alloc_zero</a> (<a class="el" href="structmemarea__t.html">memarea_t</a> *area, size_t sz)</td></tr>
<tr class="separator:afe8736114c98d9206a3705919a9e231b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b9f13ab77557473065430397a29aa6"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#aa3b9f13ab77557473065430397a29aa6">memarea_memdup</a> (<a class="el" href="structmemarea__t.html">memarea_t</a> *area, const void *s, size_t n)</td></tr>
<tr class="separator:aa3b9f13ab77557473065430397a29aa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6aeabfc89cb75df17df4e799fd34bf2"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#ae6aeabfc89cb75df17df4e799fd34bf2">memarea_strdup</a> (<a class="el" href="structmemarea__t.html">memarea_t</a> *area, const char *s)</td></tr>
<tr class="separator:ae6aeabfc89cb75df17df4e799fd34bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2324c51c63afbce99ef1e56ee0bff87"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#ae2324c51c63afbce99ef1e56ee0bff87">memarea_strndup</a> (<a class="el" href="structmemarea__t.html">memarea_t</a> *area, const char *s, size_t n)</td></tr>
<tr class="separator:ae2324c51c63afbce99ef1e56ee0bff87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa491f6c85e95c3ffe3d566adf2ca5c06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#aa491f6c85e95c3ffe3d566adf2ca5c06">memarea_get_stats</a> (<a class="el" href="structmemarea__t.html">memarea_t</a> *area, size_t *allocated_out, size_t *used_out)</td></tr>
<tr class="separator:aa491f6c85e95c3ffe3d566adf2ca5c06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac337ef9a80db4617d1792744fa7b7515"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memarea_8c.html#ac337ef9a80db4617d1792744fa7b7515">memarea_assert_ok</a> (<a class="el" href="structmemarea__t.html">memarea_t</a> *area)</td></tr>
<tr class="separator:ac337ef9a80db4617d1792744fa7b7515"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation for <a class="el" href="structmemarea__t.html">memarea_t</a>, an allocator for allocating lots of small objects that will be freed all at once. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="afa1ac21aabb74c4e3a74cab2df8d9aa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa1ac21aabb74c4e3a74cab2df8d9aa9">&#9670;&nbsp;</a></span>CHECK_SENTINEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECK_SENTINEL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">chunk</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">STMT_BEGIN                                                            \</div><div class="line">  uint32_t sent_val = <a class="code" href="compat_8c.html#a601cbc7f9d07f77c3b28d7864b768054">get_uint32</a>(&amp;(chunk)-&gt;<a class="code" href="memarea_8c.html#af96d1d28bccb39de30d440280b514f1e">U_MEM</a>[chunk-&gt;mem_size]);     \</div><div class="line">  tor_assert(sent_val == <a class="code" href="memarea_8c.html#a58c271488a8c1c693556e5667e010202">SENTINEL_VAL</a>);                                 \</div><div class="line">  STMT_END</div><div class="ttc" id="memarea_8c_html_af96d1d28bccb39de30d440280b514f1e"><div class="ttname"><a href="memarea_8c.html#af96d1d28bccb39de30d440280b514f1e">U_MEM</a></div><div class="ttdeci">#define U_MEM</div><div class="ttdef"><b>Definition:</b> memarea.c:39</div></div>
<div class="ttc" id="memarea_8c_html_a58c271488a8c1c693556e5667e010202"><div class="ttname"><a href="memarea_8c.html#a58c271488a8c1c693556e5667e010202">SENTINEL_VAL</a></div><div class="ttdeci">#define SENTINEL_VAL</div><div class="ttdef"><b>Definition:</b> memarea.c:45</div></div>
<div class="ttc" id="compat_8c_html_a601cbc7f9d07f77c3b28d7864b768054"><div class="ttname"><a href="compat_8c.html#a601cbc7f9d07f77c3b28d7864b768054">get_uint32</a></div><div class="ttdeci">uint32_t get_uint32(const void *cp)</div><div class="ttdef"><b>Definition:</b> compat.c:783</div></div>
</div><!-- fragment --><p>Assert that the sentinel on a memarea is set correctly. </p>

</div>
</div>
<a id="a518cb52278b69a6502ce7ac8cf49f2cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a518cb52278b69a6502ce7ac8cf49f2cf">&#9670;&nbsp;</a></span>CHUNK_HEADER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHUNK_HEADER_SIZE&#160;&#160;&#160;<a class="el" href="util_8h.html#a34bb1d41c655823d71f9ce54196bcfd9">STRUCT_OFFSET</a>(<a class="el" href="structmemarea__chunk__t.html">memarea_chunk_t</a>, <a class="el" href="memarea_8c.html#af96d1d28bccb39de30d440280b514f1e">U_MEM</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many bytes are needed for overhead before we get to the memory part of a chunk? </p>

</div>
</div>
<a id="aea3cfda4f3a9f978ec759f206cf186fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea3cfda4f3a9f978ec759f206cf186fe">&#9670;&nbsp;</a></span>CHUNK_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHUNK_SIZE&#160;&#160;&#160;4096</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>What's the smallest that we'll allocate a chunk? </p>

</div>
</div>
<a id="a6b251b77d759455e8e05b32347119d61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b251b77d759455e8e05b32347119d61">&#9670;&nbsp;</a></span>MEMAREA_ALIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEMAREA_ALIGN&#160;&#160;&#160;SIZEOF_VOID_P</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>All returned pointers should be aligned to the nearest multiple of this value. </p>

</div>
</div>
<a id="a69f1f8604b267fe6aab1ffbdd83a0702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69f1f8604b267fe6aab1ffbdd83a0702">&#9670;&nbsp;</a></span>SENTINEL_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SENTINEL_LEN&#160;&#160;&#160;sizeof(uint32_t)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many bytes per area do we devote to the sentinel? </p>

</div>
</div>
<a id="a58c271488a8c1c693556e5667e010202"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58c271488a8c1c693556e5667e010202">&#9670;&nbsp;</a></span>SENTINEL_VAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SENTINEL_VAL&#160;&#160;&#160;0x90806622u</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Magic value that we stick at the end of a memarea so we can make sure there are no run-off-the-end bugs. </p>

</div>
</div>
<a id="a0ef78a9c6bb3beb86bc306c2d9bd2248"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ef78a9c6bb3beb86bc306c2d9bd2248">&#9670;&nbsp;</a></span>SET_SENTINEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SET_SENTINEL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">chunk</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><a class="code" href="compat_8c.html#ac4d2010c31db105982e47dc345116b5f">STMT_BEGIN                                                    \</a></div><div class="line"><a class="code" href="compat_8c.html#ac4d2010c31db105982e47dc345116b5f">  set_uint32</a>( &amp;(chunk)-&gt;<a class="code" href="memarea_8c.html#af96d1d28bccb39de30d440280b514f1e">U_MEM</a>[chunk-&gt;mem_size], <a class="code" href="memarea_8c.html#a58c271488a8c1c693556e5667e010202">SENTINEL_VAL</a> ); \</div><div class="line">  STMT_END</div><div class="ttc" id="memarea_8c_html_af96d1d28bccb39de30d440280b514f1e"><div class="ttname"><a href="memarea_8c.html#af96d1d28bccb39de30d440280b514f1e">U_MEM</a></div><div class="ttdeci">#define U_MEM</div><div class="ttdef"><b>Definition:</b> memarea.c:39</div></div>
<div class="ttc" id="compat_8c_html_ac4d2010c31db105982e47dc345116b5f"><div class="ttname"><a href="compat_8c.html#ac4d2010c31db105982e47dc345116b5f">set_uint32</a></div><div class="ttdeci">void set_uint32(void *cp, uint32_t v)</div><div class="ttdef"><b>Definition:</b> compat.c:816</div></div>
<div class="ttc" id="memarea_8c_html_a58c271488a8c1c693556e5667e010202"><div class="ttname"><a href="memarea_8c.html#a58c271488a8c1c693556e5667e010202">SENTINEL_VAL</a></div><div class="ttdeci">#define SENTINEL_VAL</div><div class="ttdef"><b>Definition:</b> memarea.c:45</div></div>
</div><!-- fragment --><p>Given a mem_area_chunk_t with SENTINEL_LEN extra bytes allocated at the end, set those bytes. </p>

</div>
</div>
<a id="af96d1d28bccb39de30d440280b514f1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af96d1d28bccb39de30d440280b514f1e">&#9670;&nbsp;</a></span>U_MEM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define U_MEM&#160;&#160;&#160;u.mem</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A value which, when masked out of a pointer, produces a maximally aligned pointer. </p>

</div>
</div>
<a id="a7a0e98816d3ad0a1cde454b2f2613726"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a0e98816d3ad0a1cde454b2f2613726">&#9670;&nbsp;</a></span>USE_SENTINELS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USE_SENTINELS</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If true, we try to detect any attempts to write beyond the length of a memarea. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="aa81b19371d17d03cba8eb22234d48300"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa81b19371d17d03cba8eb22234d48300">&#9670;&nbsp;</a></span>memarea_chunk_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmemarea__chunk__t.html">memarea_chunk_t</a>  <a class="el" href="structmemarea__chunk__t.html">memarea_chunk_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Implements part of a memarea. New memory is carved off from chunk-&gt;mem in increasing order until a request is too big, at which point a new chunk is allocated. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab03a77a8bbd935b4b33bb1016079c3a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab03a77a8bbd935b4b33bb1016079c3a3">&#9670;&nbsp;</a></span>memarea_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* memarea_alloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemarea__t.html">memarea_t</a> *&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a pointer to a chunk of memory in <b>area</b> of at least <b>sz</b> bytes. <b>sz</b> should be significantly smaller than the area's chunk size, though we can deal if it isn't. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="memarea_8c_ab03a77a8bbd935b4b33bb1016079c3a3_icgraph.png" border="0" usemap="#memarea_8c_ab03a77a8bbd935b4b33bb1016079c3a3_icgraph" alt=""/></div>
<map name="memarea_8c_ab03a77a8bbd935b4b33bb1016079c3a3_icgraph" id="memarea_8c_ab03a77a8bbd935b4b33bb1016079c3a3_icgraph">
<area shape="rect" id="node2" href="memarea_8c.html#afe8736114c98d9206a3705919a9e231b" title="memarea_alloc_zero" alt="" coords="164,5,307,32"/>
<area shape="rect" id="node3" href="memarea_8c.html#aa3b9f13ab77557473065430397a29aa6" title="memarea_memdup" alt="" coords="169,56,302,83"/>
<area shape="rect" id="node5" href="memarea_8c.html#ae2324c51c63afbce99ef1e56ee0bff87" title="memarea_strndup" alt="" coords="172,107,299,133"/>
<area shape="rect" id="node4" href="memarea_8c.html#ae6aeabfc89cb75df17df4e799fd34bf2" title="memarea_strdup" alt="" coords="355,56,473,83"/>
</map>
</div>

</div>
</div>
<a id="afe8736114c98d9206a3705919a9e231b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe8736114c98d9206a3705919a9e231b">&#9670;&nbsp;</a></span>memarea_alloc_zero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* memarea_alloc_zero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemarea__t.html">memarea_t</a> *&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As <a class="el" href="memarea_8c.html#ab03a77a8bbd935b4b33bb1016079c3a3">memarea_alloc()</a>, but clears the memory it returns. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="memarea_8c_afe8736114c98d9206a3705919a9e231b_cgraph.png" border="0" usemap="#memarea_8c_afe8736114c98d9206a3705919a9e231b_cgraph" alt=""/></div>
<map name="memarea_8c_afe8736114c98d9206a3705919a9e231b_cgraph" id="memarea_8c_afe8736114c98d9206a3705919a9e231b_cgraph">
<area shape="rect" id="node2" href="memarea_8c.html#ab03a77a8bbd935b4b33bb1016079c3a3" title="memarea_alloc" alt="" coords="196,5,307,32"/>
</map>
</div>

</div>
</div>
<a id="ac337ef9a80db4617d1792744fa7b7515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac337ef9a80db4617d1792744fa7b7515">&#9670;&nbsp;</a></span>memarea_assert_ok()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memarea_assert_ok </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemarea__t.html">memarea_t</a> *&#160;</td>
          <td class="paramname"><em>area</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assert that <b>area</b> is okay. </p>

</div>
</div>
<a id="a98079351167b7e4a7e189045d8534dc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98079351167b7e4a7e189045d8534dc8">&#9670;&nbsp;</a></span>memarea_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memarea_clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemarea__t.html">memarea_t</a> *&#160;</td>
          <td class="paramname"><em>area</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Forget about having allocated anything in <b>area</b>, and free some of the backing storage associated with it, as appropriate. Invalidates all pointers returned from <a class="el" href="memarea_8c.html#ab03a77a8bbd935b4b33bb1016079c3a3">memarea_alloc()</a> for this area. </p>

</div>
</div>
<a id="afaa462dd0af2198fd6fa88370ef5e5d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afaa462dd0af2198fd6fa88370ef5e5d6">&#9670;&nbsp;</a></span>memarea_drop_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memarea_drop_all </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemarea__t.html">memarea_t</a> *&#160;</td>
          <td class="paramname"><em>area</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free <b>area</b>, invalidating all pointers returned from <a class="el" href="memarea_8c.html#ab03a77a8bbd935b4b33bb1016079c3a3">memarea_alloc()</a> and friends for this area </p>

</div>
</div>
<a id="aa491f6c85e95c3ffe3d566adf2ca5c06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa491f6c85e95c3ffe3d566adf2ca5c06">&#9670;&nbsp;</a></span>memarea_get_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memarea_get_stats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemarea__t.html">memarea_t</a> *&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>allocated_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>used_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>allocated_out</b> to the number of bytes allocated in <b>area</b>, and <b>used_out</b> to the number of bytes currently used. </p>

</div>
</div>
<a id="aa3b9f13ab77557473065430397a29aa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3b9f13ab77557473065430397a29aa6">&#9670;&nbsp;</a></span>memarea_memdup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* memarea_memdup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemarea__t.html">memarea_t</a> *&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As memdup, but returns the memory from <b>area</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="memarea_8c_aa3b9f13ab77557473065430397a29aa6_cgraph.png" border="0" usemap="#memarea_8c_aa3b9f13ab77557473065430397a29aa6_cgraph" alt=""/></div>
<map name="memarea_8c_aa3b9f13ab77557473065430397a29aa6_cgraph" id="memarea_8c_aa3b9f13ab77557473065430397a29aa6_cgraph">
<area shape="rect" id="node2" href="memarea_8c.html#ab03a77a8bbd935b4b33bb1016079c3a3" title="memarea_alloc" alt="" coords="187,5,297,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="memarea_8c_aa3b9f13ab77557473065430397a29aa6_icgraph.png" border="0" usemap="#memarea_8c_aa3b9f13ab77557473065430397a29aa6_icgraph" alt=""/></div>
<map name="memarea_8c_aa3b9f13ab77557473065430397a29aa6_icgraph" id="memarea_8c_aa3b9f13ab77557473065430397a29aa6_icgraph">
<area shape="rect" id="node2" href="memarea_8c.html#ae6aeabfc89cb75df17df4e799fd34bf2" title="memarea_strdup" alt="" coords="187,5,305,32"/>
</map>
</div>

</div>
</div>
<a id="a9bc481c5060ff6280cfb1e5eaaa915f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bc481c5060ff6280cfb1e5eaaa915f4">&#9670;&nbsp;</a></span>memarea_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmemarea__t.html">memarea_t</a>* memarea_new </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and return new memarea. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="memarea_8c_a9bc481c5060ff6280cfb1e5eaaa915f4_icgraph.png" border="0" usemap="#memarea_8c_a9bc481c5060ff6280cfb1e5eaaa915f4_icgraph" alt=""/></div>
<map name="memarea_8c_a9bc481c5060ff6280cfb1e5eaaa915f4_icgraph" id="memarea_8c_a9bc481c5060ff6280cfb1e5eaaa915f4_icgraph">
<area shape="rect" id="node2" href="routerparse_8h.html#a6ed67129e89fe64d2f329a1e94063f48" title="router_parse_entry\l_from_string" alt="" coords="174,5,305,47"/>
<area shape="rect" id="node4" href="routerparse_8h.html#af9f19ced712ed538c086276fa472851d" title="rend_parse_client_keys" alt="" coords="160,71,319,98"/>
<area shape="rect" id="node3" href="routerlist_8h.html#a7b194ad6a42e8fb2ef4f3aa1cf135830" title="router_load_single\l_router" alt="" coords="367,5,493,47"/>
</map>
</div>

</div>
</div>
<a id="a8ab8e82f0c894120c51349c4e5059365"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ab8e82f0c894120c51349c4e5059365">&#9670;&nbsp;</a></span>memarea_owns_ptr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int memarea_owns_ptr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmemarea__t.html">memarea_t</a> *&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff <b>p</b> is in a range that has been returned by an allocation from <b>area</b>. </p>

</div>
</div>
<a id="ae6aeabfc89cb75df17df4e799fd34bf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6aeabfc89cb75df17df4e799fd34bf2">&#9670;&nbsp;</a></span>memarea_strdup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* memarea_strdup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemarea__t.html">memarea_t</a> *&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As strdup, but returns the memory from <b>area</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="memarea_8c_ae6aeabfc89cb75df17df4e799fd34bf2_cgraph.png" border="0" usemap="#memarea_8c_ae6aeabfc89cb75df17df4e799fd34bf2_cgraph" alt=""/></div>
<map name="memarea_8c_ae6aeabfc89cb75df17df4e799fd34bf2_cgraph" id="memarea_8c_ae6aeabfc89cb75df17df4e799fd34bf2_cgraph">
<area shape="rect" id="node2" href="memarea_8c.html#aa3b9f13ab77557473065430397a29aa6" title="memarea_memdup" alt="" coords="172,5,305,32"/>
<area shape="rect" id="node3" href="memarea_8c.html#ab03a77a8bbd935b4b33bb1016079c3a3" title="memarea_alloc" alt="" coords="353,5,464,32"/>
</map>
</div>

</div>
</div>
<a id="ae2324c51c63afbce99ef1e56ee0bff87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2324c51c63afbce99ef1e56ee0bff87">&#9670;&nbsp;</a></span>memarea_strndup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* memarea_strndup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemarea__t.html">memarea_t</a> *&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As strndup, but returns the memory from <b>area</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="memarea_8c_ae2324c51c63afbce99ef1e56ee0bff87_cgraph.png" border="0" usemap="#memarea_8c_ae2324c51c63afbce99ef1e56ee0bff87_cgraph" alt=""/></div>
<map name="memarea_8c_ae2324c51c63afbce99ef1e56ee0bff87_cgraph" id="memarea_8c_ae2324c51c63afbce99ef1e56ee0bff87_cgraph">
<area shape="rect" id="node2" href="memarea_8c.html#ab03a77a8bbd935b4b33bb1016079c3a3" title="memarea_alloc" alt="" coords="180,5,291,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
