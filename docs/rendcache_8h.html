<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/rendcache.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">rendcache.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="rendcache_8c.html" title="Hidden service descriptor cache. ">rendcache.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendcommon_8h_source.html">rendcommon.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for rendcache.h:</div>
<div class="dyncontent">
<div class="center"><img src="rendcache_8h__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2rendcache_8h" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2rendcache_8h" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2rendcache_8h">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="1810,109,1854,136"/>
<area shape="rect" id="node41" href="rendcommon_8h.html" title="Header file for rendcommon.c. " alt="" coords="1878,109,1986,136"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="1097,931,1175,957"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="455,856,518,883"/>
<area shape="rect" id="node6" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="477,259,547,285"/>
<area shape="rect" id="node20" href="container_8h_source.html" title="container.h" alt="" coords="1918,483,2005,509"/>
<area shape="rect" id="node22" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1422,483,1487,509"/>
<area shape="rect" id="node23" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1205,184,1318,211"/>
<area shape="rect" id="node24" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="1149,259,1275,285"/>
<area shape="rect" id="node25" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="990,333,1133,360"/>
<area shape="rect" id="node28" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="1667,259,1730,285"/>
<area shape="rect" id="node31" href="compress_8h.html" title="Headers for compress.c. " alt="" coords="1787,184,1877,211"/>
<area shape="rect" id="node32" href="address_8h.html" title="Headers for address.h. " alt="" coords="1918,408,1997,435"/>
<area shape="rect" id="node33" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="2080,781,2208,808"/>
<area shape="rect" id="node34" href="ht_8h_source.html" title="ht.h" alt="" coords="2003,184,2047,211"/>
<area shape="rect" id="node35" href="confline_8h_source.html" title="confline.h" alt="" coords="1969,259,2047,285"/>
<area shape="rect" id="node36" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="2123,184,2226,211"/>
<area shape="rect" id="node37" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="2251,184,2341,211"/>
<area shape="rect" id="node38" href="token__bucket_8h_source.html" title="token_bucket.h" alt="" coords="558,781,669,808"/>
<area shape="rect" id="node39" href="util__format_8h_source.html" title="util_format.h" alt="" coords="439,781,534,808"/>
<area shape="rect" id="node40" href="hs__circuitmap_8h.html" title="Header file for hs_circuitmap.c. " alt="" coords="2467,184,2581,211"/>
<area shape="rect" id="node8" href="compat_8h_source.html" title="compat.h" alt="" coords="1205,707,1281,733"/>
<area shape="rect" id="node14" href="util_8h.html" title="Headers for util.c. " alt="" coords="1121,557,1172,584"/>
<area shape="rect" id="node18" href="crypto__rsa_8h.html" title="Headers for crypto_rsa.c. " alt="" coords="663,333,758,360"/>
<area shape="rect" id="node9" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="1628,856,1727,883"/>
<area shape="rect" id="node11" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="1129,856,1237,883"/>
<area shape="rect" id="node13" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="1179,781,1306,808"/>
<area shape="rect" id="node15" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="881,781,951,808"/>
<area shape="rect" id="node17" href="util__bug_8h.html" title="Macros to manage assertions, fatal and non&#45;fatal. " alt="" coords="1107,632,1186,659"/>
<area shape="rect" id="node19" href="crypto__digest_8h.html" title="Headers for crypto_digest.c. " alt="" coords="702,408,813,435"/>
<area shape="rect" id="node21" href="siphash_8h_source.html" title="siphash.h" alt="" coords="1922,557,2001,584"/>
<area shape="rect" id="node26" href="crypto__openssl__mgt_8h_source.html" title="crypto_openssl_mgt.h" alt="" coords="1177,408,1327,435"/>
<area shape="rect" id="node29" href="compat__openssl_8h.html" title="compatibility definitions for working with different openssl forks " alt="" coords="1508,333,1636,360"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="rendcache_8h__dep__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2rendcache_8hdep" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2rendcache_8hdep" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2rendcache_8hdep">
<area shape="rect" id="node2" href="rendclient_8h.html" title="Header file for rendclient.c. " alt="" coords="1061,109,1209,165"/>
<area shape="rect" id="node16" href="hs__cache_8c.html" title="Handle hidden service descriptor caches. " alt="" coords="1233,109,1381,165"/>
<area shape="rect" id="node17" href="hs__descriptor_8c.html" title="Handle hidden service descriptor encoding/decoding. " alt="" coords="1406,109,1558,165"/>
<area shape="rect" id="node18" href="relay_8c.html" title="Handle relay cell encryption/decryption, plus packaging and receiving from circuits, plus queuing on circuits. " alt="" coords="1583,109,1731,165"/>
<area shape="rect" id="node19" href="rendcache_8c.html" title="Hidden service descriptor cache. " alt="" coords="1755,109,1903,165"/>
<area shape="rect" id="node20" href="test__hs__cache_8c.html" title="Test hidden service caches. " alt="" coords="1927,109,2098,165"/>
<area shape="rect" id="node3" href="circuitlist_8c.html" title="Manage global structures that list and index circuits, and look up circuits within them..." alt="" coords="5,213,153,269"/>
<area shape="rect" id="node4" href="circuitstats_8c.html" title="Maintains and analyzes statistics about circuit built times, so we can tell how long we may need to w..." alt="" coords="177,213,325,269"/>
<area shape="rect" id="node5" href="circuituse_8c.html" title="Launch the right sort of circuits and attach the right streams to them. " alt="" coords="349,213,497,269"/>
<area shape="rect" id="node6" href="config_8c.html" title="Code to interpret the user&#39;s configuration of Tor. " alt="" coords="521,213,669,269"/>
<area shape="rect" id="node7" href="connection_8c.html" title="General high&#45;level functions to handle reading and writing on connections. " alt="" coords="693,213,841,269"/>
<area shape="rect" id="node8" href="connection__edge_8c.html" title="Handle edge streams. " alt="" coords="865,213,1037,269"/>
<area shape="rect" id="node9" href="control_8c.html" title="Implementation for Tor&#39;s control&#45;socket interface. " alt="" coords="1061,213,1209,269"/>
<area shape="rect" id="node10" href="directory_8c.html" title="Code to send and fetch information from directory authorities and caches via HTTP. " alt="" coords="1233,213,1381,269"/>
<area shape="rect" id="node11" href="hs__client_8c.html" title="Implement next generation hidden service client functionality. " alt="" coords="1405,213,1553,269"/>
<area shape="rect" id="node12" href="main_8c.html" title="Toplevel module. Handles signals, multiplexes between connections, implements main loop..." alt="" coords="1577,213,1725,269"/>
<area shape="rect" id="node13" href="rendclient_8c.html" title="Client code to access location&#45;hidden services. " alt="" coords="1749,213,1897,269"/>
<area shape="rect" id="node14" href="rendcommon_8c.html" title="Rendezvous implementation: shared code between introducers, services, clients, and rendezvous points..." alt="" coords="1922,213,2071,269"/>
<area shape="rect" id="node15" href="rendservice_8c.html" title="The hidden&#45;service side of rendezvous functionality. " alt="" coords="2096,213,2244,269"/>
</map>
</div>
</div>
<p><a href="rendcache_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrend__cache__entry__t.html">rend_cache_entry_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrend__cache__failure__intro__t.html">rend_cache_failure_intro_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrend__cache__failure__t.html">rend_cache_failure_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a9923dc98088a6370c8854337489531a6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#a9923dc98088a6370c8854337489531a6">REND_CACHE_MAX_AGE</a>&#160;&#160;&#160;(2*24*60*60)</td></tr>
<tr class="separator:a9923dc98088a6370c8854337489531a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8da4799a883657b08813f4b6bd061919"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#a8da4799a883657b08813f4b6bd061919">REND_CACHE_MAX_SKEW</a>&#160;&#160;&#160;(24*60*60)</td></tr>
<tr class="separator:a8da4799a883657b08813f4b6bd061919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1d7743b145d1737199c27ee7194f3ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#ab1d7743b145d1737199c27ee7194f3ce">REND_CACHE_FAILURE_MAX_AGE</a>&#160;&#160;&#160;(5*60)</td></tr>
<tr class="separator:ab1d7743b145d1737199c27ee7194f3ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b208821469f3eb9c8b5daed2cdb1511"><td class="memItemLeft" align="right" valign="top"><a id="a4b208821469f3eb9c8b5daed2cdb1511"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_INTRO_POINTS</b>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a4b208821469f3eb9c8b5daed2cdb1511"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:afa23073d4131b01677f2c8ce6f3193fc"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structrend__cache__entry__t.html">rend_cache_entry_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#afa23073d4131b01677f2c8ce6f3193fc">rend_cache_entry_t</a></td></tr>
<tr class="separator:afa23073d4131b01677f2c8ce6f3193fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabfc41d2d9d63e143744027571c6126c"><td class="memItemLeft" align="right" valign="top"><a id="aabfc41d2d9d63e143744027571c6126c"></a>
typedef struct <a class="el" href="structrend__cache__failure__intro__t.html">rend_cache_failure_intro_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>rend_cache_failure_intro_t</b></td></tr>
<tr class="separator:aabfc41d2d9d63e143744027571c6126c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15b4712c28ecb623624d76f2653d8c7f"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structrend__cache__failure__t.html">rend_cache_failure_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#a15b4712c28ecb623624d76f2653d8c7f">rend_cache_failure_t</a></td></tr>
<tr class="separator:a15b4712c28ecb623624d76f2653d8c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a00ad18abf5a53723422ac15a9eedadc4"><td class="memItemLeft" align="right" valign="top"><a id="a00ad18abf5a53723422ac15a9eedadc4"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>rend_cache_type_t</b> { <b>REND_CACHE_TYPE_CLIENT</b> = 1, 
<b>REND_CACHE_TYPE_SERVICE</b> = 2
 }</td></tr>
<tr class="separator:a00ad18abf5a53723422ac15a9eedadc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a236399736fb575ecb707c4eee2b50494"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#a236399736fb575ecb707c4eee2b50494">rend_cache_init</a> (void)</td></tr>
<tr class="separator:a236399736fb575ecb707c4eee2b50494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62c6247e46d1998faf442813a557e0ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#a62c6247e46d1998faf442813a557e0ad">rend_cache_clean</a> (time_t now, rend_cache_type_t cache_type)</td></tr>
<tr class="separator:a62c6247e46d1998faf442813a557e0ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab95357bc318649e8bbce982ecbae0d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#aab95357bc318649e8bbce982ecbae0d6">rend_cache_failure_clean</a> (time_t now)</td></tr>
<tr class="separator:aab95357bc318649e8bbce982ecbae0d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb504774c39f386719c13cef6854f693"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#aeb504774c39f386719c13cef6854f693">rend_cache_clean_v2_descs_as_dir</a> (time_t cutoff)</td></tr>
<tr class="separator:aeb504774c39f386719c13cef6854f693"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd82dd000c55587eedbd5478cacda170"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#abd82dd000c55587eedbd5478cacda170">rend_cache_purge</a> (void)</td></tr>
<tr class="separator:abd82dd000c55587eedbd5478cacda170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31148f91462749991e9b7d974104e419"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#a31148f91462749991e9b7d974104e419">rend_cache_free_all</a> (void)</td></tr>
<tr class="separator:a31148f91462749991e9b7d974104e419"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9955a4d0f958b0bd0222b5d2c278015"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#ad9955a4d0f958b0bd0222b5d2c278015">rend_cache_lookup_entry</a> (const char *query, int version, <a class="el" href="structrend__cache__entry__t.html">rend_cache_entry_t</a> **entry_out)</td></tr>
<tr class="separator:ad9955a4d0f958b0bd0222b5d2c278015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c3dd32aa94330b39d0e31be69e494ff"><td class="memItemLeft" align="right" valign="top"><a id="a3c3dd32aa94330b39d0e31be69e494ff"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>rend_cache_lookup_v2_desc_as_service</b> (const char *query, <a class="el" href="structrend__cache__entry__t.html">rend_cache_entry_t</a> **entry_out)</td></tr>
<tr class="separator:a3c3dd32aa94330b39d0e31be69e494ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a255ad3d6c91217591a4864830bed5ca7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#a255ad3d6c91217591a4864830bed5ca7">rend_cache_lookup_v2_desc_as_dir</a> (const char *query, const char **desc)</td></tr>
<tr class="separator:a255ad3d6c91217591a4864830bed5ca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0029729f71187fd666fb549197645b7e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#a0029729f71187fd666fb549197645b7e">rend_cache_store_v2_desc_as_dir</a> (const char *desc)</td></tr>
<tr class="separator:a0029729f71187fd666fb549197645b7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a145529a71771c651bac51954ce10838e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#a145529a71771c651bac51954ce10838e">rend_cache_store_v2_desc_as_service</a> (const char *desc)</td></tr>
<tr class="separator:a145529a71771c651bac51954ce10838e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab763fe08f2a77e28d7aef75d9ccfad4a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#ab763fe08f2a77e28d7aef75d9ccfad4a">rend_cache_store_v2_desc_as_client</a> (const char *desc, const char *desc_id_base32, const <a class="el" href="structrend__data__t.html">rend_data_t</a> *rend_query, <a class="el" href="structrend__cache__entry__t.html">rend_cache_entry_t</a> **entry)</td></tr>
<tr class="separator:ab763fe08f2a77e28d7aef75d9ccfad4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16b71a6e83a85e91212db67293fcb52c"><td class="memItemLeft" align="right" valign="top"><a id="a16b71a6e83a85e91212db67293fcb52c"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>rend_cache_get_total_allocation</b> (void)</td></tr>
<tr class="separator:a16b71a6e83a85e91212db67293fcb52c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa76d05e39fd88a59ab53062cc57d2625"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#aa76d05e39fd88a59ab53062cc57d2625">rend_cache_intro_failure_note</a> (rend_intro_point_failure_t failure, const uint8_t *identity, const char *service_id)</td></tr>
<tr class="separator:aa76d05e39fd88a59ab53062cc57d2625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a0248d1f15bccd9f6c36aa0d52969ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#a2a0248d1f15bccd9f6c36aa0d52969ec">rend_cache_failure_purge</a> (void)</td></tr>
<tr class="separator:a2a0248d1f15bccd9f6c36aa0d52969ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4539ad1623f8861e4efe051f13c9fcb9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#a4539ad1623f8861e4efe051f13c9fcb9">rend_cache_decrement_allocation</a> (size_t n)</td></tr>
<tr class="separator:a4539ad1623f8861e4efe051f13c9fcb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3f8d9164ca6c57d8844f2776aaed294"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendcache_8h.html#aa3f8d9164ca6c57d8844f2776aaed294">rend_cache_increment_allocation</a> (size_t n)</td></tr>
<tr class="separator:aa3f8d9164ca6c57d8844f2776aaed294"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="rendcache_8c.html" title="Hidden service descriptor cache. ">rendcache.c</a>. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ab1d7743b145d1737199c27ee7194f3ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1d7743b145d1737199c27ee7194f3ce">&#9670;&nbsp;</a></span>REND_CACHE_FAILURE_MAX_AGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REND_CACHE_FAILURE_MAX_AGE&#160;&#160;&#160;(5*60)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How old do we keep an intro point failure entry in the failure cache? </p>

</div>
</div>
<a id="a9923dc98088a6370c8854337489531a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9923dc98088a6370c8854337489531a6">&#9670;&nbsp;</a></span>REND_CACHE_MAX_AGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REND_CACHE_MAX_AGE&#160;&#160;&#160;(2*24*60*60)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How old do we let hidden service descriptors get before discarding them as too old? </p>

</div>
</div>
<a id="a8da4799a883657b08813f4b6bd061919"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8da4799a883657b08813f4b6bd061919">&#9670;&nbsp;</a></span>REND_CACHE_MAX_SKEW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REND_CACHE_MAX_SKEW&#160;&#160;&#160;(24*60*60)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How wrong do we assume our clock may be when checking whether hidden services are too old or too new? </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="afa23073d4131b01677f2c8ce6f3193fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa23073d4131b01677f2c8ce6f3193fc">&#9670;&nbsp;</a></span>rend_cache_entry_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structrend__cache__entry__t.html">rend_cache_entry_t</a>  <a class="el" href="structrend__cache__entry__t.html">rend_cache_entry_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A cached rendezvous descriptor. </p>

</div>
</div>
<a id="a15b4712c28ecb623624d76f2653d8c7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15b4712c28ecb623624d76f2653d8c7f">&#9670;&nbsp;</a></span>rend_cache_failure_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structrend__cache__failure__t.html">rend_cache_failure_t</a>  <a class="el" href="structrend__cache__failure__t.html">rend_cache_failure_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cache failure object indexed by service ID. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a62c6247e46d1998faf442813a557e0ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62c6247e46d1998faf442813a557e0ad">&#9670;&nbsp;</a></span>rend_cache_clean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_cache_clean </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rend_cache_type_t&#160;</td>
          <td class="paramname"><em>cache_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes all old entries from the client or service descriptor cache. </p>

</div>
</div>
<a id="aeb504774c39f386719c13cef6854f693"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb504774c39f386719c13cef6854f693">&#9670;&nbsp;</a></span>rend_cache_clean_v2_descs_as_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t rend_cache_clean_v2_descs_as_dir </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>cutoff</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove all old v2 descriptors and those for which this hidden service directory is not responsible for any more. The cutoff is the time limit for which we want to keep the cache entry. In other words, any entry created before will be removed. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendcache_8h_aeb504774c39f386719c13cef6854f693_cgraph.png" border="0" usemap="#rendcache_8h_aeb504774c39f386719c13cef6854f693_cgraph" alt=""/></div>
<map name="rendcache_8h_aeb504774c39f386719c13cef6854f693_cgraph" id="rendcache_8h_aeb504774c39f386719c13cef6854f693_cgraph">
<area shape="rect" id="node2" href="util__format_8c.html#af100283587ab62e6645c900859f95c8e" title="base32_encode" alt="" coords="201,13,315,39"/>
</map>
</div>

</div>
</div>
<a id="a4539ad1623f8861e4efe051f13c9fcb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4539ad1623f8861e4efe051f13c9fcb9">&#9670;&nbsp;</a></span>rend_cache_decrement_allocation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_cache_decrement_allocation </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrement the total bytes attributed to the rendezvous cache by n. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendcache_8h_a4539ad1623f8861e4efe051f13c9fcb9_icgraph.png" border="0" usemap="#rendcache_8h_a4539ad1623f8861e4efe051f13c9fcb9_icgraph" alt=""/></div>
<map name="rendcache_8h_a4539ad1623f8861e4efe051f13c9fcb9_icgraph" id="rendcache_8h_a4539ad1623f8861e4efe051f13c9fcb9_icgraph">
<area shape="rect" id="node2" href="rendcache_8c.html#a9c71adefc4d624d1be3abf7d25dedd1d" title="rend_cache_entry_free_" alt="" coords="211,13,372,39"/>
</map>
</div>

</div>
</div>
<a id="aab95357bc318649e8bbce982ecbae0d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab95357bc318649e8bbce982ecbae0d6">&#9670;&nbsp;</a></span>rend_cache_failure_clean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_cache_failure_clean </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove all entries that re REND_CACHE_FAILURE_MAX_AGE old. This is called every second.</p>
<p>We have to clean these regurlarly else if for whatever reasons an hidden service goes offline and a client tries to connect to it during that time, a failure entry is created and the client will be unable to connect for a while even though the service has return online. </p>

</div>
</div>
<a id="a2a0248d1f15bccd9f6c36aa0d52969ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a0248d1f15bccd9f6c36aa0d52969ec">&#9670;&nbsp;</a></span>rend_cache_failure_purge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_cache_failure_purge </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove ALL entries from the failure cache. This is also called when a NEWNYM signal is received. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendcache_8h_a2a0248d1f15bccd9f6c36aa0d52969ec_icgraph.png" border="0" usemap="#rendcache_8h_a2a0248d1f15bccd9f6c36aa0d52969ec_icgraph" alt=""/></div>
<map name="rendcache_8h_a2a0248d1f15bccd9f6c36aa0d52969ec_icgraph" id="rendcache_8h_a2a0248d1f15bccd9f6c36aa0d52969ec_icgraph">
<area shape="rect" id="node2" href="rendclient_8h.html#af25d45137e5e3a3834edf201d47ea5ca" title="rend_client_purge_state" alt="" coords="184,13,344,39"/>
</map>
</div>

</div>
</div>
<a id="a31148f91462749991e9b7d974104e419"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31148f91462749991e9b7d974104e419">&#9670;&nbsp;</a></span>rend_cache_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_cache_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all storage held by the service descriptor cache. </p>

</div>
</div>
<a id="aa3f8d9164ca6c57d8844f2776aaed294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3f8d9164ca6c57d8844f2776aaed294">&#9670;&nbsp;</a></span>rend_cache_increment_allocation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_cache_increment_allocation </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Increase the total bytes attributed to the rendezvous cache by n. </p>

</div>
</div>
<a id="a236399736fb575ecb707c4eee2b50494"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a236399736fb575ecb707c4eee2b50494">&#9670;&nbsp;</a></span>rend_cache_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_cache_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the service descriptor cache. </p>

</div>
</div>
<a id="aa76d05e39fd88a59ab53062cc57d2625"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa76d05e39fd88a59ab53062cc57d2625">&#9670;&nbsp;</a></span>rend_cache_intro_failure_note()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_cache_intro_failure_note </td>
          <td>(</td>
          <td class="paramtype">rend_intro_point_failure_t&#160;</td>
          <td class="paramname"><em>failure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>identity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>service_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Note down an intro failure in the rend failure cache using the type of failure in <b>failure</b> for the relay identity digest in <b>identity</b> and service ID <b>service_id</b>. If an entry already exists in the cache, the failure type is changed with <b>failure</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendcache_8h_aa76d05e39fd88a59ab53062cc57d2625_cgraph.png" border="0" usemap="#rendcache_8h_aa76d05e39fd88a59ab53062cc57d2625_cgraph" alt=""/></div>
<map name="rendcache_8h_aa76d05e39fd88a59ab53062cc57d2625_cgraph" id="rendcache_8h_aa76d05e39fd88a59ab53062cc57d2625_cgraph">
<area shape="rect" id="node2" href="rendcache_8c.html#aa5d4ae0f3f0e44df2209977d622b6a5c" title="cache_failure_intro\l_lookup" alt="" coords="262,5,393,47"/>
<area shape="rect" id="node4" href="rendcache_8c.html#a29c3a627ad5064fa0df4d8ab96bad375" title="cache_failure_intro_add" alt="" coords="248,71,407,98"/>
<area shape="rect" id="node3" href="container_8c.html#a1406b823cb6088df755f1b81153d137e" title="strmap_get_lc" alt="" coords="468,13,572,39"/>
<area shape="rect" id="node5" href="rendcache_8c.html#a1129f843dc29e4d747bc378da1395d15" title="rend_cache_failure\l_entry_new" alt="" coords="455,64,585,105"/>
<area shape="rect" id="node6" href="container_8c.html#ab89b18ed07c18bdf4cb8d84bcc38f667" title="strmap_set_lc" alt="" coords="468,130,572,157"/>
<area shape="rect" id="node7" href="rendcache_8c.html#a4fcb974f5d0de00e8611297aa43a2979" title="rend_cache_failure\l_intro_entry_new" alt="" coords="455,181,585,223"/>
</map>
</div>

</div>
</div>
<a id="ad9955a4d0f958b0bd0222b5d2c278015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9955a4d0f958b0bd0222b5d2c278015">&#9670;&nbsp;</a></span>rend_cache_lookup_entry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_cache_lookup_entry </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrend__cache__entry__t.html">rend_cache_entry_t</a> **&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lookup in the client cache the given service ID <b>query</b> for <b>version</b>.</p>
<p>Return 0 if found and if <b>e</b> is non NULL, set it with the entry found. Else, a negative value is returned and <b>e</b> is untouched. -EINVAL means that <b>query</b> is not a valid service id. -ENOENT means that no entry in the cache was found. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendcache_8h_ad9955a4d0f958b0bd0222b5d2c278015_cgraph.png" border="0" usemap="#rendcache_8h_ad9955a4d0f958b0bd0222b5d2c278015_cgraph" alt=""/></div>
<map name="rendcache_8h_ad9955a4d0f958b0bd0222b5d2c278015_cgraph" id="rendcache_8h_ad9955a4d0f958b0bd0222b5d2c278015_cgraph">
<area shape="rect" id="node2" href="rendcommon_8c.html#a07d97b83844365f0949fd9998269a5a9" title="rend_valid_v2_service_id" alt="" coords="224,5,392,32"/>
</map>
</div>

</div>
</div>
<a id="a255ad3d6c91217591a4864830bed5ca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a255ad3d6c91217591a4864830bed5ca7">&#9670;&nbsp;</a></span>rend_cache_lookup_v2_desc_as_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_cache_lookup_v2_desc_as_dir </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>desc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lookup the v2 service descriptor with base32-encoded <b>desc_id</b> and copy the pointer to it to *<b>desc</b>. Return 1 on success, 0 on well-formed-but-not-found, and -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendcache_8h_a255ad3d6c91217591a4864830bed5ca7_cgraph.png" border="0" usemap="#rendcache_8h_a255ad3d6c91217591a4864830bed5ca7_cgraph" alt=""/></div>
<map name="rendcache_8h_a255ad3d6c91217591a4864830bed5ca7_cgraph" id="rendcache_8h_a255ad3d6c91217591a4864830bed5ca7_cgraph">
<area shape="rect" id="node2" href="util__format_8c.html#a0db7bf387411ab548b7eaad28e6d7b28" title="base32_decode" alt="" coords="208,13,321,39"/>
</map>
</div>

</div>
</div>
<a id="abd82dd000c55587eedbd5478cacda170"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd82dd000c55587eedbd5478cacda170">&#9670;&nbsp;</a></span>rend_cache_purge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_cache_purge </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove ALL entries from the rendezvous service descriptor cache. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendcache_8h_abd82dd000c55587eedbd5478cacda170_icgraph.png" border="0" usemap="#rendcache_8h_abd82dd000c55587eedbd5478cacda170_icgraph" alt=""/></div>
<map name="rendcache_8h_abd82dd000c55587eedbd5478cacda170_icgraph" id="rendcache_8h_abd82dd000c55587eedbd5478cacda170_icgraph">
<area shape="rect" id="node2" href="rendclient_8h.html#af25d45137e5e3a3834edf201d47ea5ca" title="rend_client_purge_state" alt="" coords="181,5,341,32"/>
</map>
</div>

</div>
</div>
<a id="ab763fe08f2a77e28d7aef75d9ccfad4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab763fe08f2a77e28d7aef75d9ccfad4a">&#9670;&nbsp;</a></span>rend_cache_store_v2_desc_as_client()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_cache_store_v2_desc_as_client </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc_id_base32</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structrend__data__t.html">rend_data_t</a> *&#160;</td>
          <td class="paramname"><em>rend_query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrend__cache__entry__t.html">rend_cache_entry_t</a> **&#160;</td>
          <td class="paramname"><em>entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the v2 service descriptor in <b>desc</b>, decrypt the included list of introduction points with <b>descriptor_cookie</b> (which may also be <b>NULL</b> if decryption is not necessary), and store the descriptor to the local cache under its version and service id.</p>
<p>If we have a newer v2 descriptor with the same ID, ignore this one. If we have an older descriptor with the same ID, replace it. If the descriptor's service ID does not match <b>rend_query</b>-&gt;onion_address, reject it.</p>
<p>If the descriptor's descriptor ID doesn't match <b>desc_id_base32</b>, reject it.</p>
<p>Return 0 on success, or -1 if we rejected the descriptor. If entry is not NULL, set it with the cache entry pointer of the descriptor. </p>

</div>
</div>
<a id="a0029729f71187fd666fb549197645b7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0029729f71187fd666fb549197645b7e">&#9670;&nbsp;</a></span>rend_cache_store_v2_desc_as_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_cache_store_v2_desc_as_dir </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the v2 service descriptor(s) in <b>desc</b> and store it/them to the local rend cache. Don't attempt to decrypt the included list of introduction points (as we don't have a descriptor cookie for it).</p>
<p>If we have a newer descriptor with the same ID, ignore this one. If we have an older descriptor with the same ID, replace it.</p>
<p>Return 0 on success, or -1 if we couldn't parse any of them.</p>
<p>We should only call this function for public (e.g. non bridge) relays. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendcache_8h_a0029729f71187fd666fb549197645b7e_cgraph.png" border="0" usemap="#rendcache_8h_a0029729f71187fd666fb549197645b7e_cgraph" alt=""/></div>
<map name="rendcache_8h_a0029729f71187fd666fb549197645b7e_cgraph" id="rendcache_8h_a0029729f71187fd666fb549197645b7e_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#a2faba4db0eeeb6f97d9ba56983390b37" title="rend_parse_v2_service\l_descriptor" alt="" coords="200,5,356,47"/>
<area shape="rect" id="node3" href="util__format_8c.html#af100283587ab62e6645c900859f95c8e" title="base32_encode" alt="" coords="221,71,335,98"/>
</map>
</div>

</div>
</div>
<a id="a145529a71771c651bac51954ce10838e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a145529a71771c651bac51954ce10838e">&#9670;&nbsp;</a></span>rend_cache_store_v2_desc_as_service()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_cache_store_v2_desc_as_service </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the v2 service descriptor in <b>desc</b> and store it to the local service rend cache. Don't attempt to decrypt the included list of introduction points.</p>
<p>If we have a newer descriptor with the same ID, ignore this one. If we have an older descriptor with the same ID, replace it.</p>
<p>Return 0 on success, or -1 if we couldn't understand the descriptor. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
