<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/voting_schedule.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">voting_schedule.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains functions that are from the directory authority subsystem related to voting specifically but used by many part of tor. The full feature is built as part of the dirauth module.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="voting__schedule_8h_source.html">voting_schedule.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="networkstatus_8h_source.html">networkstatus.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for voting_schedule.c:</div>
<div class="dyncontent">
<div class="center"><img src="voting__schedule_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2voting__schedule_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2voting__schedule_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2voting__schedule_8c">
<area shape="rect" id="node2" href="voting__schedule_8h.html" title="Header file for voting_schedule.c. " alt="" coords="1898,109,2025,136"/>
<area shape="rect" id="node3" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="1290,184,1334,211"/>
<area shape="rect" id="node42" href="config_8h.html" title="Header file for config.c. " alt="" coords="2189,184,2257,211"/>
<area shape="rect" id="node43" href="networkstatus_8h.html" title="Header file for networkstatus.c. " alt="" coords="2331,781,2445,808"/>
<area shape="rect" id="node4" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="439,1005,518,1032"/>
<area shape="rect" id="node5" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="1298,931,1361,957"/>
<area shape="rect" id="node7" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="373,333,443,360"/>
<area shape="rect" id="node21" href="container_8h_source.html" title="container.h" alt="" coords="651,557,738,584"/>
<area shape="rect" id="node23" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1430,557,1495,584"/>
<area shape="rect" id="node24" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1255,259,1369,285"/>
<area shape="rect" id="node25" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="1575,333,1700,360"/>
<area shape="rect" id="node26" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="1486,408,1629,435"/>
<area shape="rect" id="node29" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="1025,333,1087,360"/>
<area shape="rect" id="node32" href="compress_8h.html" title="Headers for compress.c. " alt="" coords="1393,259,1484,285"/>
<area shape="rect" id="node33" href="address_8h.html" title="Headers for address.h. " alt="" coords="497,483,575,509"/>
<area shape="rect" id="node34" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="144,856,272,883"/>
<area shape="rect" id="node35" href="ht_8h_source.html" title="ht.h" alt="" coords="1509,259,1553,285"/>
<area shape="rect" id="node36" href="confline_8h_source.html" title="confline.h" alt="" coords="775,333,854,360"/>
<area shape="rect" id="node37" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="1577,259,1679,285"/>
<area shape="rect" id="node38" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="1704,259,1795,285"/>
<area shape="rect" id="node39" href="token__bucket_8h_source.html" title="token_bucket.h" alt="" coords="1671,856,1782,883"/>
<area shape="rect" id="node40" href="util__format_8h_source.html" title="util_format.h" alt="" coords="1806,856,1901,883"/>
<area shape="rect" id="node41" href="hs__circuitmap_8h.html" title="Header file for hs_circuitmap.c. " alt="" coords="1819,259,1933,285"/>
<area shape="rect" id="node9" href="compat_8h_source.html" title="compat.h" alt="" coords="919,781,995,808"/>
<area shape="rect" id="node15" href="util_8h.html" title="Headers for util.c. " alt="" coords="876,632,927,659"/>
<area shape="rect" id="node19" href="crypto__rsa_8h.html" title="Headers for crypto_rsa.c. " alt="" coords="879,408,974,435"/>
<area shape="rect" id="node10" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="1940,931,2039,957"/>
<area shape="rect" id="node12" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="782,931,890,957"/>
<area shape="rect" id="node14" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="1013,856,1139,883"/>
<area shape="rect" id="node16" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="635,856,706,883"/>
<area shape="rect" id="node18" href="util__bug_8h.html" title="Macros to manage assertions, fatal and non&#45;fatal. " alt="" coords="942,707,1021,733"/>
<area shape="rect" id="node20" href="crypto__digest_8h.html" title="Headers for crypto_digest.c. " alt="" coords="753,483,863,509"/>
<area shape="rect" id="node22" href="siphash_8h_source.html" title="siphash.h" alt="" coords="655,632,734,659"/>
<area shape="rect" id="node27" href="crypto__openssl__mgt_8h_source.html" title="crypto_openssl_mgt.h" alt="" coords="1199,483,1350,509"/>
<area shape="rect" id="node30" href="compat__openssl_8h.html" title="compatibility definitions for working with different openssl forks " alt="" coords="1044,408,1172,435"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a34f668fef1debb19ad937b788fa7104c"><td class="memItemLeft" align="right" valign="top"><a id="a34f668fef1debb19ad937b788fa7104c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>VOTING_SCHEDULE_PRIVATE</b></td></tr>
<tr class="separator:a34f668fef1debb19ad937b788fa7104c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5644a3305e8eac71f6e29f874fe626db"><td class="memItemLeft" align="right" valign="top"><a id="a5644a3305e8eac71f6e29f874fe626db"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>voting_schedule_free</b>(s)&#160;&#160;&#160;FREE_AND_NULL(<a class="el" href="structvoting__schedule__t.html">voting_schedule_t</a>, voting_schedule_free_, (s))</td></tr>
<tr class="separator:a5644a3305e8eac71f6e29f874fe626db"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a19239aba163189612262ba8c314d2a1c"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="voting__schedule_8c.html#a19239aba163189612262ba8c314d2a1c">voting_schedule_get_start_of_next_interval</a> (time_t now, int interval, int offset)</td></tr>
<tr class="separator:a19239aba163189612262ba8c314d2a1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb57279a071dc9d1c6480b98411efb85"><td class="memItemLeft" align="right" valign="top"><a id="afb57279a071dc9d1c6480b98411efb85"></a>
time_t&#160;</td><td class="memItemRight" valign="bottom"><b>voting_schedule_get_next_valid_after_time</b> (void)</td></tr>
<tr class="separator:afb57279a071dc9d1c6480b98411efb85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a692bf7ca1e3a855fdf43a860f437f8b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="voting__schedule_8c.html#a692bf7ca1e3a855fdf43a860f437f8b2">voting_schedule_recalculate_timing</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options, time_t now)</td></tr>
<tr class="separator:a692bf7ca1e3a855fdf43a860f437f8b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3f869326a9eecdf18946741bb17ff619"><td class="memItemLeft" align="right" valign="top"><a id="a3f869326a9eecdf18946741bb17ff619"></a>
<a class="el" href="structvoting__schedule__t.html">voting_schedule_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>voting_schedule</b></td></tr>
<tr class="separator:a3f869326a9eecdf18946741bb17ff619"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains functions that are from the directory authority subsystem related to voting specifically but used by many part of tor. The full feature is built as part of the dirauth module. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a19239aba163189612262ba8c314d2a1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19239aba163189612262ba8c314d2a1c">&#9670;&nbsp;</a></span>voting_schedule_get_start_of_next_interval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t voting_schedule_get_start_of_next_interval </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the start of the next interval of size <b>interval</b> (in seconds) after <b>now</b>, plus <b>offset</b>. Midnight always starts a fresh interval, and if the last interval of a day would be truncated to less than half its size, it is rolled into the previous interval. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="voting__schedule_8c_a19239aba163189612262ba8c314d2a1c_cgraph.png" border="0" usemap="#voting__schedule_8c_a19239aba163189612262ba8c314d2a1c_cgraph" alt=""/></div>
<map name="voting__schedule_8c_a19239aba163189612262ba8c314d2a1c_cgraph" id="voting__schedule_8c_a19239aba163189612262ba8c314d2a1c_cgraph">
<area shape="rect" id="node2" href="compat_8c.html#a983d273987a338a60523f0bce4006af2" title="tor_gmtime_r" alt="" coords="208,56,307,83"/>
<area shape="rect" id="node6" href="util_8c.html#a966c4dd39a43f89fd5207aebb4756654" title="tor_timegm" alt="" coords="214,107,301,133"/>
<area shape="rect" id="node3" href="compat__threads_8c.html#a0f3b168e06f8e4b99789af20771ee096" title="tor_mutex_new" alt="" coords="364,5,475,32"/>
<area shape="rect" id="node4" href="compat__pthreads_8c.html#a8bfcc96866bdf76508915db8b252f746" title="tor_mutex_acquire" alt="" coords="355,56,484,83"/>
<area shape="rect" id="node5" href="compat__pthreads_8c.html#a3fc2298a8cb49803528daa6d35091372" title="tor_mutex_release" alt="" coords="355,107,484,133"/>
</map>
</div>

</div>
</div>
<a id="a692bf7ca1e3a855fdf43a860f437f8b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a692bf7ca1e3a855fdf43a860f437f8b2">&#9670;&nbsp;</a></span>voting_schedule_recalculate_timing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void voting_schedule_recalculate_timing </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set voting_schedule to hold the timing for the next vote we should be doing. All type of tor do that because HS subsystem needs the timing as well to function properly. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
