<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/common/tortls.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_b7e1585941a202f53e5249c42015d573.html">common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tortls.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Wrapper functions to present a consistent interface to TLS, SSL, and X.509 functions from OpenSSL.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;orconfig.h&quot;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &quot;<a class="el" href="crypto_8h_source.html">crypto.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__rand_8h_source.html">crypto_rand.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__util_8h_source.html">crypto_util.h</a>&quot;</code><br />
<code>#include &quot;compat.h&quot;</code><br />
<code>#include &lt;openssl/opensslv.h&gt;</code><br />
<code>#include &lt;openssl/ssl.h&gt;</code><br />
<code>#include &lt;openssl/ssl3.h&gt;</code><br />
<code>#include &lt;openssl/err.h&gt;</code><br />
<code>#include &lt;openssl/tls1.h&gt;</code><br />
<code>#include &lt;openssl/asn1.h&gt;</code><br />
<code>#include &lt;openssl/bio.h&gt;</code><br />
<code>#include &lt;openssl/bn.h&gt;</code><br />
<code>#include &lt;openssl/rsa.h&gt;</code><br />
<code>#include &quot;<a class="el" href="tortls_8h_source.html">tortls.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util_8h_source.html">util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="torlog_8h_source.html">torlog.h</a>&quot;</code><br />
<code>#include &quot;container.h&quot;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;ciphers.inc&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for tortls.c:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2tortls_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2tortls_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2tortls_8c">
<area shape="rect" id="node2" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="1137,781,1216,808"/>
<area shape="rect" id="node4" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="1218,109,1287,136"/>
<area shape="rect" id="node8" href="compat_8h_source.html" title="compat.h" alt="" coords="532,557,608,584"/>
<area shape="rect" id="node14" href="util_8h.html" title="Headers for util.c. " alt="" coords="1051,408,1102,435"/>
<area shape="rect" id="node20" href="container_8h_source.html" title="container.h" alt="" coords="853,333,940,360"/>
<area shape="rect" id="node22" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="213,483,279,509"/>
<area shape="rect" id="node23" href="crypto__rand_8h.html" title="Common functions for using (pseudo&#45;)random number generators. " alt="" coords="1530,333,1631,360"/>
<area shape="rect" id="node24" href="crypto__util_8h.html" title="Common functions for cryptographic routines. " alt="" coords="1589,557,1682,584"/>
<area shape="rect" id="node34" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="387,109,449,136"/>
<area shape="rect" id="node6" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="1343,707,1405,733"/>
<area shape="rect" id="node18" href="crypto__rsa_8h.html" title="Headers for crypto_rsa.c. " alt="" coords="867,184,961,211"/>
<area shape="rect" id="node9" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="329,707,427,733"/>
<area shape="rect" id="node11" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="560,707,668,733"/>
<area shape="rect" id="node13" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="749,632,876,659"/>
<area shape="rect" id="node15" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="1240,632,1311,659"/>
<area shape="rect" id="node17" href="util__bug_8h.html" title="Macros to manage assertions, fatal and non&#45;fatal. " alt="" coords="840,483,919,509"/>
<area shape="rect" id="node19" href="crypto__digest_8h.html" title="Headers for crypto_digest.c. " alt="" coords="888,259,999,285"/>
<area shape="rect" id="node21" href="siphash_8h_source.html" title="siphash.h" alt="" coords="857,408,936,435"/>
<area shape="rect" id="node35" href="compat__openssl_8h.html" title="compatibility definitions for working with different openssl forks " alt="" coords="253,184,381,211"/>
<area shape="rect" id="node36" href="crypto__openssl__mgt_8h_source.html" title="crypto_openssl_mgt.h" alt="" coords="617,333,768,360"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa99725b6e375fd8860f7636efa529297"><td class="memItemLeft" align="right" valign="top"><a id="aa99725b6e375fd8860f7636efa529297"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TORTLS_PRIVATE</b></td></tr>
<tr class="separator:aa99725b6e375fd8860f7636efa529297"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac8f95025b24159e6dcfeb436eb1f192"><td class="memItemLeft" align="right" valign="top"><a id="aac8f95025b24159e6dcfeb436eb1f192"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TORTLS_OPENSSL_PRIVATE</b></td></tr>
<tr class="separator:aac8f95025b24159e6dcfeb436eb1f192"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa99725b6e375fd8860f7636efa529297"><td class="memItemLeft" align="right" valign="top"><a id="aa99725b6e375fd8860f7636efa529297"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TORTLS_PRIVATE</b></td></tr>
<tr class="separator:aa99725b6e375fd8860f7636efa529297"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6df0c817fd95557a33164bb741bc533"><td class="memItemLeft" align="right" valign="top"><a id="ad6df0c817fd95557a33164bb741bc533"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>X509_get_notBefore_const</b>(cert)&#160;&#160;&#160;((const ASN1_TIME*) X509_get_notBefore((X509 *)cert))</td></tr>
<tr class="separator:ad6df0c817fd95557a33164bb741bc533"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a486dc481c1c6e783103550399c577d58"><td class="memItemLeft" align="right" valign="top"><a id="a486dc481c1c6e783103550399c577d58"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>X509_get_notAfter_const</b>(cert)&#160;&#160;&#160;((const ASN1_TIME*) X509_get_notAfter((X509 *)cert))</td></tr>
<tr class="separator:a486dc481c1c6e783103550399c577d58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30e3eed1f6a9e7d47c0d6a254f0e0133"><td class="memItemLeft" align="right" valign="top"><a id="a30e3eed1f6a9e7d47c0d6a254f0e0133"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LEGAL_NICKNAME_CHARACTERS</b>&#160;&#160;&#160;&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</td></tr>
<tr class="separator:a30e3eed1f6a9e7d47c0d6a254f0e0133"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78663cc5615d377fcb150fe6bbddce1e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a78663cc5615d377fcb150fe6bbddce1e">IDENTITY_CERT_LIFETIME</a>&#160;&#160;&#160;(365*24*60*60)</td></tr>
<tr class="separator:a78663cc5615d377fcb150fe6bbddce1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8178b5ebd4946e953026880a22f69f65"><td class="memItemLeft" align="right" valign="top"><a id="a8178b5ebd4946e953026880a22f69f65"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ADDR</b>(tls)&#160;&#160;&#160;(((tls) &amp;&amp; (tls)-&gt;address) ? tls-&gt;address : &quot;peer&quot;)</td></tr>
<tr class="separator:a8178b5ebd4946e953026880a22f69f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7187187cf1085bb60bb26fec8f6763e"><td class="memItemLeft" align="right" valign="top"><a id="ab7187187cf1085bb60bb26fec8f6763e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DISABLE_SSL3_HANDSHAKE</b></td></tr>
<tr class="separator:ab7187187cf1085bb60bb26fec8f6763e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7df36c420dfea84f7291c8352e43e847"><td class="memItemLeft" align="right" valign="top"><a id="a7df36c420dfea84f7291c8352e43e847"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION</b>&#160;&#160;&#160;0x00040000L</td></tr>
<tr class="separator:a7df36c420dfea84f7291c8352e43e847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6126a38e5086ff799146a7ef7b5cffc"><td class="memItemLeft" align="right" valign="top"><a id="ad6126a38e5086ff799146a7ef7b5cffc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SSL3_FLAGS_ALLOW_UNSAFE_LEGACY_RENEGOTIATION</b>&#160;&#160;&#160;0x0010</td></tr>
<tr class="separator:ad6126a38e5086ff799146a7ef7b5cffc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7f2b6ef5a19e6398fd92322539d9919"><td class="memItemLeft" align="right" valign="top"><a id="aa7f2b6ef5a19e6398fd92322539d9919"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_SYSCALL_</b>&#160;&#160;&#160;(MIN_TOR_TLS_ERROR_VAL_ - 2)</td></tr>
<tr class="separator:aa7f2b6ef5a19e6398fd92322539d9919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80634c3c41490fc6c24e63c9c0672c4d"><td class="memItemLeft" align="right" valign="top"><a id="a80634c3c41490fc6c24e63c9c0672c4d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_ZERORETURN_</b>&#160;&#160;&#160;(MIN_TOR_TLS_ERROR_VAL_ - 1)</td></tr>
<tr class="separator:a80634c3c41490fc6c24e63c9c0672c4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a882f66c9b14e92291787b235721544a3"><td class="memItemLeft" align="right" valign="top"><a id="a882f66c9b14e92291787b235721544a3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CASE</b>(st)&#160;&#160;&#160;case TOR_TLS_ST_##st: tortls_state = &quot; in &quot;#st ; break</td></tr>
<tr class="separator:a882f66c9b14e92291787b235721544a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39e6d9b51b12cfb0939f25441d9f95f9"><td class="memItemLeft" align="right" valign="top"><a id="a39e6d9b51b12cfb0939f25441d9f95f9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CATCH_SYSCALL</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a39e6d9b51b12cfb0939f25441d9f95f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa28c47081336c8864d4fb6f79e0c068e"><td class="memItemLeft" align="right" valign="top"><a id="aa28c47081336c8864d4fb6f79e0c068e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CATCH_ZERO</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:aa28c47081336c8864d4fb6f79e0c068e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299c6a41d5c4e7c3b7e23a34c770394e"><td class="memItemLeft" align="right" valign="top"><a id="a299c6a41d5c4e7c3b7e23a34c770394e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SERIAL_NUMBER_SIZE</b>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a299c6a41d5c4e7c3b7e23a34c770394e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6711a9efc1e96b2f5eaa777d9fb20f6"><td class="memItemLeft" align="right" valign="top"><a id="ac6711a9efc1e96b2f5eaa777d9fb20f6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CIPHER</b>(id,  name)&#160;&#160;&#160;name &quot;:&quot;</td></tr>
<tr class="separator:ac6711a9efc1e96b2f5eaa777d9fb20f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa03ca4b32f87aa50c3b46f77e025325f"><td class="memItemLeft" align="right" valign="top"><a id="aa03ca4b32f87aa50c3b46f77e025325f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>XCIPHER</b>(id,  name)</td></tr>
<tr class="separator:aa03ca4b32f87aa50c3b46f77e025325f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d1ad01829ae65a5c90d8fd86ed797e1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a3d1ad01829ae65a5c90d8fd86ed797e1">NID_tor_default_ecdhe_group</a>&#160;&#160;&#160;NID_X9_62_prime256v1</td></tr>
<tr class="separator:a3d1ad01829ae65a5c90d8fd86ed797e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a072a1afc24ff2e7907ba56cb0f9e9cbc"><td class="memItemLeft" align="right" valign="top"><a id="a072a1afc24ff2e7907ba56cb0f9e9cbc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RSA_LINK_KEY_BITS</b>&#160;&#160;&#160;2048</td></tr>
<tr class="separator:a072a1afc24ff2e7907ba56cb0f9e9cbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f4d33677adca16e2e5b25db5d4cb61c"><td class="memItemLeft" align="right" valign="top"><a id="a5f4d33677adca16e2e5b25db5d4cb61c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TLSSECRET_MAGIC</b>&#160;&#160;&#160;&quot;Tor V3 handshake TLS cross-certification&quot;</td></tr>
<tr class="separator:a5f4d33677adca16e2e5b25db5d4cb61c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:acb5fde428415feac08c247946af63aff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#acb5fde428415feac08c247946af63aff">CIPHERS_ERR</a>&#160;&#160;&#160;-1</td></tr>
<tr class="separator:acb5fde428415feac08c247946af63aff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c1b23680aff7a40304d67a2109d54ab"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a2c1b23680aff7a40304d67a2109d54ab">CIPHERS_V1</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a2c1b23680aff7a40304d67a2109d54ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac969be652cbf51f48834d6576685ae2c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#ac969be652cbf51f48834d6576685ae2c">CIPHERS_V2</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ac969be652cbf51f48834d6576685ae2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47d2e592587ddaa2dde1662031bd1921"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a47d2e592587ddaa2dde1662031bd1921">CIPHERS_UNRESTRICTED</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a47d2e592587ddaa2dde1662031bd1921"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6131d58b34012459b006188b6ecc951b"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a6131d58b34012459b006188b6ecc951b">tor_tls_allocate_tor_tls_object_ex_data_index</a> (void)</td></tr>
<tr class="separator:a6131d58b34012459b006188b6ecc951b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e24642f99d95d664c8e97116ec368a4"><td class="memItemLeft" align="right" valign="top">STATIC tor_tls_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a3e24642f99d95d664c8e97116ec368a4">tor_tls_get_by_ssl</a> (const SSL *ssl)</td></tr>
<tr class="separator:a3e24642f99d95d664c8e97116ec368a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefdead64da19ca5d4ee7cb9b60a7ab13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#aefdead64da19ca5d4ee7cb9b60a7ab13">tor_tls_get_state_description</a> (tor_tls_t *tls, char *buf, size_t sz)</td></tr>
<tr class="separator:aefdead64da19ca5d4ee7cb9b60a7ab13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9a5eb99512347313d8f3495168a1501"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#ad9a5eb99512347313d8f3495168a1501">tor_tls_log_one_error</a> (tor_tls_t *tls, unsigned long err, int severity, int domain, const char *doing)</td></tr>
<tr class="separator:ad9a5eb99512347313d8f3495168a1501"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc2406721ee63472828ecc962767ebe2"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#adc2406721ee63472828ecc962767ebe2">tls_log_errors</a> (tor_tls_t *tls, int severity, int domain, const char *doing)</td></tr>
<tr class="separator:adc2406721ee63472828ecc962767ebe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad234b50af0b367035847da6efd9f86f9"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#ad234b50af0b367035847da6efd9f86f9">tor_errno_to_tls_error</a> (int e)</td></tr>
<tr class="separator:ad234b50af0b367035847da6efd9f86f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab51ce122d6957eed72dfad975600bca7"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#ab51ce122d6957eed72dfad975600bca7">tor_tls_err_to_string</a> (int err)</td></tr>
<tr class="separator:ab51ce122d6957eed72dfad975600bca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4c6052b8b597bc4c9ca00e4554798cc"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#ae4c6052b8b597bc4c9ca00e4554798cc">tor_tls_get_error</a> (tor_tls_t *tls, int r, int extra, const char *doing, int severity, int domain)</td></tr>
<tr class="separator:ae4c6052b8b597bc4c9ca00e4554798cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8e5980912c517c20c6b90419ef0c3b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#ae8e5980912c517c20c6b90419ef0c3b6">tor_tls_free_all</a> (void)</td></tr>
<tr class="separator:ae8e5980912c517c20c6b90419ef0c3b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea3023aa883bf22a995291113ca37f8a"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#aea3023aa883bf22a995291113ca37f8a">always_accept_verify_cb</a> (int preverify_ok, X509_STORE_CTX *x509_ctx)</td></tr>
<tr class="separator:aea3023aa883bf22a995291113ca37f8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac50648346a7461e7e16cfcb3d0998a64"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#ac50648346a7461e7e16cfcb3d0998a64">MOCK_IMPL</a> (STATIC X509 *, tor_tls_create_certificate,(<a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *rsa, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *rsa_sign, const char *cname, const char *cname_sign, unsigned int cert_lifetime))</td></tr>
<tr class="separator:ac50648346a7461e7e16cfcb3d0998a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af396dc12cfe27527a145727f28bbbe62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#af396dc12cfe27527a145727f28bbbe62">tor_x509_cert_free_</a> (tor_x509_cert_t *cert)</td></tr>
<tr class="separator:af396dc12cfe27527a145727f28bbbe62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafa992ad5321d733430656f683c23387"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#aafa992ad5321d733430656f683c23387">MOCK_IMPL</a> (STATIC tor_x509_cert_t *, tor_x509_cert_new,(X509 *x509_cert))</td></tr>
<tr class="separator:aafa992ad5321d733430656f683c23387"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01200614cea5495e3bf7ff1b9157811c"><td class="memItemLeft" align="right" valign="top">tor_x509_cert_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a01200614cea5495e3bf7ff1b9157811c">tor_x509_cert_dup</a> (const tor_x509_cert_t *cert)</td></tr>
<tr class="separator:a01200614cea5495e3bf7ff1b9157811c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea5999c1b596c9c571889386f8bc508c"><td class="memItemLeft" align="right" valign="top">tor_x509_cert_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#aea5999c1b596c9c571889386f8bc508c">tor_x509_cert_decode</a> (const uint8_t *certificate, size_t certificate_len)</td></tr>
<tr class="separator:aea5999c1b596c9c571889386f8bc508c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae138ea45f150f1291b09f0b5dfa34ad4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#ae138ea45f150f1291b09f0b5dfa34ad4">tor_x509_cert_get_der</a> (const tor_x509_cert_t *cert, const uint8_t **encoded_out, size_t *size_out)</td></tr>
<tr class="separator:ae138ea45f150f1291b09f0b5dfa34ad4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb4713a168234b69a9d25312a3a15770"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structcommon__digests__t.html">common_digests_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#aeb4713a168234b69a9d25312a3a15770">tor_x509_cert_get_id_digests</a> (const tor_x509_cert_t *cert)</td></tr>
<tr class="separator:aeb4713a168234b69a9d25312a3a15770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5904272a0bc1d95951b5a0aa4903cc05"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structcommon__digests__t.html">common_digests_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a5904272a0bc1d95951b5a0aa4903cc05">tor_x509_cert_get_cert_digests</a> (const tor_x509_cert_t *cert)</td></tr>
<tr class="separator:a5904272a0bc1d95951b5a0aa4903cc05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aa93459dd4e3641e885932d682db4a0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a7aa93459dd4e3641e885932d682db4a0">tor_tls_get_my_certs</a> (int server, const tor_x509_cert_t **link_cert_out, const tor_x509_cert_t **id_cert_out)</td></tr>
<tr class="separator:a7aa93459dd4e3641e885932d682db4a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cc46ce9e214e2055861f7cacdfdfca2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a7cc46ce9e214e2055861f7cacdfdfca2">tor_tls_get_my_client_auth_key</a> (void)</td></tr>
<tr class="separator:a7cc46ce9e214e2055861f7cacdfdfca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cdf67e68f80f5bef7c52a5964416024"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a4cdf67e68f80f5bef7c52a5964416024">tor_tls_cert_get_key</a> (tor_x509_cert_t *cert)</td></tr>
<tr class="separator:a4cdf67e68f80f5bef7c52a5964416024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad355a1780bc2ed2dac97586713a40447"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#ad355a1780bc2ed2dac97586713a40447">MOCK_IMPL</a> (int, tor_tls_cert_matches_key,(const tor_tls_t *tls, const tor_x509_cert_t *cert))</td></tr>
<tr class="separator:ad355a1780bc2ed2dac97586713a40447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a805d08ed945976a2b66c748073be0abc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a805d08ed945976a2b66c748073be0abc">tor_tls_cert_is_valid</a> (int severity, const tor_x509_cert_t *cert, const tor_x509_cert_t *signing_cert, time_t now, int check_rsa_1024)</td></tr>
<tr class="separator:a805d08ed945976a2b66c748073be0abc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b7b628cbb659c7899ef90e58abb559"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a18b7b628cbb659c7899ef90e58abb559">tor_tls_context_init</a> (unsigned flags, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *client_identity, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *server_identity, unsigned int key_lifetime)</td></tr>
<tr class="separator:a18b7b628cbb659c7899ef90e58abb559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bf12ea45b278b5644c7b180a1170360"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a5bf12ea45b278b5644c7b180a1170360">tor_tls_context_init_one</a> (tor_tls_context_t **ppcontext, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *identity, unsigned int key_lifetime, unsigned int flags, int is_client)</td></tr>
<tr class="separator:a5bf12ea45b278b5644c7b180a1170360"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34bd97b4e5d30b27c251d52a8151f44a"><td class="memItemLeft" align="right" valign="top">STATIC tor_tls_context_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a34bd97b4e5d30b27c251d52a8151f44a">tor_tls_context_new</a> (<a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *identity, unsigned int key_lifetime, unsigned flags, int is_client)</td></tr>
<tr class="separator:a34bd97b4e5d30b27c251d52a8151f44a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f66b1039c2f3e00e4d4602f19d5ab02"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a6f66b1039c2f3e00e4d4602f19d5ab02">tor_tls_debug_state_callback</a> (const SSL *ssl, int type, int val)</td></tr>
<tr class="separator:a6f66b1039c2f3e00e4d4602f19d5ab02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85f7685dfbf617b6b763f3895e1fbade"><td class="memItemLeft" align="right" valign="top"><a id="a85f7685dfbf617b6b763f3895e1fbade"></a>
const char *&#160;</td><td class="memItemRight" valign="bottom"><b>tor_tls_get_ciphersuite_name</b> (tor_tls_t *tls)</td></tr>
<tr class="separator:a85f7685dfbf617b6b763f3895e1fbade"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21a637d49c20f40551fab123341ee855"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a21a637d49c20f40551fab123341ee855">find_cipher_by_id</a> (const SSL *ssl, const SSL_METHOD *m, uint16_t cipher)</td></tr>
<tr class="separator:a21a637d49c20f40551fab123341ee855"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33df6ed8c10ec9fa4c63ab44755c743c"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a33df6ed8c10ec9fa4c63ab44755c743c">tor_tls_classify_client_ciphers</a> (const SSL *ssl, STACK_OF(SSL_CIPHER) *peer_ciphers)</td></tr>
<tr class="separator:a33df6ed8c10ec9fa4c63ab44755c743c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad056e06ade9276639ff4651e329d84f8"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#ad056e06ade9276639ff4651e329d84f8">tor_tls_client_is_using_v2_ciphers</a> (const SSL *ssl)</td></tr>
<tr class="separator:ad056e06ade9276639ff4651e329d84f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b0c0880a231328e1b5d7faa01fddcd9"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a3b0c0880a231328e1b5d7faa01fddcd9">tor_tls_server_info_callback</a> (const SSL *ssl, int type, int val)</td></tr>
<tr class="separator:a3b0c0880a231328e1b5d7faa01fddcd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a4651c67d3abf08e25cb819910b0c9b"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a1a4651c67d3abf08e25cb819910b0c9b">tor_tls_session_secret_cb</a> (SSL *ssl, void *secret, int *secret_len, STACK_OF(SSL_CIPHER) *peer_ciphers, CONST_IF_OPENSSL_1_1_API SSL_CIPHER **cipher, void *arg)</td></tr>
<tr class="separator:a1a4651c67d3abf08e25cb819910b0c9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0369a39c5458674c1d2f77daaf0a402a"><td class="memItemLeft" align="right" valign="top">tor_tls_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a0369a39c5458674c1d2f77daaf0a402a">tor_tls_new</a> (int sock, int isServer)</td></tr>
<tr class="separator:a0369a39c5458674c1d2f77daaf0a402a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e67c6afa29e8932b6908f1e21f5124"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#aa0e67c6afa29e8932b6908f1e21f5124">tor_tls_set_logged_address</a> (tor_tls_t *tls, const char *address)</td></tr>
<tr class="separator:aa0e67c6afa29e8932b6908f1e21f5124"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5823cfa710f0f7987d09dfececae28d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a5823cfa710f0f7987d09dfececae28d0">tor_tls_set_renegotiate_callback</a> (tor_tls_t *tls, void(*cb)(tor_tls_t *, void *arg), void *arg)</td></tr>
<tr class="separator:a5823cfa710f0f7987d09dfececae28d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2daac9018a16ea061a2429f171c25245"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a2daac9018a16ea061a2429f171c25245">tor_tls_unblock_renegotiation</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a2daac9018a16ea061a2429f171c25245"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08342968552b84d5dfbd6493338f6058"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a08342968552b84d5dfbd6493338f6058">tor_tls_block_renegotiation</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a08342968552b84d5dfbd6493338f6058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d9241115f8182cbdb26be9756f25fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a56d9241115f8182cbdb26be9756f25fb">tor_tls_assert_renegotiation_unblocked</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a56d9241115f8182cbdb26be9756f25fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89dbecf04240626af4b070b1b83c9f56"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a89dbecf04240626af4b070b1b83c9f56">tor_tls_is_server</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a89dbecf04240626af4b070b1b83c9f56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f5a528cdb3b8cb9ce04b40bb899dbeb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a6f5a528cdb3b8cb9ce04b40bb899dbeb">tor_tls_free_</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a6f5a528cdb3b8cb9ce04b40bb899dbeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa34410a913d12aff35c6df7c9d558e6e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#aa34410a913d12aff35c6df7c9d558e6e">MOCK_IMPL</a> (int, tor_tls_read,(tor_tls_t *tls, char *cp, size_t len))</td></tr>
<tr class="separator:aa34410a913d12aff35c6df7c9d558e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f79960ae7a36ce6647ceafd36c7e162"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a5f79960ae7a36ce6647ceafd36c7e162">tor_tls_write</a> (tor_tls_t *tls, const char *cp, size_t n)</td></tr>
<tr class="separator:a5f79960ae7a36ce6647ceafd36c7e162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab228adf4f9dbd0f8739a657ea66f389e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#ab228adf4f9dbd0f8739a657ea66f389e">tor_tls_handshake</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:ab228adf4f9dbd0f8739a657ea66f389e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf727dd8275cc9deb3d1b71c110b8d6e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#abf727dd8275cc9deb3d1b71c110b8d6e">tor_tls_finish_handshake</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:abf727dd8275cc9deb3d1b71c110b8d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30918c11f14636a0a5027c76a0ae8498"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a30918c11f14636a0a5027c76a0ae8498">tor_tls_shutdown</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a30918c11f14636a0a5027c76a0ae8498"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13025f3a8714b2c00a7b7d0842fc5694"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a13025f3a8714b2c00a7b7d0842fc5694">tor_tls_peer_has_cert</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a13025f3a8714b2c00a7b7d0842fc5694"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a631d2a19bd52d1de8194b24da85c3317"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a631d2a19bd52d1de8194b24da85c3317">MOCK_IMPL</a> (tor_x509_cert_t *, tor_tls_get_peer_cert,(tor_tls_t *tls))</td></tr>
<tr class="separator:a631d2a19bd52d1de8194b24da85c3317"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97b1047e5a7253e677fb549a9d2910c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a97b1047e5a7253e677fb549a9d2910c3">MOCK_IMPL</a> (tor_x509_cert_t *, tor_tls_get_own_cert,(tor_tls_t *tls))</td></tr>
<tr class="separator:a97b1047e5a7253e677fb549a9d2910c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa6f172724874c8eadf30664594c48a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#afa6f172724874c8eadf30664594c48a1">MOCK_IMPL</a> (STATIC void, try_to_extract_certs_from_tls,(int severity, tor_tls_t *tls, X509 **cert_out, X509 **id_cert_out))</td></tr>
<tr class="separator:afa6f172724874c8eadf30664594c48a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05ab54f8371c33d1f9ff9484ffad2732"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a05ab54f8371c33d1f9ff9484ffad2732">tor_tls_verify</a> (int severity, tor_tls_t *tls, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> **identity_key)</td></tr>
<tr class="separator:a05ab54f8371c33d1f9ff9484ffad2732"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7493fe8a822f0ef8d46980439882fbb1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a7493fe8a822f0ef8d46980439882fbb1">tor_tls_check_lifetime</a> (int severity, tor_tls_t *tls, time_t now, int past_tolerance, int future_tolerance)</td></tr>
<tr class="separator:a7493fe8a822f0ef8d46980439882fbb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeaf421de8fd8d7d4d3bad71272bfc4e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#aaeaf421de8fd8d7d4d3bad71272bfc4e">tor_tls_get_pending_bytes</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:aaeaf421de8fd8d7d4d3bad71272bfc4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc7afb97a99f6f7664a9ced2b8baab54"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#afc7afb97a99f6f7664a9ced2b8baab54">tor_tls_get_forced_write_size</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:afc7afb97a99f6f7664a9ced2b8baab54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2052799333f0e6afd56d3a3fc640d879"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a2052799333f0e6afd56d3a3fc640d879">tor_tls_get_n_raw_bytes</a> (tor_tls_t *tls, size_t *n_read, size_t *n_written)</td></tr>
<tr class="separator:a2052799333f0e6afd56d3a3fc640d879"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a4312bcca2c2fa92120225aa44b32e0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a0a4312bcca2c2fa92120225aa44b32e0">MOCK_IMPL</a> (double, tls_get_write_overhead_ratio,(void))</td></tr>
<tr class="separator:a0a4312bcca2c2fa92120225aa44b32e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1289d9a4db6778fc2feee7af5301a203"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a1289d9a4db6778fc2feee7af5301a203">check_no_tls_errors_</a> (const char *fname, int line)</td></tr>
<tr class="separator:a1289d9a4db6778fc2feee7af5301a203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1df770dd394f7ab33f134583c3385cd0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a1df770dd394f7ab33f134583c3385cd0">tor_tls_used_v1_handshake</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a1df770dd394f7ab33f134583c3385cd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a40e31028963e83e7a7b44199432b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#aa1a40e31028963e83e7a7b44199432b1">tor_tls_get_num_server_handshakes</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:aa1a40e31028963e83e7a7b44199432b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02131f4d24082f726fbc9b93a5adcf50"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a02131f4d24082f726fbc9b93a5adcf50">tor_tls_server_got_renegotiate</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a02131f4d24082f726fbc9b93a5adcf50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a167465e8f2e2cd8909823fea132bf68f"><td class="memItemLeft" align="right" valign="top"><a id="a167465e8f2e2cd8909823fea132bf68f"></a>
STATIC size_t&#160;</td><td class="memItemRight" valign="bottom"><b>SSL_SESSION_get_master_key</b> (SSL_SESSION *s, uint8_t *out, size_t len)</td></tr>
<tr class="separator:a167465e8f2e2cd8909823fea132bf68f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cdc403d61257cf30593a0084910587d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a0cdc403d61257cf30593a0084910587d">MOCK_IMPL</a> (int, tor_tls_get_tlssecrets,(tor_tls_t *tls, uint8_t *secrets_out))</td></tr>
<tr class="separator:a0cdc403d61257cf30593a0084910587d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9230eaa3952409a4fc289e2bdb059cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#aa9230eaa3952409a4fc289e2bdb059cf">MOCK_IMPL</a> (int, tor_tls_export_key_material,(tor_tls_t *tls, uint8_t *secrets_out, const uint8_t *context, size_t context_len, const char *label))</td></tr>
<tr class="separator:aa9230eaa3952409a4fc289e2bdb059cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fef8380f402b3e300d756a828ba9d56"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a6fef8380f402b3e300d756a828ba9d56">tor_tls_get_buffer_sizes</a> (tor_tls_t *tls, size_t *rbuf_capacity, size_t *rbuf_bytes, size_t *wbuf_capacity, size_t *wbuf_bytes)</td></tr>
<tr class="separator:a6fef8380f402b3e300d756a828ba9d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a479756d042d4e4890e403726e0cb2a5b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a479756d042d4e4890e403726e0cb2a5b">evaluate_ecgroup_for_tls</a> (const char *ecgroup)</td></tr>
<tr class="separator:a479756d042d4e4890e403726e0cb2a5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a25442c05a47e1c53a73489104ca56594"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a25442c05a47e1c53a73489104ca56594">tor_tls_object_ex_data_index</a> = -1</td></tr>
<tr class="separator:a25442c05a47e1c53a73489104ca56594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c53977d6a772c7eaac7b9a3fbf84d9e"><td class="memItemLeft" align="right" valign="top"><a id="a4c53977d6a772c7eaac7b9a3fbf84d9e"></a>
STATIC uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>v2_cipher_list</b> []</td></tr>
<tr class="separator:a4c53977d6a772c7eaac7b9a3fbf84d9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35c4dfb99a0a17253ce2238cb9c6d15a"><td class="memItemLeft" align="right" valign="top">STATIC uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a35c4dfb99a0a17253ce2238cb9c6d15a">total_bytes_written_over_tls</a> = 0</td></tr>
<tr class="separator:a35c4dfb99a0a17253ce2238cb9c6d15a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c13934505a0e9665e1357c4d3e9f032"><td class="memItemLeft" align="right" valign="top">STATIC uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#a8c13934505a0e9665e1357c4d3e9f032">total_bytes_written_by_tls</a> = 0</td></tr>
<tr class="separator:a8c13934505a0e9665e1357c4d3e9f032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:ace791365ee344ba5b611c0ff9883a47e"><td class="memItemLeft" align="right" valign="top">STATIC tor_tls_context_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8c.html#ace791365ee344ba5b611c0ff9883a47e">server_tls_context</a> = NULL</td></tr>
<tr class="separator:ace791365ee344ba5b611c0ff9883a47e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a620e8a0ba3a22ebcf5607a712b5a85e8"><td class="memItemLeft" align="right" valign="top"><a id="a620e8a0ba3a22ebcf5607a712b5a85e8"></a>
STATIC tor_tls_context_t *&#160;</td><td class="memItemRight" valign="bottom"><b>client_tls_context</b> = NULL</td></tr>
<tr class="separator:a620e8a0ba3a22ebcf5607a712b5a85e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Wrapper functions to present a consistent interface to TLS, SSL, and X.509 functions from OpenSSL. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="acb5fde428415feac08c247946af63aff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb5fde428415feac08c247946af63aff">&#9670;&nbsp;</a></span>CIPHERS_ERR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CIPHERS_ERR&#160;&#160;&#160;-1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return values for tor_tls_classify_client_ciphers.An error occurred when examining the client ciphers </p>

</div>
</div>
<a id="a47d2e592587ddaa2dde1662031bd1921"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47d2e592587ddaa2dde1662031bd1921">&#9670;&nbsp;</a></span>CIPHERS_UNRESTRICTED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CIPHERS_UNRESTRICTED&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The client cipher list indicates that the client is using the v2 or the v3 handshake, and that it is telling the truth about what ciphers it supports </p>

</div>
</div>
<a id="a2c1b23680aff7a40304d67a2109d54ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c1b23680aff7a40304d67a2109d54ab">&#9670;&nbsp;</a></span>CIPHERS_V1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CIPHERS_V1&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The client cipher list indicates that a v1 handshake was in use. </p>

</div>
</div>
<a id="ac969be652cbf51f48834d6576685ae2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac969be652cbf51f48834d6576685ae2c">&#9670;&nbsp;</a></span>CIPHERS_V2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CIPHERS_V2&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The client cipher list indicates that the client is using the v2 or the v3 handshake, but that it is (probably!) lying about what ciphers it supports </p>

</div>
</div>
<a id="a78663cc5615d377fcb150fe6bbddce1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78663cc5615d377fcb150fe6bbddce1e">&#9670;&nbsp;</a></span>IDENTITY_CERT_LIFETIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IDENTITY_CERT_LIFETIME&#160;&#160;&#160;(365*24*60*60)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How long do identity certificates live? (sec) </p>

</div>
</div>
<a id="a3d1ad01829ae65a5c90d8fd86ed797e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d1ad01829ae65a5c90d8fd86ed797e1">&#9670;&nbsp;</a></span>NID_tor_default_ecdhe_group</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NID_tor_default_ecdhe_group&#160;&#160;&#160;NID_X9_62_prime256v1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The group we should use for ecdhe when none was selected. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aea3023aa883bf22a995291113ca37f8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea3023aa883bf22a995291113ca37f8a">&#9670;&nbsp;</a></span>always_accept_verify_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int always_accept_verify_cb </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>preverify_ok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509_STORE_CTX *&#160;</td>
          <td class="paramname"><em>x509_ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We need to give OpenSSL a callback to verify certificates. This is it: We always accept peer certs and complete the handshake. We don't validate them until later. </p>

</div>
</div>
<a id="a1289d9a4db6778fc2feee7af5301a203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1289d9a4db6778fc2feee7af5301a203">&#9670;&nbsp;</a></span>check_no_tls_errors_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_no_tls_errors_ </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Implement check_no_tls_errors: If there are any pending OpenSSL errors, log an error message. </p>

</div>
</div>
<a id="a479756d042d4e4890e403726e0cb2a5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a479756d042d4e4890e403726e0cb2a5b">&#9670;&nbsp;</a></span>evaluate_ecgroup_for_tls()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evaluate_ecgroup_for_tls </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ecgroup</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether the ECC group requested is supported by the current OpenSSL library instance. Return 1 if the group is supported, and 0 if not. </p>

</div>
</div>
<a id="a21a637d49c20f40551fab123341ee855"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21a637d49c20f40551fab123341ee855">&#9670;&nbsp;</a></span>find_cipher_by_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int find_cipher_by_id </td>
          <td>(</td>
          <td class="paramtype">const SSL *&#160;</td>
          <td class="paramname"><em>ssl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SSL_METHOD *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>cipher</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return 0 if <b>m</b> does not support the cipher with ID <b>cipher</b>; return 1 if it does support it, or if we have no way to tell. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a21a637d49c20f40551fab123341ee855_cgraph.png" border="0" usemap="#tortls_8c_a21a637d49c20f40551fab123341ee855_cgraph" alt=""/></div>
<map name="tortls_8c_a21a637d49c20f40551fab123341ee855_cgraph" id="tortls_8c_a21a637d49c20f40551fab123341ee855_cgraph">
<area shape="rect" id="node2" href="compat_8c.html#adbf52deccd4f2b9244d6911488b907f3" title="set_uint16" alt="" coords="176,5,259,32"/>
</map>
</div>

</div>
</div>
<a id="ac50648346a7461e7e16cfcb3d0998a64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac50648346a7461e7e16cfcb3d0998a64">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[1/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC X509 *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_tls_create_certificate&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(<a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *rsa, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *rsa_sign, const char *cname, const char *cname_sign, unsigned int cert_lifetime)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate and sign an X509 certificate with the public key <b>rsa</b>, signed by the private key <b>rsa_sign</b>. The commonName of the certificate will be <b>cname</b>; the commonName of the issuer will be <b>cname_sign</b>. The cert will be valid for <b>cert_lifetime</b> seconds, starting from some time in the past.</p>
<p>Return a certificate on success, NULL on failure. </p>

</div>
</div>
<a id="aafa992ad5321d733430656f683c23387"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafa992ad5321d733430656f683c23387">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[2/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC tor_x509_cert_t *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_x509_cert_new&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(X509 *x509_cert)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate a new tor_x509_cert_t to hold the certificate "x509_cert".</p>
<p>Steals a reference to x509_cert. </p>

</div>
</div>
<a id="ad355a1780bc2ed2dac97586713a40447"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad355a1780bc2ed2dac97586713a40447">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[3/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_tls_cert_matches_key&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(const tor_tls_t *tls, const tor_x509_cert_t *cert)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff the other side of <b>tls</b> has authenticated to us, and the key certified in <b>cert</b> is the same as the key they used to do it. </p>

</div>
</div>
<a id="aa34410a913d12aff35c6df7c9d558e6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa34410a913d12aff35c6df7c9d558e6e">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[4/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_tls_read&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(tor_tls_t *tls, char *cp, size_t len)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Underlying function for TLS reading. Reads up to <b>len</b> characters from <b>tls</b> into <b>cp</b>. On success, returns the number of characters read. On failure, returns TOR_TLS_ERROR, TOR_TLS_CLOSE, TOR_TLS_WANTREAD, or TOR_TLS_WANTWRITE. </p>

</div>
</div>
<a id="a631d2a19bd52d1de8194b24da85c3317"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a631d2a19bd52d1de8194b24da85c3317">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[5/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">tor_x509_cert_t *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_tls_get_peer_cert&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(tor_tls_t *tls)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a newly allocated copy of the peer certificate, or NULL if there isn't one. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a631d2a19bd52d1de8194b24da85c3317_cgraph.png" border="0" usemap="#tortls_8c_a631d2a19bd52d1de8194b24da85c3317_cgraph" alt=""/></div>
<map name="tortls_8c_a631d2a19bd52d1de8194b24da85c3317_cgraph" id="tortls_8c_a631d2a19bd52d1de8194b24da85c3317_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#adc2406721ee63472828ecc962767ebe2" title="tls_log_errors" alt="" coords="153,5,253,32"/>
<area shape="rect" id="node3" href="tortls_8c.html#ad9a5eb99512347313d8f3495168a1501" title="tor_tls_log_one_error" alt="" coords="301,5,444,32"/>
<area shape="rect" id="node4" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="492,5,553,32"/>
</map>
</div>

</div>
</div>
<a id="a97b1047e5a7253e677fb549a9d2910c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97b1047e5a7253e677fb549a9d2910c3">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[6/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">tor_x509_cert_t *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_tls_get_own_cert&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(tor_tls_t *tls)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a newly allocated copy of the cerficate we used on the connection, or NULL if somehow we didn't use one. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a97b1047e5a7253e677fb549a9d2910c3_cgraph.png" border="0" usemap="#tortls_8c_a97b1047e5a7253e677fb549a9d2910c3_cgraph" alt=""/></div>
<map name="tortls_8c_a97b1047e5a7253e677fb549a9d2910c3_cgraph" id="tortls_8c_a97b1047e5a7253e677fb549a9d2910c3_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#adc2406721ee63472828ecc962767ebe2" title="tls_log_errors" alt="" coords="153,5,253,32"/>
<area shape="rect" id="node3" href="tortls_8c.html#ad9a5eb99512347313d8f3495168a1501" title="tor_tls_log_one_error" alt="" coords="301,5,444,32"/>
<area shape="rect" id="node4" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="492,5,553,32"/>
</map>
</div>

</div>
</div>
<a id="afa6f172724874c8eadf30664594c48a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa6f172724874c8eadf30664594c48a1">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[7/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC&#160;</td>
          <td class="paramname"><em>void</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">try_to_extract_certs_from_tls&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(int severity, tor_tls_t *tls, X509 **cert_out, X509 **id_cert_out)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function: try to extract a link certificate and an identity certificate from <b>tls</b>, and store them in *<b>cert_out</b> and *<b>id_cert_out</b> respectively. Log all messages at level <b>severity</b>.</p>
<p>Note that a reference is added to cert_out, so it needs to be freed. id_cert_out doesn't. </p>

</div>
</div>
<a id="a0a4312bcca2c2fa92120225aa44b32e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a4312bcca2c2fa92120225aa44b32e0">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[8/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tls_get_write_overhead_ratio&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(void)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a ratio of the bytes that TLS has sent to the bytes that we've told it to send. Used to track whether our TLS records are getting too tiny. </p>

</div>
</div>
<a id="a0cdc403d61257cf30593a0084910587d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cdc403d61257cf30593a0084910587d">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[9/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_tls_get_tlssecrets&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(tor_tls_t *tls, uint8_t *secrets_out)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the DIGEST256_LEN buffer at <b>secrets_out</b> to the value used in the v3 handshake to prove that the client knows the TLS secrets for the connection <b>tls</b>. Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="aa9230eaa3952409a4fc289e2bdb059cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9230eaa3952409a4fc289e2bdb059cf">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[10/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_tls_export_key_material&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(tor_tls_t *tls, uint8_t *secrets_out, const uint8_t *context, size_t context_len, const char *label)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Using the RFC5705 key material exporting construction, and the provided <b>context</b> (<b>context_len</b> bytes long) and <b>label</b> (a NUL-terminated string), compute a 32-byte secret in <b>secrets_out</b> that only the parties to this TLS session can compute. Return 0 on success and -1 on failure. </p>

</div>
</div>
<a id="adc2406721ee63472828ecc962767ebe2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc2406721ee63472828ecc962767ebe2">&#9670;&nbsp;</a></span>tls_log_errors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void tls_log_errors </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>doing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log all pending tls errors at level <b>severity</b> in log domain <b>domain</b>. Use <b>doing</b> to describe our current activities. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_adc2406721ee63472828ecc962767ebe2_cgraph.png" border="0" usemap="#tortls_8c_adc2406721ee63472828ecc962767ebe2_cgraph" alt=""/></div>
<map name="tortls_8c_adc2406721ee63472828ecc962767ebe2_cgraph" id="tortls_8c_adc2406721ee63472828ecc962767ebe2_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#ad9a5eb99512347313d8f3495168a1501" title="tor_tls_log_one_error" alt="" coords="153,5,296,32"/>
<area shape="rect" id="node3" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="344,5,405,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_adc2406721ee63472828ecc962767ebe2_icgraph.png" border="0" usemap="#tortls_8c_adc2406721ee63472828ecc962767ebe2_icgraph" alt=""/></div>
<map name="tortls_8c_adc2406721ee63472828ecc962767ebe2_icgraph" id="tortls_8c_adc2406721ee63472828ecc962767ebe2_icgraph">
<area shape="rect" id="node2" href="tortls_8h.html#a13025f3a8714b2c00a7b7d0842fc5694" title="tor_tls_peer_has_cert" alt="" coords="153,5,300,32"/>
<area shape="rect" id="node3" href="tortls_8c.html#a631d2a19bd52d1de8194b24da85c3317" title="MOCK_IMPL" alt="" coords="177,56,277,83"/>
</map>
</div>

</div>
</div>
<a id="ad234b50af0b367035847da6efd9f86f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad234b50af0b367035847da6efd9f86f9">&#9670;&nbsp;</a></span>tor_errno_to_tls_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int tor_errno_to_tls_error </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert an errno (or a WSAerrno on windows) into a TOR_TLS_* error code. </p>

</div>
</div>
<a id="a6131d58b34012459b006188b6ecc951b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6131d58b34012459b006188b6ecc951b">&#9670;&nbsp;</a></span>tor_tls_allocate_tor_tls_object_ex_data_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void tor_tls_allocate_tor_tls_object_ex_data_index </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: Allocate tor_tls_object_ex_data_index. </p>

</div>
</div>
<a id="a56d9241115f8182cbdb26be9756f25fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56d9241115f8182cbdb26be9756f25fb">&#9670;&nbsp;</a></span>tor_tls_assert_renegotiation_unblocked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_assert_renegotiation_unblocked </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assert that the flags that allow legacy renegotiation are still set </p>

</div>
</div>
<a id="a08342968552b84d5dfbd6493338f6058"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08342968552b84d5dfbd6493338f6058">&#9670;&nbsp;</a></span>tor_tls_block_renegotiation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_block_renegotiation </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If this version of openssl supports it, turn off renegotiation on <b>tls</b>. (Our protocol never requires this for security, but it's nice to use belt-and-suspenders here.) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a08342968552b84d5dfbd6493338f6058_icgraph.png" border="0" usemap="#tortls_8c_a08342968552b84d5dfbd6493338f6058_icgraph" alt=""/></div>
<map name="tortls_8c_a08342968552b84d5dfbd6493338f6058_icgraph" id="tortls_8c_a08342968552b84d5dfbd6493338f6058_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#aecfd6590f4dd5c079f371e48eb1e09f2" title="connection_or_block\l_renegotiation" alt="" coords="231,5,372,47"/>
</map>
</div>

</div>
</div>
<a id="a4cdf67e68f80f5bef7c52a5964416024"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cdf67e68f80f5bef7c52a5964416024">&#9670;&nbsp;</a></span>tor_tls_cert_get_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a>* tor_tls_cert_get_key </td>
          <td>(</td>
          <td class="paramtype">tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a newly allocated copy of the public key that a certificate certifies. Watch out! This returns NULL if the cert's key is not RSA. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a4cdf67e68f80f5bef7c52a5964416024_cgraph.png" border="0" usemap="#tortls_8c_a4cdf67e68f80f5bef7c52a5964416024_cgraph" alt=""/></div>
<map name="tortls_8c_a4cdf67e68f80f5bef7c52a5964416024_cgraph" id="tortls_8c_a4cdf67e68f80f5bef7c52a5964416024_cgraph">
<area shape="rect" id="node2" href="crypto__rsa_8c.html#a1218ae18907870b5eba2e014006c41e3" title="crypto_new_pk_from_rsa_" alt="" coords="193,5,368,32"/>
</map>
</div>

</div>
</div>
<a id="a805d08ed945976a2b66c748073be0abc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a805d08ed945976a2b66c748073be0abc">&#9670;&nbsp;</a></span>tor_tls_cert_is_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_cert_is_valid </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>signing_cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>check_rsa_1024</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether <b>cert</b> is well-formed, currently live, and correctly signed by the public key in <b>signing_cert</b>. If <b>check_rsa_1024</b>, make sure that it has an RSA key with 1024 bits; otherwise, just check that the key is long enough. Return 1 if the cert is good, and 0 if it's bad or we couldn't check it. </p>

</div>
</div>
<a id="a7493fe8a822f0ef8d46980439882fbb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7493fe8a822f0ef8d46980439882fbb1">&#9670;&nbsp;</a></span>tor_tls_check_lifetime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_check_lifetime </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>past_tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>future_tolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether the certificate set on the connection <b>tls</b> is expired give or take <b>past_tolerance</b> seconds, or not-yet-valid give or take <b>future_tolerance</b> seconds. Return 0 for valid, -1 for failure.</p>
<p>NOTE: you should call tor_tls_verify before tor_tls_check_lifetime. </p>

</div>
</div>
<a id="a33df6ed8c10ec9fa4c63ab44755c743c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33df6ed8c10ec9fa4c63ab44755c743c">&#9670;&nbsp;</a></span>tor_tls_classify_client_ciphers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int tor_tls_classify_client_ciphers </td>
          <td>(</td>
          <td class="paramtype">const SSL *&#160;</td>
          <td class="paramname"><em>ssl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">STACK_OF(SSL_CIPHER) *&#160;</td>
          <td class="paramname"><em>peer_ciphers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Examine the client cipher list in <b>ssl</b>, and determine what kind of client it is. Return one of CIPHERS_ERR, CIPHERS_V1, CIPHERS_V2, CIPHERS_UNRESTRICTED. </p>

</div>
</div>
<a id="ad056e06ade9276639ff4651e329d84f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad056e06ade9276639ff4651e329d84f8">&#9670;&nbsp;</a></span>tor_tls_client_is_using_v2_ciphers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int tor_tls_client_is_using_v2_ciphers </td>
          <td>(</td>
          <td class="paramtype">const SSL *&#160;</td>
          <td class="paramname"><em>ssl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff the cipher list suggested by the client for <b>ssl</b> is a list that indicates that the client knows how to do the v2 TLS connection handshake. </p>

</div>
</div>
<a id="a18b7b628cbb659c7899ef90e58abb559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18b7b628cbb659c7899ef90e58abb559">&#9670;&nbsp;</a></span>tor_tls_context_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_context_init </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>client_identity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>server_identity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>key_lifetime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create new global client and server TLS contexts.</p>
<p>If <b>server_identity</b> is NULL, this will not generate a server TLS context. If TOR_TLS_CTX_IS_PUBLIC_SERVER is set in <b>flags</b>, use the same TLS context for incoming and outgoing connections, and ignore <b>client_identity</b>. If one of TOR_TLS_CTX_USE_ECDHE_P{224,256} is set in <b>flags</b>, use that ECDHE group if possible; otherwise use the default ECDHE group. </p>

</div>
</div>
<a id="a5bf12ea45b278b5644c7b180a1170360"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bf12ea45b278b5644c7b180a1170360">&#9670;&nbsp;</a></span>tor_tls_context_init_one()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int tor_tls_context_init_one </td>
          <td>(</td>
          <td class="paramtype">tor_tls_context_t **&#160;</td>
          <td class="paramname"><em>ppcontext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>identity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>key_lifetime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_client</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new global TLS context.</p>
<p>You can call this function multiple times. Each time you call it, it generates new certificates; all new connections will use the new SSL context. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a5bf12ea45b278b5644c7b180a1170360_cgraph.png" border="0" usemap="#tortls_8c_a5bf12ea45b278b5644c7b180a1170360_cgraph" alt=""/></div>
<map name="tortls_8c_a5bf12ea45b278b5644c7b180a1170360_cgraph" id="tortls_8c_a5bf12ea45b278b5644c7b180a1170360_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#a34bd97b4e5d30b27c251d52a8151f44a" title="tor_tls_context_new" alt="" coords="213,5,352,32"/>
</map>
</div>

</div>
</div>
<a id="a34bd97b4e5d30b27c251d52a8151f44a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34bd97b4e5d30b27c251d52a8151f44a">&#9670;&nbsp;</a></span>tor_tls_context_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC tor_tls_context_t* tor_tls_context_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>identity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>key_lifetime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_client</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new TLS context for use with Tor TLS handshakes. <b>identity</b> should be set to the identity key used to sign the certificate. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a34bd97b4e5d30b27c251d52a8151f44a_icgraph.png" border="0" usemap="#tortls_8c_a34bd97b4e5d30b27c251d52a8151f44a_icgraph" alt=""/></div>
<map name="tortls_8c_a34bd97b4e5d30b27c251d52a8151f44a_icgraph" id="tortls_8c_a34bd97b4e5d30b27c251d52a8151f44a_icgraph">
<area shape="rect" id="node2" href="tortls_8c.html#a5bf12ea45b278b5644c7b180a1170360" title="tor_tls_context_init_one" alt="" coords="192,5,352,32"/>
</map>
</div>

</div>
</div>
<a id="a6f66b1039c2f3e00e4d4602f19d5ab02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f66b1039c2f3e00e4d4602f19d5ab02">&#9670;&nbsp;</a></span>tor_tls_debug_state_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void tor_tls_debug_state_callback </td>
          <td>(</td>
          <td class="paramtype">const SSL *&#160;</td>
          <td class="paramname"><em>ssl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Invoked when a TLS state changes: log the change at severity 'debug' </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a6f66b1039c2f3e00e4d4602f19d5ab02_icgraph.png" border="0" usemap="#tortls_8c_a6f66b1039c2f3e00e4d4602f19d5ab02_icgraph" alt=""/></div>
<map name="tortls_8c_a6f66b1039c2f3e00e4d4602f19d5ab02_icgraph" id="tortls_8c_a6f66b1039c2f3e00e4d4602f19d5ab02_icgraph">
<area shape="rect" id="node2" href="tortls_8h.html#a5823cfa710f0f7987d09dfececae28d0" title="tor_tls_set_renegotiate\l_callback" alt="" coords="189,5,344,47"/>
<area shape="rect" id="node3" href="connection__or_8h.html#aecfd6590f4dd5c079f371e48eb1e09f2" title="connection_or_block\l_renegotiation" alt="" coords="392,5,533,47"/>
</map>
</div>

</div>
</div>
<a id="ab51ce122d6957eed72dfad975600bca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab51ce122d6957eed72dfad975600bca7">&#9670;&nbsp;</a></span>tor_tls_err_to_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* tor_tls_err_to_string </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>err</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a TOR_TLS_* error code, return a string equivalent. </p>

</div>
</div>
<a id="abf727dd8275cc9deb3d1b71c110b8d6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf727dd8275cc9deb3d1b71c110b8d6e">&#9670;&nbsp;</a></span>tor_tls_finish_handshake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_finish_handshake </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform the final part of the initial TLS handshake on <b>tls</b>. This should be called for the first handshake only: it determines whether the v1 or the v2 handshake was used, and adjusts things for the renegotiation handshake as appropriate.</p>
<p><a class="el" href="tortls_8c.html#ab228adf4f9dbd0f8739a657ea66f389e">tor_tls_handshake()</a> calls this on its own; you only need to call this if bufferevent is doing the handshake for you. </p>

</div>
</div>
<a id="a6f5a528cdb3b8cb9ce04b40bb899dbeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f5a528cdb3b8cb9ce04b40bb899dbeb">&#9670;&nbsp;</a></span>tor_tls_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_free_ </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release resources associated with a TLS object. Does not close the underlying file descriptor. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a6f5a528cdb3b8cb9ce04b40bb899dbeb_cgraph.png" border="0" usemap="#tortls_8c_a6f5a528cdb3b8cb9ce04b40bb899dbeb_cgraph" alt=""/></div>
<map name="tortls_8c_a6f5a528cdb3b8cb9ce04b40bb899dbeb_cgraph" id="tortls_8c_a6f5a528cdb3b8cb9ce04b40bb899dbeb_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#a2052799333f0e6afd56d3a3fc640d879" title="tor_tls_get_n_raw_bytes" alt="" coords="148,5,312,32"/>
</map>
</div>

</div>
</div>
<a id="ae8e5980912c517c20c6b90419ef0c3b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8e5980912c517c20c6b90419ef0c3b6">&#9670;&nbsp;</a></span>tor_tls_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all global TLS structures. </p>

</div>
</div>
<a id="a6fef8380f402b3e300d756a828ba9d56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fef8380f402b3e300d756a828ba9d56">&#9670;&nbsp;</a></span>tor_tls_get_buffer_sizes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_get_buffer_sizes </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>rbuf_capacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>rbuf_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>wbuf_capacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>wbuf_bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Examine the amount of memory used and available for buffers in <b>tls</b>. Set *<b>rbuf_capacity</b> to the amount of storage allocated for the read buffer and *<b>rbuf_bytes</b> to the amount actually used. Set *<b>wbuf_capacity</b> to the amount of storage allocated for the write buffer and *<b>wbuf_bytes</b> to the amount actually used.</p>
<p>Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="a3e24642f99d95d664c8e97116ec368a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e24642f99d95d664c8e97116ec368a4">&#9670;&nbsp;</a></span>tor_tls_get_by_ssl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC tor_tls_t* tor_tls_get_by_ssl </td>
          <td>(</td>
          <td class="paramtype">const SSL *&#160;</td>
          <td class="paramname"><em>ssl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: given a SSL* pointer, return the tor_tls_t object using that pointer. </p>

</div>
</div>
<a id="ae4c6052b8b597bc4c9ca00e4554798cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4c6052b8b597bc4c9ca00e4554798cc">&#9670;&nbsp;</a></span>tor_tls_get_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int tor_tls_get_error </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>extra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>doing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a TLS object and the result of an SSL_* call, use SSL_get_error to determine whether an error has occurred, and if so which one. Return one of TOR_TLS_{DONE|WANTREAD|WANTWRITE|ERROR}. If extra&amp;CATCH_SYSCALL is true, return TOR_TLS_SYSCALL_ instead of reporting syscall errors. If extra&amp;CATCH_ZERO is true, return TOR_TLS_ZERORETURN_ instead of reporting zero-return errors.</p>
<p>If an error has occurred, log it at level <b>severity</b> and describe the current action as <b>doing</b>. </p>

</div>
</div>
<a id="afc7afb97a99f6f7664a9ced2b8baab54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc7afb97a99f6f7664a9ced2b8baab54">&#9670;&nbsp;</a></span>tor_tls_get_forced_write_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t tor_tls_get_forced_write_size </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If <b>tls</b> requires that the next write be of a particular size, return that size. Otherwise, return 0. </p>

</div>
</div>
<a id="a7aa93459dd4e3641e885932d682db4a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aa93459dd4e3641e885932d682db4a0">&#9670;&nbsp;</a></span>tor_tls_get_my_certs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_get_my_certs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>server</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tor_x509_cert_t **&#160;</td>
          <td class="paramname"><em>link_cert_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tor_x509_cert_t **&#160;</td>
          <td class="paramname"><em>id_cert_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set *<b>link_cert_out</b> and *<b>id_cert_out</b> to the link certificate and ID certificate that we're currently using for our V3 in-protocol handshake's certificate chain. If <b>server</b> is true, provide the certs that we use in server mode (auth, ID); otherwise, provide the certs that we use in client mode. (link, ID) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a7aa93459dd4e3641e885932d682db4a0_icgraph.png" border="0" usemap="#tortls_8c_a7aa93459dd4e3641e885932d682db4a0_icgraph" alt=""/></div>
<map name="tortls_8c_a7aa93459dd4e3641e885932d682db4a0_icgraph" id="tortls_8c_a7aa93459dd4e3641e885932d682db4a0_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#a373bc2ce63f7b8a6530d1b16e420f7c4" title="connection_or_send\l_certs_cell" alt="" coords="209,5,348,47"/>
<area shape="rect" id="node3" href="connection__or_8h.html#a299125b246f5c829b4af2cef1efa7378" title="connection_or_compute\l_authenticate_cell_body" alt="" coords="197,71,360,112"/>
<area shape="rect" id="node4" href="routerkeys_8c.html#abebfd6b56ecfb14c8ef132e50485907e" title="generate_ed_link_cert" alt="" coords="204,137,353,163"/>
</map>
</div>

</div>
</div>
<a id="a7cc46ce9e214e2055861f7cacdfdfca2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cc46ce9e214e2055861f7cacdfdfca2">&#9670;&nbsp;</a></span>tor_tls_get_my_client_auth_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a>* tor_tls_get_my_client_auth_key </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the authentication key that we use to authenticate ourselves as a client in the V3 in-protocol handshake. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a7cc46ce9e214e2055861f7cacdfdfca2_icgraph.png" border="0" usemap="#tortls_8c_a7cc46ce9e214e2055861f7cacdfdfca2_icgraph" alt=""/></div>
<map name="tortls_8c_a7cc46ce9e214e2055861f7cacdfdfca2_icgraph" id="tortls_8c_a7cc46ce9e214e2055861f7cacdfdfca2_icgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a0e89fff0e71d905b83cae2583a7bc49f" title="MOCK_IMPL" alt="" coords="200,13,300,39"/>
</map>
</div>

</div>
</div>
<a id="a2052799333f0e6afd56d3a3fc640d879"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2052799333f0e6afd56d3a3fc640d879">&#9670;&nbsp;</a></span>tor_tls_get_n_raw_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_get_n_raw_bytes </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>n_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>n_written</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets n_read and n_written to the number of bytes read and written, respectively, on the raw socket used by <b>tls</b> since the last time this function was called on <b>tls</b>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a2052799333f0e6afd56d3a3fc640d879_icgraph.png" border="0" usemap="#tortls_8c_a2052799333f0e6afd56d3a3fc640d879_icgraph" alt=""/></div>
<map name="tortls_8c_a2052799333f0e6afd56d3a3fc640d879_icgraph" id="tortls_8c_a2052799333f0e6afd56d3a3fc640d879_icgraph">
<area shape="rect" id="node2" href="tortls_8h.html#a6f5a528cdb3b8cb9ce04b40bb899dbeb" title="tor_tls_free_" alt="" coords="217,5,312,32"/>
</map>
</div>

</div>
</div>
<a id="aa1a40e31028963e83e7a7b44199432b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1a40e31028963e83e7a7b44199432b1">&#9670;&nbsp;</a></span>tor_tls_get_num_server_handshakes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_get_num_server_handshakes </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of server handshakes that we've noticed doing on <b>tls</b>. </p>

</div>
</div>
<a id="aaeaf421de8fd8d7d4d3bad71272bfc4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeaf421de8fd8d7d4d3bad71272bfc4e">&#9670;&nbsp;</a></span>tor_tls_get_pending_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_get_pending_bytes </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of bytes available for reading from <b>tls</b>. </p>

</div>
</div>
<a id="aefdead64da19ca5d4ee7cb9b60a7ab13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefdead64da19ca5d4ee7cb9b60a7ab13">&#9670;&nbsp;</a></span>tor_tls_get_state_description()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_get_state_description </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write a description of the current state of <b>tls</b> into the <b>sz</b>-byte buffer at <b>buf</b>. </p>

</div>
</div>
<a id="ab228adf4f9dbd0f8739a657ea66f389e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab228adf4f9dbd0f8739a657ea66f389e">&#9670;&nbsp;</a></span>tor_tls_handshake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_handshake </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform initial handshake on <b>tls</b>. When finished, returns TOR_TLS_DONE. On failure, returns TOR_TLS_ERROR, TOR_TLS_WANTREAD, or TOR_TLS_WANTWRITE. </p>

</div>
</div>
<a id="a89dbecf04240626af4b070b1b83c9f56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89dbecf04240626af4b070b1b83c9f56">&#9670;&nbsp;</a></span>tor_tls_is_server()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_is_server </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return whether this tls initiated the connect (client) or received it (server). </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a89dbecf04240626af4b070b1b83c9f56_icgraph.png" border="0" usemap="#tortls_8c_a89dbecf04240626af4b070b1b83c9f56_icgraph" alt=""/></div>
<map name="tortls_8c_a89dbecf04240626af4b070b1b83c9f56_icgraph" id="tortls_8c_a89dbecf04240626af4b070b1b83c9f56_icgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a9874fc9cd6f255b931cbbcfc534702b7" title="connection_or_nonopen\l_was_started_here" alt="" coords="172,5,331,47"/>
</map>
</div>

</div>
</div>
<a id="ad9a5eb99512347313d8f3495168a1501"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9a5eb99512347313d8f3495168a1501">&#9670;&nbsp;</a></span>tor_tls_log_one_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_log_one_error </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>err</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>doing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log a single error <b>err</b> as returned by ERR_get_error(), which was received while performing an operation <b>doing</b> on <b>tls</b>. Log the message at <b>severity</b>, in log domain <b>domain</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_ad9a5eb99512347313d8f3495168a1501_cgraph.png" border="0" usemap="#tortls_8c_ad9a5eb99512347313d8f3495168a1501_cgraph" alt=""/></div>
<map name="tortls_8c_ad9a5eb99512347313d8f3495168a1501_cgraph" id="tortls_8c_ad9a5eb99512347313d8f3495168a1501_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="196,5,257,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_ad9a5eb99512347313d8f3495168a1501_icgraph.png" border="0" usemap="#tortls_8c_ad9a5eb99512347313d8f3495168a1501_icgraph" alt=""/></div>
<map name="tortls_8c_ad9a5eb99512347313d8f3495168a1501_icgraph" id="tortls_8c_ad9a5eb99512347313d8f3495168a1501_icgraph">
<area shape="rect" id="node2" href="tortls_8c.html#adc2406721ee63472828ecc962767ebe2" title="tls_log_errors" alt="" coords="196,31,296,57"/>
<area shape="rect" id="node3" href="tortls_8h.html#a13025f3a8714b2c00a7b7d0842fc5694" title="tor_tls_peer_has_cert" alt="" coords="344,5,491,32"/>
<area shape="rect" id="node4" href="tortls_8c.html#a631d2a19bd52d1de8194b24da85c3317" title="MOCK_IMPL" alt="" coords="367,56,467,83"/>
</map>
</div>

</div>
</div>
<a id="a0369a39c5458674c1d2f77daaf0a402a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0369a39c5458674c1d2f77daaf0a402a">&#9670;&nbsp;</a></span>tor_tls_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tor_tls_t* tor_tls_new </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isServer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new TLS object from a file descriptor, and a flag to determine whether it is functioning as a server. </p>

</div>
</div>
<a id="a13025f3a8714b2c00a7b7d0842fc5694"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13025f3a8714b2c00a7b7d0842fc5694">&#9670;&nbsp;</a></span>tor_tls_peer_has_cert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_peer_has_cert </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff this TLS connection is authenticated. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a13025f3a8714b2c00a7b7d0842fc5694_cgraph.png" border="0" usemap="#tortls_8c_a13025f3a8714b2c00a7b7d0842fc5694_cgraph" alt=""/></div>
<map name="tortls_8c_a13025f3a8714b2c00a7b7d0842fc5694_cgraph" id="tortls_8c_a13025f3a8714b2c00a7b7d0842fc5694_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#adc2406721ee63472828ecc962767ebe2" title="tls_log_errors" alt="" coords="200,5,300,32"/>
<area shape="rect" id="node3" href="tortls_8c.html#ad9a5eb99512347313d8f3495168a1501" title="tor_tls_log_one_error" alt="" coords="348,5,491,32"/>
<area shape="rect" id="node4" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="539,5,600,32"/>
</map>
</div>

</div>
</div>
<a id="a02131f4d24082f726fbc9b93a5adcf50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02131f4d24082f726fbc9b93a5adcf50">&#9670;&nbsp;</a></span>tor_tls_server_got_renegotiate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_server_got_renegotiate </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff the server TLS connection <b>tls</b> got the renegotiation request it was waiting for. </p>

</div>
</div>
<a id="a3b0c0880a231328e1b5d7faa01fddcd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b0c0880a231328e1b5d7faa01fddcd9">&#9670;&nbsp;</a></span>tor_tls_server_info_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void tor_tls_server_info_callback </td>
          <td>(</td>
          <td class="paramtype">const SSL *&#160;</td>
          <td class="paramname"><em>ssl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Invoked when we're accepting a connection on <b>ssl</b>, and the connection changes state. We use this: </p><ul>
<li>
To alter the state of the handshake partway through, so we do not send or request extra certificates in v2 handshakes. </li>
<li>
To detect renegotiation</li>
</ul>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a3b0c0880a231328e1b5d7faa01fddcd9_icgraph.png" border="0" usemap="#tortls_8c_a3b0c0880a231328e1b5d7faa01fddcd9_icgraph" alt=""/></div>
<map name="tortls_8c_a3b0c0880a231328e1b5d7faa01fddcd9_icgraph" id="tortls_8c_a3b0c0880a231328e1b5d7faa01fddcd9_icgraph">
<area shape="rect" id="node2" href="tortls_8h.html#a5823cfa710f0f7987d09dfececae28d0" title="tor_tls_set_renegotiate\l_callback" alt="" coords="183,5,337,47"/>
<area shape="rect" id="node3" href="connection__or_8h.html#aecfd6590f4dd5c079f371e48eb1e09f2" title="connection_or_block\l_renegotiation" alt="" coords="385,5,527,47"/>
</map>
</div>

</div>
</div>
<a id="a1a4651c67d3abf08e25cb819910b0c9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a4651c67d3abf08e25cb819910b0c9b">&#9670;&nbsp;</a></span>tor_tls_session_secret_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int tor_tls_session_secret_cb </td>
          <td>(</td>
          <td class="paramtype">SSL *&#160;</td>
          <td class="paramname"><em>ssl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>secret_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">STACK_OF(SSL_CIPHER) *&#160;</td>
          <td class="paramname"><em>peer_ciphers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST_IF_OPENSSL_1_1_API SSL_CIPHER **&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Callback to get invoked on a server after we've read the list of ciphers the client supports, but before we pick our own ciphersuite.</p>
<p>We can't abuse an info_cb for this, since by the time one of the client_hello info_cbs is called, we've already picked which ciphersuite to use.</p>
<p>Technically, this function is an abuse of this callback, since the point of a session_secret_cb is to try to set up and/or verify a shared-secret for authentication on the fly. But as long as we return 0, we won't actually be setting up a shared secret, and all will be fine. </p>

</div>
</div>
<a id="aa0e67c6afa29e8932b6908f1e21f5124"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0e67c6afa29e8932b6908f1e21f5124">&#9670;&nbsp;</a></span>tor_tls_set_logged_address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_set_logged_address </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make future log messages about <b>tls</b> display the address <b>address</b>. </p>

</div>
</div>
<a id="a5823cfa710f0f7987d09dfececae28d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5823cfa710f0f7987d09dfececae28d0">&#9670;&nbsp;</a></span>tor_tls_set_renegotiate_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_set_renegotiate_callback </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(tor_tls_t *, void *arg)&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>cb</b> to be called with argument <b>arg</b> whenever <b>tls</b> next gets a client-side renegotiate in the middle of a read. Do not invoke this function until <em>after</em> initial handshaking is done! </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a5823cfa710f0f7987d09dfececae28d0_cgraph.png" border="0" usemap="#tortls_8c_a5823cfa710f0f7987d09dfececae28d0_cgraph" alt=""/></div>
<map name="tortls_8c_a5823cfa710f0f7987d09dfececae28d0_cgraph" id="tortls_8c_a5823cfa710f0f7987d09dfececae28d0_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#a3b0c0880a231328e1b5d7faa01fddcd9" title="tor_tls_server_info\l_callback" alt="" coords="211,5,341,47"/>
<area shape="rect" id="node3" href="tortls_8c.html#a6f66b1039c2f3e00e4d4602f19d5ab02" title="tor_tls_debug_state\l_callback" alt="" coords="208,71,344,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_a5823cfa710f0f7987d09dfececae28d0_icgraph.png" border="0" usemap="#tortls_8c_a5823cfa710f0f7987d09dfececae28d0_icgraph" alt=""/></div>
<map name="tortls_8c_a5823cfa710f0f7987d09dfececae28d0_icgraph" id="tortls_8c_a5823cfa710f0f7987d09dfececae28d0_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#aecfd6590f4dd5c079f371e48eb1e09f2" title="connection_or_block\l_renegotiation" alt="" coords="208,5,349,47"/>
</map>
</div>

</div>
</div>
<a id="a30918c11f14636a0a5027c76a0ae8498"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30918c11f14636a0a5027c76a0ae8498">&#9670;&nbsp;</a></span>tor_tls_shutdown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_shutdown </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Shut down an open tls connection <b>tls</b>. When finished, returns TOR_TLS_DONE. On failure, returns TOR_TLS_ERROR, TOR_TLS_WANTREAD, or TOR_TLS_WANTWRITE. </p>

</div>
</div>
<a id="a2daac9018a16ea061a2429f171c25245"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2daac9018a16ea061a2429f171c25245">&#9670;&nbsp;</a></span>tor_tls_unblock_renegotiation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_unblock_renegotiation </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If this version of openssl requires it, turn on renegotiation on <b>tls</b>. </p>

</div>
</div>
<a id="a1df770dd394f7ab33f134583c3385cd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1df770dd394f7ab33f134583c3385cd0">&#9670;&nbsp;</a></span>tor_tls_used_v1_handshake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_used_v1_handshake </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff the initial TLS connection at <b>tls</b> did not use a v2 TLS handshake. Output is undefined if the handshake isn't finished. </p>

</div>
</div>
<a id="a05ab54f8371c33d1f9ff9484ffad2732"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05ab54f8371c33d1f9ff9484ffad2732">&#9670;&nbsp;</a></span>tor_tls_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_verify </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> **&#160;</td>
          <td class="paramname"><em>identity_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If the provided tls connection is authenticated and has a certificate chain that is currently valid and signed, then set *<b>identity_key</b> to the identity certificate's key and return 0. Else, return -1 and log complaints with log-level <b>severity</b>. </p>

</div>
</div>
<a id="a5f79960ae7a36ce6647ceafd36c7e162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f79960ae7a36ce6647ceafd36c7e162">&#9670;&nbsp;</a></span>tor_tls_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_write </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Underlying function for TLS writing. Write up to <b>n</b> characters from <b>cp</b> onto <b>tls</b>. On success, returns the number of characters written. On failure, returns TOR_TLS_ERROR, TOR_TLS_WANTREAD, or TOR_TLS_WANTWRITE. </p>

</div>
</div>
<a id="aea5999c1b596c9c571889386f8bc508c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea5999c1b596c9c571889386f8bc508c">&#9670;&nbsp;</a></span>tor_x509_cert_decode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tor_x509_cert_t* tor_x509_cert_decode </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>certificate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>certificate_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read a DER-encoded X509 cert, of length exactly <b>certificate_len</b>, from a <b>certificate</b>. Return a newly allocated tor_x509_cert_t on success and NULL on failure. </p>

</div>
</div>
<a id="a01200614cea5495e3bf7ff1b9157811c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01200614cea5495e3bf7ff1b9157811c">&#9670;&nbsp;</a></span>tor_x509_cert_dup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tor_x509_cert_t* tor_x509_cert_dup </td>
          <td>(</td>
          <td class="paramtype">const tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a new copy of <b>cert</b>. </p>

</div>
</div>
<a id="af396dc12cfe27527a145727f28bbbe62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af396dc12cfe27527a145727f28bbbe62">&#9670;&nbsp;</a></span>tor_x509_cert_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_x509_cert_free_ </td>
          <td>(</td>
          <td class="paramtype">tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all storage held in <b>cert</b> </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_af396dc12cfe27527a145727f28bbbe62_cgraph.png" border="0" usemap="#tortls_8c_af396dc12cfe27527a145727f28bbbe62_cgraph" alt=""/></div>
<map name="tortls_8c_af396dc12cfe27527a145727f28bbbe62_cgraph" id="tortls_8c_af396dc12cfe27527a145727f28bbbe62_cgraph">
<area shape="rect" id="node2" href="crypto__util_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="191,5,269,32"/>
</map>
</div>

</div>
</div>
<a id="a5904272a0bc1d95951b5a0aa4903cc05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5904272a0bc1d95951b5a0aa4903cc05">&#9670;&nbsp;</a></span>tor_x509_cert_get_cert_digests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structcommon__digests__t.html">common_digests_t</a>* tor_x509_cert_get_cert_digests </td>
          <td>(</td>
          <td class="paramtype">const tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a set of digests for the public key in <b>cert</b>. </p>

</div>
</div>
<a id="ae138ea45f150f1291b09f0b5dfa34ad4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae138ea45f150f1291b09f0b5dfa34ad4">&#9670;&nbsp;</a></span>tor_x509_cert_get_der()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_x509_cert_get_der </td>
          <td>(</td>
          <td class="paramtype">const tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t **&#160;</td>
          <td class="paramname"><em>encoded_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>size_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set *<b>encoded_out</b> and *<b>size_out</b> to <b>cert</b>'s encoded DER representation and length, respectively. </p>

</div>
</div>
<a id="aeb4713a168234b69a9d25312a3a15770"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb4713a168234b69a9d25312a3a15770">&#9670;&nbsp;</a></span>tor_x509_cert_get_id_digests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structcommon__digests__t.html">common_digests_t</a>* tor_x509_cert_get_id_digests </td>
          <td>(</td>
          <td class="paramtype">const tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a set of digests for the public key in <b>cert</b>, or NULL if this cert's public key is not one we know how to take the digest of. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8c_aeb4713a168234b69a9d25312a3a15770_icgraph.png" border="0" usemap="#tortls_8c_aeb4713a168234b69a9d25312a3a15770_icgraph" alt=""/></div>
<map name="tortls_8c_aeb4713a168234b69a9d25312a3a15770_icgraph" id="tortls_8c_aeb4713a168234b69a9d25312a3a15770_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#a299125b246f5c829b4af2cef1efa7378" title="connection_or_compute\l_authenticate_cell_body" alt="" coords="196,5,359,47"/>
<area shape="rect" id="node3" href="torcert_8c.html#acd16d9acb0ee87c596577d7e3c333f39" title="or_handshake_certs\l_check_both" alt="" coords="208,71,347,112"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ace791365ee344ba5b611c0ff9883a47e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace791365ee344ba5b611c0ff9883a47e">&#9670;&nbsp;</a></span>server_tls_context</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC tor_tls_context_t* server_tls_context = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Global TLS contexts. We keep them here because nobody else needs to touch them. </p>

</div>
</div>
<a id="a25442c05a47e1c53a73489104ca56594"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25442c05a47e1c53a73489104ca56594">&#9670;&nbsp;</a></span>tor_tls_object_ex_data_index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int tor_tls_object_ex_data_index = -1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The ex_data index in which we store a pointer to an SSL object's corresponding tor_tls_t object. </p>

</div>
</div>
<a id="a8c13934505a0e9665e1357c4d3e9f032"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c13934505a0e9665e1357c4d3e9f032">&#9670;&nbsp;</a></span>total_bytes_written_by_tls</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC uint64_t total_bytes_written_by_tls = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Total number of bytes that TLS has put on the network for us. Used to track TLS overhead. </p>

</div>
</div>
<a id="a35c4dfb99a0a17253ce2238cb9c6d15a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35c4dfb99a0a17253ce2238cb9c6d15a">&#9670;&nbsp;</a></span>total_bytes_written_over_tls</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC uint64_t total_bytes_written_over_tls = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Total number of bytes that we've used TLS to send. Used to track TLS overhead. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
