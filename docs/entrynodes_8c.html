<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/entrynodes.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">entrynodes.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Code to manage our fixed first nodes for various functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="channel_8h_source.html">channel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="bridges_8h_source.html">bridges.h</a>&quot;</code><br />
<code>#include &quot;circpathbias.h&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitbuild_8h_source.html">circuitbuild.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitlist_8h_source.html">circuitlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuituse_8h_source.html">circuituse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitstats_8h_source.html">circuitstats.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;confparse.h&quot;</code><br />
<code>#include &quot;<a class="el" href="connection_8h_source.html">connection.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="control_8h_source.html">control.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__rand_8h_source.html">crypto_rand.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="directory_8h_source.html">directory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="entrynodes_8h_source.html">entrynodes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="main_8h_source.html">main.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="microdesc_8h_source.html">microdesc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="networkstatus_8h_source.html">networkstatus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nodelist_8h_source.html">nodelist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="policies_8h_source.html">policies.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="router_8h_source.html">router.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerlist_8h_source.html">routerlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerparse_8h_source.html">routerparse.h</a>&quot;</code><br />
<code>#include &quot;routerset.h&quot;</code><br />
<code>#include &quot;<a class="el" href="transports_8h_source.html">transports.h</a>&quot;</code><br />
<code>#include &quot;statefile.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for entrynodes.c:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2entrynodes_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2entrynodes_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2entrynodes_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="1314,259,1358,285"/>
<area shape="rect" id="node23" href="channel_8h.html" title="Header file for channel.c. " alt="" coords="1215,109,1294,136"/>
<area shape="rect" id="node27" href="bridges_8h.html" title="Header file for circuitbuild.c. " alt="" coords="44,109,118,136"/>
<area shape="rect" id="node28" href="circpathbias_8h_source.html" title="circpathbias.h" alt="" coords="143,109,246,136"/>
<area shape="rect" id="node29" href="circuitbuild_8h.html" title="Header file for circuitbuild.c. " alt="" coords="270,109,364,136"/>
<area shape="rect" id="node30" href="circuitlist_8h.html" title="Header file for circuitlist.c. " alt="" coords="546,184,632,211"/>
<area shape="rect" id="node31" href="circuituse_8h.html" title="Header file for circuituse.c. " alt="" coords="440,109,530,136"/>
<area shape="rect" id="node32" href="circuitstats_8h.html" title="Header file for circuitstats.c. " alt="" coords="554,109,651,136"/>
<area shape="rect" id="node33" href="config_8h.html" title="Header file for config.c. " alt="" coords="75,259,143,285"/>
<area shape="rect" id="node34" href="confparse_8h_source.html" title="confparse.h" alt="" coords="726,109,817,136"/>
<area shape="rect" id="node35" href="connection_8h.html" title="Header file for connection.c. " alt="" coords="841,109,937,136"/>
<area shape="rect" id="node36" href="control_8h.html" title="Header file for control.c. " alt="" coords="961,109,1033,136"/>
<area shape="rect" id="node37" href="crypto__rand_8h.html" title="Common functions for using (pseudo&#45;)random number generators. " alt="" coords="2066,259,2168,285"/>
<area shape="rect" id="node38" href="directory_8h.html" title="Header file for directory.c. " alt="" coords="1108,109,1190,136"/>
<area shape="rect" id="node39" href="entrynodes_8h.html" title="Header file for circuitbuild.c. " alt="" coords="1706,184,1803,211"/>
<area shape="rect" id="node40" href="main_8h.html" title="Header file for main.c. " alt="" coords="1318,109,1380,136"/>
<area shape="rect" id="node41" href="microdesc_8h.html" title="Header file for microdesc.c. " alt="" coords="1404,109,1497,136"/>
<area shape="rect" id="node42" href="networkstatus_8h.html" title="Header file for networkstatus.c. " alt="" coords="122,184,237,211"/>
<area shape="rect" id="node43" href="nodelist_8h.html" title="Header file for nodelist.c. " alt="" coords="1572,109,1651,136"/>
<area shape="rect" id="node44" href="policies_8h.html" title="Header file for policies.c. " alt="" coords="1676,109,1753,136"/>
<area shape="rect" id="node45" href="router_8h.html" title="Header file for router.c. " alt="" coords="373,259,440,285"/>
<area shape="rect" id="node46" href="routerlist_8h.html" title="Header file for routerlist.c. " alt="" coords="440,184,522,211"/>
<area shape="rect" id="node47" href="routerparse_8h.html" title="Header file for routerparse.c. " alt="" coords="1878,109,1977,136"/>
<area shape="rect" id="node48" href="routerset_8h_source.html" title="routerset.h" alt="" coords="2002,109,2086,136"/>
<area shape="rect" id="node49" href="transports_8h.html" title="Headers for transports.c. " alt="" coords="2110,109,2201,136"/>
<area shape="rect" id="node50" href="statefile_8h_source.html" title="statefile.h" alt="" coords="2226,109,2304,136"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="1562,632,1640,659"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="1570,557,1632,584"/>
<area shape="rect" id="node5" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="1908,483,1977,509"/>
<area shape="rect" id="node6" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1279,333,1392,360"/>
<area shape="rect" id="node8" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="1217,408,1342,435"/>
<area shape="rect" id="node9" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="1199,483,1342,509"/>
<area shape="rect" id="node10" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="760,408,823,435"/>
<area shape="rect" id="node11" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="671,408,736,435"/>
<area shape="rect" id="node12" href="container_8h_source.html" title="container.h" alt="" coords="1639,408,1726,435"/>
<area shape="rect" id="node13" href="compress_8h.html" title="Headers for compress.c. " alt="" coords="1062,333,1153,360"/>
<area shape="rect" id="node14" href="address_8h.html" title="Headers for address.h. " alt="" coords="1818,333,1896,360"/>
<area shape="rect" id="node15" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="912,483,1040,509"/>
<area shape="rect" id="node16" href="ht_8h_source.html" title="ht.h" alt="" coords="1623,333,1667,360"/>
<area shape="rect" id="node17" href="confline_8h_source.html" title="confline.h" alt="" coords="1468,333,1547,360"/>
<area shape="rect" id="node18" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="1691,333,1794,360"/>
<area shape="rect" id="node19" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="2022,333,2113,360"/>
<area shape="rect" id="node20" href="token__bucket_8h_source.html" title="token_bucket.h" alt="" coords="1064,483,1175,509"/>
<area shape="rect" id="node21" href="util__format_8h_source.html" title="util_format.h" alt="" coords="1468,483,1563,509"/>
<area shape="rect" id="node22" href="hs__circuitmap_8h.html" title="Header file for hs_circuitmap.c. " alt="" coords="772,333,886,360"/>
<area shape="rect" id="node7" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="654,557,753,584"/>
<area shape="rect" id="node24" href="circuitmux_8h.html" title="Header file for circuitmux.c. " alt="" coords="1205,184,1298,211"/>
<area shape="rect" id="node25" href="timers_8h_source.html" title="timers.h" alt="" coords="349,483,418,509"/>
<area shape="rect" id="node26" href="handles_8h.html" title="Macros for C weak&#45;handle implementation. " alt="" coords="1798,259,1876,285"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aaf639dedf7da20e15c74f17ed20ff1a8"><td class="memItemLeft" align="right" valign="top"><a id="aaf639dedf7da20e15c74f17ed20ff1a8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ENTRYNODES_PRIVATE</b></td></tr>
<tr class="separator:aaf639dedf7da20e15c74f17ed20ff1a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d651929c750e80e07cc394ea79a7237"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a3d651929c750e80e07cc394ea79a7237">MIN_GUARDS_FOR_MD_RESTRICTION</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a3d651929c750e80e07cc394ea79a7237"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c2485d8fb49eab6cefa244712b7f7af"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>PB_FIELD</b>(field)</td></tr>
<tr class="separator:a2c2485d8fb49eab6cefa244712b7f7af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e0df62256cb4a16cca774166fd9dbb7"><td class="memItemLeft" align="right" valign="top"><a id="a4e0df62256cb4a16cca774166fd9dbb7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>FIELD</b>(f)&#160;&#160;&#160;strmap_set(vals, #f, &amp;f);</td></tr>
<tr class="separator:a4e0df62256cb4a16cca774166fd9dbb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46069f878ae61df0b1187164b413bd3e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>HANDLE_TIME</b>(field)</td></tr>
<tr class="separator:a46069f878ae61df0b1187164b413bd3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c2485d8fb49eab6cefa244712b7f7af"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>PB_FIELD</b>(field)</td></tr>
<tr class="separator:a2c2485d8fb49eab6cefa244712b7f7af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb0c7915d7a15c49d280940344ee334f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#abb0c7915d7a15c49d280940344ee334f">SLOW_GUARD_STATE_FLUSH_TIME</a>&#160;&#160;&#160;600</td></tr>
<tr class="separator:abb0c7915d7a15c49d280940344ee334f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad81819d8305e2ed8f171fc0ddc979bfe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#ad81819d8305e2ed8f171fc0ddc979bfe">FAST_GUARD_STATE_FLUSH_TIME</a>&#160;&#160;&#160;30</td></tr>
<tr class="separator:ad81819d8305e2ed8f171fc0ddc979bfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abcf00389e72807f2534ffd3da3de31e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#abcf00389e72807f2534ffd3da3de31e6">should_apply_guardfraction</a> (const <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *ns)</td></tr>
<tr class="separator:abcf00389e72807f2534ffd3da3de31e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c1f65570571aeb066bb8777124ad8b6"><td class="memItemLeft" align="right" valign="top">STATIC guard_selection_type_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a2c1f65570571aeb066bb8777124ad8b6">guard_selection_infer_type</a> (guard_selection_type_t type, const char *name)</td></tr>
<tr class="separator:a2c1f65570571aeb066bb8777124ad8b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcc3f15af65afdabe459528a2a230666"><td class="memItemLeft" align="right" valign="top">STATIC guard_selection_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#afcc3f15af65afdabe459528a2a230666">guard_selection_new</a> (const char *name, guard_selection_type_t type)</td></tr>
<tr class="separator:afcc3f15af65afdabe459528a2a230666"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ce04a08aa5735caf86d77a168eec0d4"><td class="memItemLeft" align="right" valign="top">STATIC guard_selection_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a4ce04a08aa5735caf86d77a168eec0d4">get_guard_selection_by_name</a> (const char *name, guard_selection_type_t type, int create_if_absent)</td></tr>
<tr class="separator:a4ce04a08aa5735caf86d77a168eec0d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae55f2a4d95b0bc81220dd0464b8494f8"><td class="memItemLeft" align="right" valign="top">guard_selection_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#ae55f2a4d95b0bc81220dd0464b8494f8">get_guard_selection_info</a> (void)</td></tr>
<tr class="separator:ae55f2a4d95b0bc81220dd0464b8494f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a446ff1a56de96285dac2fe015e972bd0"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a446ff1a56de96285dac2fe015e972bd0">entry_guard_describe</a> (const entry_guard_t *guard)</td></tr>
<tr class="separator:a446ff1a56de96285dac2fe015e972bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a728f1532a6ee05de69f5c8d988af2bd6"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a728f1532a6ee05de69f5c8d988af2bd6">entry_guard_get_rsa_id_digest</a> (const entry_guard_t *guard)</td></tr>
<tr class="separator:a728f1532a6ee05de69f5c8d988af2bd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a438f7a3ebb9ad87d9baee6a364441007"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structguard__pathbias__t.html">guard_pathbias_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a438f7a3ebb9ad87d9baee6a364441007">entry_guard_get_pathbias_state</a> (entry_guard_t *guard)</td></tr>
<tr class="separator:a438f7a3ebb9ad87d9baee6a364441007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8365c0314d4e3396d3058e50aff13535"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a8365c0314d4e3396d3058e50aff13535">MOCK_IMPL</a> (STATIC time_t, randomize_time,(time_t now, time_t max_backdate))</td></tr>
<tr class="separator:a8365c0314d4e3396d3058e50aff13535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f24532831169418e29141d5d59b903d"><td class="memItemLeft" align="right" valign="top">STATIC const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a6f24532831169418e29141d5d59b903d">choose_guard_selection</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options, const <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *live_ns, const guard_selection_t *old_selection, guard_selection_type_t *type_out)</td></tr>
<tr class="separator:a6f24532831169418e29141d5d59b903d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b8e402c5c5ea8de25416c11ff59d7b8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a7b8e402c5c5ea8de25416c11ff59d7b8">update_guard_selection_choice</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:a7b8e402c5c5ea8de25416c11ff59d7b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85c4a90c7407cd8c13fae402c414a5c8"><td class="memItemLeft" align="right" valign="top">STATIC entry_guard_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a85c4a90c7407cd8c13fae402c414a5c8">get_sampled_guard_with_id</a> (guard_selection_t *gs, const uint8_t *rsa_id)</td></tr>
<tr class="separator:a85c4a90c7407cd8c13fae402c414a5c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55c3838fe87b6171719d729a6d24147c"><td class="memItemLeft" align="right" valign="top">STATIC entry_guard_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a55c3838fe87b6171719d729a6d24147c">entry_guard_add_to_sample</a> (guard_selection_t *gs, const <a class="el" href="structnode__t.html">node_t</a> *node)</td></tr>
<tr class="separator:a55c3838fe87b6171719d729a6d24147c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06acab15b1c0a42b82485bf1f4fa78ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a06acab15b1c0a42b82485bf1f4fa78ed">entry_guard_learned_bridge_identity</a> (const <a class="el" href="structtor__addr__port__t.html">tor_addr_port_t</a> *addrport, const uint8_t *rsa_id_digest)</td></tr>
<tr class="separator:a06acab15b1c0a42b82485bf1f4fa78ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac771815070c48fdafceda321e3b56739"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#ac771815070c48fdafceda321e3b56739">num_reachable_filtered_guards</a> (const guard_selection_t *gs, const entry_guard_restriction_t *rst)</td></tr>
<tr class="separator:ac771815070c48fdafceda321e3b56739"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a284215d5fcf3e4f5c33969072c4e27d5"><td class="memItemLeft" align="right" valign="top">STATIC entry_guard_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a284215d5fcf3e4f5c33969072c4e27d5">entry_guards_expand_sample</a> (guard_selection_t *gs)</td></tr>
<tr class="separator:a284215d5fcf3e4f5c33969072c4e27d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ea264180d07d1806a71c00fe67b1964"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a5ea264180d07d1806a71c00fe67b1964">MOCK_IMPL</a> (STATIC int, entry_guard_is_listed,(guard_selection_t *gs, const entry_guard_t *guard))</td></tr>
<tr class="separator:a5ea264180d07d1806a71c00fe67b1964"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2a8cbdaeab1361a4527e0d1b6233f25"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#af2a8cbdaeab1361a4527e0d1b6233f25">sampled_guards_update_from_consensus</a> (guard_selection_t *gs)</td></tr>
<tr class="separator:af2a8cbdaeab1361a4527e0d1b6233f25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05fdc8a898708ce55cf06c96a2c0a052"><td class="memItemLeft" align="right" valign="top"><a id="a05fdc8a898708ce55cf06c96a2c0a052"></a>
STATIC entry_guard_restriction_t *&#160;</td><td class="memItemRight" valign="bottom"><b>guard_create_exit_restriction</b> (const uint8_t *exit_id)</td></tr>
<tr class="separator:a05fdc8a898708ce55cf06c96a2c0a052"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b3f1de0905e52f3a76961bd1db25e01"><td class="memItemLeft" align="right" valign="top">STATIC entry_guard_restriction_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a5b3f1de0905e52f3a76961bd1db25e01">guard_create_dirserver_md_restriction</a> (void)</td></tr>
<tr class="separator:a5b3f1de0905e52f3a76961bd1db25e01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d8b3b670aac830e78037876f2a000ea"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a6d8b3b670aac830e78037876f2a000ea">entry_guards_update_filtered_sets</a> (guard_selection_t *gs)</td></tr>
<tr class="separator:a6d8b3b670aac830e78037876f2a000ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a440f5217f0a557c13b02a251f93db5d6"><td class="memItemLeft" align="right" valign="top">STATIC entry_guard_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a440f5217f0a557c13b02a251f93db5d6">sample_reachable_filtered_entry_guards</a> (guard_selection_t *gs, const entry_guard_restriction_t *rst, unsigned flags)</td></tr>
<tr class="separator:a440f5217f0a557c13b02a251f93db5d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691aafe1ed64f00a693b7bd1b0675ef1"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a691aafe1ed64f00a693b7bd1b0675ef1">entry_guards_update_confirmed</a> (guard_selection_t *gs)</td></tr>
<tr class="separator:a691aafe1ed64f00a693b7bd1b0675ef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0098c969567b69eb585160f12700b06"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#ae0098c969567b69eb585160f12700b06">make_guard_confirmed</a> (guard_selection_t *gs, entry_guard_t *guard)</td></tr>
<tr class="separator:ae0098c969567b69eb585160f12700b06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0715381bede98a7d8f4da7f73d062801"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801">entry_guards_update_primary</a> (guard_selection_t *gs)</td></tr>
<tr class="separator:a0715381bede98a7d8f4da7f73d062801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab335f71d2749aa457ffd8a82065649c6"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#ab335f71d2749aa457ffd8a82065649c6">entry_guard_consider_retry</a> (entry_guard_t *guard)</td></tr>
<tr class="separator:ab335f71d2749aa457ffd8a82065649c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61c84cb9bea9ab7fbeff429a27893c33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a61c84cb9bea9ab7fbeff429a27893c33">entry_guards_note_internet_connectivity</a> (guard_selection_t *gs)</td></tr>
<tr class="separator:a61c84cb9bea9ab7fbeff429a27893c33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997305afc0db6f7e66d50f4273db1898"><td class="memItemLeft" align="right" valign="top">STATIC entry_guard_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a997305afc0db6f7e66d50f4273db1898">select_entry_guard_for_circuit</a> (guard_selection_t *gs, <a class="el" href="entrynodes_8h.html#aef1363614195376e58c3090a0f1a4ff6">guard_usage_t</a> usage, const entry_guard_restriction_t *rst, unsigned *state_out)</td></tr>
<tr class="separator:a997305afc0db6f7e66d50f4273db1898"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dcd016fd276da6af70697a39ab2b372"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a1dcd016fd276da6af70697a39ab2b372">entry_guards_note_guard_failure</a> (guard_selection_t *gs, entry_guard_t *guard)</td></tr>
<tr class="separator:a1dcd016fd276da6af70697a39ab2b372"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa020db50cb3f41bd32d264228a2bc249"><td class="memItemLeft" align="right" valign="top">STATIC unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#aa020db50cb3f41bd32d264228a2bc249">entry_guards_note_guard_success</a> (guard_selection_t *gs, entry_guard_t *guard, unsigned old_state)</td></tr>
<tr class="separator:aa020db50cb3f41bd32d264228a2bc249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f45fc1e26c98705d0c0f1a9fb862b1a"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a5f45fc1e26c98705d0c0f1a9fb862b1a">entry_guard_has_higher_priority</a> (entry_guard_t *a, entry_guard_t *b)</td></tr>
<tr class="separator:a5f45fc1e26c98705d0c0f1a9fb862b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a554594e310c51064070d388bb682b1d4"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a554594e310c51064070d388bb682b1d4">entry_guard_restriction_free_</a> (entry_guard_restriction_t *rst)</td></tr>
<tr class="separator:a554594e310c51064070d388bb682b1d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89782b7020c630cfbfe37496991068e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a89782b7020c630cfbfe37496991068e6">circuit_guard_state_free_</a> (circuit_guard_state_t *state)</td></tr>
<tr class="separator:a89782b7020c630cfbfe37496991068e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb3562d26ee2014d43566ac52e3e801"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a4fb3562d26ee2014d43566ac52e3e801">MOCK_IMPL</a> (STATIC circuit_guard_state_t *, circuit_guard_state_new,(entry_guard_t *guard, unsigned state, entry_guard_restriction_t *rst))</td></tr>
<tr class="separator:a4fb3562d26ee2014d43566ac52e3e801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89cd1e4049c1b18c57214d9414586ad4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a89cd1e4049c1b18c57214d9414586ad4">entry_guard_pick_for_circuit</a> (guard_selection_t *gs, <a class="el" href="entrynodes_8h.html#aef1363614195376e58c3090a0f1a4ff6">guard_usage_t</a> usage, entry_guard_restriction_t *rst, const <a class="el" href="structnode__t.html">node_t</a> **chosen_node_out, circuit_guard_state_t **guard_state_out)</td></tr>
<tr class="separator:a89cd1e4049c1b18c57214d9414586ad4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aceb4f4f990b9b3ed2ecea41abc9aab"><td class="memItemLeft" align="right" valign="top">guard_usable_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a5aceb4f4f990b9b3ed2ecea41abc9aab">entry_guard_succeeded</a> (circuit_guard_state_t **guard_state_p)</td></tr>
<tr class="separator:a5aceb4f4f990b9b3ed2ecea41abc9aab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c41a0672c81fe07767a6e80523af88d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a2c41a0672c81fe07767a6e80523af88d">entry_guard_cancel</a> (circuit_guard_state_t **guard_state_p)</td></tr>
<tr class="separator:a2c41a0672c81fe07767a6e80523af88d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00a05d40c93fe360c18cbf66dcbe2b29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a00a05d40c93fe360c18cbf66dcbe2b29">entry_guard_failed</a> (circuit_guard_state_t **guard_state_p)</td></tr>
<tr class="separator:a00a05d40c93fe360c18cbf66dcbe2b29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e486d12b1fae8b40a392567b676a083"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a0e486d12b1fae8b40a392567b676a083">entry_guard_chan_failed</a> (<a class="el" href="structchannel__s.html">channel_t</a> *chan)</td></tr>
<tr class="separator:a0e486d12b1fae8b40a392567b676a083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acad8e7ba6123e0a214361a425f711c05"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#acad8e7ba6123e0a214361a425f711c05">entry_guards_all_primary_guards_are_down</a> (guard_selection_t *gs)</td></tr>
<tr class="separator:acad8e7ba6123e0a214361a425f711c05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30eec9f6966e2df9934d3d9770e45df9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a30eec9f6966e2df9934d3d9770e45df9">entry_guards_upgrade_waiting_circuits</a> (guard_selection_t *gs, const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *all_circuits_in, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *newly_complete_out)</td></tr>
<tr class="separator:a30eec9f6966e2df9934d3d9770e45df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa42b6de85549bfc96f56f89cab179042"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#aa42b6de85549bfc96f56f89cab179042">entry_guard_state_should_expire</a> (circuit_guard_state_t *guard_state)</td></tr>
<tr class="separator:aa42b6de85549bfc96f56f89cab179042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4360ef3264ab398b48b851e0d2d675b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a4360ef3264ab398b48b851e0d2d675b5">entry_guards_update_all</a> (guard_selection_t *gs)</td></tr>
<tr class="separator:a4360ef3264ab398b48b851e0d2d675b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1db102ac34d25399676df24b415765b"><td class="memItemLeft" align="right" valign="top">STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#ae1db102ac34d25399676df24b415765b">entry_guard_encode_for_state</a> (entry_guard_t *guard)</td></tr>
<tr class="separator:ae1db102ac34d25399676df24b415765b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd874b8fcfbabcce363186ec1ce31577"><td class="memItemLeft" align="right" valign="top">STATIC entry_guard_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#afd874b8fcfbabcce363186ec1ce31577">entry_guard_parse_from_state</a> (const char *s)</td></tr>
<tr class="separator:afd874b8fcfbabcce363186ec1ce31577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ecb7c2ddf9746ab0b0cb62a2239b6f6"><td class="memItemLeft" align="right" valign="top">entry_guard_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a9ecb7c2ddf9746ab0b0cb62a2239b6f6">entry_guard_get_by_id_digest_for_guard_selection</a> (guard_selection_t *gs, const char *digest)</td></tr>
<tr class="separator:a9ecb7c2ddf9746ab0b0cb62a2239b6f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b9225be7f0d88d71bbf0f0f728b809a"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structnode__t.html">node_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a1b9225be7f0d88d71bbf0f0f728b809a">entry_guard_find_node</a> (const entry_guard_t *guard)</td></tr>
<tr class="separator:a1b9225be7f0d88d71bbf0f0f728b809a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a059f7981078a896a9349a578b82bc645"><td class="memItemLeft" align="right" valign="top">entry_guard_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a059f7981078a896a9349a578b82bc645">entry_guard_get_by_id_digest</a> (const char *digest)</td></tr>
<tr class="separator:a059f7981078a896a9349a578b82bc645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab5f4a60cc416cbf7109763a3b44c45a"><td class="memItemLeft" align="right" valign="top">circuit_guard_state_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#aab5f4a60cc416cbf7109763a3b44c45a">get_guard_state_for_bridge_desc_fetch</a> (const char *digest)</td></tr>
<tr class="separator:aab5f4a60cc416cbf7109763a3b44c45a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51a04fae0758a9edb54f2b4e12dc0713"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a51a04fae0758a9edb54f2b4e12dc0713">entry_guard_free_</a> (entry_guard_t *e)</td></tr>
<tr class="separator:a51a04fae0758a9edb54f2b4e12dc0713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a574dc0f7b96e7da5652ddb234d42adb3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a574dc0f7b96e7da5652ddb234d42adb3">entry_list_is_constrained</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:a574dc0f7b96e7da5652ddb234d42adb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ec40670f6c775c40033252d64dfdf53"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a6ec40670f6c775c40033252d64dfdf53">MOCK_IMPL</a> (int, num_bridges_usable,(int use_maybe_reachable))</td></tr>
<tr class="separator:a6ec40670f6c775c40033252d64dfdf53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fe13e92c8806b6fe22889c7e7b303f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a9fe13e92c8806b6fe22889c7e7b303f5">entry_guards_parse_state</a> (<a class="el" href="structor__state__t.html">or_state_t</a> *state, int set, char **msg)</td></tr>
<tr class="separator:a9fe13e92c8806b6fe22889c7e7b303f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe944c95b279887314f1101ada1f4884"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#abe944c95b279887314f1101ada1f4884">entry_guards_changed_for_guard_selection</a> (guard_selection_t *gs)</td></tr>
<tr class="separator:abe944c95b279887314f1101ada1f4884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aedcf8995075b212cce9d510e9e70d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a1aedcf8995075b212cce9d510e9e70d7">entry_guards_changed</a> (void)</td></tr>
<tr class="separator:a1aedcf8995075b212cce9d510e9e70d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e4a5b6f39d4d23a701fa0ddc38e3e17"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a6e4a5b6f39d4d23a701fa0ddc38e3e17">entry_guards_update_state</a> (<a class="el" href="structor__state__t.html">or_state_t</a> *state)</td></tr>
<tr class="separator:a6e4a5b6f39d4d23a701fa0ddc38e3e17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa848c940a527c2e4be395fdd4dc933c0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#aa848c940a527c2e4be395fdd4dc933c0">entry_guard_could_succeed</a> (const circuit_guard_state_t *guard_state)</td></tr>
<tr class="separator:aa848c940a527c2e4be395fdd4dc933c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e25941e32118099ac4b42000a37afc4"><td class="memItemLeft" align="right" valign="top">STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a8e25941e32118099ac4b42000a37afc4">getinfo_helper_format_single_entry_guard</a> (const entry_guard_t *e)</td></tr>
<tr class="separator:a8e25941e32118099ac4b42000a37afc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3a6a46f97e2693fa41867ff68a88a0f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#ae3a6a46f97e2693fa41867ff68a88a0f">getinfo_helper_entry_guards</a> (<a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *conn, const char *question, char **answer, const char **errmsg)</td></tr>
<tr class="separator:ae3a6a46f97e2693fa41867ff68a88a0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5872840b23806e149551b63fbf4e5407"><td class="memItemLeft" align="right" valign="top"><a id="a5872840b23806e149551b63fbf4e5407"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>guard_get_guardfraction_bandwidth</b> (<a class="el" href="structguardfraction__bandwidth__t.html">guardfraction_bandwidth_t</a> *guardfraction_bw, int orig_bandwidth, uint32_t guardfraction_percentage)</td></tr>
<tr class="separator:a5872840b23806e149551b63fbf4e5407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedaac29d3130717a9c3fdb8950a2f4af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#aedaac29d3130717a9c3fdb8950a2f4af">guards_update_all</a> (void)</td></tr>
<tr class="separator:aedaac29d3130717a9c3fdb8950a2f4af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab71ff8062c99e9722afef949590df2da"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structnode__t.html">node_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#ab71ff8062c99e9722afef949590df2da">guards_choose_guard</a> (<a class="el" href="structcpath__build__state__t.html">cpath_build_state_t</a> *state, uint8_t purpose, circuit_guard_state_t **guard_state_out)</td></tr>
<tr class="separator:ab71ff8062c99e9722afef949590df2da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37261ae47f6bec9d6ade03c87b74f916"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a37261ae47f6bec9d6ade03c87b74f916">remove_all_entry_guards_for_guard_selection</a> (guard_selection_t *gs)</td></tr>
<tr class="separator:a37261ae47f6bec9d6ade03c87b74f916"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2059c6a8b0ae5f6bd64087fe00a27d9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a2059c6a8b0ae5f6bd64087fe00a27d9d">remove_all_entry_guards</a> (void)</td></tr>
<tr class="separator:a2059c6a8b0ae5f6bd64087fe00a27d9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93db2fbe0af8230c60e96836cab30a29"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structnode__t.html">node_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a93db2fbe0af8230c60e96836cab30a29">guards_choose_dirguard</a> (uint8_t dir_purpose, circuit_guard_state_t **guard_state_out)</td></tr>
<tr class="separator:a93db2fbe0af8230c60e96836cab30a29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9eddf77d45dab94c87c4ae9e9a659fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#aa9eddf77d45dab94c87c4ae9e9a659fb">guards_retry_optimistic</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:aa9eddf77d45dab94c87c4ae9e9a659fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e9ad8a9d2d435a30b8ece9e786533bf"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a0e9ad8a9d2d435a30b8ece9e786533bf">guard_selection_get_err_str_if_dir_info_missing</a> (guard_selection_t *gs, int using_mds, int num_present, int num_usable)</td></tr>
<tr class="separator:a0e9ad8a9d2d435a30b8ece9e786533bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f69ddf668f984f783eb7cfcb358185e"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a1f69ddf668f984f783eb7cfcb358185e">entry_guards_get_err_str_if_dir_info_missing</a> (int using_mds, int num_present, int num_usable)</td></tr>
<tr class="separator:a1f69ddf668f984f783eb7cfcb358185e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dfe3b4d55f624730b23a35b1a41e466"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a1dfe3b4d55f624730b23a35b1a41e466">guard_selection_free_</a> (guard_selection_t *gs)</td></tr>
<tr class="separator:a1dfe3b4d55f624730b23a35b1a41e466"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe2c7c43057097f0ca57f4429249f576"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#afe2c7c43057097f0ca57f4429249f576">entry_guards_free_all</a> (void)</td></tr>
<tr class="separator:afe2c7c43057097f0ca57f4429249f576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">parameters for networkstatus algorithm</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>These parameters are taken from the consensus; some are overrideable in the torrc. </p>
</div></td></tr>
<tr class="memitem:abc0d21d94e5a6c9569b2315f49f8e652"><td class="memItemLeft" align="right" valign="top">STATIC double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#abc0d21d94e5a6c9569b2315f49f8e652">get_max_sample_threshold</a> (void)</td></tr>
<tr class="separator:abc0d21d94e5a6c9569b2315f49f8e652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98b98d186ce126225c6d12ab85912aa1"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a98b98d186ce126225c6d12ab85912aa1">get_max_sample_size_absolute</a> (void)</td></tr>
<tr class="separator:a98b98d186ce126225c6d12ab85912aa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b05b0c16452a4211e371d6aab9d3ee8"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a4b05b0c16452a4211e371d6aab9d3ee8">get_min_filtered_sample_size</a> (void)</td></tr>
<tr class="separator:a4b05b0c16452a4211e371d6aab9d3ee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eea3721f2ce3de824f68890f6ab1778"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a8eea3721f2ce3de824f68890f6ab1778">get_remove_unlisted_guards_after_days</a> (void)</td></tr>
<tr class="separator:a8eea3721f2ce3de824f68890f6ab1778"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae41f8e975c87c2a80c3f73b8d76e1d34"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#ae41f8e975c87c2a80c3f73b8d76e1d34">get_guard_lifetime</a> (void)</td></tr>
<tr class="separator:ae41f8e975c87c2a80c3f73b8d76e1d34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59d1e35a0ef7aee589078c526fc0da40"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a59d1e35a0ef7aee589078c526fc0da40">get_guard_confirmed_min_lifetime</a> (void)</td></tr>
<tr class="separator:a59d1e35a0ef7aee589078c526fc0da40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a045186178310a765b1193b31c9c98be8"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a045186178310a765b1193b31c9c98be8">get_n_primary_guards</a> (void)</td></tr>
<tr class="separator:a045186178310a765b1193b31c9c98be8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acca85058789d4eb247b7e560bfeb7767"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#acca85058789d4eb247b7e560bfeb7767">get_n_primary_guards_to_use</a> (<a class="el" href="entrynodes_8h.html#aef1363614195376e58c3090a0f1a4ff6">guard_usage_t</a> usage)</td></tr>
<tr class="separator:acca85058789d4eb247b7e560bfeb7767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeb688f386509434c598e00be58b1fd5"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#afeb688f386509434c598e00be58b1fd5">get_internet_likely_down_interval</a> (void)</td></tr>
<tr class="separator:afeb688f386509434c598e00be58b1fd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99a0819d62fb5b014597c4afa1c46acb"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a99a0819d62fb5b014597c4afa1c46acb">get_nonprimary_guard_connect_timeout</a> (void)</td></tr>
<tr class="separator:a99a0819d62fb5b014597c4afa1c46acb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c7ec361faf235b7a77e9b73314046c5"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a2c7ec361faf235b7a77e9b73314046c5">get_nonprimary_guard_idle_timeout</a> (void)</td></tr>
<tr class="separator:a2c7ec361faf235b7a77e9b73314046c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25a11e12a2c15465561ceb978ee3af2f"><td class="memItemLeft" align="right" valign="top">STATIC double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a25a11e12a2c15465561ceb978ee3af2f">get_meaningful_restriction_threshold</a> (void)</td></tr>
<tr class="separator:a25a11e12a2c15465561ceb978ee3af2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e1881dfc0c2926b6fea95cb22ef904d"><td class="memItemLeft" align="right" valign="top">STATIC double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a3e1881dfc0c2926b6fea95cb22ef904d">get_extreme_restriction_threshold</a> (void)</td></tr>
<tr class="separator:a3e1881dfc0c2926b6fea95cb22ef904d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a477e0e6936f2e44747be238f30dd7"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="entrynodes_8c.html#a30a477e0e6936f2e44747be238f30dd7">mark_primary_guards_maybe_reachable</a> (guard_selection_t *gs)</td></tr>
<tr class="separator:a30a477e0e6936f2e44747be238f30dd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Code to manage our fixed first nodes for various functions. </p>
<p>Entry nodes can be guards (for general use) or bridges (for censorship circumvention).</p>
<p>In general, we use entry guards to prevent traffic-sampling attacks: if we chose every circuit independently, an adversary controlling some fraction of paths on the network would observe a sample of every user's traffic. Using guards gives users a chance of not being profiled.</p>
<p>The current entry guard selection code is designed to try to avoid <em>ever</em> trying every guard on the network, to try to stick to guards that we've used before, to handle hostile/broken networks, and to behave sanely when the network goes up and down.</p>
<p>Our algorithm works as follows: First, we maintain a SAMPLE of guards we've seen in the networkstatus consensus. We maintain this sample over time, and store it persistently; it is chosen without reference to our configuration or firewall rules. Guards remain in the sample as they enter and leave the consensus. We expand this sample as needed, up to a maximum size.</p>
<p>As a subset of the sample, we maintain a FILTERED SET of the guards that we would be willing to use if we could connect to them. The filter removes all the guards that we're excluding because they're bridges (or not bridges), because we have restrictive firewall rules, because of ExcludeNodes, because we of path bias restrictions, because they're absent from the network at present, and so on.</p>
<p>As a subset of the filtered set, we keep a REACHABLE FILTERED SET (also called a "usable filtered set") of those guards that we call "reachable" or "maybe reachable". A guard is reachable if we've connected to it more recently than we've failed. A guard is "maybe
reachable" if we have never tried to connect to it, or if we failed to connect to it so long ago that we no longer think our failure means it's down.</p>
<p>As a persistent ordered list whose elements are taken from the sampled set, we track a CONFIRMED GUARDS LIST. A guard becomes confirmed when we successfully build a circuit through it, and decide to use that circuit. We order the guards on this list by the order in which they became confirmed.</p>
<p>And as a final group, we have an ordered list of PRIMARY GUARDS, whose elements are taken from the filtered set. We prefer confirmed guards to non-confirmed guards for this list, and place other restrictions on it. The primary guards are the ones that we connect to "when nothing is wrong" &ndash; circuits through them can be used immediately.</p>
<p>To build circuits, we take a primary guard if possible &ndash; or a reachable filtered confirmed guard if no primary guard is possible &ndash; or a random reachable filtered guard otherwise. If the guard is primary, we can use the circuit immediately on success. Otherwise, the guard is now "pending" &ndash; we won't use its circuit unless all of the circuits we're trying to build through better guards have definitely failed.</p>
<p>While we're building circuits, we track a little "guard state" for each circuit. We use this to keep track of whether the circuit is one that we can use as soon as it's done, or whether it's one that we should keep around to see if we can do better. In the latter case, a periodic call to <a class="el" href="entrynodes_8c.html#a30eec9f6966e2df9934d3d9770e45df9">entry_guards_upgrade_waiting_circuits()</a> will eventually upgrade it. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad81819d8305e2ed8f171fc0ddc979bfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad81819d8305e2ed8f171fc0ddc979bfe">&#9670;&nbsp;</a></span>FAST_GUARD_STATE_FLUSH_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAST_GUARD_STATE_FLUSH_TIME&#160;&#160;&#160;30</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How long will we let a change in our guard nodes stay un-saved when we are not trying to avoid disk writes? </p>

</div>
</div>
<a id="a46069f878ae61df0b1187164b413bd3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46069f878ae61df0b1187164b413bd3e">&#9670;&nbsp;</a></span>HANDLE_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HANDLE_TIME</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">field</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                                 \</div><div class="line">    if (field) {                                                \</div><div class="line">      int r = <a class="code" href="util_8c.html#aa0779e255dfcab930dc0016b1d78657a">parse_iso_time_nospace</a>(field, &amp;field ## _time);   \</div><div class="line">      if (r &lt; 0) {                                              \</div><div class="line">        log_warn(<a class="code" href="torlog_8h.html#ae1aa5de12ca29452eca3594b36615eda">LD_CIRC</a>, <span class="stringliteral">&quot;Unable to parse %s %s from guard&quot;</span>,   \</div><div class="line">                 #field, <a class="code" href="util_8c.html#a354eb90598823d4fd6111b94c9c0ce97">escaped</a>(field));                       \</div><div class="line">        field##_time = -1;                                      \</div><div class="line">      }                                                         \</div><div class="line">    }                                                           \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div><div class="ttc" id="util_8c_html_aa0779e255dfcab930dc0016b1d78657a"><div class="ttname"><a href="util_8c.html#aa0779e255dfcab930dc0016b1d78657a">parse_iso_time_nospace</a></div><div class="ttdeci">int parse_iso_time_nospace(const char *cp, time_t *t)</div><div class="ttdef"><b>Definition:</b> util.c:1937</div></div>
<div class="ttc" id="torlog_8h_html_ae1aa5de12ca29452eca3594b36615eda"><div class="ttname"><a href="torlog_8h.html#ae1aa5de12ca29452eca3594b36615eda">LD_CIRC</a></div><div class="ttdeci">#define LD_CIRC</div><div class="ttdef"><b>Definition:</b> torlog.h:76</div></div>
<div class="ttc" id="util_8c_html_a354eb90598823d4fd6111b94c9c0ce97"><div class="ttname"><a href="util_8c.html#a354eb90598823d4fd6111b94c9c0ce97">escaped</a></div><div class="ttdeci">const char * escaped(const char *s)</div><div class="ttdef"><b>Definition:</b> util.c:1412</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d651929c750e80e07cc394ea79a7237"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d651929c750e80e07cc394ea79a7237">&#9670;&nbsp;</a></span>MIN_GUARDS_FOR_MD_RESTRICTION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN_GUARDS_FOR_MD_RESTRICTION&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If we have fewer than this many possible usable guards, don't set MD-availability-based restrictions: we might blacklist all of them. </p>

</div>
</div>
<a id="a2c2485d8fb49eab6cefa244712b7f7af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c2485d8fb49eab6cefa244712b7f7af">&#9670;&nbsp;</a></span>PB_FIELD <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PB_FIELD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">field</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                                          \</div><div class="line">      if (pb-&gt;field &gt;= <a class="code" href="circuitmux__ewma_8c.html#a002b2f4894492820fe708b1b7e7c5e70">EPSILON</a>) {                                       \</div><div class="line">        smartlist_add_asprintf(result, <span class="stringliteral">&quot;pb_&quot;</span> #field <span class="stringliteral">&quot;=%f&quot;</span>, pb-&gt;field);  \</div><div class="line">      }                                                                 \</div><div class="line">    } <span class="keywordflow">while</span> (0)</div><div class="ttc" id="circuitmux__ewma_8c_html_a002b2f4894492820fe708b1b7e7c5e70"><div class="ttname"><a href="circuitmux__ewma_8c.html#a002b2f4894492820fe708b1b7e7c5e70">EPSILON</a></div><div class="ttdeci">#define EPSILON</div><div class="ttdef"><b>Definition:</b> circuitmux_ewma.c:56</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c2485d8fb49eab6cefa244712b7f7af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c2485d8fb49eab6cefa244712b7f7af">&#9670;&nbsp;</a></span>PB_FIELD <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PB_FIELD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">field</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                                                                  \</div><div class="line">    if (pb_ ## field) {                                                 \</div><div class="line">      int ok = 1;                                                       \</div><div class="line">      double r = <a class="code" href="util_8c.html#ab465dbfbc9e54d89b7cada4bcb3c83cb">tor_parse_double</a>(pb_ ## field, 0.0, 1e9, &amp;ok, NULL);   \</div><div class="line">      if (! ok) {                                                       \</div><div class="line">        log_warn(<a class="code" href="torlog_8h.html#ae1aa5de12ca29452eca3594b36615eda">LD_CIRC</a>, <span class="stringliteral">&quot;Guard has invalid pb_%s %s&quot;</span>,                 \</div><div class="line">                 #field, pb_ ## field);                                 \</div><div class="line">      } <span class="keywordflow">else</span> {                                                          \</div><div class="line">        guard-&gt;pb.field = r;                                            \</div><div class="line">      }                                                                 \</div><div class="line">    }                                                                   \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div><div class="ttc" id="util_8c_html_ab465dbfbc9e54d89b7cada4bcb3c83cb"><div class="ttname"><a href="util_8c.html#ab465dbfbc9e54d89b7cada4bcb3c83cb">tor_parse_double</a></div><div class="ttdeci">double tor_parse_double(const char *s, double min, double max, int *ok, char **next)</div><div class="ttdef"><b>Definition:</b> util.c:1264</div></div>
<div class="ttc" id="torlog_8h_html_ae1aa5de12ca29452eca3594b36615eda"><div class="ttname"><a href="torlog_8h.html#ae1aa5de12ca29452eca3594b36615eda">LD_CIRC</a></div><div class="ttdeci">#define LD_CIRC</div><div class="ttdef"><b>Definition:</b> torlog.h:76</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb0c7915d7a15c49d280940344ee334f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb0c7915d7a15c49d280940344ee334f">&#9670;&nbsp;</a></span>SLOW_GUARD_STATE_FLUSH_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SLOW_GUARD_STATE_FLUSH_TIME&#160;&#160;&#160;600</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How long will we let a change in our guard nodes stay un-saved when we are trying to avoid disk writes? </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6f24532831169418e29141d5d59b903d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f24532831169418e29141d5d59b903d">&#9670;&nbsp;</a></span>choose_guard_selection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC const char* choose_guard_selection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>live_ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const guard_selection_t *&#160;</td>
          <td class="paramname"><em>old_selection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">guard_selection_type_t *&#160;</td>
          <td class="paramname"><em>type_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given our options and our list of nodes, return the name of the guard selection that we should use. Return NULL for "use the same selection you were using before. </p>

</div>
</div>
<a id="a89782b7020c630cfbfe37496991068e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89782b7020c630cfbfe37496991068e6">&#9670;&nbsp;</a></span>circuit_guard_state_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_guard_state_free_ </td>
          <td>(</td>
          <td class="paramtype">circuit_guard_state_t *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all storage held in <b>state</b>. </p>

</div>
</div>
<a id="a55c3838fe87b6171719d729a6d24147c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55c3838fe87b6171719d729a6d24147c">&#9670;&nbsp;</a></span>entry_guard_add_to_sample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC entry_guard_t* entry_guard_add_to_sample </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structnode__t.html">node_t</a> *&#160;</td>
          <td class="paramname"><em>node</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate a new entry_guard_t object for <b>node</b>, add it to the sampled entry guards in <b>gs</b>, and return it. <b>node</b> must not currently be a sampled guard in <b>gs</b>. </p>

</div>
</div>
<a id="a2c41a0672c81fe07767a6e80523af88d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c41a0672c81fe07767a6e80523af88d">&#9670;&nbsp;</a></span>entry_guard_cancel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void entry_guard_cancel </td>
          <td>(</td>
          <td class="paramtype">circuit_guard_state_t **&#160;</td>
          <td class="paramname"><em>guard_state_p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cancel the selection of *<b>guard_state_p</b> without declaring success or failure. It is safe to call this function if success or failure <em>has</em> already been declared. </p>

</div>
</div>
<a id="a0e486d12b1fae8b40a392567b676a083"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e486d12b1fae8b40a392567b676a083">&#9670;&nbsp;</a></span>entry_guard_chan_failed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void entry_guard_chan_failed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structchannel__s.html">channel_t</a> *&#160;</td>
          <td class="paramname"><em>chan</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Run the <a class="el" href="entrynodes_8c.html#a00a05d40c93fe360c18cbf66dcbe2b29">entry_guard_failed()</a> function on every circuit that is pending on <b>chan</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a0e486d12b1fae8b40a392567b676a083_cgraph.png" border="0" usemap="#entrynodes_8c_a0e486d12b1fae8b40a392567b676a083_cgraph" alt=""/></div>
<map name="entrynodes_8c_a0e486d12b1fae8b40a392567b676a083_cgraph" id="entrynodes_8c_a0e486d12b1fae8b40a392567b676a083_cgraph">
<area shape="rect" id="node2" href="circuitlist_8c.html#aaef0c4aefe50f0432478e21e51814a34" title="circuit_get_all_pending\l_on_channel" alt="" coords="216,23,371,65"/>
<area shape="rect" id="node3" href="util_8c.html#add0703747195c2abd042572426e80266" title="tor_digest_is_zero" alt="" coords="454,5,582,32"/>
<area shape="rect" id="node5" href="channel_8c.html#a6cb4f4e8f649a753d3d22fb84653c05b" title="channel_matches_extend_info" alt="" coords="419,56,617,83"/>
<area shape="rect" id="node4" href="di__ops_8c.html#a473334ee93cca0aea10523321a444ea3" title="tor_memeq" alt="" coords="665,5,752,32"/>
</map>
</div>

</div>
</div>
<a id="ab335f71d2749aa457ffd8a82065649c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab335f71d2749aa457ffd8a82065649c6">&#9670;&nbsp;</a></span>entry_guard_consider_retry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void entry_guard_consider_retry </td>
          <td>(</td>
          <td class="paramtype">entry_guard_t *&#160;</td>
          <td class="paramname"><em>guard</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If <b>guard</b> is unreachable, consider whether enough time has passed to consider it maybe-reachable again. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_ab335f71d2749aa457ffd8a82065649c6_cgraph.png" border="0" usemap="#entrynodes_8c_ab335f71d2749aa457ffd8a82065649c6_cgraph" alt=""/></div>
<map name="entrynodes_8c_ab335f71d2749aa457ffd8a82065649c6_cgraph" id="entrynodes_8c_ab335f71d2749aa457ffd8a82065649c6_cgraph">
<area shape="rect" id="node2" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="200,13,293,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_ab335f71d2749aa457ffd8a82065649c6_icgraph.png" border="0" usemap="#entrynodes_8c_ab335f71d2749aa457ffd8a82065649c6_icgraph" alt=""/></div>
<map name="entrynodes_8c_ab335f71d2749aa457ffd8a82065649c6_icgraph" id="entrynodes_8c_ab335f71d2749aa457ffd8a82065649c6_icgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#ac771815070c48fdafceda321e3b56739" title="num_reachable_filtered\l_guards" alt="" coords="200,154,356,195"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a440f5217f0a557c13b02a251f93db5d6" title="sample_reachable_filtered\l_entry_guards" alt="" coords="404,154,577,195"/>
<area shape="rect" id="node8" href="entrynodes_8c.html#acad8e7ba6123e0a214361a425f711c05" title="entry_guards_all_primary\l_guards_are_down" alt="" coords="817,269,983,310"/>
<area shape="rect" id="node4" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801" title="entry_guards_update\l_primary" alt="" coords="625,153,768,194"/>
<area shape="rect" id="node5" href="entrynodes_8c.html#a30a477e0e6936f2e44747be238f30dd7" title="mark_primary_guards\l_maybe_reachable" alt="" coords="827,86,973,127"/>
<area shape="rect" id="node7" href="entrynodes_8c.html#aa020db50cb3f41bd32d264228a2bc249" title="entry_guards_note_guard\l_success" alt="" coords="816,151,984,193"/>
<area shape="rect" id="node12" href="entrynodes_8h.html#a4360ef3264ab398b48b851e0d2d675b5" title="entry_guards_update_all" alt="" coords="819,217,981,244"/>
<area shape="rect" id="node13" href="entrynodes_8h.html#a0e9ad8a9d2d435a30b8ece9e786533bf" title="guard_selection_get\l_err_str_if_dir_info\l_missing" alt="" coords="831,5,969,61"/>
<area shape="rect" id="node6" href="entrynodes_8h.html#aa9eddf77d45dab94c87c4ae9e9a659fb" title="guards_retry_optimistic" alt="" coords="1033,93,1190,120"/>
<area shape="rect" id="node9" href="entrynodes_8h.html#af943c868320a66ee2dca652ad0555a32" title="entry_guards_upgrade\l_waiting_circuits" alt="" coords="1036,269,1187,310"/>
<area shape="rect" id="node10" href="circuitlist_8h.html#a8d569b96b07da7c91549695cc1ce8ccf" title="circuit_find_circuits\l_to_upgrade_from_guard_wait" alt="" coords="1239,269,1435,310"/>
<area shape="rect" id="node11" href="circuitbuild_8h.html#afbeee8004f6e86e019ed4c4a9556d7de" title="circuit_upgrade_circuits\l_from_guard_wait" alt="" coords="1483,269,1641,310"/>
<area shape="rect" id="node14" href="entrynodes_8h.html#a1f69ddf668f984f783eb7cfcb358185e" title="entry_guards_get_err\l_str_if_dir_info_missing" alt="" coords="1032,13,1191,54"/>
</map>
</div>

</div>
</div>
<a id="aa848c940a527c2e4be395fdd4dc933c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa848c940a527c2e4be395fdd4dc933c0">&#9670;&nbsp;</a></span>entry_guard_could_succeed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int entry_guard_could_succeed </td>
          <td>(</td>
          <td class="paramtype">const circuit_guard_state_t *&#160;</td>
          <td class="paramname"><em>guard_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff the circuit's guard can succeed that is can be used. </p>

</div>
</div>
<a id="a446ff1a56de96285dac2fe015e972bd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a446ff1a56de96285dac2fe015e972bd0">&#9670;&nbsp;</a></span>entry_guard_describe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* entry_guard_describe </td>
          <td>(</td>
          <td class="paramtype">const entry_guard_t *&#160;</td>
          <td class="paramname"><em>guard</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a statically allocated human-readable description of <b>guard</b> </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a446ff1a56de96285dac2fe015e972bd0_cgraph.png" border="0" usemap="#entrynodes_8c_a446ff1a56de96285dac2fe015e972bd0_cgraph" alt=""/></div>
<map name="entrynodes_8c_a446ff1a56de96285dac2fe015e972bd0_cgraph" id="entrynodes_8c_a446ff1a56de96285dac2fe015e972bd0_cgraph">
<area shape="rect" id="node2" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="200,5,287,32"/>
<area shape="rect" id="node4" href="util_8c.html#a17effd59ed2f9bf4cfebb12e423ded7f" title="hex_str" alt="" coords="211,56,276,83"/>
<area shape="rect" id="node3" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="344,5,439,32"/>
<area shape="rect" id="node5" href="util__format_8c.html#a8b8940b2ef607928eb3dca4850567ea5" title="base16_encode" alt="" coords="335,56,448,83"/>
</map>
</div>

</div>
</div>
<a id="ae1db102ac34d25399676df24b415765b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1db102ac34d25399676df24b415765b">&#9670;&nbsp;</a></span>entry_guard_encode_for_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC char* entry_guard_encode_for_state </td>
          <td>(</td>
          <td class="paramtype">entry_guard_t *&#160;</td>
          <td class="paramname"><em>guard</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a newly allocated string for encoding the persistent parts of <b>guard</b> to the state file. </p>

</div>
</div>
<a id="a00a05d40c93fe360c18cbf66dcbe2b29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00a05d40c93fe360c18cbf66dcbe2b29">&#9670;&nbsp;</a></span>entry_guard_failed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void entry_guard_failed </td>
          <td>(</td>
          <td class="paramtype">circuit_guard_state_t **&#160;</td>
          <td class="paramname"><em>guard_state_p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called by the circuit building module when a circuit has failed: informs the guards code that the guard in *<b>guard_state_p</b> is not working, and advances the state of the guard module. </p>

</div>
</div>
<a id="a1b9225be7f0d88d71bbf0f0f728b809a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b9225be7f0d88d71bbf0f0f728b809a">&#9670;&nbsp;</a></span>entry_guard_find_node()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structnode__t.html">node_t</a>* entry_guard_find_node </td>
          <td>(</td>
          <td class="paramtype">const entry_guard_t *&#160;</td>
          <td class="paramname"><em>guard</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the <a class="el" href="structnode__t.html">node_t</a> associated with a single entry_guard_t. May return NULL if the guard is not currently in the consensus. </p>

</div>
</div>
<a id="a51a04fae0758a9edb54f2b4e12dc0713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51a04fae0758a9edb54f2b4e12dc0713">&#9670;&nbsp;</a></span>entry_guard_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void entry_guard_free_ </td>
          <td>(</td>
          <td class="paramtype">entry_guard_t *&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all storage held by <b>e</b>. </p>

</div>
</div>
<a id="a059f7981078a896a9349a578b82bc645"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a059f7981078a896a9349a578b82bc645">&#9670;&nbsp;</a></span>entry_guard_get_by_id_digest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">entry_guard_t* entry_guard_get_by_id_digest </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>digest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If <b>digest</b> matches the identity of any node in the entry_guards list for the default guard selection state, return that node. Else return NULL. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a059f7981078a896a9349a578b82bc645_cgraph.png" border="0" usemap="#entrynodes_8c_a059f7981078a896a9349a578b82bc645_cgraph" alt=""/></div>
<map name="entrynodes_8c_a059f7981078a896a9349a578b82bc645_cgraph" id="entrynodes_8c_a059f7981078a896a9349a578b82bc645_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a9ecb7c2ddf9746ab0b0cb62a2239b6f6" title="entry_guard_get_by\l_id_digest_for_guard\l_selection" alt="" coords="201,5,344,61"/>
<area shape="rect" id="node5" href="entrynodes_8c.html#ae55f2a4d95b0bc81220dd0464b8494f8" title="get_guard_selection_info" alt="" coords="189,85,356,112"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a85c4a90c7407cd8c13fae402c414a5c8" title="get_sampled_guard_with_id" alt="" coords="404,20,587,47"/>
<area shape="rect" id="node4" href="di__ops_8c.html#a473334ee93cca0aea10523321a444ea3" title="tor_memeq" alt="" coords="635,20,721,47"/>
</map>
</div>

</div>
</div>
<a id="a9ecb7c2ddf9746ab0b0cb62a2239b6f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ecb7c2ddf9746ab0b0cb62a2239b6f6">&#9670;&nbsp;</a></span>entry_guard_get_by_id_digest_for_guard_selection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">entry_guard_t* entry_guard_get_by_id_digest_for_guard_selection </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>digest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If <b>digest</b> matches the identity of any node in the entry_guards list for the provided guard selection state, return that node. Else return NULL. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a9ecb7c2ddf9746ab0b0cb62a2239b6f6_cgraph.png" border="0" usemap="#entrynodes_8c_a9ecb7c2ddf9746ab0b0cb62a2239b6f6_cgraph" alt=""/></div>
<map name="entrynodes_8c_a9ecb7c2ddf9746ab0b0cb62a2239b6f6_cgraph" id="entrynodes_8c_a9ecb7c2ddf9746ab0b0cb62a2239b6f6_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a85c4a90c7407cd8c13fae402c414a5c8" title="get_sampled_guard_with_id" alt="" coords="196,20,379,47"/>
<area shape="rect" id="node3" href="di__ops_8c.html#a473334ee93cca0aea10523321a444ea3" title="tor_memeq" alt="" coords="427,20,513,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a9ecb7c2ddf9746ab0b0cb62a2239b6f6_icgraph.png" border="0" usemap="#entrynodes_8c_a9ecb7c2ddf9746ab0b0cb62a2239b6f6_icgraph" alt=""/></div>
<map name="entrynodes_8c_a9ecb7c2ddf9746ab0b0cb62a2239b6f6_icgraph" id="entrynodes_8c_a9ecb7c2ddf9746ab0b0cb62a2239b6f6_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a059f7981078a896a9349a578b82bc645" title="entry_guard_get_by\l_id_digest" alt="" coords="197,5,333,47"/>
<area shape="rect" id="node3" href="entrynodes_8h.html#aab5f4a60cc416cbf7109763a3b44c45a" title="get_guard_state_for\l_bridge_desc_fetch" alt="" coords="196,71,333,112"/>
</map>
</div>

</div>
</div>
<a id="a438f7a3ebb9ad87d9baee6a364441007"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a438f7a3ebb9ad87d9baee6a364441007">&#9670;&nbsp;</a></span>entry_guard_get_pathbias_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structguard__pathbias__t.html">guard_pathbias_t</a>* entry_guard_get_pathbias_state </td>
          <td>(</td>
          <td class="paramtype">entry_guard_t *&#160;</td>
          <td class="paramname"><em>guard</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the pathbias state associated with <b>guard</b>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a438f7a3ebb9ad87d9baee6a364441007_icgraph.png" border="0" usemap="#entrynodes_8c_a438f7a3ebb9ad87d9baee6a364441007_icgraph" alt=""/></div>
<map name="entrynodes_8c_a438f7a3ebb9ad87d9baee6a364441007_icgraph" id="entrynodes_8c_a438f7a3ebb9ad87d9baee6a364441007_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#afe9ef8d49fc04454e5c3cf61b7c5667f" title="pathbias_get_close\l_success_count" alt="" coords="247,5,381,47"/>
<area shape="rect" id="node3" href="entrynodes_8h.html#a65437bc034e2202eb60d5cffd285fd48" title="pathbias_get_use_success\l_count" alt="" coords="224,71,404,112"/>
</map>
</div>

</div>
</div>
<a id="a728f1532a6ee05de69f5c8d988af2bd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a728f1532a6ee05de69f5c8d988af2bd6">&#9670;&nbsp;</a></span>entry_guard_get_rsa_id_digest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* entry_guard_get_rsa_id_digest </td>
          <td>(</td>
          <td class="paramtype">const entry_guard_t *&#160;</td>
          <td class="paramname"><em>guard</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return <b>guard</b>'s 20-byte RSA identity digest </p>

</div>
</div>
<a id="a5f45fc1e26c98705d0c0f1a9fb862b1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f45fc1e26c98705d0c0f1a9fb862b1a">&#9670;&nbsp;</a></span>entry_guard_has_higher_priority()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int entry_guard_has_higher_priority </td>
          <td>(</td>
          <td class="paramtype">entry_guard_t *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">entry_guard_t *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: Return true iff <b>a</b> has higher priority than <b>b</b>. </p>

</div>
</div>
<a id="a06acab15b1c0a42b82485bf1f4fa78ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06acab15b1c0a42b82485bf1f4fa78ed">&#9670;&nbsp;</a></span>entry_guard_learned_bridge_identity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void entry_guard_learned_bridge_identity </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtor__addr__port__t.html">tor_addr_port_t</a> *&#160;</td>
          <td class="paramname"><em>addrport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>rsa_id_digest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update the guard subsystem's knowledge of the identity of the bridge at <b>addrport</b>. Idempotent. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a06acab15b1c0a42b82485bf1f4fa78ed_cgraph.png" border="0" usemap="#entrynodes_8c_a06acab15b1c0a42b82485bf1f4fa78ed_cgraph" alt=""/></div>
<map name="entrynodes_8c_a06acab15b1c0a42b82485bf1f4fa78ed_cgraph" id="entrynodes_8c_a06acab15b1c0a42b82485bf1f4fa78ed_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a4ce04a08aa5735caf86d77a168eec0d4" title="get_guard_selection\l_by_name" alt="" coords="192,5,331,47"/>
</map>
</div>

</div>
</div>
<a id="afd874b8fcfbabcce363186ec1ce31577"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd874b8fcfbabcce363186ec1ce31577">&#9670;&nbsp;</a></span>entry_guard_parse_from_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC entry_guard_t* entry_guard_parse_from_state </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a string generated by <a class="el" href="entrynodes_8c.html#ae1db102ac34d25399676df24b415765b">entry_guard_encode_for_state()</a>, parse it (if possible) and return an entry_guard_t object for it. Return NULL on complete failure. </p>

</div>
</div>
<a id="a89cd1e4049c1b18c57214d9414586ad4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89cd1e4049c1b18c57214d9414586ad4">&#9670;&nbsp;</a></span>entry_guard_pick_for_circuit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int entry_guard_pick_for_circuit </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="entrynodes_8h.html#aef1363614195376e58c3090a0f1a4ff6">guard_usage_t</a>&#160;</td>
          <td class="paramname"><em>usage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">entry_guard_restriction_t *&#160;</td>
          <td class="paramname"><em>rst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structnode__t.html">node_t</a> **&#160;</td>
          <td class="paramname"><em>chosen_node_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">circuit_guard_state_t **&#160;</td>
          <td class="paramname"><em>guard_state_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pick a suitable entry guard for a circuit in, and place that guard in *<b>chosen_node_out</b>. Set *<b>guard_state_out</b> to an opaque state object that will record whether the circuit is ready to be used or not. Return 0 on success; on failure, return -1.</p>
<p>If a restriction is provided in <b>rst</b>, do not return any guards that violate it, and remember that restriction in <b>guard_state_out</b> for later use. (Takes ownership of the <b>rst</b> object.) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a89cd1e4049c1b18c57214d9414586ad4_cgraph.png" border="0" usemap="#entrynodes_8c_a89cd1e4049c1b18c57214d9414586ad4_cgraph" alt=""/></div>
<map name="entrynodes_8c_a89cd1e4049c1b18c57214d9414586ad4_cgraph" id="entrynodes_8c_a89cd1e4049c1b18c57214d9414586ad4_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a997305afc0db6f7e66d50f4273db1898" title="select_entry_guard\l_for_circuit" alt="" coords="196,5,328,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a89cd1e4049c1b18c57214d9414586ad4_icgraph.png" border="0" usemap="#entrynodes_8c_a89cd1e4049c1b18c57214d9414586ad4_icgraph" alt=""/></div>
<map name="entrynodes_8c_a89cd1e4049c1b18c57214d9414586ad4_icgraph" id="entrynodes_8c_a89cd1e4049c1b18c57214d9414586ad4_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a93db2fbe0af8230c60e96836cab30a29" title="guards_choose_dirguard" alt="" coords="196,13,359,39"/>
</map>
</div>

</div>
</div>
<a id="a554594e310c51064070d388bb682b1d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a554594e310c51064070d388bb682b1d4">&#9670;&nbsp;</a></span>entry_guard_restriction_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void entry_guard_restriction_free_ </td>
          <td>(</td>
          <td class="paramtype">entry_guard_restriction_t *&#160;</td>
          <td class="paramname"><em>rst</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all storage held in <b>restriction</b> </p>

</div>
</div>
<a id="aa42b6de85549bfc96f56f89cab179042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa42b6de85549bfc96f56f89cab179042">&#9670;&nbsp;</a></span>entry_guard_state_should_expire()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int entry_guard_state_should_expire </td>
          <td>(</td>
          <td class="paramtype">circuit_guard_state_t *&#160;</td>
          <td class="paramname"><em>guard_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff the circuit whose state is <b>guard_state</b> should expire. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_aa42b6de85549bfc96f56f89cab179042_cgraph.png" border="0" usemap="#entrynodes_8c_aa42b6de85549bfc96f56f89cab179042_cgraph" alt=""/></div>
<map name="entrynodes_8c_aa42b6de85549bfc96f56f89cab179042_cgraph" id="entrynodes_8c_aa42b6de85549bfc96f56f89cab179042_cgraph">
<area shape="rect" id="node2" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="253,5,346,32"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a2c7ec361faf235b7a77e9b73314046c5" title="get_nonprimary_guard\l_idle_timeout" alt="" coords="224,57,375,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_aa42b6de85549bfc96f56f89cab179042_icgraph.png" border="0" usemap="#entrynodes_8c_aa42b6de85549bfc96f56f89cab179042_icgraph" alt=""/></div>
<map name="entrynodes_8c_aa42b6de85549bfc96f56f89cab179042_icgraph" id="entrynodes_8c_aa42b6de85549bfc96f56f89cab179042_icgraph">
<area shape="rect" id="node2" href="circuituse_8h.html#a4be6726f65e9f2c81ad77a9c70002ad1" title="circuit_expire_waiting\l_for_better_guard" alt="" coords="224,5,371,47"/>
</map>
</div>

</div>
</div>
<a id="a5aceb4f4f990b9b3ed2ecea41abc9aab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aceb4f4f990b9b3ed2ecea41abc9aab">&#9670;&nbsp;</a></span>entry_guard_succeeded()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">guard_usable_t entry_guard_succeeded </td>
          <td>(</td>
          <td class="paramtype">circuit_guard_state_t **&#160;</td>
          <td class="paramname"><em>guard_state_p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called by the circuit building module when a circuit has succeeded: informs the guards code that the guard in *<b>guard_state_p</b> is working, and advances the state of the guard module. On a GUARD_USABLE_NEVER return value, the circuit is broken and should not be used. On a GUARD_USABLE_NOW return value, the circuit is ready to use. On a GUARD_MAYBE_USABLE_LATER return value, the circuit should not be used until we find out whether preferred guards will work for us. </p>

</div>
</div>
<a id="acad8e7ba6123e0a214361a425f711c05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acad8e7ba6123e0a214361a425f711c05">&#9670;&nbsp;</a></span>entry_guards_all_primary_guards_are_down()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int entry_guards_all_primary_guards_are_down </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff every primary guard in <b>gs</b> is believed to be unreachable. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_acad8e7ba6123e0a214361a425f711c05_cgraph.png" border="0" usemap="#entrynodes_8c_acad8e7ba6123e0a214361a425f711c05_cgraph" alt=""/></div>
<map name="entrynodes_8c_acad8e7ba6123e0a214361a425f711c05_cgraph" id="entrynodes_8c_acad8e7ba6123e0a214361a425f711c05_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801" title="entry_guards_update\l_primary" alt="" coords="220,125,363,166"/>
<area shape="rect" id="node8" href="entrynodes_8c.html#ab335f71d2749aa457ffd8a82065649c6" title="entry_guard_consider\l_retry" alt="" coords="836,209,983,250"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a045186178310a765b1193b31c9c98be8" title="get_n_primary_guards" alt="" coords="422,5,573,32"/>
<area shape="rect" id="node4" href="container_8c.html#a5e71fb7bc775f079d9f9d724f0203fc1" title="smartlist_add_all" alt="" coords="437,56,557,83"/>
<area shape="rect" id="node5" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="447,107,547,133"/>
<area shape="rect" id="node6" href="container_8c.html#abbb4ca13d840b2761ed4d70c63f0b2f4" title="smartlist_contains" alt="" coords="433,157,561,184"/>
<area shape="rect" id="node7" href="entrynodes_8c.html#a440f5217f0a557c13b02a251f93db5d6" title="sample_reachable_filtered\l_entry_guards" alt="" coords="411,209,584,250"/>
<area shape="rect" id="node10" href="entrynodes_8c.html#ac771815070c48fdafceda321e3b56739" title="num_reachable_filtered\l_guards" alt="" coords="632,209,788,250"/>
<area shape="rect" id="node9" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="1031,216,1124,243"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_acad8e7ba6123e0a214361a425f711c05_icgraph.png" border="0" usemap="#entrynodes_8c_acad8e7ba6123e0a214361a425f711c05_icgraph" alt=""/></div>
<map name="entrynodes_8c_acad8e7ba6123e0a214361a425f711c05_icgraph" id="entrynodes_8c_acad8e7ba6123e0a214361a425f711c05_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#af943c868320a66ee2dca652ad0555a32" title="entry_guards_upgrade\l_waiting_circuits" alt="" coords="220,5,371,47"/>
<area shape="rect" id="node3" href="circuitlist_8h.html#a8d569b96b07da7c91549695cc1ce8ccf" title="circuit_find_circuits\l_to_upgrade_from_guard_wait" alt="" coords="419,5,615,47"/>
<area shape="rect" id="node4" href="circuitbuild_8h.html#afbeee8004f6e86e019ed4c4a9556d7de" title="circuit_upgrade_circuits\l_from_guard_wait" alt="" coords="663,5,821,47"/>
</map>
</div>

</div>
</div>
<a id="a1aedcf8995075b212cce9d510e9e70d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aedcf8995075b212cce9d510e9e70d7">&#9670;&nbsp;</a></span>entry_guards_changed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void entry_guards_changed </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Our list of entry guards has changed for the default guard selection context, or some element of one of our entry guards has changed. Write the changes to disk within the next few minutes. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a1aedcf8995075b212cce9d510e9e70d7_cgraph.png" border="0" usemap="#entrynodes_8c_a1aedcf8995075b212cce9d510e9e70d7_cgraph" alt=""/></div>
<map name="entrynodes_8c_a1aedcf8995075b212cce9d510e9e70d7_cgraph" id="entrynodes_8c_a1aedcf8995075b212cce9d510e9e70d7_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#abe944c95b279887314f1101ada1f4884" title="entry_guards_changed\l_for_guard_selection" alt="" coords="213,5,367,47"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#ae55f2a4d95b0bc81220dd0464b8494f8" title="get_guard_selection_info" alt="" coords="207,71,373,98"/>
</map>
</div>

</div>
</div>
<a id="abe944c95b279887314f1101ada1f4884"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe944c95b279887314f1101ada1f4884">&#9670;&nbsp;</a></span>entry_guards_changed_for_guard_selection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void entry_guards_changed_for_guard_selection </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Our list of entry guards has changed for a particular guard selection context, or some element of one of our entry guards has changed for one. Write the changes to disk within the next few minutes. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_abe944c95b279887314f1101ada1f4884_icgraph.png" border="0" usemap="#entrynodes_8c_abe944c95b279887314f1101ada1f4884_icgraph" alt=""/></div>
<map name="entrynodes_8c_abe944c95b279887314f1101ada1f4884_icgraph" id="entrynodes_8c_abe944c95b279887314f1101ada1f4884_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a1aedcf8995075b212cce9d510e9e70d7" title="entry_guards_changed" alt="" coords="207,13,360,39"/>
</map>
</div>

</div>
</div>
<a id="a284215d5fcf3e4f5c33969072c4e27d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a284215d5fcf3e4f5c33969072c4e27d5">&#9670;&nbsp;</a></span>entry_guards_expand_sample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC entry_guard_t* entry_guards_expand_sample </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add new guards to the sampled guards in <b>gs</b> until there are enough usable filtered guards, but never grow the sample beyond its maximum size. Return the last guard added, or NULL if none were added. </p>

</div>
</div>
<a id="afe2c7c43057097f0ca57f4429249f576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe2c7c43057097f0ca57f4429249f576">&#9670;&nbsp;</a></span>entry_guards_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void entry_guards_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all storage held by the list of entry guards and related memory structs. </p>

</div>
</div>
<a id="a1f69ddf668f984f783eb7cfcb358185e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f69ddf668f984f783eb7cfcb358185e">&#9670;&nbsp;</a></span>entry_guards_get_err_str_if_dir_info_missing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* entry_guards_get_err_str_if_dir_info_missing </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>using_mds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_present</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_usable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As guard_selection_have_enough_dir_info_to_build_circuits, but uses the default guard selection. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a1f69ddf668f984f783eb7cfcb358185e_cgraph.png" border="0" usemap="#entrynodes_8c_a1f69ddf668f984f783eb7cfcb358185e_cgraph" alt=""/></div>
<map name="entrynodes_8c_a1f69ddf668f984f783eb7cfcb358185e_cgraph" id="entrynodes_8c_a1f69ddf668f984f783eb7cfcb358185e_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a0e9ad8a9d2d435a30b8ece9e786533bf" title="guard_selection_get\l_err_str_if_dir_info\l_missing" alt="" coords="226,125,365,181"/>
<area shape="rect" id="node13" href="entrynodes_8c.html#ae55f2a4d95b0bc81220dd0464b8494f8" title="get_guard_selection_info" alt="" coords="212,205,379,232"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801" title="entry_guards_update\l_primary" alt="" coords="431,99,573,141"/>
<area shape="rect" id="node12" href="entrynodes_8c.html#acca85058789d4eb247b7e560bfeb7767" title="get_n_primary_guards\l_to_use" alt="" coords="427,165,577,206"/>
<area shape="rect" id="node4" href="entrynodes_8c.html#a045186178310a765b1193b31c9c98be8" title="get_n_primary_guards" alt="" coords="637,5,787,32"/>
<area shape="rect" id="node5" href="container_8c.html#a5e71fb7bc775f079d9f9d724f0203fc1" title="smartlist_add_all" alt="" coords="652,56,772,83"/>
<area shape="rect" id="node6" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="662,107,762,133"/>
<area shape="rect" id="node7" href="container_8c.html#abbb4ca13d840b2761ed4d70c63f0b2f4" title="smartlist_contains" alt="" coords="648,157,776,184"/>
<area shape="rect" id="node8" href="entrynodes_8c.html#a440f5217f0a557c13b02a251f93db5d6" title="sample_reachable_filtered\l_entry_guards" alt="" coords="625,209,799,250"/>
<area shape="rect" id="node9" href="entrynodes_8c.html#ab335f71d2749aa457ffd8a82065649c6" title="entry_guard_consider\l_retry" alt="" coords="1051,209,1197,250"/>
<area shape="rect" id="node11" href="entrynodes_8c.html#ac771815070c48fdafceda321e3b56739" title="num_reachable_filtered\l_guards" alt="" coords="847,238,1003,279"/>
<area shape="rect" id="node10" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="1245,216,1339,243"/>
</map>
</div>

</div>
</div>
<a id="a1dcd016fd276da6af70697a39ab2b372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dcd016fd276da6af70697a39ab2b372">&#9670;&nbsp;</a></span>entry_guards_note_guard_failure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void entry_guards_note_guard_failure </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">entry_guard_t *&#160;</td>
          <td class="paramname"><em>guard</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Note that we failed to connect to or build circuits through <b>guard</b>. Use with a guard returned by <a class="el" href="entrynodes_8c.html#a997305afc0db6f7e66d50f4273db1898">select_entry_guard_for_circuit()</a>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a1dcd016fd276da6af70697a39ab2b372_cgraph.png" border="0" usemap="#entrynodes_8c_a1dcd016fd276da6af70697a39ab2b372_cgraph" alt=""/></div>
<map name="entrynodes_8c_a1dcd016fd276da6af70697a39ab2b372_cgraph" id="entrynodes_8c_a1dcd016fd276da6af70697a39ab2b372_cgraph">
<area shape="rect" id="node2" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="221,13,315,39"/>
</map>
</div>

</div>
</div>
<a id="aa020db50cb3f41bd32d264228a2bc249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa020db50cb3f41bd32d264228a2bc249">&#9670;&nbsp;</a></span>entry_guards_note_guard_success()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC unsigned entry_guards_note_guard_success </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">entry_guard_t *&#160;</td>
          <td class="paramname"><em>guard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>old_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Note that we successfully connected to, and built a circuit through <b>guard</b>. Given the old guard-state of the circuit in <b>old_state</b>, return the new guard-state of the circuit.</p>
<p>Be aware: the circuit is only usable when its guard-state becomes GUARD_CIRC_STATE_COMPLETE. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_aa020db50cb3f41bd32d264228a2bc249_cgraph.png" border="0" usemap="#entrynodes_8c_aa020db50cb3f41bd32d264228a2bc249_cgraph" alt=""/></div>
<map name="entrynodes_8c_aa020db50cb3f41bd32d264228a2bc249_cgraph" id="entrynodes_8c_aa020db50cb3f41bd32d264228a2bc249_cgraph">
<area shape="rect" id="node2" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="1047,93,1140,120"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#ae0098c969567b69eb585160f12700b06" title="make_guard_confirmed" alt="" coords="221,53,379,80"/>
<area shape="rect" id="node4" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801" title="entry_guards_update\l_primary" alt="" coords="229,126,371,167"/>
<area shape="rect" id="node5" href="entrynodes_8c.html#a045186178310a765b1193b31c9c98be8" title="get_n_primary_guards" alt="" coords="438,43,589,69"/>
<area shape="rect" id="node6" href="container_8c.html#a5e71fb7bc775f079d9f9d724f0203fc1" title="smartlist_add_all" alt="" coords="453,93,573,120"/>
<area shape="rect" id="node7" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="463,144,563,171"/>
<area shape="rect" id="node8" href="container_8c.html#abbb4ca13d840b2761ed4d70c63f0b2f4" title="smartlist_contains" alt="" coords="449,195,577,221"/>
<area shape="rect" id="node9" href="entrynodes_8c.html#a440f5217f0a557c13b02a251f93db5d6" title="sample_reachable_filtered\l_entry_guards" alt="" coords="427,246,600,287"/>
<area shape="rect" id="node10" href="entrynodes_8c.html#ab335f71d2749aa457ffd8a82065649c6" title="entry_guard_consider\l_retry" alt="" coords="852,187,999,229"/>
<area shape="rect" id="node11" href="entrynodes_8c.html#ac771815070c48fdafceda321e3b56739" title="num_reachable_filtered\l_guards" alt="" coords="648,246,804,287"/>
</map>
</div>

</div>
</div>
<a id="a61c84cb9bea9ab7fbeff429a27893c33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61c84cb9bea9ab7fbeff429a27893c33">&#9670;&nbsp;</a></span>entry_guards_note_internet_connectivity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void entry_guards_note_internet_connectivity </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tell the entry guards subsystem that we have confirmed that as of just now, we're on the internet. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a61c84cb9bea9ab7fbeff429a27893c33_cgraph.png" border="0" usemap="#entrynodes_8c_a61c84cb9bea9ab7fbeff429a27893c33_cgraph" alt=""/></div>
<map name="entrynodes_8c_a61c84cb9bea9ab7fbeff429a27893c33_cgraph" id="entrynodes_8c_a61c84cb9bea9ab7fbeff429a27893c33_cgraph">
<area shape="rect" id="node2" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="232,13,325,39"/>
</map>
</div>

</div>
</div>
<a id="a9fe13e92c8806b6fe22889c7e7b303f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fe13e92c8806b6fe22889c7e7b303f5">&#9670;&nbsp;</a></span>entry_guards_parse_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int entry_guards_parse_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__state__t.html">or_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>set</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse <b>state</b> and learn about the entry guards it describes. If <b>set</b> is true, and there are no errors, replace the guard list in the default guard selection context with what we find. On success, return 0. On failure, alloc into *<b>msg</b> a string describing the error, and return -1. </p>

</div>
</div>
<a id="a4360ef3264ab398b48b851e0d2d675b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4360ef3264ab398b48b851e0d2d675b5">&#9670;&nbsp;</a></span>entry_guards_update_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int entry_guards_update_all </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update all derived pieces of the guard selection state in <b>gs</b>. Return true iff we should stop using all previously generated circuits. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a4360ef3264ab398b48b851e0d2d675b5_cgraph.png" border="0" usemap="#entrynodes_8c_a4360ef3264ab398b48b851e0d2d675b5_cgraph" alt=""/></div>
<map name="entrynodes_8c_a4360ef3264ab398b48b851e0d2d675b5_cgraph" id="entrynodes_8c_a4360ef3264ab398b48b851e0d2d675b5_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#af2a8cbdaeab1361a4527e0d1b6233f25" title="sampled_guards_update\l_from_consensus" alt="" coords="216,5,379,47"/>
<area shape="rect" id="node4" href="entrynodes_8c.html#a6d8b3b670aac830e78037876f2a000ea" title="entry_guards_update\l_filtered_sets" alt="" coords="226,71,369,112"/>
<area shape="rect" id="node5" href="entrynodes_8c.html#a691aafe1ed64f00a693b7bd1b0675ef1" title="entry_guards_update\l_confirmed" alt="" coords="226,136,369,177"/>
<area shape="rect" id="node9" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801" title="entry_guards_update\l_primary" alt="" coords="226,252,369,293"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a8eea3721f2ce3de824f68890f6ab1778" title="get_remove_unlisted\l_guards_after_days" alt="" coords="442,5,585,47"/>
<area shape="rect" id="node6" href="container_8c.html#ad24500d61ff1dbb6c845a8a70f6d2f14" title="smartlist_clear" alt="" coords="460,82,567,109"/>
<area shape="rect" id="node7" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="463,183,563,210"/>
<area shape="rect" id="node8" href="container_8c.html#adeb0528c65b62117acb2b8f6e2b0e910" title="smartlist_sort" alt="" coords="463,133,564,159"/>
<area shape="rect" id="node10" href="entrynodes_8c.html#a045186178310a765b1193b31c9c98be8" title="get_n_primary_guards" alt="" coords="438,234,589,261"/>
<area shape="rect" id="node11" href="container_8c.html#a5e71fb7bc775f079d9f9d724f0203fc1" title="smartlist_add_all" alt="" coords="453,285,573,311"/>
<area shape="rect" id="node12" href="container_8c.html#abbb4ca13d840b2761ed4d70c63f0b2f4" title="smartlist_contains" alt="" coords="449,335,577,362"/>
<area shape="rect" id="node13" href="entrynodes_8c.html#a440f5217f0a557c13b02a251f93db5d6" title="sample_reachable_filtered\l_entry_guards" alt="" coords="427,387,600,428"/>
<area shape="rect" id="node14" href="entrynodes_8c.html#ab335f71d2749aa457ffd8a82065649c6" title="entry_guard_consider\l_retry" alt="" coords="852,387,999,428"/>
<area shape="rect" id="node16" href="entrynodes_8c.html#ac771815070c48fdafceda321e3b56739" title="num_reachable_filtered\l_guards" alt="" coords="648,416,804,457"/>
<area shape="rect" id="node15" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="1047,394,1140,421"/>
</map>
</div>

</div>
</div>
<a id="a691aafe1ed64f00a693b7bd1b0675ef1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a691aafe1ed64f00a693b7bd1b0675ef1">&#9670;&nbsp;</a></span>entry_guards_update_confirmed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void entry_guards_update_confirmed </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find the confirmed guards from among the sampled guards in <b>gs</b>, and put them in confirmed_entry_guards in the correct order. Recalculate their indices. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a691aafe1ed64f00a693b7bd1b0675ef1_cgraph.png" border="0" usemap="#entrynodes_8c_a691aafe1ed64f00a693b7bd1b0675ef1_cgraph" alt=""/></div>
<map name="entrynodes_8c_a691aafe1ed64f00a693b7bd1b0675ef1_cgraph" id="entrynodes_8c_a691aafe1ed64f00a693b7bd1b0675ef1_cgraph">
<area shape="rect" id="node2" href="container_8c.html#ad24500d61ff1dbb6c845a8a70f6d2f14" title="smartlist_clear" alt="" coords="196,5,303,32"/>
<area shape="rect" id="node3" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="199,56,299,83"/>
<area shape="rect" id="node4" href="container_8c.html#adeb0528c65b62117acb2b8f6e2b0e910" title="smartlist_sort" alt="" coords="199,107,300,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a691aafe1ed64f00a693b7bd1b0675ef1_icgraph.png" border="0" usemap="#entrynodes_8c_a691aafe1ed64f00a693b7bd1b0675ef1_icgraph" alt=""/></div>
<map name="entrynodes_8c_a691aafe1ed64f00a693b7bd1b0675ef1_icgraph" id="entrynodes_8c_a691aafe1ed64f00a693b7bd1b0675ef1_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a4360ef3264ab398b48b851e0d2d675b5" title="entry_guards_update_all" alt="" coords="196,13,359,39"/>
</map>
</div>

</div>
</div>
<a id="a6d8b3b670aac830e78037876f2a000ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d8b3b670aac830e78037876f2a000ea">&#9670;&nbsp;</a></span>entry_guards_update_filtered_sets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void entry_guards_update_filtered_sets </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update the <b>is_filtered_guard</b> and <b>is_usable_filtered_guard</b> flag on every guard in <b>gs</b>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a6d8b3b670aac830e78037876f2a000ea_icgraph.png" border="0" usemap="#entrynodes_8c_a6d8b3b670aac830e78037876f2a000ea_icgraph" alt=""/></div>
<map name="entrynodes_8c_a6d8b3b670aac830e78037876f2a000ea_icgraph" id="entrynodes_8c_a6d8b3b670aac830e78037876f2a000ea_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a4360ef3264ab398b48b851e0d2d675b5" title="entry_guards_update_all" alt="" coords="196,13,359,39"/>
</map>
</div>

</div>
</div>
<a id="a0715381bede98a7d8f4da7f73d062801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0715381bede98a7d8f4da7f73d062801">&#9670;&nbsp;</a></span>entry_guards_update_primary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void entry_guards_update_primary </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Recalculate the list of primary guards (the ones we'd prefer to use) from the filtered sample and the confirmed list. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a0715381bede98a7d8f4da7f73d062801_cgraph.png" border="0" usemap="#entrynodes_8c_a0715381bede98a7d8f4da7f73d062801_cgraph" alt=""/></div>
<map name="entrynodes_8c_a0715381bede98a7d8f4da7f73d062801_cgraph" id="entrynodes_8c_a0715381bede98a7d8f4da7f73d062801_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a045186178310a765b1193b31c9c98be8" title="get_n_primary_guards" alt="" coords="207,5,358,32"/>
<area shape="rect" id="node3" href="container_8c.html#a5e71fb7bc775f079d9f9d724f0203fc1" title="smartlist_add_all" alt="" coords="223,56,343,83"/>
<area shape="rect" id="node4" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="233,107,333,133"/>
<area shape="rect" id="node5" href="container_8c.html#abbb4ca13d840b2761ed4d70c63f0b2f4" title="smartlist_contains" alt="" coords="219,157,347,184"/>
<area shape="rect" id="node6" href="entrynodes_8c.html#a440f5217f0a557c13b02a251f93db5d6" title="sample_reachable_filtered\l_entry_guards" alt="" coords="196,209,369,250"/>
<area shape="rect" id="node7" href="entrynodes_8c.html#ab335f71d2749aa457ffd8a82065649c6" title="entry_guard_consider\l_retry" alt="" coords="621,209,768,250"/>
<area shape="rect" id="node9" href="entrynodes_8c.html#ac771815070c48fdafceda321e3b56739" title="num_reachable_filtered\l_guards" alt="" coords="417,238,573,279"/>
<area shape="rect" id="node8" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="816,216,909,243"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a0715381bede98a7d8f4da7f73d062801_icgraph.png" border="0" usemap="#entrynodes_8c_a0715381bede98a7d8f4da7f73d062801_icgraph" alt=""/></div>
<map name="entrynodes_8c_a0715381bede98a7d8f4da7f73d062801_icgraph" id="entrynodes_8c_a0715381bede98a7d8f4da7f73d062801_icgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a30a477e0e6936f2e44747be238f30dd7" title="mark_primary_guards\l_maybe_reachable" alt="" coords="207,5,353,47"/>
<area shape="rect" id="node4" href="entrynodes_8c.html#aa020db50cb3f41bd32d264228a2bc249" title="entry_guards_note_guard\l_success" alt="" coords="196,71,364,112"/>
<area shape="rect" id="node5" href="entrynodes_8c.html#acad8e7ba6123e0a214361a425f711c05" title="entry_guards_all_primary\l_guards_are_down" alt="" coords="197,136,363,177"/>
<area shape="rect" id="node9" href="entrynodes_8h.html#a4360ef3264ab398b48b851e0d2d675b5" title="entry_guards_update_all" alt="" coords="199,202,361,229"/>
<area shape="rect" id="node10" href="entrynodes_8h.html#a0e9ad8a9d2d435a30b8ece9e786533bf" title="guard_selection_get\l_err_str_if_dir_info\l_missing" alt="" coords="211,253,349,309"/>
<area shape="rect" id="node3" href="entrynodes_8h.html#aa9eddf77d45dab94c87c4ae9e9a659fb" title="guards_retry_optimistic" alt="" coords="413,13,570,39"/>
<area shape="rect" id="node6" href="entrynodes_8h.html#af943c868320a66ee2dca652ad0555a32" title="entry_guards_upgrade\l_waiting_circuits" alt="" coords="416,136,567,177"/>
<area shape="rect" id="node7" href="circuitlist_8h.html#a8d569b96b07da7c91549695cc1ce8ccf" title="circuit_find_circuits\l_to_upgrade_from_guard_wait" alt="" coords="619,136,815,177"/>
<area shape="rect" id="node8" href="circuitbuild_8h.html#afbeee8004f6e86e019ed4c4a9556d7de" title="circuit_upgrade_circuits\l_from_guard_wait" alt="" coords="863,136,1021,177"/>
<area shape="rect" id="node11" href="entrynodes_8h.html#a1f69ddf668f984f783eb7cfcb358185e" title="entry_guards_get_err\l_str_if_dir_info_missing" alt="" coords="412,260,571,301"/>
</map>
</div>

</div>
</div>
<a id="a6e4a5b6f39d4d23a701fa0ddc38e3e17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e4a5b6f39d4d23a701fa0ddc38e3e17">&#9670;&nbsp;</a></span>entry_guards_update_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void entry_guards_update_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__state__t.html">or_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If the entry guard info has not changed, do nothing and return. Otherwise, free the EntryGuards piece of <b>state</b> and create a new one out of the global entry_guards list, and then mark <b>state</b> dirty so it will get saved to disk. </p>

</div>
</div>
<a id="a30eec9f6966e2df9934d3d9770e45df9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30eec9f6966e2df9934d3d9770e45df9">&#9670;&nbsp;</a></span>entry_guards_upgrade_waiting_circuits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int entry_guards_upgrade_waiting_circuits </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>all_circuits_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>newly_complete_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Look at all of the <a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> * objects in <b>all_circuits_in</b>, and see if any of them that were previously not ready to use for guard-related reasons are now ready to use. Place those circuits in <b>newly_complete_out</b>, and mark them COMPLETE.</p>
<p>Return 1 if we upgraded any circuits, and 0 otherwise. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a30eec9f6966e2df9934d3d9770e45df9_cgraph.png" border="0" usemap="#entrynodes_8c_a30eec9f6966e2df9934d3d9770e45df9_cgraph" alt=""/></div>
<map name="entrynodes_8c_a30eec9f6966e2df9934d3d9770e45df9_cgraph" id="entrynodes_8c_a30eec9f6966e2df9934d3d9770e45df9_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#acad8e7ba6123e0a214361a425f711c05" title="entry_guards_all_primary\l_guards_are_down" alt="" coords="204,197,371,238"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801" title="entry_guards_update\l_primary" alt="" coords="419,125,561,166"/>
<area shape="rect" id="node9" href="entrynodes_8c.html#ab335f71d2749aa457ffd8a82065649c6" title="entry_guard_consider\l_retry" alt="" coords="1035,209,1181,250"/>
<area shape="rect" id="node4" href="entrynodes_8c.html#a045186178310a765b1193b31c9c98be8" title="get_n_primary_guards" alt="" coords="621,5,771,32"/>
<area shape="rect" id="node5" href="container_8c.html#a5e71fb7bc775f079d9f9d724f0203fc1" title="smartlist_add_all" alt="" coords="636,56,756,83"/>
<area shape="rect" id="node6" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="646,107,746,133"/>
<area shape="rect" id="node7" href="container_8c.html#abbb4ca13d840b2761ed4d70c63f0b2f4" title="smartlist_contains" alt="" coords="632,157,760,184"/>
<area shape="rect" id="node8" href="entrynodes_8c.html#a440f5217f0a557c13b02a251f93db5d6" title="sample_reachable_filtered\l_entry_guards" alt="" coords="609,209,783,250"/>
<area shape="rect" id="node11" href="entrynodes_8c.html#ac771815070c48fdafceda321e3b56739" title="num_reachable_filtered\l_guards" alt="" coords="831,209,987,250"/>
<area shape="rect" id="node10" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="1229,216,1323,243"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a30eec9f6966e2df9934d3d9770e45df9_icgraph.png" border="0" usemap="#entrynodes_8c_a30eec9f6966e2df9934d3d9770e45df9_icgraph" alt=""/></div>
<map name="entrynodes_8c_a30eec9f6966e2df9934d3d9770e45df9_icgraph" id="entrynodes_8c_a30eec9f6966e2df9934d3d9770e45df9_icgraph">
<area shape="rect" id="node2" href="circuitlist_8h.html#a8d569b96b07da7c91549695cc1ce8ccf" title="circuit_find_circuits\l_to_upgrade_from_guard_wait" alt="" coords="204,5,400,47"/>
<area shape="rect" id="node3" href="circuitbuild_8h.html#afbeee8004f6e86e019ed4c4a9556d7de" title="circuit_upgrade_circuits\l_from_guard_wait" alt="" coords="448,5,607,47"/>
</map>
</div>

</div>
</div>
<a id="a574dc0f7b96e7da5652ddb234d42adb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a574dc0f7b96e7da5652ddb234d42adb3">&#9670;&nbsp;</a></span>entry_list_is_constrained()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int entry_list_is_constrained </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return 0 if we're fine adding arbitrary routers out of the directory to our entry guard list, or return 1 if we have a list already and we must stick to it. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a574dc0f7b96e7da5652ddb234d42adb3_icgraph.png" border="0" usemap="#entrynodes_8c_a574dc0f7b96e7da5652ddb234d42adb3_icgraph" alt=""/></div>
<map name="entrynodes_8c_a574dc0f7b96e7da5652ddb234d42adb3_icgraph" id="entrynodes_8c_a574dc0f7b96e7da5652ddb234d42adb3_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#aa9eddf77d45dab94c87c4ae9e9a659fb" title="guards_retry_optimistic" alt="" coords="220,5,377,32"/>
</map>
</div>

</div>
</div>
<a id="a3e1881dfc0c2926b6fea95cb22ef904d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e1881dfc0c2926b6fea95cb22ef904d">&#9670;&nbsp;</a></span>get_extreme_restriction_threshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC double get_extreme_restriction_threshold </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If our configuration retains fewer than this fraction of guards from the torrc, we are in an extremely restricted setting, and should warn. </p>

</div>
</div>
<a id="a59d1e35a0ef7aee589078c526fc0da40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59d1e35a0ef7aee589078c526fc0da40">&#9670;&nbsp;</a></span>get_guard_confirmed_min_lifetime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int get_guard_confirmed_min_lifetime </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We remove confirmed guards from the sample if they were sampled GUARD_LIFETIME_DAYS ago and confirmed this many days ago. </p>

</div>
</div>
<a id="ae41f8e975c87c2a80c3f73b8d76e1d34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae41f8e975c87c2a80c3f73b8d76e1d34">&#9670;&nbsp;</a></span>get_guard_lifetime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int get_guard_lifetime </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We remove unconfirmed guards from the sample after this many days, regardless of whether they are listed or unlisted. </p>

</div>
</div>
<a id="a4ce04a08aa5735caf86d77a168eec0d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ce04a08aa5735caf86d77a168eec0d4">&#9670;&nbsp;</a></span>get_guard_selection_by_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC guard_selection_t* get_guard_selection_by_name </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">guard_selection_type_t&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>create_if_absent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the guard selection called <b>name</b>. If there is none, and <b>create_if_absent</b> is true, then create and return it. If there is none, and <b>create_if_absent</b> is false, then return NULL. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a4ce04a08aa5735caf86d77a168eec0d4_icgraph.png" border="0" usemap="#entrynodes_8c_a4ce04a08aa5735caf86d77a168eec0d4_icgraph" alt=""/></div>
<map name="entrynodes_8c_a4ce04a08aa5735caf86d77a168eec0d4_icgraph" id="entrynodes_8c_a4ce04a08aa5735caf86d77a168eec0d4_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a06acab15b1c0a42b82485bf1f4fa78ed" title="entry_guard_learned\l_bridge_identity" alt="" coords="192,5,331,47"/>
</map>
</div>

</div>
</div>
<a id="ae55f2a4d95b0bc81220dd0464b8494f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae55f2a4d95b0bc81220dd0464b8494f8">&#9670;&nbsp;</a></span>get_guard_selection_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">guard_selection_t* get_guard_selection_info </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get current default guard_selection_t, creating it if necessary </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_ae55f2a4d95b0bc81220dd0464b8494f8_icgraph.png" border="0" usemap="#entrynodes_8c_ae55f2a4d95b0bc81220dd0464b8494f8_icgraph" alt=""/></div>
<map name="entrynodes_8c_ae55f2a4d95b0bc81220dd0464b8494f8_icgraph" id="entrynodes_8c_ae55f2a4d95b0bc81220dd0464b8494f8_icgraph">
<area shape="rect" id="node2" href="circuitlist_8h.html#a8d569b96b07da7c91549695cc1ce8ccf" title="circuit_find_circuits\l_to_upgrade_from_guard_wait" alt="" coords="220,5,416,47"/>
<area shape="rect" id="node4" href="entrynodes_8h.html#a059f7981078a896a9349a578b82bc645" title="entry_guard_get_by\l_id_digest" alt="" coords="250,71,386,112"/>
<area shape="rect" id="node5" href="entrynodes_8h.html#aab5f4a60cc416cbf7109763a3b44c45a" title="get_guard_state_for\l_bridge_desc_fetch" alt="" coords="249,136,387,177"/>
<area shape="rect" id="node6" href="entrynodes_8h.html#a1aedcf8995075b212cce9d510e9e70d7" title="entry_guards_changed" alt="" coords="241,202,395,229"/>
<area shape="rect" id="node7" href="entrynodes_8h.html#ae3a6a46f97e2693fa41867ff68a88a0f" title="getinfo_helper_entry\l_guards" alt="" coords="249,253,387,295"/>
<area shape="rect" id="node8" href="entrynodes_8h.html#a2059c6a8b0ae5f6bd64087fe00a27d9d" title="remove_all_entry_guards" alt="" coords="235,319,401,346"/>
<area shape="rect" id="node9" href="entrynodes_8h.html#a93db2fbe0af8230c60e96836cab30a29" title="guards_choose_dirguard" alt="" coords="237,370,399,397"/>
<area shape="rect" id="node10" href="entrynodes_8h.html#aa9eddf77d45dab94c87c4ae9e9a659fb" title="guards_retry_optimistic" alt="" coords="239,421,397,447"/>
<area shape="rect" id="node11" href="entrynodes_8h.html#a1f69ddf668f984f783eb7cfcb358185e" title="entry_guards_get_err\l_str_if_dir_info_missing" alt="" coords="239,472,397,513"/>
<area shape="rect" id="node3" href="circuitbuild_8h.html#afbeee8004f6e86e019ed4c4a9556d7de" title="circuit_upgrade_circuits\l_from_guard_wait" alt="" coords="464,5,623,47"/>
</map>
</div>

</div>
</div>
<a id="aab5f4a60cc416cbf7109763a3b44c45a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab5f4a60cc416cbf7109763a3b44c45a">&#9670;&nbsp;</a></span>get_guard_state_for_bridge_desc_fetch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">circuit_guard_state_t* get_guard_state_for_bridge_desc_fetch </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>digest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We are about to connect to bridge with identity <b>digest</b> to fetch its descriptor. Create a new guard state for this connection and return it. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_aab5f4a60cc416cbf7109763a3b44c45a_cgraph.png" border="0" usemap="#entrynodes_8c_aab5f4a60cc416cbf7109763a3b44c45a_cgraph" alt=""/></div>
<map name="entrynodes_8c_aab5f4a60cc416cbf7109763a3b44c45a_cgraph" id="entrynodes_8c_aab5f4a60cc416cbf7109763a3b44c45a_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a9ecb7c2ddf9746ab0b0cb62a2239b6f6" title="entry_guard_get_by\l_id_digest_for_guard\l_selection" alt="" coords="203,5,345,61"/>
<area shape="rect" id="node5" href="entrynodes_8c.html#ae55f2a4d95b0bc81220dd0464b8494f8" title="get_guard_selection_info" alt="" coords="191,85,357,112"/>
<area shape="rect" id="node6" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="227,136,321,163"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a85c4a90c7407cd8c13fae402c414a5c8" title="get_sampled_guard_with_id" alt="" coords="405,20,588,47"/>
<area shape="rect" id="node4" href="di__ops_8c.html#a473334ee93cca0aea10523321a444ea3" title="tor_memeq" alt="" coords="636,20,723,47"/>
</map>
</div>

</div>
</div>
<a id="afeb688f386509434c598e00be58b1fd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeb688f386509434c598e00be58b1fd5">&#9670;&nbsp;</a></span>get_internet_likely_down_interval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int get_internet_likely_down_interval </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If we haven't successfully built or used a circuit in this long, then consider that the internet is probably down. </p>

</div>
</div>
<a id="a98b98d186ce126225c6d12ab85912aa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98b98d186ce126225c6d12ab85912aa1">&#9670;&nbsp;</a></span>get_max_sample_size_absolute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int get_max_sample_size_absolute </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We never let our sampled guard set grow larger than this number. </p>

</div>
</div>
<a id="abc0d21d94e5a6c9569b2315f49f8e652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc0d21d94e5a6c9569b2315f49f8e652">&#9670;&nbsp;</a></span>get_max_sample_threshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC double get_max_sample_threshold </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We never let our sampled guard set grow larger than this fraction of the guards on the network. </p>

</div>
</div>
<a id="a25a11e12a2c15465561ceb978ee3af2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25a11e12a2c15465561ceb978ee3af2f">&#9670;&nbsp;</a></span>get_meaningful_restriction_threshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC double get_meaningful_restriction_threshold </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If our configuration retains fewer than this fraction of guards from the torrc, we are in a restricted setting. </p>

</div>
</div>
<a id="a4b05b0c16452a4211e371d6aab9d3ee8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b05b0c16452a4211e371d6aab9d3ee8">&#9670;&nbsp;</a></span>get_min_filtered_sample_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int get_min_filtered_sample_size </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We always try to make our sample contain at least this many guards. </p>

</div>
</div>
<a id="a045186178310a765b1193b31c9c98be8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a045186178310a765b1193b31c9c98be8">&#9670;&nbsp;</a></span>get_n_primary_guards()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int get_n_primary_guards </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many guards do we try to keep on our primary guard list? </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a045186178310a765b1193b31c9c98be8_icgraph.png" border="0" usemap="#entrynodes_8c_a045186178310a765b1193b31c9c98be8_icgraph" alt=""/></div>
<map name="entrynodes_8c_a045186178310a765b1193b31c9c98be8_icgraph" id="entrynodes_8c_a045186178310a765b1193b31c9c98be8_icgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801" title="entry_guards_update\l_primary" alt="" coords="204,136,347,177"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a30a477e0e6936f2e44747be238f30dd7" title="mark_primary_guards\l_maybe_reachable" alt="" coords="405,5,552,47"/>
<area shape="rect" id="node5" href="entrynodes_8c.html#aa020db50cb3f41bd32d264228a2bc249" title="entry_guards_note_guard\l_success" alt="" coords="395,71,563,112"/>
<area shape="rect" id="node6" href="entrynodes_8c.html#acad8e7ba6123e0a214361a425f711c05" title="entry_guards_all_primary\l_guards_are_down" alt="" coords="395,136,562,177"/>
<area shape="rect" id="node10" href="entrynodes_8h.html#a4360ef3264ab398b48b851e0d2d675b5" title="entry_guards_update_all" alt="" coords="397,202,560,229"/>
<area shape="rect" id="node11" href="entrynodes_8h.html#a0e9ad8a9d2d435a30b8ece9e786533bf" title="guard_selection_get\l_err_str_if_dir_info\l_missing" alt="" coords="409,253,548,309"/>
<area shape="rect" id="node4" href="entrynodes_8h.html#aa9eddf77d45dab94c87c4ae9e9a659fb" title="guards_retry_optimistic" alt="" coords="611,13,769,39"/>
<area shape="rect" id="node7" href="entrynodes_8h.html#af943c868320a66ee2dca652ad0555a32" title="entry_guards_upgrade\l_waiting_circuits" alt="" coords="615,136,765,177"/>
<area shape="rect" id="node8" href="circuitlist_8h.html#a8d569b96b07da7c91549695cc1ce8ccf" title="circuit_find_circuits\l_to_upgrade_from_guard_wait" alt="" coords="817,136,1013,177"/>
<area shape="rect" id="node9" href="circuitbuild_8h.html#afbeee8004f6e86e019ed4c4a9556d7de" title="circuit_upgrade_circuits\l_from_guard_wait" alt="" coords="1061,136,1220,177"/>
<area shape="rect" id="node12" href="entrynodes_8h.html#a1f69ddf668f984f783eb7cfcb358185e" title="entry_guards_get_err\l_str_if_dir_info_missing" alt="" coords="611,260,769,301"/>
</map>
</div>

</div>
</div>
<a id="acca85058789d4eb247b7e560bfeb7767"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acca85058789d4eb247b7e560bfeb7767">&#9670;&nbsp;</a></span>get_n_primary_guards_to_use()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int get_n_primary_guards_to_use </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="entrynodes_8h.html#aef1363614195376e58c3090a0f1a4ff6">guard_usage_t</a>&#160;</td>
          <td class="paramname"><em>usage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of the live primary guards we should look at when making a circuit. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_acca85058789d4eb247b7e560bfeb7767_icgraph.png" border="0" usemap="#entrynodes_8c_acca85058789d4eb247b7e560bfeb7767_icgraph" alt=""/></div>
<map name="entrynodes_8c_acca85058789d4eb247b7e560bfeb7767_icgraph" id="entrynodes_8c_acca85058789d4eb247b7e560bfeb7767_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a0e9ad8a9d2d435a30b8ece9e786533bf" title="guard_selection_get\l_err_str_if_dir_info\l_missing" alt="" coords="204,5,343,61"/>
<area shape="rect" id="node3" href="entrynodes_8h.html#a1f69ddf668f984f783eb7cfcb358185e" title="entry_guards_get_err\l_str_if_dir_info_missing" alt="" coords="391,13,549,54"/>
</map>
</div>

</div>
</div>
<a id="a99a0819d62fb5b014597c4afa1c46acb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99a0819d62fb5b014597c4afa1c46acb">&#9670;&nbsp;</a></span>get_nonprimary_guard_connect_timeout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int get_nonprimary_guard_connect_timeout </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If we're trying to connect to a nonprimary guard for at least this many seconds, and we haven't gotten the connection to work, we will treat lower-priority guards as usable. </p>

</div>
</div>
<a id="a2c7ec361faf235b7a77e9b73314046c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c7ec361faf235b7a77e9b73314046c5">&#9670;&nbsp;</a></span>get_nonprimary_guard_idle_timeout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int get_nonprimary_guard_idle_timeout </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If a circuit has been sitting around in 'waiting for better guard' state for at least this long, we'll expire it. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a2c7ec361faf235b7a77e9b73314046c5_icgraph.png" border="0" usemap="#entrynodes_8c_a2c7ec361faf235b7a77e9b73314046c5_icgraph" alt=""/></div>
<map name="entrynodes_8c_a2c7ec361faf235b7a77e9b73314046c5_icgraph" id="entrynodes_8c_a2c7ec361faf235b7a77e9b73314046c5_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#aa42b6de85549bfc96f56f89cab179042" title="entry_guard_state_should\l_expire" alt="" coords="204,5,375,47"/>
<area shape="rect" id="node3" href="circuituse_8h.html#a4be6726f65e9f2c81ad77a9c70002ad1" title="circuit_expire_waiting\l_for_better_guard" alt="" coords="423,5,569,47"/>
</map>
</div>

</div>
</div>
<a id="a8eea3721f2ce3de824f68890f6ab1778"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eea3721f2ce3de824f68890f6ab1778">&#9670;&nbsp;</a></span>get_remove_unlisted_guards_after_days()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int get_remove_unlisted_guards_after_days </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If a guard is unlisted for this many days in a row, we remove it. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a8eea3721f2ce3de824f68890f6ab1778_icgraph.png" border="0" usemap="#entrynodes_8c_a8eea3721f2ce3de824f68890f6ab1778_icgraph" alt=""/></div>
<map name="entrynodes_8c_a8eea3721f2ce3de824f68890f6ab1778_icgraph" id="entrynodes_8c_a8eea3721f2ce3de824f68890f6ab1778_icgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#af2a8cbdaeab1361a4527e0d1b6233f25" title="sampled_guards_update\l_from_consensus" alt="" coords="196,5,359,47"/>
<area shape="rect" id="node3" href="entrynodes_8h.html#a4360ef3264ab398b48b851e0d2d675b5" title="entry_guards_update_all" alt="" coords="407,13,569,39"/>
</map>
</div>

</div>
</div>
<a id="a85c4a90c7407cd8c13fae402c414a5c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85c4a90c7407cd8c13fae402c414a5c8">&#9670;&nbsp;</a></span>get_sampled_guard_with_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC entry_guard_t* get_sampled_guard_with_id </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>rsa_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the sampled guard with the RSA identity digest <b>rsa_id</b>, or NULL if we don't have one. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a85c4a90c7407cd8c13fae402c414a5c8_cgraph.png" border="0" usemap="#entrynodes_8c_a85c4a90c7407cd8c13fae402c414a5c8_cgraph" alt=""/></div>
<map name="entrynodes_8c_a85c4a90c7407cd8c13fae402c414a5c8_cgraph" id="entrynodes_8c_a85c4a90c7407cd8c13fae402c414a5c8_cgraph">
<area shape="rect" id="node2" href="di__ops_8c.html#a473334ee93cca0aea10523321a444ea3" title="tor_memeq" alt="" coords="236,5,323,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a85c4a90c7407cd8c13fae402c414a5c8_icgraph.png" border="0" usemap="#entrynodes_8c_a85c4a90c7407cd8c13fae402c414a5c8_icgraph" alt=""/></div>
<map name="entrynodes_8c_a85c4a90c7407cd8c13fae402c414a5c8_icgraph" id="entrynodes_8c_a85c4a90c7407cd8c13fae402c414a5c8_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a9ecb7c2ddf9746ab0b0cb62a2239b6f6" title="entry_guard_get_by\l_id_digest_for_guard\l_selection" alt="" coords="236,31,379,87"/>
<area shape="rect" id="node3" href="entrynodes_8h.html#a059f7981078a896a9349a578b82bc645" title="entry_guard_get_by\l_id_digest" alt="" coords="427,5,563,47"/>
<area shape="rect" id="node4" href="entrynodes_8h.html#aab5f4a60cc416cbf7109763a3b44c45a" title="get_guard_state_for\l_bridge_desc_fetch" alt="" coords="427,71,564,112"/>
</map>
</div>

</div>
</div>
<a id="ae3a6a46f97e2693fa41867ff68a88a0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3a6a46f97e2693fa41867ff68a88a0f">&#9670;&nbsp;</a></span>getinfo_helper_entry_guards()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getinfo_helper_entry_guards </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>question</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>answer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>errmsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If <b>question</b> is the string "entry-guards", then dump to *<b>answer</b> a newly allocated string describing all of the nodes in the global entry_guards list. See control-spec.txt for details. For backward compatibility, we also handle the string "helper-nodes".</p>
<p>XXX this should be totally redesigned after prop 271 too, and that's going to take some control spec work. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_ae3a6a46f97e2693fa41867ff68a88a0f_cgraph.png" border="0" usemap="#entrynodes_8c_ae3a6a46f97e2693fa41867ff68a88a0f_cgraph" alt=""/></div>
<map name="entrynodes_8c_ae3a6a46f97e2693fa41867ff68a88a0f_cgraph" id="entrynodes_8c_ae3a6a46f97e2693fa41867ff68a88a0f_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#ae55f2a4d95b0bc81220dd0464b8494f8" title="get_guard_selection_info" alt="" coords="192,5,359,32"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a8e25941e32118099ac4b42000a37afc4" title="getinfo_helper_format\l_single_entry_guard" alt="" coords="202,57,349,98"/>
<area shape="rect" id="node4" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="225,123,325,149"/>
<area shape="rect" id="node5" href="container_8c.html#ab865391a8cac688c51809c33dad0bfe2" title="smartlist_join_strings" alt="" coords="203,173,348,200"/>
<area shape="rect" id="node6" href="container_8c.html#aac69a4c0d462859a1a13a6eb35ab3c0a" title="smartlist_join_strings2" alt="" coords="407,173,559,200"/>
</map>
</div>

</div>
</div>
<a id="a8e25941e32118099ac4b42000a37afc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e25941e32118099ac4b42000a37afc4">&#9670;&nbsp;</a></span>getinfo_helper_format_single_entry_guard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC char* getinfo_helper_format_single_entry_guard </td>
          <td>(</td>
          <td class="paramtype">const entry_guard_t *&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Format a single entry guard in the format expected by the controller. Return a newly allocated string. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a8e25941e32118099ac4b42000a37afc4_icgraph.png" border="0" usemap="#entrynodes_8c_a8e25941e32118099ac4b42000a37afc4_icgraph" alt=""/></div>
<map name="entrynodes_8c_a8e25941e32118099ac4b42000a37afc4_icgraph" id="entrynodes_8c_a8e25941e32118099ac4b42000a37afc4_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#ae3a6a46f97e2693fa41867ff68a88a0f" title="getinfo_helper_entry\l_guards" alt="" coords="200,5,339,47"/>
</map>
</div>

</div>
</div>
<a id="a5b3f1de0905e52f3a76961bd1db25e01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b3f1de0905e52f3a76961bd1db25e01">&#9670;&nbsp;</a></span>guard_create_dirserver_md_restriction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC entry_guard_restriction_t* guard_create_dirserver_md_restriction </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and return an outdated md guard restriction. Return NULL if no such restriction is needed. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a5b3f1de0905e52f3a76961bd1db25e01_icgraph.png" border="0" usemap="#entrynodes_8c_a5b3f1de0905e52f3a76961bd1db25e01_icgraph" alt=""/></div>
<map name="entrynodes_8c_a5b3f1de0905e52f3a76961bd1db25e01_icgraph" id="entrynodes_8c_a5b3f1de0905e52f3a76961bd1db25e01_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a93db2fbe0af8230c60e96836cab30a29" title="guards_choose_dirguard" alt="" coords="208,13,371,39"/>
</map>
</div>

</div>
</div>
<a id="a1dfe3b4d55f624730b23a35b1a41e466"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dfe3b4d55f624730b23a35b1a41e466">&#9670;&nbsp;</a></span>guard_selection_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void guard_selection_free_ </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free one guard selection context </p>

</div>
</div>
<a id="a0e9ad8a9d2d435a30b8ece9e786533bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e9ad8a9d2d435a30b8ece9e786533bf">&#9670;&nbsp;</a></span>guard_selection_get_err_str_if_dir_info_missing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* guard_selection_get_err_str_if_dir_info_missing </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>using_mds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_present</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_usable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if we are missing any crucial dirinfo for the guard subsystem to work. Return NULL if everything went well, otherwise return a newly allocated string with an informative error message. In the latter case, use the genreal descriptor information <b>using_mds</b>, <b>num_present</b> and <b>num_usable</b> to improve the error message. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a0e9ad8a9d2d435a30b8ece9e786533bf_cgraph.png" border="0" usemap="#entrynodes_8c_a0e9ad8a9d2d435a30b8ece9e786533bf_cgraph" alt=""/></div>
<map name="entrynodes_8c_a0e9ad8a9d2d435a30b8ece9e786533bf_cgraph" id="entrynodes_8c_a0e9ad8a9d2d435a30b8ece9e786533bf_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801" title="entry_guards_update\l_primary" alt="" coords="196,99,339,141"/>
<area shape="rect" id="node11" href="entrynodes_8c.html#acca85058789d4eb247b7e560bfeb7767" title="get_n_primary_guards\l_to_use" alt="" coords="192,165,343,206"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a045186178310a765b1193b31c9c98be8" title="get_n_primary_guards" alt="" coords="402,5,553,32"/>
<area shape="rect" id="node4" href="container_8c.html#a5e71fb7bc775f079d9f9d724f0203fc1" title="smartlist_add_all" alt="" coords="417,56,537,83"/>
<area shape="rect" id="node5" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="427,107,527,133"/>
<area shape="rect" id="node6" href="container_8c.html#abbb4ca13d840b2761ed4d70c63f0b2f4" title="smartlist_contains" alt="" coords="413,157,541,184"/>
<area shape="rect" id="node7" href="entrynodes_8c.html#a440f5217f0a557c13b02a251f93db5d6" title="sample_reachable_filtered\l_entry_guards" alt="" coords="391,209,564,250"/>
<area shape="rect" id="node8" href="entrynodes_8c.html#ab335f71d2749aa457ffd8a82065649c6" title="entry_guard_consider\l_retry" alt="" coords="816,209,963,250"/>
<area shape="rect" id="node10" href="entrynodes_8c.html#ac771815070c48fdafceda321e3b56739" title="num_reachable_filtered\l_guards" alt="" coords="612,238,768,279"/>
<area shape="rect" id="node9" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="1011,216,1104,243"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a0e9ad8a9d2d435a30b8ece9e786533bf_icgraph.png" border="0" usemap="#entrynodes_8c_a0e9ad8a9d2d435a30b8ece9e786533bf_icgraph" alt=""/></div>
<map name="entrynodes_8c_a0e9ad8a9d2d435a30b8ece9e786533bf_icgraph" id="entrynodes_8c_a0e9ad8a9d2d435a30b8ece9e786533bf_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a1f69ddf668f984f783eb7cfcb358185e" title="entry_guards_get_err\l_str_if_dir_info_missing" alt="" coords="192,13,351,54"/>
</map>
</div>

</div>
</div>
<a id="a2c1f65570571aeb066bb8777124ad8b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c1f65570571aeb066bb8777124ad8b6">&#9670;&nbsp;</a></span>guard_selection_infer_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC guard_selection_type_t guard_selection_infer_type </td>
          <td>(</td>
          <td class="paramtype">guard_selection_type_t&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Try to determine the correct type for a selection named "name", if <b>type</b> is GS_TYPE_INFER. </p>

</div>
</div>
<a id="afcc3f15af65afdabe459528a2a230666"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcc3f15af65afdabe459528a2a230666">&#9670;&nbsp;</a></span>guard_selection_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC guard_selection_t* guard_selection_new </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">guard_selection_type_t&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and return a new guard_selection_t, with the name <b>name</b>. </p>

</div>
</div>
<a id="a93db2fbe0af8230c60e96836cab30a29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93db2fbe0af8230c60e96836cab30a29">&#9670;&nbsp;</a></span>guards_choose_dirguard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structnode__t.html">node_t</a>* guards_choose_dirguard </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dir_purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">circuit_guard_state_t **&#160;</td>
          <td class="paramname"><em>guard_state_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: pick a directory guard, with whatever algorithm is used. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a93db2fbe0af8230c60e96836cab30a29_cgraph.png" border="0" usemap="#entrynodes_8c_a93db2fbe0af8230c60e96836cab30a29_cgraph" alt=""/></div>
<map name="entrynodes_8c_a93db2fbe0af8230c60e96836cab30a29_cgraph" id="entrynodes_8c_a93db2fbe0af8230c60e96836cab30a29_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a5b3f1de0905e52f3a76961bd1db25e01" title="guard_create_dirserver\l_md_restriction" alt="" coords="222,5,377,47"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a89cd1e4049c1b18c57214d9414586ad4" title="entry_guard_pick_for\l_circuit" alt="" coords="228,71,371,112"/>
<area shape="rect" id="node5" href="entrynodes_8c.html#ae55f2a4d95b0bc81220dd0464b8494f8" title="get_guard_selection_info" alt="" coords="216,137,383,163"/>
<area shape="rect" id="node4" href="entrynodes_8c.html#a997305afc0db6f7e66d50f4273db1898" title="select_entry_guard\l_for_circuit" alt="" coords="431,71,563,112"/>
</map>
</div>

</div>
</div>
<a id="ab71ff8062c99e9722afef949590df2da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab71ff8062c99e9722afef949590df2da">&#9670;&nbsp;</a></span>guards_choose_guard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structnode__t.html">node_t</a>* guards_choose_guard </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcpath__build__state__t.html">cpath_build_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">circuit_guard_state_t **&#160;</td>
          <td class="paramname"><em>guard_state_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: pick a guard for a circuit, with whatever algorithm is used. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_ab71ff8062c99e9722afef949590df2da_cgraph.png" border="0" usemap="#entrynodes_8c_ab71ff8062c99e9722afef949590df2da_cgraph" alt=""/></div>
<map name="entrynodes_8c_ab71ff8062c99e9722afef949590df2da_cgraph" id="entrynodes_8c_ab71ff8062c99e9722afef949590df2da_cgraph">
<area shape="rect" id="node2" href="circuituse_8c.html#a5e8e36fe1fa5af29eb3595f31e0e01db" title="circuit_should_use\l_vanguards" alt="" coords="207,5,337,47"/>
<area shape="rect" id="node4" href="circuitbuild_8c.html#a4928871a4861aa6f71b50a5642406747" title="build_state_get_exit\l_rsa_id" alt="" coords="203,71,341,112"/>
<area shape="rect" id="node3" href="circuituse_8c.html#aff875d76fff1f49cbbf561415216f3b3" title="circuit_purpose_is\l_hidden_service" alt="" coords="389,5,516,47"/>
</map>
</div>

</div>
</div>
<a id="aa9eddf77d45dab94c87c4ae9e9a659fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9eddf77d45dab94c87c4ae9e9a659fb">&#9670;&nbsp;</a></span>guards_retry_optimistic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int guards_retry_optimistic </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If we're running with a constrained guard set, then maybe mark our guards usable. Return 1 if we do; 0 if we don't. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_aa9eddf77d45dab94c87c4ae9e9a659fb_cgraph.png" border="0" usemap="#entrynodes_8c_aa9eddf77d45dab94c87c4ae9e9a659fb_cgraph" alt=""/></div>
<map name="entrynodes_8c_aa9eddf77d45dab94c87c4ae9e9a659fb_cgraph" id="entrynodes_8c_aa9eddf77d45dab94c87c4ae9e9a659fb_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a574dc0f7b96e7da5652ddb234d42adb3" title="entry_list_is_constrained" alt="" coords="211,48,377,75"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a30a477e0e6936f2e44747be238f30dd7" title="mark_primary_guards\l_maybe_reachable" alt="" coords="221,99,367,141"/>
<area shape="rect" id="node13" href="entrynodes_8c.html#ae55f2a4d95b0bc81220dd0464b8494f8" title="get_guard_selection_info" alt="" coords="211,165,377,192"/>
<area shape="rect" id="node4" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801" title="entry_guards_update\l_primary" alt="" coords="425,99,568,141"/>
<area shape="rect" id="node5" href="entrynodes_8c.html#a045186178310a765b1193b31c9c98be8" title="get_n_primary_guards" alt="" coords="627,5,778,32"/>
<area shape="rect" id="node6" href="container_8c.html#a5e71fb7bc775f079d9f9d724f0203fc1" title="smartlist_add_all" alt="" coords="643,56,763,83"/>
<area shape="rect" id="node7" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="653,107,753,133"/>
<area shape="rect" id="node8" href="container_8c.html#abbb4ca13d840b2761ed4d70c63f0b2f4" title="smartlist_contains" alt="" coords="639,157,767,184"/>
<area shape="rect" id="node9" href="entrynodes_8c.html#a440f5217f0a557c13b02a251f93db5d6" title="sample_reachable_filtered\l_entry_guards" alt="" coords="616,209,789,250"/>
<area shape="rect" id="node10" href="entrynodes_8c.html#ab335f71d2749aa457ffd8a82065649c6" title="entry_guard_consider\l_retry" alt="" coords="1041,209,1188,250"/>
<area shape="rect" id="node12" href="entrynodes_8c.html#ac771815070c48fdafceda321e3b56739" title="num_reachable_filtered\l_guards" alt="" coords="837,238,993,279"/>
<area shape="rect" id="node11" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="1236,216,1329,243"/>
</map>
</div>

</div>
</div>
<a id="aedaac29d3130717a9c3fdb8950a2f4af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedaac29d3130717a9c3fdb8950a2f4af">&#9670;&nbsp;</a></span>guards_update_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int guards_update_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: Update the status of all entry guards, in whatever algorithm is used. Return true if we should stop using all previously generated circuits, by calling <a class="el" href="circuitlist_8c.html#afbc3a3bf5eccd42bc5dc3f75d5aec392">circuit_mark_all_unused_circs()</a> and <a class="el" href="circuitlist_8c.html#a52c4991dce45efd8d927b6092e3c85be">circuit_mark_all_dirty_circs_as_unusable()</a>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_aedaac29d3130717a9c3fdb8950a2f4af_cgraph.png" border="0" usemap="#entrynodes_8c_aedaac29d3130717a9c3fdb8950a2f4af_cgraph" alt=""/></div>
<map name="entrynodes_8c_aedaac29d3130717a9c3fdb8950a2f4af_cgraph" id="entrynodes_8c_aedaac29d3130717a9c3fdb8950a2f4af_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a7b8e402c5c5ea8de25416c11ff59d7b8" title="update_guard_selection\l_choice" alt="" coords="180,5,339,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_aedaac29d3130717a9c3fdb8950a2f4af_icgraph.png" border="0" usemap="#entrynodes_8c_aedaac29d3130717a9c3fdb8950a2f4af_icgraph" alt=""/></div>
<map name="entrynodes_8c_aedaac29d3130717a9c3fdb8950a2f4af_icgraph" id="entrynodes_8c_aedaac29d3130717a9c3fdb8950a2f4af_icgraph">
<area shape="rect" id="node2" href="main_8h.html#ac64189cc036980dc5785f76d85db9fa6" title="directory_info_has\l_arrived" alt="" coords="180,5,308,47"/>
</map>
</div>

</div>
</div>
<a id="ae0098c969567b69eb585160f12700b06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0098c969567b69eb585160f12700b06">&#9670;&nbsp;</a></span>make_guard_confirmed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void make_guard_confirmed </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">entry_guard_t *&#160;</td>
          <td class="paramname"><em>guard</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mark <b>guard</b> as a confirmed guard &ndash; that is, one that we have connected to, and intend to use again. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_ae0098c969567b69eb585160f12700b06_icgraph.png" border="0" usemap="#entrynodes_8c_ae0098c969567b69eb585160f12700b06_icgraph" alt=""/></div>
<map name="entrynodes_8c_ae0098c969567b69eb585160f12700b06_icgraph" id="entrynodes_8c_ae0098c969567b69eb585160f12700b06_icgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#aa020db50cb3f41bd32d264228a2bc249" title="entry_guards_note_guard\l_success" alt="" coords="211,5,379,47"/>
</map>
</div>

</div>
</div>
<a id="a30a477e0e6936f2e44747be238f30dd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30a477e0e6936f2e44747be238f30dd7">&#9670;&nbsp;</a></span>mark_primary_guards_maybe_reachable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void mark_primary_guards_maybe_reachable </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when the network comes up after having seemed to be down for a while: Mark the primary guards as maybe-reachable so that we'll try them again. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a30a477e0e6936f2e44747be238f30dd7_cgraph.png" border="0" usemap="#entrynodes_8c_a30a477e0e6936f2e44747be238f30dd7_cgraph" alt=""/></div>
<map name="entrynodes_8c_a30a477e0e6936f2e44747be238f30dd7_cgraph" id="entrynodes_8c_a30a477e0e6936f2e44747be238f30dd7_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801" title="entry_guards_update\l_primary" alt="" coords="200,99,343,141"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a045186178310a765b1193b31c9c98be8" title="get_n_primary_guards" alt="" coords="402,5,553,32"/>
<area shape="rect" id="node4" href="container_8c.html#a5e71fb7bc775f079d9f9d724f0203fc1" title="smartlist_add_all" alt="" coords="417,56,537,83"/>
<area shape="rect" id="node5" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="427,107,527,133"/>
<area shape="rect" id="node6" href="container_8c.html#abbb4ca13d840b2761ed4d70c63f0b2f4" title="smartlist_contains" alt="" coords="413,157,541,184"/>
<area shape="rect" id="node7" href="entrynodes_8c.html#a440f5217f0a557c13b02a251f93db5d6" title="sample_reachable_filtered\l_entry_guards" alt="" coords="391,209,564,250"/>
<area shape="rect" id="node8" href="entrynodes_8c.html#ab335f71d2749aa457ffd8a82065649c6" title="entry_guard_consider\l_retry" alt="" coords="816,209,963,250"/>
<area shape="rect" id="node10" href="entrynodes_8c.html#ac771815070c48fdafceda321e3b56739" title="num_reachable_filtered\l_guards" alt="" coords="612,238,768,279"/>
<area shape="rect" id="node9" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="1011,216,1104,243"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a30a477e0e6936f2e44747be238f30dd7_icgraph.png" border="0" usemap="#entrynodes_8c_a30a477e0e6936f2e44747be238f30dd7_icgraph" alt=""/></div>
<map name="entrynodes_8c_a30a477e0e6936f2e44747be238f30dd7_icgraph" id="entrynodes_8c_a30a477e0e6936f2e44747be238f30dd7_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#aa9eddf77d45dab94c87c4ae9e9a659fb" title="guards_retry_optimistic" alt="" coords="200,13,357,39"/>
</map>
</div>

</div>
</div>
<a id="a8365c0314d4e3396d3058e50aff13535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8365c0314d4e3396d3058e50aff13535">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC&#160;</td>
          <td class="paramname"><em>time_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">randomize_time&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(time_t now, time_t max_backdate)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return an interval betweeen 'now' and 'max_backdate' seconds in the past, chosen uniformly at random. We use this before recording persistent dates, so that we aren't leaking exactly when we recorded it. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a8365c0314d4e3396d3058e50aff13535_cgraph.png" border="0" usemap="#entrynodes_8c_a8365c0314d4e3396d3058e50aff13535_cgraph" alt=""/></div>
<map name="entrynodes_8c_a8365c0314d4e3396d3058e50aff13535_cgraph" id="entrynodes_8c_a8365c0314d4e3396d3058e50aff13535_cgraph">
<area shape="rect" id="node2" href="crypto__rand_8c.html#a64cba578d1a791934c473c19fc960c6d" title="crypto_rand_time_range" alt="" coords="153,5,315,32"/>
<area shape="rect" id="node3" href="crypto__rand_8c.html#ad85d7652b99b6a20bffbbe81972b9fa6" title="crypto_rand_uint64" alt="" coords="363,5,495,32"/>
</map>
</div>

</div>
</div>
<a id="a5ea264180d07d1806a71c00fe67b1964"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ea264180d07d1806a71c00fe67b1964">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC&#160;</td>
          <td class="paramname"><em>int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">entry_guard_is_listed&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(guard_selection_t *gs, const entry_guard_t *guard)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff <b>guard</b> is currently "listed" &ndash; that is, it appears in the consensus, or as a configured bridge (as appropriate) </p>

</div>
</div>
<a id="a4fb3562d26ee2014d43566ac52e3e801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb3562d26ee2014d43566ac52e3e801">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC circuit_guard_state_t *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">circuit_guard_state_new&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(entry_guard_t *guard, unsigned state, entry_guard_restriction_t *rst)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and return a new circuit_guard_state_t to track the result of using <b>guard</b> for a given operation. </p>

</div>
</div>
<a id="a6ec40670f6c775c40033252d64dfdf53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ec40670f6c775c40033252d64dfdf53">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">num_bridges_usable&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(int use_maybe_reachable)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of bridges that have descriptors that are marked with purpose 'bridge' and are running. If use_maybe_reachable is true, include bridges that might be reachable in the count. Otherwise, if it is false, only include bridges that have recently been found running in the count.</p>
<p>We use this function to decide if we're ready to start building circuits through our bridges, or if we need to wait until the directory "server/authority" requests finish. </p>

</div>
</div>
<a id="ac771815070c48fdafceda321e3b56739"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac771815070c48fdafceda321e3b56739">&#9670;&nbsp;</a></span>num_reachable_filtered_guards()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int num_reachable_filtered_guards </td>
          <td>(</td>
          <td class="paramtype">const guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const entry_guard_restriction_t *&#160;</td>
          <td class="paramname"><em>rst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of sampled guards in <b>gs</b> that are "filtered" (that is, we're willing to connect to them) and that are "usable" (that is, either "reachable" or "maybe reachable").</p>
<p>If a restriction is provided in <b>rst</b>, do not count any guards that violate it. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_ac771815070c48fdafceda321e3b56739_cgraph.png" border="0" usemap="#entrynodes_8c_ac771815070c48fdafceda321e3b56739_cgraph" alt=""/></div>
<map name="entrynodes_8c_ac771815070c48fdafceda321e3b56739_cgraph" id="entrynodes_8c_ac771815070c48fdafceda321e3b56739_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#ab335f71d2749aa457ffd8a82065649c6" title="entry_guard_consider\l_retry" alt="" coords="209,5,356,47"/>
<area shape="rect" id="node3" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="404,13,497,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_ac771815070c48fdafceda321e3b56739_icgraph.png" border="0" usemap="#entrynodes_8c_ac771815070c48fdafceda321e3b56739_icgraph" alt=""/></div>
<map name="entrynodes_8c_ac771815070c48fdafceda321e3b56739_icgraph" id="entrynodes_8c_ac771815070c48fdafceda321e3b56739_icgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a440f5217f0a557c13b02a251f93db5d6" title="sample_reachable_filtered\l_entry_guards" alt="" coords="209,136,383,177"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801" title="entry_guards_update\l_primary" alt="" coords="431,136,573,177"/>
<area shape="rect" id="node4" href="entrynodes_8c.html#a30a477e0e6936f2e44747be238f30dd7" title="mark_primary_guards\l_maybe_reachable" alt="" coords="632,5,779,47"/>
<area shape="rect" id="node6" href="entrynodes_8c.html#aa020db50cb3f41bd32d264228a2bc249" title="entry_guards_note_guard\l_success" alt="" coords="621,71,789,112"/>
<area shape="rect" id="node7" href="entrynodes_8c.html#acad8e7ba6123e0a214361a425f711c05" title="entry_guards_all_primary\l_guards_are_down" alt="" coords="622,136,789,177"/>
<area shape="rect" id="node11" href="entrynodes_8h.html#a4360ef3264ab398b48b851e0d2d675b5" title="entry_guards_update_all" alt="" coords="624,202,787,229"/>
<area shape="rect" id="node12" href="entrynodes_8h.html#a0e9ad8a9d2d435a30b8ece9e786533bf" title="guard_selection_get\l_err_str_if_dir_info\l_missing" alt="" coords="636,253,775,309"/>
<area shape="rect" id="node5" href="entrynodes_8h.html#aa9eddf77d45dab94c87c4ae9e9a659fb" title="guards_retry_optimistic" alt="" coords="838,13,995,39"/>
<area shape="rect" id="node8" href="entrynodes_8h.html#af943c868320a66ee2dca652ad0555a32" title="entry_guards_upgrade\l_waiting_circuits" alt="" coords="841,136,992,177"/>
<area shape="rect" id="node9" href="circuitlist_8h.html#a8d569b96b07da7c91549695cc1ce8ccf" title="circuit_find_circuits\l_to_upgrade_from_guard_wait" alt="" coords="1044,136,1240,177"/>
<area shape="rect" id="node10" href="circuitbuild_8h.html#afbeee8004f6e86e019ed4c4a9556d7de" title="circuit_upgrade_circuits\l_from_guard_wait" alt="" coords="1288,136,1447,177"/>
<area shape="rect" id="node13" href="entrynodes_8h.html#a1f69ddf668f984f783eb7cfcb358185e" title="entry_guards_get_err\l_str_if_dir_info_missing" alt="" coords="837,260,996,301"/>
</map>
</div>

</div>
</div>
<a id="a2059c6a8b0ae5f6bd64087fe00a27d9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2059c6a8b0ae5f6bd64087fe00a27d9d">&#9670;&nbsp;</a></span>remove_all_entry_guards()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void remove_all_entry_guards </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove all currently listed entry guards, so new ones will be chosen.</p>
<p>XXXX This function shouldn't exist &ndash; it's meant to support the DROPGUARDS command, which is deprecated. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a2059c6a8b0ae5f6bd64087fe00a27d9d_cgraph.png" border="0" usemap="#entrynodes_8c_a2059c6a8b0ae5f6bd64087fe00a27d9d_cgraph" alt=""/></div>
<map name="entrynodes_8c_a2059c6a8b0ae5f6bd64087fe00a27d9d_cgraph" id="entrynodes_8c_a2059c6a8b0ae5f6bd64087fe00a27d9d_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a37261ae47f6bec9d6ade03c87b74f916" title="remove_all_entry_guards\l_for_guard_selection" alt="" coords="220,5,387,47"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#ae55f2a4d95b0bc81220dd0464b8494f8" title="get_guard_selection_info" alt="" coords="220,71,387,98"/>
</map>
</div>

</div>
</div>
<a id="a37261ae47f6bec9d6ade03c87b74f916"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37261ae47f6bec9d6ade03c87b74f916">&#9670;&nbsp;</a></span>remove_all_entry_guards_for_guard_selection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void remove_all_entry_guards_for_guard_selection </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove all currently listed entry guards for a given guard selection context. This frees and replaces <b>gs</b>, so don't use <b>gs</b> after calling this function. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a37261ae47f6bec9d6ade03c87b74f916_icgraph.png" border="0" usemap="#entrynodes_8c_a37261ae47f6bec9d6ade03c87b74f916_icgraph" alt=""/></div>
<map name="entrynodes_8c_a37261ae47f6bec9d6ade03c87b74f916_icgraph" id="entrynodes_8c_a37261ae47f6bec9d6ade03c87b74f916_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a2059c6a8b0ae5f6bd64087fe00a27d9d" title="remove_all_entry_guards" alt="" coords="220,13,387,39"/>
</map>
</div>

</div>
</div>
<a id="a440f5217f0a557c13b02a251f93db5d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a440f5217f0a557c13b02a251f93db5d6">&#9670;&nbsp;</a></span>sample_reachable_filtered_entry_guards()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC entry_guard_t* sample_reachable_filtered_entry_guards </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const entry_guard_restriction_t *&#160;</td>
          <td class="paramname"><em>rst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a random guard from the reachable filtered sample guards in <b>gs</b>, subject to the exclusion rules listed in <b>flags</b>. Return NULL if no such guard can be found.</p>
<p>Make sure that the sample is big enough, and that all the filter flags are set correctly, before calling this function.</p>
<p>If a restriction is provided in <b>rst</b>, do not return any guards that violate it. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a440f5217f0a557c13b02a251f93db5d6_cgraph.png" border="0" usemap="#entrynodes_8c_a440f5217f0a557c13b02a251f93db5d6_cgraph" alt=""/></div>
<map name="entrynodes_8c_a440f5217f0a557c13b02a251f93db5d6_cgraph" id="entrynodes_8c_a440f5217f0a557c13b02a251f93db5d6_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#ab335f71d2749aa457ffd8a82065649c6" title="entry_guard_consider\l_retry" alt="" coords="431,5,577,47"/>
<area shape="rect" id="node4" href="entrynodes_8c.html#ac771815070c48fdafceda321e3b56739" title="num_reachable_filtered\l_guards" alt="" coords="227,35,383,76"/>
<area shape="rect" id="node3" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="625,13,719,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a440f5217f0a557c13b02a251f93db5d6_icgraph.png" border="0" usemap="#entrynodes_8c_a440f5217f0a557c13b02a251f93db5d6_icgraph" alt=""/></div>
<map name="entrynodes_8c_a440f5217f0a557c13b02a251f93db5d6_icgraph" id="entrynodes_8c_a440f5217f0a557c13b02a251f93db5d6_icgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a0715381bede98a7d8f4da7f73d062801" title="entry_guards_update\l_primary" alt="" coords="227,136,369,177"/>
<area shape="rect" id="node3" href="entrynodes_8c.html#a30a477e0e6936f2e44747be238f30dd7" title="mark_primary_guards\l_maybe_reachable" alt="" coords="428,5,575,47"/>
<area shape="rect" id="node5" href="entrynodes_8c.html#aa020db50cb3f41bd32d264228a2bc249" title="entry_guards_note_guard\l_success" alt="" coords="417,71,585,112"/>
<area shape="rect" id="node6" href="entrynodes_8c.html#acad8e7ba6123e0a214361a425f711c05" title="entry_guards_all_primary\l_guards_are_down" alt="" coords="418,136,585,177"/>
<area shape="rect" id="node10" href="entrynodes_8h.html#a4360ef3264ab398b48b851e0d2d675b5" title="entry_guards_update_all" alt="" coords="420,202,583,229"/>
<area shape="rect" id="node11" href="entrynodes_8h.html#a0e9ad8a9d2d435a30b8ece9e786533bf" title="guard_selection_get\l_err_str_if_dir_info\l_missing" alt="" coords="432,253,571,309"/>
<area shape="rect" id="node4" href="entrynodes_8h.html#aa9eddf77d45dab94c87c4ae9e9a659fb" title="guards_retry_optimistic" alt="" coords="634,13,791,39"/>
<area shape="rect" id="node7" href="entrynodes_8h.html#af943c868320a66ee2dca652ad0555a32" title="entry_guards_upgrade\l_waiting_circuits" alt="" coords="637,136,788,177"/>
<area shape="rect" id="node8" href="circuitlist_8h.html#a8d569b96b07da7c91549695cc1ce8ccf" title="circuit_find_circuits\l_to_upgrade_from_guard_wait" alt="" coords="840,136,1036,177"/>
<area shape="rect" id="node9" href="circuitbuild_8h.html#afbeee8004f6e86e019ed4c4a9556d7de" title="circuit_upgrade_circuits\l_from_guard_wait" alt="" coords="1084,136,1243,177"/>
<area shape="rect" id="node12" href="entrynodes_8h.html#a1f69ddf668f984f783eb7cfcb358185e" title="entry_guards_get_err\l_str_if_dir_info_missing" alt="" coords="633,260,792,301"/>
</map>
</div>

</div>
</div>
<a id="af2a8cbdaeab1361a4527e0d1b6233f25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2a8cbdaeab1361a4527e0d1b6233f25">&#9670;&nbsp;</a></span>sampled_guards_update_from_consensus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void sampled_guards_update_from_consensus </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update the status of all sampled guards based on the arrival of a new consensus networkstatus document. This will include marking some guards as listed or unlisted, and removing expired guards. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_af2a8cbdaeab1361a4527e0d1b6233f25_cgraph.png" border="0" usemap="#entrynodes_8c_af2a8cbdaeab1361a4527e0d1b6233f25_cgraph" alt=""/></div>
<map name="entrynodes_8c_af2a8cbdaeab1361a4527e0d1b6233f25_cgraph" id="entrynodes_8c_af2a8cbdaeab1361a4527e0d1b6233f25_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a8eea3721f2ce3de824f68890f6ab1778" title="get_remove_unlisted\l_guards_after_days" alt="" coords="216,5,359,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_af2a8cbdaeab1361a4527e0d1b6233f25_icgraph.png" border="0" usemap="#entrynodes_8c_af2a8cbdaeab1361a4527e0d1b6233f25_icgraph" alt=""/></div>
<map name="entrynodes_8c_af2a8cbdaeab1361a4527e0d1b6233f25_icgraph" id="entrynodes_8c_af2a8cbdaeab1361a4527e0d1b6233f25_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a4360ef3264ab398b48b851e0d2d675b5" title="entry_guards_update_all" alt="" coords="216,13,379,39"/>
</map>
</div>

</div>
</div>
<a id="a997305afc0db6f7e66d50f4273db1898"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a997305afc0db6f7e66d50f4273db1898">&#9670;&nbsp;</a></span>select_entry_guard_for_circuit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC entry_guard_t* select_entry_guard_for_circuit </td>
          <td>(</td>
          <td class="paramtype">guard_selection_t *&#160;</td>
          <td class="paramname"><em>gs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="entrynodes_8h.html#aef1363614195376e58c3090a0f1a4ff6">guard_usage_t</a>&#160;</td>
          <td class="paramname"><em>usage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const entry_guard_restriction_t *&#160;</td>
          <td class="paramname"><em>rst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname"><em>state_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a guard for use with a circuit. Prefer to pick a running primary guard; then a non-pending running filtered confirmed guard; then a non-pending runnable filtered guard. Update the <b>last_tried_to_connect</b> time and the <b>is_pending</b> fields of the guard as appropriate. Set <b>state_out</b> to the new guard-state of the circuit. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a997305afc0db6f7e66d50f4273db1898_icgraph.png" border="0" usemap="#entrynodes_8c_a997305afc0db6f7e66d50f4273db1898_icgraph" alt=""/></div>
<map name="entrynodes_8c_a997305afc0db6f7e66d50f4273db1898_icgraph" id="entrynodes_8c_a997305afc0db6f7e66d50f4273db1898_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#a89cd1e4049c1b18c57214d9414586ad4" title="entry_guard_pick_for\l_circuit" alt="" coords="185,5,328,47"/>
<area shape="rect" id="node3" href="entrynodes_8h.html#a93db2fbe0af8230c60e96836cab30a29" title="guards_choose_dirguard" alt="" coords="376,13,539,39"/>
</map>
</div>

</div>
</div>
<a id="abcf00389e72807f2534ffd3da3de31e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcf00389e72807f2534ffd3da3de31e6">&#9670;&nbsp;</a></span>should_apply_guardfraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int should_apply_guardfraction </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>ns</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return 0 if we should apply guardfraction information found in the consensus. A specific consensus can be specified with the <b>ns</b> argument, if NULL the most recent one will be picked. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_abcf00389e72807f2534ffd3da3de31e6_icgraph.png" border="0" usemap="#entrynodes_8c_abcf00389e72807f2534ffd3da3de31e6_icgraph" alt=""/></div>
<map name="entrynodes_8c_abcf00389e72807f2534ffd3da3de31e6_icgraph" id="entrynodes_8c_abcf00389e72807f2534ffd3da3de31e6_icgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#aa5182e7b61c8640ef94186a19760d90c" title="routerstatus_parse\l_guardfraction" alt="" coords="233,5,364,47"/>
</map>
</div>

</div>
</div>
<a id="a7b8e402c5c5ea8de25416c11ff59d7b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b8e402c5c5ea8de25416c11ff59d7b8">&#9670;&nbsp;</a></span>update_guard_selection_choice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_guard_selection_choice </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether we should switch from our current guard selection to a different one. If so, switch and return 1. Return 0 otherwise.</p>
<p>On a 1 return, the caller should mark all currently live circuits unusable for new streams, by calling <a class="el" href="circuitlist_8c.html#afbc3a3bf5eccd42bc5dc3f75d5aec392">circuit_mark_all_unused_circs()</a> and <a class="el" href="circuitlist_8c.html#a52c4991dce45efd8d927b6092e3c85be">circuit_mark_all_dirty_circs_as_unusable()</a>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="entrynodes_8c_a7b8e402c5c5ea8de25416c11ff59d7b8_icgraph.png" border="0" usemap="#entrynodes_8c_a7b8e402c5c5ea8de25416c11ff59d7b8_icgraph" alt=""/></div>
<map name="entrynodes_8c_a7b8e402c5c5ea8de25416c11ff59d7b8_icgraph" id="entrynodes_8c_a7b8e402c5c5ea8de25416c11ff59d7b8_icgraph">
<area shape="rect" id="node2" href="entrynodes_8h.html#aedaac29d3130717a9c3fdb8950a2f4af" title="guards_update_all" alt="" coords="212,13,339,39"/>
<area shape="rect" id="node3" href="main_8h.html#ac64189cc036980dc5785f76d85db9fa6" title="directory_info_has\l_arrived" alt="" coords="387,5,515,47"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
