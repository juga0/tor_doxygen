<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/keypin.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">keypin.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions and structures for associating routers' RSA key fingerprints with their ED25519 keys.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;orconfig.h&quot;</code><br />
<code>#include &quot;compat.h&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto_8h_source.html">crypto.h</a>&quot;</code><br />
<code>#include &quot;crypto_format.h&quot;</code><br />
<code>#include &quot;<a class="el" href="di__ops_8h_source.html">di_ops.h</a>&quot;</code><br />
<code>#include &quot;ht.h&quot;</code><br />
<code>#include &quot;keypin.h&quot;</code><br />
<code>#include &quot;siphash.h&quot;</code><br />
<code>#include &quot;<a class="el" href="torint_8h_source.html">torint.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="torlog_8h_source.html">torlog.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util_8h_source.html">util.h</a>&quot;</code><br />
<code>#include &quot;util_format.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for keypin.c:</div>
<div class="dyncontent">
<div class="center"><img src="keypin_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2keypin_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2keypin_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2keypin_8c">
<area shape="rect" id="node2" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="1338,483,1417,509"/>
<area shape="rect" id="node3" href="compat_8h_source.html" title="compat.h" alt="" coords="1169,259,1245,285"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="278,408,341,435"/>
<area shape="rect" id="node11" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="865,184,935,211"/>
<area shape="rect" id="node12" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="425,184,538,211"/>
<area shape="rect" id="node15" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="49,259,119,285"/>
<area shape="rect" id="node16" href="ht_8h_source.html" title="ht.h" alt="" coords="938,109,982,136"/>
<area shape="rect" id="node17" href="keypin_8h_source.html" title="keypin.h" alt="" coords="790,259,861,285"/>
<area shape="rect" id="node18" href="siphash_8h_source.html" title="siphash.h" alt="" coords="1090,109,1169,136"/>
<area shape="rect" id="node19" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1174,184,1239,211"/>
<area shape="rect" id="node20" href="util_8h.html" title="Headers for util.c. " alt="" coords="1252,109,1303,136"/>
<area shape="rect" id="node23" href="util__format_8h_source.html" title="util_format.h" alt="" coords="565,333,659,360"/>
<area shape="rect" id="node5" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="851,408,949,435"/>
<area shape="rect" id="node7" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="1323,408,1431,435"/>
<area shape="rect" id="node10" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="1023,333,1150,360"/>
<area shape="rect" id="node13" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="195,259,320,285"/>
<area shape="rect" id="node14" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="398,333,541,360"/>
<area shape="rect" id="node22" href="util__bug_8h.html" title="util_bug.h" alt="" coords="1594,184,1673,211"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a281963ac826e80b2543823ee57597da3"><td class="memItemLeft" align="right" valign="top"><a id="a281963ac826e80b2543823ee57597da3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>KEYPIN_PRIVATE</b></td></tr>
<tr class="separator:a281963ac826e80b2543823ee57597da3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33a59114e14beb6fbc5a6f022d31fe99"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypin_8c.html#a33a59114e14beb6fbc5a6f022d31fe99">JOURNAL_LINE_LEN</a>&#160;&#160;&#160;(<a class="el" href="crypto_8h.html#a8d361a876652b0d7555e9edb1d46a879">BASE64_DIGEST_LEN</a> + <a class="el" href="crypto_8h.html#a0fd432ba13cc68d1cd01af2eb5572c9d">BASE64_DIGEST256_LEN</a> + 2)</td></tr>
<tr class="separator:a33a59114e14beb6fbc5a6f022d31fe99"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a382dbdebe51455bdf450cda814351a27"><td class="memItemLeft" align="right" valign="top"><a id="a382dbdebe51455bdf450cda814351a27"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>HT_PROTOTYPE</b> (<a class="el" href="nodelist_8c.html#ab29f8b81bcf05c59f16fb5b42ec36879">HT_GENERATE2</a>(rsamap, <a class="el" href="nodelist_8c.html#ab29f8b81bcf05c59f16fb5b42ec36879">HT_GENERATE2</a>(keypin_ent_st, <a class="el" href="nodelist_8c.html#ab29f8b81bcf05c59f16fb5b42ec36879">HT_GENERATE2</a>(rsamap_node, <a class="el" href="nodelist_8c.html#ab29f8b81bcf05c59f16fb5b42ec36879">HT_GENERATE2</a>(keypin_ent_hash_rsa, <a class="el" href="nodelist_8c.html#ab29f8b81bcf05c59f16fb5b42ec36879">HT_GENERATE2</a>(keypin_ents_eq_rsa)</td></tr>
<tr class="separator:a382dbdebe51455bdf450cda814351a27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d8d936ff1b54b8418c956a2395abadd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypin_8c.html#a9d8d936ff1b54b8418c956a2395abadd">keypin_check</a> (const uint8_t *rsa_id_digest, const uint8_t *ed25519_id_key)</td></tr>
<tr class="separator:a9d8d936ff1b54b8418c956a2395abadd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9107698e2a8ea640fbe546c3d5047901"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypin_8c.html#a9107698e2a8ea640fbe546c3d5047901">MOCK_IMPL</a> (STATIC void, keypin_add_entry_to_map,(keypin_ent_t *ent))</td></tr>
<tr class="separator:a9107698e2a8ea640fbe546c3d5047901"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b1cfd25cb21838c6098b1b9d6dd75ca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypin_8c.html#a9b1cfd25cb21838c6098b1b9d6dd75ca">keypin_check_lone_rsa</a> (const uint8_t *rsa_id_digest)</td></tr>
<tr class="separator:a9b1cfd25cb21838c6098b1b9d6dd75ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb854ec6cf0f8d6e0f3e62719c224908"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypin_8c.html#acb854ec6cf0f8d6e0f3e62719c224908">keypin_open_journal</a> (const char *fname)</td></tr>
<tr class="separator:acb854ec6cf0f8d6e0f3e62719c224908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb4c9c35a6775ff96ae86b13042d023a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypin_8c.html#adb4c9c35a6775ff96ae86b13042d023a">keypin_close_journal</a> (void)</td></tr>
<tr class="separator:adb4c9c35a6775ff96ae86b13042d023a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8822b7ce9ee3365fdeb3b56246d29161"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypin_8c.html#a8822b7ce9ee3365fdeb3b56246d29161">keypin_load_journal_impl</a> (const char *data, size_t size)</td></tr>
<tr class="separator:a8822b7ce9ee3365fdeb3b56246d29161"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f6f002b522a2cca8412f958d0ca1e66"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypin_8c.html#a1f6f002b522a2cca8412f958d0ca1e66">keypin_load_journal</a> (const char *fname)</td></tr>
<tr class="separator:a1f6f002b522a2cca8412f958d0ca1e66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a638adbed911c93339ecda4b7edc6121d"><td class="memItemLeft" align="right" valign="top">STATIC keypin_ent_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypin_8c.html#a638adbed911c93339ecda4b7edc6121d">keypin_parse_journal_line</a> (const char *cp)</td></tr>
<tr class="separator:a638adbed911c93339ecda4b7edc6121d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bc2bc64cef3f30c36a8e7a3c98dfa9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypin_8c.html#a4bc2bc64cef3f30c36a8e7a3c98dfa9f">keypin_clear</a> (void)</td></tr>
<tr class="separator:a4bc2bc64cef3f30c36a8e7a3c98dfa9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions and structures for associating routers' RSA key fingerprints with their ED25519 keys. </p>
<p>Key-pinning for RSA and Ed25519 identity keys at directory authorities.</p>
<p>Many older clients, and many internal interfaces, still refer to relays by their RSA1024 identity keys. We can make this more secure, however: authorities use this module to track which RSA keys have been used along with which Ed25519 keys, and force such associations to be permanent.</p>
<p>This module implements a key-pinning mechanism to ensure that it's safe to use RSA keys as identitifers even as we migrate to Ed25519 keys. It remembers, for every Ed25519 key we've seen, what the associated Ed25519 key is. This way, if we see a different Ed25519 key with that RSA key, we'll know that there's a mismatch.</p>
<p>(As of this writing, these key associations are advisory only, mostly because some relay operators kept mishandling their Ed25519 keys during the initial Ed25519 rollout. We should fix this problem, and then toggle the AuthDirPinKeys option.)</p>
<p>We persist these entries to disk using a simple format, where each line has a base64-encoded RSA SHA1 hash, then a base64-endoded Ed25519 key. Empty lines, misformed lines, and lines beginning with # are ignored. Lines beginning with @ are reserved for future extensions.</p>
<p>The <a class="el" href="dirserv_8c.html" title="Directory server core implementation. Manages directory contents and generates directories. ">dirserv.c</a> module is the main user of these functions. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a33a59114e14beb6fbc5a6f022d31fe99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33a59114e14beb6fbc5a6f022d31fe99">&#9670;&nbsp;</a></span>JOURNAL_LINE_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define JOURNAL_LINE_LEN&#160;&#160;&#160;(<a class="el" href="crypto_8h.html#a8d361a876652b0d7555e9edb1d46a879">BASE64_DIGEST_LEN</a> + <a class="el" href="crypto_8h.html#a0fd432ba13cc68d1cd01af2eb5572c9d">BASE64_DIGEST256_LEN</a> + 2)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Length of a keypinning journal line, including terminating newline. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9d8d936ff1b54b8418c956a2395abadd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d8d936ff1b54b8418c956a2395abadd">&#9670;&nbsp;</a></span>keypin_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int keypin_check </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>rsa_id_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ed25519_id_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As keypin_check_and_add, but do not add. Return KEYPIN_NOT_FOUND if we would add. </p>

</div>
</div>
<a id="a9b1cfd25cb21838c6098b1b9d6dd75ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b1cfd25cb21838c6098b1b9d6dd75ca">&#9670;&nbsp;</a></span>keypin_check_lone_rsa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int keypin_check_lone_rsa </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>rsa_id_digest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether we already have an entry in the key pinning table for a router with RSA ID digest <b>rsa_id_digest</b>. If we have no such entry, return KEYPIN_NOT_FOUND. If we find an entry that matches the RSA key but which has an ed25519 key, return KEYPIN_MISMATCH. </p>

</div>
</div>
<a id="a4bc2bc64cef3f30c36a8e7a3c98dfa9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bc2bc64cef3f30c36a8e7a3c98dfa9f">&#9670;&nbsp;</a></span>keypin_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void keypin_clear </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove all entries from the keypinning table. </p>

</div>
</div>
<a id="adb4c9c35a6775ff96ae86b13042d023a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb4c9c35a6775ff96ae86b13042d023a">&#9670;&nbsp;</a></span>keypin_close_journal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int keypin_close_journal </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Close the keypinning journal file. </p>

</div>
</div>
<a id="a1f6f002b522a2cca8412f958d0ca1e66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f6f002b522a2cca8412f958d0ca1e66">&#9670;&nbsp;</a></span>keypin_load_journal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int keypin_load_journal </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load a journal from the file called <b>fname</b>. Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="a8822b7ce9ee3365fdeb3b56246d29161"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8822b7ce9ee3365fdeb3b56246d29161">&#9670;&nbsp;</a></span>keypin_load_journal_impl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int keypin_load_journal_impl </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load a journal from the <b>size</b>-byte region at <b>data</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keypin_8c_a8822b7ce9ee3365fdeb3b56246d29161_cgraph.png" border="0" usemap="#keypin_8c_a8822b7ce9ee3365fdeb3b56246d29161_cgraph" alt=""/></div>
<map name="keypin_8c_a8822b7ce9ee3365fdeb3b56246d29161_cgraph" id="keypin_8c_a8822b7ce9ee3365fdeb3b56246d29161_cgraph">
<area shape="rect" id="node2" href="keypin_8c.html#a638adbed911c93339ecda4b7edc6121d" title="keypin_parse_journal_line" alt="" coords="220,5,391,32"/>
</map>
</div>

</div>
</div>
<a id="acb854ec6cf0f8d6e0f3e62719c224908"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb854ec6cf0f8d6e0f3e62719c224908">&#9670;&nbsp;</a></span>keypin_open_journal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int keypin_open_journal </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Open the key-pinning journal to append to <b>fname</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keypin_8c_acb854ec6cf0f8d6e0f3e62719c224908_cgraph.png" border="0" usemap="#keypin_8c_acb854ec6cf0f8d6e0f3e62719c224908_cgraph" alt=""/></div>
<map name="keypin_8c_acb854ec6cf0f8d6e0f3e62719c224908_cgraph" id="keypin_8c_acb854ec6cf0f8d6e0f3e62719c224908_cgraph">
<area shape="rect" id="node2" href="compat_8c.html#a68cf2b7e7222c4f58cdc37dea2b5a912" title="tor_open_cloexec" alt="" coords="193,5,317,32"/>
</map>
</div>

</div>
</div>
<a id="a638adbed911c93339ecda4b7edc6121d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a638adbed911c93339ecda4b7edc6121d">&#9670;&nbsp;</a></span>keypin_parse_journal_line()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC keypin_ent_t* keypin_parse_journal_line </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a single keypinning journal line entry from <b>cp</b>. The input does not need to be NUL-terminated, but it <em>does</em> need to have KEYPIN_JOURNAL_LINE_LEN -1 bytes available to read. Return a new entry on success, and NULL on failure. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keypin_8c_a638adbed911c93339ecda4b7edc6121d_icgraph.png" border="0" usemap="#keypin_8c_a638adbed911c93339ecda4b7edc6121d_icgraph" alt=""/></div>
<map name="keypin_8c_a638adbed911c93339ecda4b7edc6121d_icgraph" id="keypin_8c_a638adbed911c93339ecda4b7edc6121d_icgraph">
<area shape="rect" id="node2" href="keypin_8c.html#a8822b7ce9ee3365fdeb3b56246d29161" title="keypin_load_journal_impl" alt="" coords="224,5,391,32"/>
</map>
</div>

</div>
</div>
<a id="a9107698e2a8ea640fbe546c3d5047901"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9107698e2a8ea640fbe546c3d5047901">&#9670;&nbsp;</a></span>MOCK_IMPL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC&#160;</td>
          <td class="paramname"><em>void</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">keypin_add_entry_to_map&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(keypin_ent_t *ent)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: add <b>ent</b> to the hash tables. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
