<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/dirvote.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">dirvote.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to compute directory consensus, and schedule voting.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dircollate_8h_source.html">dircollate.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="directory_8h_source.html">directory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dirserv_8h_source.html">dirserv.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dirvote_8h_source.html">dirvote.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="microdesc_8h_source.html">microdesc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="networkstatus_8h_source.html">networkstatus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="policies_8h_source.html">policies.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="protover_8h_source.html">protover.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rephist_8h_source.html">rephist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="router_8h_source.html">router.h</a>&quot;</code><br />
<code>#include &quot;routerkeys.h&quot;</code><br />
<code>#include &quot;<a class="el" href="routerlist_8h_source.html">routerlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerparse_8h_source.html">routerparse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="entrynodes_8h_source.html">entrynodes.h</a>&quot;</code><br />
<code>#include &quot;torcert.h&quot;</code><br />
<code>#include &quot;shared_random_state.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for dirvote.c:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2dirvote_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2dirvote_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2dirvote_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="1201,259,1245,285"/>
<area shape="rect" id="node33" href="config_8h.html" title="Header file for config.c. " alt="" coords="1766,408,1834,435"/>
<area shape="rect" id="node34" href="dircollate_8h.html" title="Header file for dircollate.c. " alt="" coords="1808,184,1893,211"/>
<area shape="rect" id="node35" href="directory_8h.html" title="Header file for directory.c. " alt="" coords="2216,109,2299,136"/>
<area shape="rect" id="node36" href="dirserv_8h.html" title="Header file for dirserv.c. " alt="" coords="1917,184,1989,211"/>
<area shape="rect" id="node37" href="dirvote_8h.html" title="Header file for dirvote.c. " alt="" coords="1963,259,2035,285"/>
<area shape="rect" id="node38" href="microdesc_8h.html" title="Header file for microdesc.c. " alt="" coords="2323,109,2416,136"/>
<area shape="rect" id="node39" href="networkstatus_8h.html" title="Header file for networkstatus.c. " alt="" coords="2011,408,2125,435"/>
<area shape="rect" id="node40" href="policies_8h.html" title="Header file for policies.c. " alt="" coords="2440,109,2517,136"/>
<area shape="rect" id="node41" href="protover_8h.html" title="Headers and type declarations for protover.c. " alt="" coords="1503,259,1583,285"/>
<area shape="rect" id="node42" href="rephist_8h.html" title="Header file for rephist.c. " alt="" coords="2541,109,2613,136"/>
<area shape="rect" id="node43" href="router_8h.html" title="Header file for router.c. " alt="" coords="2115,184,2181,211"/>
<area shape="rect" id="node44" href="routerkeys_8h_source.html" title="routerkeys.h" alt="" coords="1678,259,1773,285"/>
<area shape="rect" id="node45" href="routerlist_8h.html" title="Header file for routerlist.c. " alt="" coords="2251,259,2333,285"/>
<area shape="rect" id="node46" href="routerparse_8h.html" title="Header file for routerparse.c. " alt="" coords="2637,109,2736,136"/>
<area shape="rect" id="node47" href="entrynodes_8h.html" title="Header file for circuitbuild.c. " alt="" coords="2761,109,2858,136"/>
<area shape="rect" id="node48" href="torcert_8h_source.html" title="torcert.h" alt="" coords="1607,184,1678,211"/>
<area shape="rect" id="node49" href="shared__random__state_8h_source.html" title="shared_random_state.h" alt="" coords="1199,109,1358,136"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="407,781,486,808"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="687,707,750,733"/>
<area shape="rect" id="node5" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="611,483,680,509"/>
<area shape="rect" id="node13" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1475,483,1589,509"/>
<area shape="rect" id="node14" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="1636,557,1761,584"/>
<area shape="rect" id="node15" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="1539,632,1682,659"/>
<area shape="rect" id="node16" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="747,408,810,435"/>
<area shape="rect" id="node19" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1094,483,1159,509"/>
<area shape="rect" id="node20" href="container_8h_source.html" title="container.h" alt="" coords="1313,408,1399,435"/>
<area shape="rect" id="node25" href="torgzip_8h.html" title="Headers for torgzip.h. " alt="" coords="885,333,957,360"/>
<area shape="rect" id="node26" href="address_8h.html" title="Headers for address.h. " alt="" coords="534,333,613,360"/>
<area shape="rect" id="node27" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="2243,632,2371,659"/>
<area shape="rect" id="node29" href="ht_8h_source.html" title="ht.h" alt="" coords="982,333,1026,360"/>
<area shape="rect" id="node30" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="1050,333,1153,360"/>
<area shape="rect" id="node31" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="1177,333,1268,360"/>
<area shape="rect" id="node32" href="util__format_8h_source.html" title="util_format.h" alt="" coords="1369,632,1463,659"/>
<area shape="rect" id="node7" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="1696,707,1795,733"/>
<area shape="rect" id="node8" href="compat_8h_source.html" title="compat.h" alt="" coords="606,557,682,584"/>
<area shape="rect" id="node10" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="347,707,455,733"/>
<area shape="rect" id="node12" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="398,632,525,659"/>
<area shape="rect" id="node17" href="compat__openssl_8h.html" title="compatability definitions for working with different openssl forks " alt="" coords="760,483,888,509"/>
<area shape="rect" id="node21" href="util_8h.html" title="Headers for util.c. " alt="" coords="1188,483,1239,509"/>
<area shape="rect" id="node24" href="siphash_8h_source.html" title="siphash.h" alt="" coords="1317,483,1395,509"/>
<area shape="rect" id="node22" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="1070,632,1141,659"/>
<area shape="rect" id="node50" href="shared__random_8h_source.html" title="shared_random.h" alt="" coords="1173,184,1296,211"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpending__consensus__t.html">pending_consensus_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdir__src__ent__t.html">dir_src_ent_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpending__vote__t.html">pending_vote_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>consensus_method_range_t</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmicrodesc__vote__line__t.html">microdesc_vote_line_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a01edd4184c640d2ef15b77e6e0ef9004"><td class="memItemLeft" align="right" valign="top"><a id="a01edd4184c640d2ef15b77e6e0ef9004"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DIRVOTE_PRIVATE</b></td></tr>
<tr class="separator:a01edd4184c640d2ef15b77e6e0ef9004"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ac322bc7706fdb6fbe0b5ef824f40ed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a8ac322bc7706fdb6fbe0b5ef824f40ed">get_most_frequent_member</a>(lst)&#160;&#160;&#160;<a class="el" href="container_8c.html#ae8bc3603ae2ab2d245291a914c84a1f1">smartlist_get_most_frequent_string</a>(lst)</td></tr>
<tr class="separator:a8ac322bc7706fdb6fbe0b5ef824f40ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33655c8ce9871b95a88f4655acd785a8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>CMP_FIELD</b>(utype,  itype,  field)</td></tr>
<tr class="separator:a33655c8ce9871b95a88f4655acd785a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf32d124cdb2c18fcf58f1665dfe2f72"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#aaf32d124cdb2c18fcf58f1665dfe2f72">MIN_VOTES_FOR_PARAM</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:aaf32d124cdb2c18fcf58f1665dfe2f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97f53dc1593611bb590d17ea4a43b5de"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>RANGE_CHECK</b>(a,  b,  c,  d,  e,  f,  g,  mx)</td></tr>
<tr class="separator:a97f53dc1593611bb590d17ea4a43b5de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad81ce7a955cb848c14356df94c38eb8"><td class="memItemLeft" align="right" valign="top"><a id="aad81ce7a955cb848c14356df94c38eb8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHECK_EQ</b>(a,  b,  margin)&#160;&#160;&#160;((a)-(b) &gt;= 0 ? (a)-(b) &lt;= (margin) : (b)-(a) &lt;= (margin))</td></tr>
<tr class="separator:aad81ce7a955cb848c14356df94c38eb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a1617c61c2051e59bf7c6717404c67e1d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structpending__consensus__t.html">pending_consensus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a1617c61c2051e59bf7c6717404c67e1d">pending_consensus_t</a></td></tr>
<tr class="separator:a1617c61c2051e59bf7c6717404c67e1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48a7397dde2dc10b728b03ef31890ae1"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structdir__src__ent__t.html">dir_src_ent_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a48a7397dde2dc10b728b03ef31890ae1">dir_src_ent_t</a></td></tr>
<tr class="separator:a48a7397dde2dc10b728b03ef31890ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4da89e03e157186c817490c71a1374e7"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structpending__vote__t.html">pending_vote_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a4da89e03e157186c817490c71a1374e7">pending_vote_t</a></td></tr>
<tr class="separator:a4da89e03e157186c817490c71a1374e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1b0279b6beb6ae83c3a894ca35132a7"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structmicrodesc__vote__line__t.html">microdesc_vote_line_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#aa1b0279b6beb6ae83c3a894ca35132a7">microdesc_vote_line_t</a></td></tr>
<tr class="separator:aa1b0279b6beb6ae83c3a894ca35132a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a4b6f6e66ea2136b41cd2645d8f86dcd0"><td class="memItemLeft" align="right" valign="top"><a id="a4b6f6e66ea2136b41cd2645d8f86dcd0"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>bw_weights_error_t</b> { <br />
&#160;&#160;<b>BW_WEIGHTS_NO_ERROR</b> = 0, 
<b>BW_WEIGHTS_RANGE_ERROR</b> = 1, 
<b>BW_WEIGHTS_SUMG_ERROR</b> = 2, 
<b>BW_WEIGHTS_SUME_ERROR</b> = 3, 
<br />
&#160;&#160;<b>BW_WEIGHTS_SUMD_ERROR</b> = 4, 
<b>BW_WEIGHTS_BALANCE_MID_ERROR</b> = 5, 
<b>BW_WEIGHTS_BALANCE_EG_ERROR</b> = 6
<br />
 }</td></tr>
<tr class="separator:a4b6f6e66ea2136b41cd2645d8f86dcd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7c7f8a75319fa1345604f7cac5b02831"><td class="memItemLeft" align="right" valign="top">STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a7c7f8a75319fa1345604f7cac5b02831">format_networkstatus_vote</a> (<a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *private_signing_key, <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *v3_ns)</td></tr>
<tr class="separator:a7c7f8a75319fa1345604f7cac5b02831"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60af55f760759eb6ad39a5c11ba3baaf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdocument__signature__t.html">document_signature_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a60af55f760759eb6ad39a5c11ba3baaf">voter_get_sig_by_algorithm</a> (const <a class="el" href="structnetworkstatus__voter__info__t.html">networkstatus_voter_info_t</a> *voter, digest_algorithm_t alg)</td></tr>
<tr class="separator:a60af55f760759eb6ad39a5c11ba3baaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a170431e56608ff40b06dd265519102a7"><td class="memItemLeft" align="right" valign="top">STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a170431e56608ff40b06dd265519102a7">make_consensus_method_list</a> (int low, int high, const char *separator)</td></tr>
<tr class="separator:a170431e56608ff40b06dd265519102a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53c84b14cb4293be3481901a2bf7d344"><td class="memItemLeft" align="right" valign="top">STATIC int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a53c84b14cb4293be3481901a2bf7d344">dirvote_get_intermediate_param_value</a> (const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *param_list, const char *keyword, int32_t default_val)</td></tr>
<tr class="separator:a53c84b14cb4293be3481901a2bf7d344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8fd15ddb8a25674fa692b574339503c"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#ae8fd15ddb8a25674fa692b574339503c">dirvote_compute_params</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *votes, int method, int total_authorities)</td></tr>
<tr class="separator:ae8fd15ddb8a25674fa692b574339503c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cedd7ac4100a20d3069d42dc535c84e"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a0cedd7ac4100a20d3069d42dc535c84e">networkstatus_compute_consensus</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *votes, int total_authorities, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *identity_key, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *signing_key, const char *legacy_id_key_digest, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *legacy_signing_key, <a class="el" href="or_8h.html#ada0879620550843533b891a49543b109">consensus_flavor_t</a> flavor)</td></tr>
<tr class="separator:a0cedd7ac4100a20d3069d42dc535c84e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab876fd37d49b88c5ce095d93e458ff10"><td class="memItemLeft" align="right" valign="top">STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#ab876fd37d49b88c5ce095d93e458ff10">compute_consensus_package_lines</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *votes)</td></tr>
<tr class="separator:ab876fd37d49b88c5ce095d93e458ff10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b21332ec8c217620fefe5f2bd405c93"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a5b21332ec8c217620fefe5f2bd405c93">networkstatus_add_detached_signatures</a> (<a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *target, <a class="el" href="structns__detached__signatures__t.html">ns_detached_signatures_t</a> *sigs, const char *source, int severity, const char **msg_out)</td></tr>
<tr class="separator:a5b21332ec8c217620fefe5f2bd405c93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88b12c0f09a9033deb2cb78cc1dc321c"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a88b12c0f09a9033deb2cb78cc1dc321c">networkstatus_get_detached_signatures</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *consensuses)</td></tr>
<tr class="separator:a88b12c0f09a9033deb2cb78cc1dc321c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a36c2930edf9d2ca915c30057a64da8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a4a36c2930edf9d2ca915c30057a64da8">ns_detached_signatures_free</a> (<a class="el" href="structns__detached__signatures__t.html">ns_detached_signatures_t</a> *s)</td></tr>
<tr class="separator:a4a36c2930edf9d2ca915c30057a64da8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38bc81b8644900e12b2b9b9569d105b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structauthority__cert__t.html">authority_cert_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a38bc81b8644900e12b2b9b9569d105b5">authority_cert_dup</a> (<a class="el" href="structauthority__cert__t.html">authority_cert_t</a> *cert)</td></tr>
<tr class="separator:a38bc81b8644900e12b2b9b9569d105b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60188357707e416d29de6342bc32a883"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a60188357707e416d29de6342bc32a883">dirvote_get_preferred_voting_intervals</a> (<a class="el" href="structvote__timing__t.html">vote_timing_t</a> *timing_out)</td></tr>
<tr class="separator:a60188357707e416d29de6342bc32a883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad12be9f1748f89ce9e33a895218912fb"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#ad12be9f1748f89ce9e33a895218912fb">dirvote_get_start_of_next_interval</a> (time_t now, int interval, int offset)</td></tr>
<tr class="separator:ad12be9f1748f89ce9e33a895218912fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7335b766c539b24f72e1953ed9ee59c1"><td class="memItemLeft" align="right" valign="top"><a id="a7335b766c539b24f72e1953ed9ee59c1"></a>
time_t&#160;</td><td class="memItemRight" valign="bottom"><b>get_next_valid_after_time</b> (time_t now)</td></tr>
<tr class="separator:a7335b766c539b24f72e1953ed9ee59c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab7ea3ac9bbece8dbdd6c3c167dc0ae9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#aab7ea3ac9bbece8dbdd6c3c167dc0ae9">dirvote_recalculate_timing</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options, time_t now)</td></tr>
<tr class="separator:aab7ea3ac9bbece8dbdd6c3c167dc0ae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f959ff7a4b18d042860c27616465a2b"><td class="memItemLeft" align="right" valign="top"><a id="a8f959ff7a4b18d042860c27616465a2b"></a>
<a class="el" href="structvoting__schedule__t.html">voting_schedule_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>get_voting_schedule</b> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options, time_t now, int severity)</td></tr>
<tr class="separator:a8f959ff7a4b18d042860c27616465a2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adffd241c7a248002845c761c4147ab58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#adffd241c7a248002845c761c4147ab58">voting_schedule_free</a> (<a class="el" href="structvoting__schedule__t.html">voting_schedule_t</a> *voting_schedule_to_free)</td></tr>
<tr class="separator:adffd241c7a248002845c761c4147ab58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a333f56fb4797757ca9e04bee1550cabe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a333f56fb4797757ca9e04bee1550cabe">dirvote_act</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options, time_t now)</td></tr>
<tr class="separator:a333f56fb4797757ca9e04bee1550cabe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4e7e393e4261047243c1c3f339886e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpending__vote__t.html">pending_vote_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#ae4e7e393e4261047243c1c3f339886e4">dirvote_add_vote</a> (const char *vote_body, const char **msg_out, int *status_out)</td></tr>
<tr class="separator:ae4e7e393e4261047243c1c3f339886e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a705721f192e93574c305f27b7e24f272"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a705721f192e93574c305f27b7e24f272">dirvote_add_signatures</a> (const char *detached_signatures_body, const char *source, const char **msg)</td></tr>
<tr class="separator:a705721f192e93574c305f27b7e24f272"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a585a4928108f1321756e08eb86712d51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a585a4928108f1321756e08eb86712d51">dirvote_free_all</a> (void)</td></tr>
<tr class="separator:a585a4928108f1321756e08eb86712d51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c6d21276cc8671a821bc012da3b1661"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a6c6d21276cc8671a821bc012da3b1661">MOCK_IMPL</a> (const char *, dirvote_get_pending_consensus,(<a class="el" href="or_8h.html#ada0879620550843533b891a49543b109">consensus_flavor_t</a> flav))</td></tr>
<tr class="separator:a6c6d21276cc8671a821bc012da3b1661"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e6f2ecd6383f9ed442ec8e827ce666e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a6e6f2ecd6383f9ed442ec8e827ce666e">MOCK_IMPL</a> (const char *, dirvote_get_pending_detached_signatures,(void))</td></tr>
<tr class="separator:a6e6f2ecd6383f9ed442ec8e827ce666e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6905fdc89a2bce64a9f79c526c140f94"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structcached__dir__t.html">cached_dir_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a6905fdc89a2bce64a9f79c526c140f94">dirvote_get_vote</a> (const char *fp, int flags)</td></tr>
<tr class="separator:a6905fdc89a2bce64a9f79c526c140f94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97feb95be6e8e94295fa6775355318ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmicrodesc__t.html">microdesc_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a97feb95be6e8e94295fa6775355318ee">dirvote_create_microdescriptor</a> (const <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> *ri, int consensus_method)</td></tr>
<tr class="separator:a97feb95be6e8e94295fa6775355318ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadeea5dccfa87bef2915fd6e9ad92a39"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#aadeea5dccfa87bef2915fd6e9ad92a39">dirvote_format_microdesc_vote_line</a> (char *out_buf, size_t out_buf_len, const <a class="el" href="structmicrodesc__t.html">microdesc_t</a> *md, int consensus_method_low, int consensus_method_high)</td></tr>
<tr class="separator:aadeea5dccfa87bef2915fd6e9ad92a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c8c11aee1a421ac4cd72f1d020ac6d5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structvote__microdesc__hash__t.html">vote_microdesc_hash_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a7c8c11aee1a421ac4cd72f1d020ac6d5">dirvote_format_all_microdesc_vote_lines</a> (const <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> *ri, time_t now, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *microdescriptors_out)</td></tr>
<tr class="separator:a7c8c11aee1a421ac4cd72f1d020ac6d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72cd954260c2fb4bfc45884588730a50"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a72cd954260c2fb4bfc45884588730a50">vote_routerstatus_find_microdesc_hash</a> (char *digest256_out, const <a class="el" href="structvote__routerstatus__t.html">vote_routerstatus_t</a> *vrs, int method, digest_algorithm_t alg)</td></tr>
<tr class="separator:a72cd954260c2fb4bfc45884588730a50"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions to compute directory consensus, and schedule voting. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a33655c8ce9871b95a88f4655acd785a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33655c8ce9871b95a88f4655acd785a8">&#9670;&nbsp;</a></span>CMP_FIELD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMP_FIELD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">utype, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">itype, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">field&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                             \</div><div class="line">    utype aval = (utype) (itype) a-&gt;status.field;                       \</div><div class="line">    utype bval = (utype) (itype) b-&gt;status.field;                       \</div><div class="line">    utype u = bval - aval;                                              \</div><div class="line">    itype r2 = (itype) u;                                               \</div><div class="line">    if (r2 &lt; 0) {                                                       \</div><div class="line">      return -1;                                                        \</div><div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r2 &gt; 0) {                                                \</div><div class="line">      return 1;                                                         \</div><div class="line">    }                                                                   \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div></div><!-- fragment -->
</div>
</div>
<a id="a8ac322bc7706fdb6fbe0b5ef824f40ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ac322bc7706fdb6fbe0b5ef824f40ed">&#9670;&nbsp;</a></span>get_most_frequent_member</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define get_most_frequent_member</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lst</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="container_8c.html#ae8bc3603ae2ab2d245291a914c84a1f1">smartlist_get_most_frequent_string</a>(lst)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a sorted list of strings <b>lst</b>, return the member that appears most. Break ties in favor of later-occurring members. </p>

</div>
</div>
<a id="aaf32d124cdb2c18fcf58f1665dfe2f72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf32d124cdb2c18fcf58f1665dfe2f72">&#9670;&nbsp;</a></span>MIN_VOTES_FOR_PARAM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN_VOTES_FOR_PARAM&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Minimum number of directory authorities voting for a parameter to include it in the consensus, if consensus method 12 or later is to be used. See proposal 178 for details. </p>

</div>
</div>
<a id="a97f53dc1593611bb590d17ea4a43b5de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97f53dc1593611bb590d17ea4a43b5de">&#9670;&nbsp;</a></span>RANGE_CHECK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RANGE_CHECK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">e, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">g, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">mx&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">((a) &gt;= 0 &amp;&amp; (a) &lt;= (mx) &amp;&amp; (b) &gt;= 0 &amp;&amp; (b) &lt;= (mx) &amp;&amp; \</div><div class="line">        (c) &gt;= 0 &amp;&amp; (c) &lt;= (mx) &amp;&amp; (<a class="code" href="namespaced.html">d</a>) &gt;= 0 &amp;&amp; (<a class="code" href="namespaced.html">d</a>) &lt;= (mx) &amp;&amp; \</div><div class="line">        (e) &gt;= 0 &amp;&amp; (e) &lt;= (mx) &amp;&amp; (f) &gt;= 0 &amp;&amp; (f) &lt;= (mx) &amp;&amp; \</div><div class="line">        (g) &gt;= 0 &amp;&amp; (g) &lt;= (mx))</div><div class="ttc" id="namespaced_html"><div class="ttname"><a href="namespaced.html">d</a></div><div class="ttdef"><b>Definition:</b> d.py:1</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a48a7397dde2dc10b728b03ef31890ae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48a7397dde2dc10b728b03ef31890ae1">&#9670;&nbsp;</a></span>dir_src_ent_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structdir__src__ent__t.html">dir_src_ent_t</a>  <a class="el" href="structdir__src__ent__t.html">dir_src_ent_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Temporary structure used in constructing a list of dir-source entries for a consensus. One of these is generated for every vote, and one more for every legacy key in each vote. </p>

</div>
</div>
<a id="aa1b0279b6beb6ae83c3a894ca35132a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1b0279b6beb6ae83c3a894ca35132a7">&#9670;&nbsp;</a></span>microdesc_vote_line_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmicrodesc__vote__line__t.html">microdesc_vote_line_t</a>  <a class="el" href="structmicrodesc__vote__line__t.html">microdesc_vote_line_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper type used when generating the microdescriptor lines in a directory vote. </p>

</div>
</div>
<a id="a1617c61c2051e59bf7c6717404c67e1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1617c61c2051e59bf7c6717404c67e1d">&#9670;&nbsp;</a></span>pending_consensus_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structpending__consensus__t.html">pending_consensus_t</a>  <a class="el" href="structpending__consensus__t.html">pending_consensus_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A consensus that we have built and are appending signatures to. Once it's time to publish it, it will become an active consensus if it accumulates enough signatures. </p>

</div>
</div>
<a id="a4da89e03e157186c817490c71a1374e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4da89e03e157186c817490c71a1374e7">&#9670;&nbsp;</a></span>pending_vote_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structpending__vote__t.html">pending_vote_t</a>  <a class="el" href="structpending__vote__t.html">pending_vote_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A vote <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> and its unparsed body: held around so we can use it to generate a consensus (at voting_ends) and so we can serve it to other authorities that might want it. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a38bc81b8644900e12b2b9b9569d105b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38bc81b8644900e12b2b9b9569d105b5">&#9670;&nbsp;</a></span>authority_cert_dup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structauthority__cert__t.html">authority_cert_t</a>* authority_cert_dup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structauthority__cert__t.html">authority_cert_t</a> *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and return a new <a class="el" href="structauthority__cert__t.html">authority_cert_t</a> with the same contents as <b>cert</b>. </p>

</div>
</div>
<a id="ab876fd37d49b88c5ce095d93e458ff10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab876fd37d49b88c5ce095d93e458ff10">&#9670;&nbsp;</a></span>compute_consensus_package_lines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC char* compute_consensus_package_lines </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>votes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a list of <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> for each vote, return a newly allocated string containing the "package" lines for the vote. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_ab876fd37d49b88c5ce095d93e458ff10_cgraph.png" border="0" usemap="#dirvote_8c_ab876fd37d49b88c5ce095d93e458ff10_cgraph" alt=""/></div>
<map name="dirvote_8c_ab876fd37d49b88c5ce095d93e458ff10_cgraph" id="dirvote_8c_ab876fd37d49b88c5ce095d93e458ff10_cgraph">
<area shape="rect" id="node2" href="dirserv_8c.html#ae4f82bd716ec94f012312bf508728269" title="validate_recommended\l_package_line" alt="" coords="252,5,408,47"/>
</map>
</div>

</div>
</div>
<a id="a333f56fb4797757ca9e04bee1550cabe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a333f56fb4797757ca9e04bee1550cabe">&#9670;&nbsp;</a></span>dirvote_act()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dirvote_act </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Entry point: Take whatever voting actions are pending as of <b>now</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_a333f56fb4797757ca9e04bee1550cabe_cgraph.png" border="0" usemap="#dirvote_8c_a333f56fb4797757ca9e04bee1550cabe_cgraph" alt=""/></div>
<map name="dirvote_8c_a333f56fb4797757ca9e04bee1550cabe_cgraph" id="dirvote_8c_a333f56fb4797757ca9e04bee1550cabe_cgraph">
<area shape="rect" id="node2" href="router_8c.html#a71fbf956eedbc38a293306c9bf1962e7" title="authdir_mode_v3" alt="" coords="140,5,261,32"/>
<area shape="rect" id="node3" href="router_8c.html#a2d62b1eeaa990670a04de8dfbb42ab8f" title="authdir_mode" alt="" coords="309,5,409,32"/>
</map>
</div>

</div>
</div>
<a id="a705721f192e93574c305f27b7e24f272"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a705721f192e93574c305f27b7e24f272">&#9670;&nbsp;</a></span>dirvote_add_signatures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dirvote_add_signatures </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>detached_signatures_body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: we just got the <b>detached_signatures_body</b> sent to us as signatures on the currently pending consensus. Add them to the pending consensus (if we have one); otherwise queue them until we have a consensus. Return negative on failure, nonnegative on success. </p>

</div>
</div>
<a id="ae4e7e393e4261047243c1c3f339886e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4e7e393e4261047243c1c3f339886e4">&#9670;&nbsp;</a></span>dirvote_add_vote()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpending__vote__t.html">pending_vote_t</a>* dirvote_add_vote </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>vote_body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>msg_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we have received a networkstatus vote in <b>vote_body</b>. Parse and validate it, and on success store it as a pending vote (which we then return). Return NULL on failure. Sets *<b>msg_out</b> and *<b>status_out</b> to an HTTP response and status code. (V3 authority only) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_ae4e7e393e4261047243c1c3f339886e4_cgraph.png" border="0" usemap="#dirvote_8c_ae4e7e393e4261047243c1c3f339886e4_cgraph" alt=""/></div>
<map name="dirvote_8c_ae4e7e393e4261047243c1c3f339886e4_cgraph" id="dirvote_8c_ae4e7e393e4261047243c1c3f339886e4_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#a65f051065986f87c9969726c07d761be" title="networkstatus_parse\l_vote_from_string" alt="" coords="175,5,317,47"/>
</map>
</div>

</div>
</div>
<a id="ae8fd15ddb8a25674fa692b574339503c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8fd15ddb8a25674fa692b574339503c">&#9670;&nbsp;</a></span>dirvote_compute_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="structsmartlist__t.html">smartlist_t</a>* dirvote_compute_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>votes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total_authorities</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: given a list of valid <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a>, return a new smartlist containing the contents of the consensus network parameter set. </p>

</div>
</div>
<a id="a97feb95be6e8e94295fa6775355318ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97feb95be6e8e94295fa6775355318ee">&#9670;&nbsp;</a></span>dirvote_create_microdescriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmicrodesc__t.html">microdesc_t</a>* dirvote_create_microdescriptor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>consensus_method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Construct and return a new microdescriptor from a routerinfo <b>ri</b> according to <b>consensus_method</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_a97feb95be6e8e94295fa6775355318ee_cgraph.png" border="0" usemap="#dirvote_8c_a97feb95be6e8e94295fa6775355318ee_cgraph" alt=""/></div>
<map name="dirvote_8c_a97feb95be6e8e94295fa6775355318ee_cgraph" id="dirvote_8c_a97feb95be6e8e94295fa6775355318ee_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a557593755a335c3edf74bb3ead7af209" title="crypto_pk_write_public\l_key_to_string" alt="" coords="265,5,420,47"/>
<area shape="rect" id="node3" href="policies_8c.html#af2e21a770e119c34b55360c703040bdc" title="policy_summarize" alt="" coords="279,71,406,98"/>
<area shape="rect" id="node4" href="container_8c.html#ab865391a8cac688c51809c33dad0bfe2" title="smartlist_join_strings" alt="" coords="270,122,415,149"/>
<area shape="rect" id="node6" href="util_8c.html#a68cb44a66a7446022122c93590b6d179" title="smartlist_add_asprintf" alt="" coords="481,173,631,199"/>
<area shape="rect" id="node10" href="util__format_8c.html#a2394b082102cdbb3d443955e9b056e0e" title="base64_encode" alt="" coords="702,426,815,453"/>
<area shape="rect" id="node12" href="address_8c.html#a6ecc12236743caf7527376436791c75e" title="tor_addr_is_null" alt="" coords="286,274,399,301"/>
<area shape="rect" id="node13" href="address_8c.html#a1b6ba2d6f5a3bc607d7d761c849ec110" title="fmt_addrport" alt="" coords="295,325,390,351"/>
<area shape="rect" id="node16" href="policies_8c.html#a8dd804fdc250aed2c7270fe142400c56" title="write_short_policy" alt="" coords="279,223,406,250"/>
<area shape="rect" id="node17" href="crypto__format_8c.html#abfe3914879d93c7eb2f06d9628979364" title="ed25519_public_to_base64" alt="" coords="253,375,432,402"/>
<area shape="rect" id="node19" href="crypto__format_8c.html#aa31b9d5fd609a1c8c3c888c7d817284c" title="digest_to_base64" alt="" coords="494,477,618,503"/>
<area shape="rect" id="node20" href="routerparse_8c.html#abfc52ced95cf906593bbdab812e1cd8e" title="microdescs_parse_from\l_string" alt="" coords="262,528,423,569"/>
<area shape="rect" id="node5" href="container_8c.html#aac69a4c0d462859a1a13a6eb35ab3c0a" title="smartlist_join_strings2" alt="" coords="480,122,632,149"/>
<area shape="rect" id="node7" href="util_8c.html#a4fee2abf83af3a8b8a18b245daf4083b" title="smartlist_add_vasprintf" alt="" coords="680,173,837,199"/>
<area shape="rect" id="node8" href="compat_8c.html#a5ef7a08e8b543c0d61f9ef1081d4c1ea" title="tor_vasprintf" alt="" coords="910,173,1005,199"/>
<area shape="rect" id="node9" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="907,223,1007,250"/>
<area shape="rect" id="node11" href="util__format_8c.html#a733f32f58c6056750ad6f64228af51b2" title="base64_encode_size" alt="" coords="885,426,1029,453"/>
<area shape="rect" id="node14" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="513,325,599,351"/>
<area shape="rect" id="node15" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="711,325,806,351"/>
<area shape="rect" id="node18" href="crypto__format_8c.html#a357bf351fe9894c905f7e7029da38f9a" title="digest256_to_base64" alt="" coords="483,375,629,402"/>
</map>
</div>

</div>
</div>
<a id="a7c8c11aee1a421ac4cd72f1d020ac6d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c8c11aee1a421ac4cd72f1d020ac6d5">&#9670;&nbsp;</a></span>dirvote_format_all_microdesc_vote_lines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structvote__microdesc__hash__t.html">vote_microdesc_hash_t</a>* dirvote_format_all_microdesc_vote_lines </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>microdescriptors_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate and return a linked list of all the lines that should appear to describe a router's microdescriptor versions in a directory vote. Add the generated microdescriptors to <b>microdescriptors_out</b>. </p>

</div>
</div>
<a id="aadeea5dccfa87bef2915fd6e9ad92a39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadeea5dccfa87bef2915fd6e9ad92a39">&#9670;&nbsp;</a></span>dirvote_format_microdesc_vote_line()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t dirvote_format_microdesc_vote_line </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>out_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>out_buf_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmicrodesc__t.html">microdesc_t</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>consensus_method_low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>consensus_method_high</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Format the appropriate vote line to describe the microdescriptor <b>md</b> in a consensus vote document. Write it into the <b>out_len</b>-byte buffer in <b>out</b>. Return -1 on failure and the number of characters written on success. </p>

</div>
</div>
<a id="a585a4928108f1321756e08eb86712d51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a585a4928108f1321756e08eb86712d51">&#9670;&nbsp;</a></span>dirvote_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dirvote_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all static storage held in <a class="el" href="dirvote_8c.html" title="Functions to compute directory consensus, and schedule voting. ">dirvote.c</a> </p>

</div>
</div>
<a id="a53c84b14cb4293be3481901a2bf7d344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53c84b14cb4293be3481901a2bf7d344">&#9670;&nbsp;</a></span>dirvote_get_intermediate_param_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int32_t dirvote_get_intermediate_param_value </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>param_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>keyword</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>default_val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a list of K=V values, return the int32_t value corresponding to KEYWORD=, or default_val if no such value exists, or if the value is corrupt. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_a53c84b14cb4293be3481901a2bf7d344_cgraph.png" border="0" usemap="#dirvote_8c_a53c84b14cb4293be3481901a2bf7d344_cgraph" alt=""/></div>
<map name="dirvote_8c_a53c84b14cb4293be3481901a2bf7d344_cgraph" id="dirvote_8c_a53c84b14cb4293be3481901a2bf7d344_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="227,5,315,32"/>
<area shape="rect" id="node3" href="util_8c.html#a1d00748e8ddd4a785d07fec04205b892" title="tor_parse_long" alt="" coords="217,56,324,83"/>
</map>
</div>

</div>
</div>
<a id="a60188357707e416d29de6342bc32a883"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60188357707e416d29de6342bc32a883">&#9670;&nbsp;</a></span>dirvote_get_preferred_voting_intervals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dirvote_get_preferred_voting_intervals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvote__timing__t.html">vote_timing_t</a> *&#160;</td>
          <td class="paramname"><em>timing_out</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set *<b>timing_out</b> to the intervals at which we would like to vote. Note that these aren't the intervals we'll use to vote; they're the ones that we'll vote to use. </p>

</div>
</div>
<a id="ad12be9f1748f89ce9e33a895218912fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad12be9f1748f89ce9e33a895218912fb">&#9670;&nbsp;</a></span>dirvote_get_start_of_next_interval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t dirvote_get_start_of_next_interval </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the start of the next interval of size <b>interval</b> (in seconds) after <b>now</b>, plus <b>offset</b>. Midnight always starts a fresh interval, and if the last interval of a day would be truncated to less than half its size, it is rolled into the previous interval. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_ad12be9f1748f89ce9e33a895218912fb_cgraph.png" border="0" usemap="#dirvote_8c_ad12be9f1748f89ce9e33a895218912fb_cgraph" alt=""/></div>
<map name="dirvote_8c_ad12be9f1748f89ce9e33a895218912fb_cgraph" id="dirvote_8c_ad12be9f1748f89ce9e33a895218912fb_cgraph">
<area shape="rect" id="node2" href="compat_8c.html#a983d273987a338a60523f0bce4006af2" title="tor_gmtime_r" alt="" coords="191,56,289,83"/>
<area shape="rect" id="node6" href="util_8c.html#a966c4dd39a43f89fd5207aebb4756654" title="tor_timegm" alt="" coords="197,107,283,133"/>
<area shape="rect" id="node3" href="compat__threads_8c.html#a0f3b168e06f8e4b99789af20771ee096" title="tor_mutex_new" alt="" coords="347,5,457,32"/>
<area shape="rect" id="node4" href="compat__pthreads_8c.html#a8bfcc96866bdf76508915db8b252f746" title="tor_mutex_acquire" alt="" coords="337,56,467,83"/>
<area shape="rect" id="node5" href="compat__pthreads_8c.html#a3fc2298a8cb49803528daa6d35091372" title="tor_mutex_release" alt="" coords="337,107,467,133"/>
</map>
</div>

</div>
</div>
<a id="a6905fdc89a2bce64a9f79c526c140f94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6905fdc89a2bce64a9f79c526c140f94">&#9670;&nbsp;</a></span>dirvote_get_vote()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structcached__dir__t.html">cached_dir_t</a>* dirvote_get_vote </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a given vote specified by <b>fp</b>. If <b>by_id</b>, return the vote for the authority with the v3 authority identity key digest <b>fp</b>; if <b>by_id</b> is false, return the vote whose digest is <b>fp</b>. If <b>fp</b> is NULL, return our own vote. If <b>include_previous</b> is false, do not consider any votes for a consensus that's already been built. If <b>include_pending</b> is false, do not consider any votes for the consensus that's in progress. May return NULL if we have no vote for the authority in question. </p>

</div>
</div>
<a id="aab7ea3ac9bbece8dbdd6c3c167dc0ae9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab7ea3ac9bbece8dbdd6c3c167dc0ae9">&#9670;&nbsp;</a></span>dirvote_recalculate_timing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dirvote_recalculate_timing </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set voting_schedule to hold the timing for the next vote we should be doing. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_aab7ea3ac9bbece8dbdd6c3c167dc0ae9_cgraph.png" border="0" usemap="#dirvote_8c_aab7ea3ac9bbece8dbdd6c3c167dc0ae9_cgraph" alt=""/></div>
<map name="dirvote_8c_aab7ea3ac9bbece8dbdd6c3c167dc0ae9_cgraph" id="dirvote_8c_aab7ea3ac9bbece8dbdd6c3c167dc0ae9_cgraph">
<area shape="rect" id="node2" href="router_8c.html#a71fbf956eedbc38a293306c9bf1962e7" title="authdir_mode_v3" alt="" coords="184,13,305,39"/>
<area shape="rect" id="node3" href="router_8c.html#a2d62b1eeaa990670a04de8dfbb42ab8f" title="authdir_mode" alt="" coords="353,13,453,39"/>
</map>
</div>

</div>
</div>
<a id="a7c7f8a75319fa1345604f7cac5b02831"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c7f8a75319fa1345604f7cac5b02831">&#9670;&nbsp;</a></span>format_networkstatus_vote()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC char* format_networkstatus_vote </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>private_signing_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>v3_ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a new string containing the string representation of the vote in <b>v3_ns</b>, signed with our v3 signing key <b>private_signing_key</b>. For v3 authorities. </p>

</div>
</div>
<a id="a170431e56608ff40b06dd265519102a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a170431e56608ff40b06dd265519102a7">&#9670;&nbsp;</a></span>make_consensus_method_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC char* make_consensus_method_list </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>high</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>separator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a newly allocated string holding the numbers between low and high (inclusive) that are supported consensus methods. </p>

</div>
</div>
<a id="a6c6d21276cc8671a821bc012da3b1661"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c6d21276cc8671a821bc012da3b1661">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dirvote_get_pending_consensus&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(<a class="el" href="or_8h.html#ada0879620550843533b891a49543b109">consensus_flavor_t</a> flav)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the body of the consensus that we're currently trying to build. </p>

</div>
</div>
<a id="a6e6f2ecd6383f9ed442ec8e827ce666e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e6f2ecd6383f9ed442ec8e827ce666e">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dirvote_get_pending_detached_signatures&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(void)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the signatures that we know for the consensus that we're currently trying to build. </p>

</div>
</div>
<a id="a5b21332ec8c217620fefe5f2bd405c93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b21332ec8c217620fefe5f2bd405c93">&#9670;&nbsp;</a></span>networkstatus_add_detached_signatures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int networkstatus_add_detached_signatures </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structns__detached__signatures__t.html">ns_detached_signatures_t</a> *&#160;</td>
          <td class="paramname"><em>sigs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a consensus vote <b>target</b> and a set of detached signatures in <b>sigs</b> that correspond to the same consensus, check whether there are any new signatures in <b>src_voter_list</b> that should be added to <b>target</b>. (A signature should be added if we have no signature for that voter in <b>target</b> yet, or if we have no verifiable signature and the new signature is verifiable.) Return the number of signatures added or changed, or -1 if the document signed by <b>sigs</b> isn't the same document as <b>target</b>. </p>
<p>Make sure all the digests we know match, and at least one matches. </p>

</div>
</div>
<a id="a0cedd7ac4100a20d3069d42dc535c84e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cedd7ac4100a20d3069d42dc535c84e">&#9670;&nbsp;</a></span>networkstatus_compute_consensus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* networkstatus_compute_consensus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>votes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total_authorities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>identity_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>signing_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>legacy_id_key_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>legacy_signing_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#ada0879620550843533b891a49543b109">consensus_flavor_t</a>&#160;</td>
          <td class="paramname"><em>flavor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a list of vote <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> in <b>votes</b>, our public authority <b>identity_key</b>, our private authority <b>signing_key</b>, and the number of <b>total_authorities</b> that we believe exist in our voting quorum, generate the text of a new v3 consensus vote, and return the value in a newly allocated string.</p>
<p>Note: this function DOES NOT check whether the votes are from recognized authorities. (dirvote_add_vote does that.) </p>

</div>
</div>
<a id="a88b12c0f09a9033deb2cb78cc1dc321c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b12c0f09a9033deb2cb78cc1dc321c">&#9670;&nbsp;</a></span>networkstatus_get_detached_signatures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* networkstatus_get_detached_signatures </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>consensuses</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a newly allocated string holding the detached-signatures document corresponding to the signatures on <b>consensuses</b>, which must contain exactly one FLAV_NS consensus, and no more than one consensus for each other flavor. </p>

</div>
</div>
<a id="a4a36c2930edf9d2ca915c30057a64da8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a36c2930edf9d2ca915c30057a64da8">&#9670;&nbsp;</a></span>ns_detached_signatures_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ns_detached_signatures_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structns__detached__signatures__t.html">ns_detached_signatures_t</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all storage held in <b>s</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_a4a36c2930edf9d2ca915c30057a64da8_cgraph.png" border="0" usemap="#dirvote_8c_a4a36c2930edf9d2ca915c30057a64da8_cgraph" alt=""/></div>
<map name="dirvote_8c_a4a36c2930edf9d2ca915c30057a64da8_cgraph" id="dirvote_8c_a4a36c2930edf9d2ca915c30057a64da8_cgraph">
<area shape="rect" id="node2" href="networkstatus_8c.html#af6fa8990a971778c3d879c662c1579a9" title="document_signature_free" alt="" coords="245,5,413,32"/>
<area shape="rect" id="node3" href="util_8c.html#a40d94cc20afc38582c65aa418919ebed" title="tor_free_" alt="" coords="293,56,366,83"/>
</map>
</div>

</div>
</div>
<a id="a72cd954260c2fb4bfc45884588730a50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72cd954260c2fb4bfc45884588730a50">&#9670;&nbsp;</a></span>vote_routerstatus_find_microdesc_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vote_routerstatus_find_microdesc_hash </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>digest256_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structvote__routerstatus__t.html">vote_routerstatus_t</a> *&#160;</td>
          <td class="paramname"><em>vrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">digest_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If <b>vrs</b> has a hash made for the consensus method <b>method</b> with the digest algorithm <b>alg</b>, decode it and copy it into <b>digest256_out</b> and return 0. Otherwise return -1. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_a72cd954260c2fb4bfc45884588730a50_cgraph.png" border="0" usemap="#dirvote_8c_a72cd954260c2fb4bfc45884588730a50_cgraph" alt=""/></div>
<map name="dirvote_8c_a72cd954260c2fb4bfc45884588730a50_cgraph" id="dirvote_8c_a72cd954260c2fb4bfc45884588730a50_cgraph">
<area shape="rect" id="node2" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="241,5,327,32"/>
<area shape="rect" id="node4" href="crypto_8c.html#adefcd6cb8ded2532779e981dce8d5011" title="crypto_digest_algorithm\l_get_name" alt="" coords="204,57,364,98"/>
<area shape="rect" id="node3" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="412,5,507,32"/>
</map>
</div>

</div>
</div>
<a id="a60af55f760759eb6ad39a5c11ba3baaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60af55f760759eb6ad39a5c11ba3baaf">&#9670;&nbsp;</a></span>voter_get_sig_by_algorithm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdocument__signature__t.html">document_signature_t</a>* voter_get_sig_by_algorithm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structnetworkstatus__voter__info__t.html">networkstatus_voter_info_t</a> *&#160;</td>
          <td class="paramname"><em>voter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">digest_algorithm_t&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the signature made by <b>voter</b> using the algorithm <b>alg</b>, or NULL if none is found. </p>

</div>
</div>
<a id="adffd241c7a248002845c761c4147ab58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adffd241c7a248002845c761c4147ab58">&#9670;&nbsp;</a></span>voting_schedule_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void voting_schedule_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvoting__schedule__t.html">voting_schedule_t</a> *&#160;</td>
          <td class="paramname"><em>voting_schedule_to_free</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees a <a class="el" href="structvoting__schedule__t.html">voting_schedule_t</a>. This should be used instead of the generic tor_free. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
