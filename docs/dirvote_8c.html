<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/dirauth/dirvote.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li><li class="navelem"><a class="el" href="dir_c5d850bddae166bb86a80dcb64398e39.html">dirauth</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">dirvote.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to compute directory consensus, and schedule voting.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dircollate_8h_source.html">dircollate.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="directory_8h_source.html">directory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dirserv_8h_source.html">dirserv.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="microdesc_8h_source.html">microdesc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="networkstatus_8h_source.html">networkstatus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nodelist_8h_source.html">nodelist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="parsecommon_8h_source.html">parsecommon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="policies_8h_source.html">policies.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="protover_8h_source.html">protover.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rephist_8h_source.html">rephist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="router_8h_source.html">router.h</a>&quot;</code><br />
<code>#include &quot;routerkeys.h&quot;</code><br />
<code>#include &quot;<a class="el" href="routerlist_8h_source.html">routerlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerparse_8h_source.html">routerparse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="entrynodes_8h_source.html">entrynodes.h</a>&quot;</code><br />
<code>#include &quot;torcert.h&quot;</code><br />
<code>#include &quot;<a class="el" href="voting__schedule_8h_source.html">voting_schedule.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dirvote_8h_source.html">dirauth/dirvote.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mode_8h_source.html">dirauth/mode.h</a>&quot;</code><br />
<code>#include &quot;dirauth/shared_random_state.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for dirvote.c:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2dirauth_2dirvote_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2dirauth_2dirvote_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2dirauth_2dirvote_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="1141,273,1185,300"/>
<area shape="rect" id="node26" href="config_8h.html" title="Header file for config.c. " alt="" coords="1741,273,1809,300"/>
<area shape="rect" id="node27" href="dircollate_8h.html" title="Header file for dircollate.c. " alt="" coords="1652,199,1737,225"/>
<area shape="rect" id="node28" href="directory_8h.html" title="Header file for directory.c. " alt="" coords="97,199,180,225"/>
<area shape="rect" id="node30" href="dirserv_8h.html" title="Header file for dirserv.c. " alt="" coords="1812,199,1884,225"/>
<area shape="rect" id="node31" href="microdesc_8h.html" title="Header file for microdesc.c. " alt="" coords="2088,117,2181,143"/>
<area shape="rect" id="node32" href="networkstatus_8h.html" title="Header file for networkstatus.c. " alt="" coords="1885,273,2000,300"/>
<area shape="rect" id="node33" href="nodelist_8h.html" title="Header file for nodelist.c. " alt="" coords="2206,117,2285,143"/>
<area shape="rect" id="node34" href="parsecommon_8h.html" title="Header file for parsecommon.c. " alt="" coords="1449,348,1564,375"/>
<area shape="rect" id="node36" href="policies_8h.html" title="Header file for policies.c. " alt="" coords="2309,117,2387,143"/>
<area shape="rect" id="node37" href="protover_8h.html" title="Headers and type declarations for protover.c. " alt="" coords="1584,273,1664,300"/>
<area shape="rect" id="node38" href="rephist_8h.html" title="Header file for rephist.c. " alt="" coords="2411,117,2483,143"/>
<area shape="rect" id="node39" href="router_8h.html" title="Header file for router.c. " alt="" coords="2108,497,2175,524"/>
<area shape="rect" id="node40" href="routerkeys_8h_source.html" title="routerkeys.h" alt="" coords="113,273,207,300"/>
<area shape="rect" id="node41" href="routerlist_8h.html" title="Header file for routerlist.c. " alt="" coords="2165,199,2248,225"/>
<area shape="rect" id="node42" href="routerparse_8h.html" title="Header file for routerparse.c. " alt="" coords="2507,117,2605,143"/>
<area shape="rect" id="node43" href="entrynodes_8h.html" title="Header file for circuitbuild.c. " alt="" coords="1965,199,2062,225"/>
<area shape="rect" id="node45" href="torcert_8h_source.html" title="torcert.h" alt="" coords="899,199,970,225"/>
<area shape="rect" id="node46" href="voting__schedule_8h.html" title="Header file for voting_schedule.c. " alt="" coords="1375,199,1502,225"/>
<area shape="rect" id="node47" href="dirvote_8h.html" title="Header file for dirvote.c. " alt="" coords="2629,117,2744,143"/>
<area shape="rect" id="node48" href="mode_8h.html" title="Standalone header file for directory authority mode. " alt="" coords="2769,117,2877,143"/>
<area shape="rect" id="node49" href="shared__random__state_8h_source.html" title="dirauth/shared_random\l_state.h" alt="" coords="1104,109,1259,151"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="1173,647,1251,673"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="663,572,726,599"/>
<area shape="rect" id="node6" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="1047,423,1116,449"/>
<area shape="rect" id="node10" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="350,348,463,375"/>
<area shape="rect" id="node11" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="288,423,413,449"/>
<area shape="rect" id="node12" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="489,497,631,524"/>
<area shape="rect" id="node13" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="1261,423,1323,449"/>
<area shape="rect" id="node14" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1569,423,1634,449"/>
<area shape="rect" id="node15" href="container_8h_source.html" title="container.h" alt="" coords="1347,423,1434,449"/>
<area shape="rect" id="node16" href="compress_8h.html" title="Headers for compress.c. " alt="" coords="795,348,885,375"/>
<area shape="rect" id="node17" href="address_8h.html" title="Headers for address.h. " alt="" coords="641,348,719,375"/>
<area shape="rect" id="node18" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="1740,497,1868,524"/>
<area shape="rect" id="node19" href="ht_8h_source.html" title="ht.h" alt="" coords="910,348,954,375"/>
<area shape="rect" id="node20" href="confline_8h_source.html" title="confline.h" alt="" coords="1346,348,1425,375"/>
<area shape="rect" id="node21" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="978,348,1081,375"/>
<area shape="rect" id="node22" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="1892,348,1983,375"/>
<area shape="rect" id="node23" href="token__bucket_8h_source.html" title="token_bucket.h" alt="" coords="927,497,1038,524"/>
<area shape="rect" id="node24" href="util__format_8h_source.html" title="util_format.h" alt="" coords="809,497,903,524"/>
<area shape="rect" id="node25" href="hs__circuitmap_8h.html" title="Header file for hs_circuitmap.c. " alt="" coords="1105,348,1220,375"/>
<area shape="rect" id="node8" href="compat_8h_source.html" title="compat.h" alt="" coords="1165,497,1241,524"/>
<area shape="rect" id="node9" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="1552,572,1651,599"/>
<area shape="rect" id="node29" href="hs__ident_8h.html" title="Header file containing circuit and connection identifier data for the whole HS subsytem. " alt="" coords="5,273,88,300"/>
<area shape="rect" id="node35" href="memarea_8h_source.html" title="memarea.h" alt="" coords="1458,423,1545,449"/>
<area shape="rect" id="node44" href="handles_8h.html" title="Macros for C weak&#45;handle implementation. " alt="" coords="2025,273,2103,300"/>
<area shape="rect" id="node50" href="shared__random_8h_source.html" title="shared_random.h" alt="" coords="1103,199,1225,225"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpending__consensus__t.html">pending_consensus_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdir__src__ent__t.html">dir_src_ent_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpending__vote__t.html">pending_vote_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>consensus_method_range_t</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmicrodesc__vote__line__t.html">microdesc_vote_line_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a01edd4184c640d2ef15b77e6e0ef9004"><td class="memItemLeft" align="right" valign="top"><a id="a01edd4184c640d2ef15b77e6e0ef9004"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DIRVOTE_PRIVATE</b></td></tr>
<tr class="separator:a01edd4184c640d2ef15b77e6e0ef9004"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ac322bc7706fdb6fbe0b5ef824f40ed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a8ac322bc7706fdb6fbe0b5ef824f40ed">get_most_frequent_member</a>(lst)&#160;&#160;&#160;<a class="el" href="container_8c.html#ae8bc3603ae2ab2d245291a914c84a1f1">smartlist_get_most_frequent_string</a>(lst)</td></tr>
<tr class="separator:a8ac322bc7706fdb6fbe0b5ef824f40ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33655c8ce9871b95a88f4655acd785a8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>CMP_FIELD</b>(utype,  itype,  field)</td></tr>
<tr class="separator:a33655c8ce9871b95a88f4655acd785a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf32d124cdb2c18fcf58f1665dfe2f72"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#aaf32d124cdb2c18fcf58f1665dfe2f72">MIN_VOTES_FOR_PARAM</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:aaf32d124cdb2c18fcf58f1665dfe2f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97f53dc1593611bb590d17ea4a43b5de"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>RANGE_CHECK</b>(a,  b,  c,  d,  e,  f,  g,  mx)</td></tr>
<tr class="separator:a97f53dc1593611bb590d17ea4a43b5de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad81ce7a955cb848c14356df94c38eb8"><td class="memItemLeft" align="right" valign="top"><a id="aad81ce7a955cb848c14356df94c38eb8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHECK_EQ</b>(a,  b,  margin)&#160;&#160;&#160;((a)-(b) &gt;= 0 ? (a)-(b) &lt;= (margin) : (b)-(a) &lt;= (margin))</td></tr>
<tr class="separator:aad81ce7a955cb848c14356df94c38eb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a593ec48f332d0f3114976bfe78024fca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>IF_TIME_FOR_NEXT_ACTION</b>(when_field,  done_field)</td></tr>
<tr class="separator:a593ec48f332d0f3114976bfe78024fca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7039fb6fb9cb00f8e223a05e1ee436b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>ENDIF</b></td></tr>
<tr class="separator:af7039fb6fb9cb00f8e223a05e1ee436b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a1617c61c2051e59bf7c6717404c67e1d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structpending__consensus__t.html">pending_consensus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a1617c61c2051e59bf7c6717404c67e1d">pending_consensus_t</a></td></tr>
<tr class="separator:a1617c61c2051e59bf7c6717404c67e1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48a7397dde2dc10b728b03ef31890ae1"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structdir__src__ent__t.html">dir_src_ent_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a48a7397dde2dc10b728b03ef31890ae1">dir_src_ent_t</a></td></tr>
<tr class="separator:a48a7397dde2dc10b728b03ef31890ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4da89e03e157186c817490c71a1374e7"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structpending__vote__t.html">pending_vote_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a4da89e03e157186c817490c71a1374e7">pending_vote_t</a></td></tr>
<tr class="separator:a4da89e03e157186c817490c71a1374e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1b0279b6beb6ae83c3a894ca35132a7"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structmicrodesc__vote__line__t.html">microdesc_vote_line_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#aa1b0279b6beb6ae83c3a894ca35132a7">microdesc_vote_line_t</a></td></tr>
<tr class="separator:aa1b0279b6beb6ae83c3a894ca35132a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a4b6f6e66ea2136b41cd2645d8f86dcd0"><td class="memItemLeft" align="right" valign="top"><a id="a4b6f6e66ea2136b41cd2645d8f86dcd0"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>bw_weights_error_t</b> { <br />
&#160;&#160;<b>BW_WEIGHTS_NO_ERROR</b> = 0, 
<b>BW_WEIGHTS_RANGE_ERROR</b> = 1, 
<b>BW_WEIGHTS_SUMG_ERROR</b> = 2, 
<b>BW_WEIGHTS_SUME_ERROR</b> = 3, 
<br />
&#160;&#160;<b>BW_WEIGHTS_SUMD_ERROR</b> = 4, 
<b>BW_WEIGHTS_BALANCE_MID_ERROR</b> = 5, 
<b>BW_WEIGHTS_BALANCE_EG_ERROR</b> = 6
<br />
 }</td></tr>
<tr class="separator:a4b6f6e66ea2136b41cd2645d8f86dcd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a52d3ec34f8dff4092975aeb4ccaaec68"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="structauthority__cert__t.html">authority_cert_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a52d3ec34f8dff4092975aeb4ccaaec68">authority_cert_dup</a> (<a class="el" href="structauthority__cert__t.html">authority_cert_t</a> *cert)</td></tr>
<tr class="separator:a52d3ec34f8dff4092975aeb4ccaaec68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7f8a75319fa1345604f7cac5b02831"><td class="memItemLeft" align="right" valign="top">STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a7c7f8a75319fa1345604f7cac5b02831">format_networkstatus_vote</a> (<a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *private_signing_key, <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *v3_ns)</td></tr>
<tr class="separator:a7c7f8a75319fa1345604f7cac5b02831"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a170431e56608ff40b06dd265519102a7"><td class="memItemLeft" align="right" valign="top">STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a170431e56608ff40b06dd265519102a7">make_consensus_method_list</a> (int low, int high, const char *separator)</td></tr>
<tr class="separator:a170431e56608ff40b06dd265519102a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53c84b14cb4293be3481901a2bf7d344"><td class="memItemLeft" align="right" valign="top">STATIC int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a53c84b14cb4293be3481901a2bf7d344">dirvote_get_intermediate_param_value</a> (const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *param_list, const char *keyword, int32_t default_val)</td></tr>
<tr class="separator:a53c84b14cb4293be3481901a2bf7d344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8fd15ddb8a25674fa692b574339503c"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#ae8fd15ddb8a25674fa692b574339503c">dirvote_compute_params</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *votes, int method, int total_authorities)</td></tr>
<tr class="separator:ae8fd15ddb8a25674fa692b574339503c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a826a16133541381aa8e115b2211e442e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a826a16133541381aa8e115b2211e442e">networkstatus_compute_bw_weights_v10</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *chunks, int64_t G, int64_t M, int64_t E, int64_t D, int64_t <a class="el" href="parsecommon_8h.html#ab691bd2eed9864879c6f851bda3168a8">T</a>, int64_t weight_scale)</td></tr>
<tr class="separator:a826a16133541381aa8e115b2211e442e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fa14e3f74b40d0a380fcda84609611c"><td class="memItemLeft" align="right" valign="top">STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a6fa14e3f74b40d0a380fcda84609611c">networkstatus_compute_consensus</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *votes, int total_authorities, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *identity_key, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *signing_key, const char *legacy_id_key_digest, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *legacy_signing_key, <a class="el" href="or_8h.html#ada0879620550843533b891a49543b109">consensus_flavor_t</a> flavor)</td></tr>
<tr class="separator:a6fa14e3f74b40d0a380fcda84609611c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab876fd37d49b88c5ce095d93e458ff10"><td class="memItemLeft" align="right" valign="top">STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#ab876fd37d49b88c5ce095d93e458ff10">compute_consensus_package_lines</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *votes)</td></tr>
<tr class="separator:ab876fd37d49b88c5ce095d93e458ff10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa21e9db3a0c157ff08f322a8892609b8"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#aa21e9db3a0c157ff08f322a8892609b8">networkstatus_add_detached_signatures</a> (<a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *target, <a class="el" href="structns__detached__signatures__t.html">ns_detached_signatures_t</a> *sigs, const char *source, int severity, const char **msg_out)</td></tr>
<tr class="separator:aa21e9db3a0c157ff08f322a8892609b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a621fb01e9587c2d750d2e8a08cf3fbcc"><td class="memItemLeft" align="right" valign="top">STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a621fb01e9587c2d750d2e8a08cf3fbcc">networkstatus_get_detached_signatures</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *consensuses)</td></tr>
<tr class="separator:a621fb01e9587c2d750d2e8a08cf3fbcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a400b5c51c76c06099342ee3501f5f66d"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a400b5c51c76c06099342ee3501f5f66d">dirvote_act</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options, time_t now)</td></tr>
<tr class="separator:a400b5c51c76c06099342ee3501f5f66d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4e7e393e4261047243c1c3f339886e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpending__vote__t.html">pending_vote_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#ae4e7e393e4261047243c1c3f339886e4">dirvote_add_vote</a> (const char *vote_body, const char **msg_out, int *status_out)</td></tr>
<tr class="separator:ae4e7e393e4261047243c1c3f339886e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a705721f192e93574c305f27b7e24f272"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a705721f192e93574c305f27b7e24f272">dirvote_add_signatures</a> (const char *detached_signatures_body, const char *source, const char **msg)</td></tr>
<tr class="separator:a705721f192e93574c305f27b7e24f272"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a585a4928108f1321756e08eb86712d51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a585a4928108f1321756e08eb86712d51">dirvote_free_all</a> (void)</td></tr>
<tr class="separator:a585a4928108f1321756e08eb86712d51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c6d21276cc8671a821bc012da3b1661"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a6c6d21276cc8671a821bc012da3b1661">MOCK_IMPL</a> (const char *, dirvote_get_pending_consensus,(<a class="el" href="or_8h.html#ada0879620550843533b891a49543b109">consensus_flavor_t</a> flav))</td></tr>
<tr class="separator:a6c6d21276cc8671a821bc012da3b1661"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e6f2ecd6383f9ed442ec8e827ce666e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a6e6f2ecd6383f9ed442ec8e827ce666e">MOCK_IMPL</a> (const char *, dirvote_get_pending_detached_signatures,(void))</td></tr>
<tr class="separator:a6e6f2ecd6383f9ed442ec8e827ce666e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6905fdc89a2bce64a9f79c526c140f94"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structcached__dir__t.html">cached_dir_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a6905fdc89a2bce64a9f79c526c140f94">dirvote_get_vote</a> (const char *fp, int flags)</td></tr>
<tr class="separator:a6905fdc89a2bce64a9f79c526c140f94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a059168318a87de5f77438cbcefdb73ed"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="structmicrodesc__t.html">microdesc_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a059168318a87de5f77438cbcefdb73ed">dirvote_create_microdescriptor</a> (const <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> *ri, int consensus_method)</td></tr>
<tr class="separator:a059168318a87de5f77438cbcefdb73ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c8c11aee1a421ac4cd72f1d020ac6d5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structvote__microdesc__hash__t.html">vote_microdesc_hash_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#a7c8c11aee1a421ac4cd72f1d020ac6d5">dirvote_format_all_microdesc_vote_lines</a> (const <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> *ri, time_t now, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *microdescriptors_out)</td></tr>
<tr class="separator:a7c8c11aee1a421ac4cd72f1d020ac6d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d7912178742b7e18778b375828f3c91"><td class="memItemLeft" align="right" valign="top"><a id="a2d7912178742b7e18778b375828f3c91"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>dirvote_parse_sr_commits</b> (<a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *ns, const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *tokens)</td></tr>
<tr class="separator:a2d7912178742b7e18778b375828f3c91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a588a13d1e8e7be7ffa778f27566d1475"><td class="memItemLeft" align="right" valign="top"><a id="a588a13d1e8e7be7ffa778f27566d1475"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>dirvote_clear_commits</b> (<a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *ns)</td></tr>
<tr class="separator:a588a13d1e8e7be7ffa778f27566d1475"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa52bf9605db3dc6545f1b22b89de33cf"><td class="memItemLeft" align="right" valign="top"><a id="aa52bf9605db3dc6545f1b22b89de33cf"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>dirvote_dirreq_get_status_vote</b> (const char *url, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *items, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *dir_items)</td></tr>
<tr class="separator:aa52bf9605db3dc6545f1b22b89de33cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae288382ee634aeb5099f263fa9af8c25"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dirvote_8c.html#ae288382ee634aeb5099f263fa9af8c25">dirserv_generate_networkstatus_vote_obj</a> (<a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *private_key, <a class="el" href="structauthority__cert__t.html">authority_cert_t</a> *cert)</td></tr>
<tr class="separator:ae288382ee634aeb5099f263fa9af8c25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions to compute directory consensus, and schedule voting. </p>
<p>This module is the center of the consensus-voting based directory authority system. With this system, a set of authorities first publish vote based on their opinions of the network, and then compute a consensus from those votes. Each authority signs the consensus, and clients trust the consensus if enough known authorities have signed it.</p>
<p>The code in this module is only invoked on directory authorities. It's responsible for:</p>
<ul>
<li>
Generating this authority's vote networkstatus, based on the authority's view of the network as represented in <a class="el" href="dirserv_8c.html" title="Directory server core implementation. Manages directory contents and generates directories. ">dirserv.c</a> </li>
<li>
Formatting the vote networkstatus objects. </li>
<li>
Generating the microdescriptors that correspond to our own vote. </li>
<li>
Sending votes to all the other authorities. </li>
<li>
Trying to fetch missing votes from other authorities. </li>
<li>
Computing the consensus from a set of votes, as well as a "detached signature" object for other authorities to fetch. </li>
<li>
Collecting other authorities' signatures on the same consensus, until there are enough. </li>
<li>
Publishing the consensus to the reset of the directory system. </li>
<li>
Scheduling all of the above operations. </li>
</ul>
<p>The main entry points are in <a class="el" href="dirvote_8c.html#a400b5c51c76c06099342ee3501f5f66d">dirvote_act()</a>, which handles scheduled actions; and <a class="el" href="dirvote_8c.html#ae4e7e393e4261047243c1c3f339886e4">dirvote_add_vote()</a> and <a class="el" href="dirvote_8c.html#a705721f192e93574c305f27b7e24f272">dirvote_add_signatures()</a>, which handle uploaded and downloaded votes and signatures.</p>
<p>(See dir-spec.txt from torspec.git for a complete specification of the directory protocol and voting algorithms.) </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a33655c8ce9871b95a88f4655acd785a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33655c8ce9871b95a88f4655acd785a8">&#9670;&nbsp;</a></span>CMP_FIELD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMP_FIELD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">utype, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">itype, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">field&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                             \</div><div class="line">    utype aval = (utype) (itype) a-&gt;status.field;                       \</div><div class="line">    utype bval = (utype) (itype) b-&gt;status.field;                       \</div><div class="line">    utype u = bval - aval;                                              \</div><div class="line">    itype r2 = (itype) u;                                               \</div><div class="line">    if (r2 &lt; 0) {                                                       \</div><div class="line">      return -1;                                                        \</div><div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r2 &gt; 0) {                                                \</div><div class="line">      return 1;                                                         \</div><div class="line">    }                                                                   \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div></div><!-- fragment -->
</div>
</div>
<a id="af7039fb6fb9cb00f8e223a05e1ee436b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7039fb6fb9cb00f8e223a05e1ee436b">&#9670;&nbsp;</a></span>ENDIF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENDIF</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">}           \</div><div class="line">  }</div></div><!-- fragment -->
</div>
</div>
<a id="a8ac322bc7706fdb6fbe0b5ef824f40ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ac322bc7706fdb6fbe0b5ef824f40ed">&#9670;&nbsp;</a></span>get_most_frequent_member</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define get_most_frequent_member</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lst</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="container_8c.html#ae8bc3603ae2ab2d245291a914c84a1f1">smartlist_get_most_frequent_string</a>(lst)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a sorted list of strings <b>lst</b>, return the member that appears most. Break ties in favor of later-occurring members. </p>

</div>
</div>
<a id="a593ec48f332d0f3114976bfe78024fca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a593ec48f332d0f3114976bfe78024fca">&#9670;&nbsp;</a></span>IF_TIME_FOR_NEXT_ACTION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IF_TIME_FOR_NEXT_ACTION</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">when_field, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">done_field&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">if</span> (! voting_schedule.done_field) {                   \</div><div class="line">    if (voting_schedule.when_field &gt; now) {             \</div><div class="line">      return voting_schedule.when_field;                \</div><div class="line">    } <span class="keywordflow">else</span> {</div></div><!-- fragment -->
</div>
</div>
<a id="aaf32d124cdb2c18fcf58f1665dfe2f72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf32d124cdb2c18fcf58f1665dfe2f72">&#9670;&nbsp;</a></span>MIN_VOTES_FOR_PARAM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN_VOTES_FOR_PARAM&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Minimum number of directory authorities voting for a parameter to include it in the consensus, if consensus method 12 or later is to be used. See proposal 178 for details. </p>

</div>
</div>
<a id="a97f53dc1593611bb590d17ea4a43b5de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97f53dc1593611bb590d17ea4a43b5de">&#9670;&nbsp;</a></span>RANGE_CHECK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RANGE_CHECK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">e, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">g, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">mx&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">((a) &gt;= 0 &amp;&amp; (a) &lt;= (mx) &amp;&amp; (b) &gt;= 0 &amp;&amp; (b) &lt;= (mx) &amp;&amp; \</div><div class="line">        (c) &gt;= 0 &amp;&amp; (c) &lt;= (mx) &amp;&amp; (<a class="code" href="namespaced.html">d</a>) &gt;= 0 &amp;&amp; (<a class="code" href="namespaced.html">d</a>) &lt;= (mx) &amp;&amp; \</div><div class="line">        (e) &gt;= 0 &amp;&amp; (e) &lt;= (mx) &amp;&amp; (f) &gt;= 0 &amp;&amp; (f) &lt;= (mx) &amp;&amp; \</div><div class="line">        (g) &gt;= 0 &amp;&amp; (g) &lt;= (mx))</div><div class="ttc" id="namespaced_html"><div class="ttname"><a href="namespaced.html">d</a></div><div class="ttdef"><b>Definition:</b> d.py:1</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a48a7397dde2dc10b728b03ef31890ae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48a7397dde2dc10b728b03ef31890ae1">&#9670;&nbsp;</a></span>dir_src_ent_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structdir__src__ent__t.html">dir_src_ent_t</a>  <a class="el" href="structdir__src__ent__t.html">dir_src_ent_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Temporary structure used in constructing a list of dir-source entries for a consensus. One of these is generated for every vote, and one more for every legacy key in each vote. </p>

</div>
</div>
<a id="aa1b0279b6beb6ae83c3a894ca35132a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1b0279b6beb6ae83c3a894ca35132a7">&#9670;&nbsp;</a></span>microdesc_vote_line_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmicrodesc__vote__line__t.html">microdesc_vote_line_t</a>  <a class="el" href="structmicrodesc__vote__line__t.html">microdesc_vote_line_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper type used when generating the microdescriptor lines in a directory vote. </p>

</div>
</div>
<a id="a1617c61c2051e59bf7c6717404c67e1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1617c61c2051e59bf7c6717404c67e1d">&#9670;&nbsp;</a></span>pending_consensus_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structpending__consensus__t.html">pending_consensus_t</a>  <a class="el" href="structpending__consensus__t.html">pending_consensus_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A consensus that we have built and are appending signatures to. Once it's time to publish it, it will become an active consensus if it accumulates enough signatures. </p>

</div>
</div>
<a id="a4da89e03e157186c817490c71a1374e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4da89e03e157186c817490c71a1374e7">&#9670;&nbsp;</a></span>pending_vote_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structpending__vote__t.html">pending_vote_t</a>  <a class="el" href="structpending__vote__t.html">pending_vote_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A vote <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> and its unparsed body: held around so we can use it to generate a consensus (at voting_ends) and so we can serve it to other authorities that might want it. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a52d3ec34f8dff4092975aeb4ccaaec68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52d3ec34f8dff4092975aeb4ccaaec68">&#9670;&nbsp;</a></span>authority_cert_dup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="structauthority__cert__t.html">authority_cert_t</a>* authority_cert_dup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structauthority__cert__t.html">authority_cert_t</a> *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and return a new <a class="el" href="structauthority__cert__t.html">authority_cert_t</a> with the same contents as <b>cert</b>. </p>

</div>
</div>
<a id="ab876fd37d49b88c5ce095d93e458ff10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab876fd37d49b88c5ce095d93e458ff10">&#9670;&nbsp;</a></span>compute_consensus_package_lines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC char* compute_consensus_package_lines </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>votes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a list of <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> for each vote, return a newly allocated string containing the "package" lines for the vote. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_ab876fd37d49b88c5ce095d93e458ff10_cgraph.png" border="0" usemap="#dirvote_8c_ab876fd37d49b88c5ce095d93e458ff10_cgraph" alt=""/></div>
<map name="dirvote_8c_ab876fd37d49b88c5ce095d93e458ff10_cgraph" id="dirvote_8c_ab876fd37d49b88c5ce095d93e458ff10_cgraph">
<area shape="rect" id="node2" href="dirserv_8c.html#ae4f82bd716ec94f012312bf508728269" title="validate_recommended\l_package_line" alt="" coords="252,5,408,47"/>
</map>
</div>

</div>
</div>
<a id="ae288382ee634aeb5099f263fa9af8c25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae288382ee634aeb5099f263fa9af8c25">&#9670;&nbsp;</a></span>dirserv_generate_networkstatus_vote_obj()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a>* dirserv_generate_networkstatus_vote_obj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structauthority__cert__t.html">authority_cert_t</a> *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a new networkstatus_t* containing our current opinion. (For v3 authorities) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_ae288382ee634aeb5099f263fa9af8c25_cgraph.png" border="0" usemap="#dirvote_8c_ae288382ee634aeb5099f263fa9af8c25_cgraph" alt=""/></div>
<map name="dirvote_8c_ae288382ee634aeb5099f263fa9af8c25_cgraph" id="dirvote_8c_ae288382ee634aeb5099f263fa9af8c25_cgraph">
<area shape="rect" id="node2" href="routerlist_8c.html#a9181bbed0ee6ff8088a7c53fc8c446f1" title="router_get_routerlist" alt="" coords="260,13,397,39"/>
</map>
</div>

</div>
</div>
<a id="a400b5c51c76c06099342ee3501f5f66d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a400b5c51c76c06099342ee3501f5f66d">&#9670;&nbsp;</a></span>dirvote_act()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t dirvote_act </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Entry point: Take whatever voting actions are pending as of <b>now</b>.</p>
<p>Return the time at which the next action should be taken. </p>

</div>
</div>
<a id="a705721f192e93574c305f27b7e24f272"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a705721f192e93574c305f27b7e24f272">&#9670;&nbsp;</a></span>dirvote_add_signatures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dirvote_add_signatures </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>detached_signatures_body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: we just got the <b>detached_signatures_body</b> sent to us as signatures on the currently pending consensus. Add them to the pending consensus (if we have one); otherwise queue them until we have a consensus. Return negative on failure, nonnegative on success. </p>

</div>
</div>
<a id="ae4e7e393e4261047243c1c3f339886e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4e7e393e4261047243c1c3f339886e4">&#9670;&nbsp;</a></span>dirvote_add_vote()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpending__vote__t.html">pending_vote_t</a>* dirvote_add_vote </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>vote_body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>msg_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we have received a networkstatus vote in <b>vote_body</b>. Parse and validate it, and on success store it as a pending vote (which we then return). Return NULL on failure. Sets *<b>msg_out</b> and *<b>status_out</b> to an HTTP response and status code. (V3 authority only) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_ae4e7e393e4261047243c1c3f339886e4_cgraph.png" border="0" usemap="#dirvote_8c_ae4e7e393e4261047243c1c3f339886e4_cgraph" alt=""/></div>
<map name="dirvote_8c_ae4e7e393e4261047243c1c3f339886e4_cgraph" id="dirvote_8c_ae4e7e393e4261047243c1c3f339886e4_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#a65f051065986f87c9969726c07d761be" title="networkstatus_parse\l_vote_from_string" alt="" coords="175,5,317,47"/>
</map>
</div>

</div>
</div>
<a id="ae8fd15ddb8a25674fa692b574339503c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8fd15ddb8a25674fa692b574339503c">&#9670;&nbsp;</a></span>dirvote_compute_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="structsmartlist__t.html">smartlist_t</a>* dirvote_compute_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>votes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total_authorities</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: given a list of valid <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a>, return a new smartlist containing the contents of the consensus network parameter set. </p>

</div>
</div>
<a id="a059168318a87de5f77438cbcefdb73ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a059168318a87de5f77438cbcefdb73ed">&#9670;&nbsp;</a></span>dirvote_create_microdescriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="structmicrodesc__t.html">microdesc_t</a>* dirvote_create_microdescriptor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>consensus_method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Construct and return a new microdescriptor from a routerinfo <b>ri</b> according to <b>consensus_method</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_a059168318a87de5f77438cbcefdb73ed_cgraph.png" border="0" usemap="#dirvote_8c_a059168318a87de5f77438cbcefdb73ed_cgraph" alt=""/></div>
<map name="dirvote_8c_a059168318a87de5f77438cbcefdb73ed_cgraph" id="dirvote_8c_a059168318a87de5f77438cbcefdb73ed_cgraph">
<area shape="rect" id="node2" href="crypto__rsa_8c.html#a557593755a335c3edf74bb3ead7af209" title="crypto_pk_write_public\l_key_to_string" alt="" coords="265,5,420,47"/>
<area shape="rect" id="node3" href="policies_8c.html#af2e21a770e119c34b55360c703040bdc" title="policy_summarize" alt="" coords="279,71,406,98"/>
<area shape="rect" id="node4" href="container_8c.html#ab865391a8cac688c51809c33dad0bfe2" title="smartlist_join_strings" alt="" coords="483,122,628,149"/>
<area shape="rect" id="node6" href="util_8c.html#a68cb44a66a7446022122c93590b6d179" title="smartlist_add_asprintf" alt="" coords="480,223,631,250"/>
<area shape="rect" id="node10" href="util__format_8c.html#a2394b082102cdbb3d443955e9b056e0e" title="base64_encode" alt="" coords="701,426,814,453"/>
<area shape="rect" id="node12" href="address_8c.html#a6ecc12236743caf7527376436791c75e" title="tor_addr_is_null" alt="" coords="286,274,399,301"/>
<area shape="rect" id="node13" href="address_8c.html#a1b6ba2d6f5a3bc607d7d761c849ec110" title="fmt_addrport" alt="" coords="295,325,390,351"/>
<area shape="rect" id="node16" href="policies_8c.html#a8dd804fdc250aed2c7270fe142400c56" title="write_short_policy" alt="" coords="279,173,406,199"/>
<area shape="rect" id="node18" href="crypto__format_8c.html#abfe3914879d93c7eb2f06d9628979364" title="ed25519_public_to_base64" alt="" coords="253,375,432,402"/>
<area shape="rect" id="node20" href="crypto__format_8c.html#aa31b9d5fd609a1c8c3c888c7d817284c" title="digest_to_base64" alt="" coords="493,477,617,503"/>
<area shape="rect" id="node21" href="routerparse_8c.html#abfc52ced95cf906593bbdab812e1cd8e" title="microdescs_parse_from\l_string" alt="" coords="262,528,423,569"/>
<area shape="rect" id="node5" href="container_8c.html#aac69a4c0d462859a1a13a6eb35ab3c0a" title="smartlist_join_strings2" alt="" coords="681,122,833,149"/>
<area shape="rect" id="node7" href="util_8c.html#a4fee2abf83af3a8b8a18b245daf4083b" title="smartlist_add_vasprintf" alt="" coords="679,223,836,250"/>
<area shape="rect" id="node8" href="compat_8c.html#a5ef7a08e8b543c0d61f9ef1081d4c1ea" title="tor_vasprintf" alt="" coords="909,249,1003,275"/>
<area shape="rect" id="node9" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="906,198,1006,225"/>
<area shape="rect" id="node11" href="util__format_8c.html#a733f32f58c6056750ad6f64228af51b2" title="base64_encode_size" alt="" coords="884,426,1028,453"/>
<area shape="rect" id="node14" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="512,325,599,351"/>
<area shape="rect" id="node15" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="710,325,805,351"/>
<area shape="rect" id="node17" href="util_8c.html#a95ad8dd258dec01eebc504928e6df180" title="smartlist_add_strdup" alt="" coords="484,173,627,199"/>
<area shape="rect" id="node19" href="crypto__format_8c.html#a357bf351fe9894c905f7e7029da38f9a" title="digest256_to_base64" alt="" coords="483,375,628,402"/>
</map>
</div>

</div>
</div>
<a id="a7c8c11aee1a421ac4cd72f1d020ac6d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c8c11aee1a421ac4cd72f1d020ac6d5">&#9670;&nbsp;</a></span>dirvote_format_all_microdesc_vote_lines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structvote__microdesc__hash__t.html">vote_microdesc_hash_t</a>* dirvote_format_all_microdesc_vote_lines </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> *&#160;</td>
          <td class="paramname"><em>ri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>microdescriptors_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate and return a linked list of all the lines that should appear to describe a router's microdescriptor versions in a directory vote. Add the generated microdescriptors to <b>microdescriptors_out</b>. </p>

</div>
</div>
<a id="a585a4928108f1321756e08eb86712d51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a585a4928108f1321756e08eb86712d51">&#9670;&nbsp;</a></span>dirvote_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dirvote_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all static storage held in <a class="el" href="dirvote_8c.html" title="Functions to compute directory consensus, and schedule voting. ">dirvote.c</a> </p>

</div>
</div>
<a id="a53c84b14cb4293be3481901a2bf7d344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53c84b14cb4293be3481901a2bf7d344">&#9670;&nbsp;</a></span>dirvote_get_intermediate_param_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int32_t dirvote_get_intermediate_param_value </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>param_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>keyword</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>default_val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a list of K=V values, return the int32_t value corresponding to KEYWORD=, or default_val if no such value exists, or if the value is corrupt. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dirvote_8c_a53c84b14cb4293be3481901a2bf7d344_cgraph.png" border="0" usemap="#dirvote_8c_a53c84b14cb4293be3481901a2bf7d344_cgraph" alt=""/></div>
<map name="dirvote_8c_a53c84b14cb4293be3481901a2bf7d344_cgraph" id="dirvote_8c_a53c84b14cb4293be3481901a2bf7d344_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="227,5,315,32"/>
<area shape="rect" id="node3" href="util_8c.html#a1d00748e8ddd4a785d07fec04205b892" title="tor_parse_long" alt="" coords="217,56,324,83"/>
</map>
</div>

</div>
</div>
<a id="a6905fdc89a2bce64a9f79c526c140f94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6905fdc89a2bce64a9f79c526c140f94">&#9670;&nbsp;</a></span>dirvote_get_vote()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structcached__dir__t.html">cached_dir_t</a>* dirvote_get_vote </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a given vote specified by <b>fp</b>. If <b>by_id</b>, return the vote for the authority with the v3 authority identity key digest <b>fp</b>; if <b>by_id</b> is false, return the vote whose digest is <b>fp</b>. If <b>fp</b> is NULL, return our own vote. If <b>include_previous</b> is false, do not consider any votes for a consensus that's already been built. If <b>include_pending</b> is false, do not consider any votes for the consensus that's in progress. May return NULL if we have no vote for the authority in question. </p>

</div>
</div>
<a id="a7c7f8a75319fa1345604f7cac5b02831"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c7f8a75319fa1345604f7cac5b02831">&#9670;&nbsp;</a></span>format_networkstatus_vote()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC char* format_networkstatus_vote </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>private_signing_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>v3_ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a new string containing the string representation of the vote in <b>v3_ns</b>, signed with our v3 signing key <b>private_signing_key</b>. For v3 authorities. </p>

</div>
</div>
<a id="a170431e56608ff40b06dd265519102a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a170431e56608ff40b06dd265519102a7">&#9670;&nbsp;</a></span>make_consensus_method_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC char* make_consensus_method_list </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>high</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>separator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a newly allocated string holding the numbers between low and high (inclusive) that are supported consensus methods. </p>

</div>
</div>
<a id="a6c6d21276cc8671a821bc012da3b1661"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c6d21276cc8671a821bc012da3b1661">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dirvote_get_pending_consensus&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(<a class="el" href="or_8h.html#ada0879620550843533b891a49543b109">consensus_flavor_t</a> flav)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the body of the consensus that we're currently trying to build. </p>

</div>
</div>
<a id="a6e6f2ecd6383f9ed442ec8e827ce666e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e6f2ecd6383f9ed442ec8e827ce666e">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dirvote_get_pending_detached_signatures&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(void)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the signatures that we know for the consensus that we're currently trying to build. </p>

</div>
</div>
<a id="aa21e9db3a0c157ff08f322a8892609b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa21e9db3a0c157ff08f322a8892609b8">&#9670;&nbsp;</a></span>networkstatus_add_detached_signatures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int networkstatus_add_detached_signatures </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structns__detached__signatures__t.html">ns_detached_signatures_t</a> *&#160;</td>
          <td class="paramname"><em>sigs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a consensus vote <b>target</b> and a set of detached signatures in <b>sigs</b> that correspond to the same consensus, check whether there are any new signatures in <b>src_voter_list</b> that should be added to <b>target</b>. (A signature should be added if we have no signature for that voter in <b>target</b> yet, or if we have no verifiable signature and the new signature is verifiable.) Return the number of signatures added or changed, or -1 if the document signed by <b>sigs</b> isn't the same document as <b>target</b>. </p>
<p>Make sure all the digests we know match, and at least one matches. </p>

</div>
</div>
<a id="a826a16133541381aa8e115b2211e442e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a826a16133541381aa8e115b2211e442e">&#9670;&nbsp;</a></span>networkstatus_compute_bw_weights_v10()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int networkstatus_compute_bw_weights_v10 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>chunks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>weight_scale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function computes the bandwidth weights for consensus method 10.</p>
<p>It returns true if weights could be computed, false otherwise. </p>

</div>
</div>
<a id="a6fa14e3f74b40d0a380fcda84609611c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fa14e3f74b40d0a380fcda84609611c">&#9670;&nbsp;</a></span>networkstatus_compute_consensus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC char* networkstatus_compute_consensus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>votes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total_authorities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>identity_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>signing_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>legacy_id_key_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>legacy_signing_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#ada0879620550843533b891a49543b109">consensus_flavor_t</a>&#160;</td>
          <td class="paramname"><em>flavor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a list of vote <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> in <b>votes</b>, our public authority <b>identity_key</b>, our private authority <b>signing_key</b>, and the number of <b>total_authorities</b> that we believe exist in our voting quorum, generate the text of a new v3 consensus or microdescriptor consensus (depending on <b>flavor</b>), and return the value in a newly allocated string.</p>
<p>Note: this function DOES NOT check whether the votes are from recognized authorities. (dirvote_add_vote does that.)</p>
<p><b>WATCH OUT</b>: You need to think before you change the behavior of this function, or of the functions it calls! If some authorities compute the consensus with a different algorithm than others, they will not reach the same result, and they will not all sign the same thing! If you really need to change the algorithm here, you should allocate a new "consensus_method" for the new behavior, and make the new behavior conditional on a new-enough consensus_method. </p>

</div>
</div>
<a id="a621fb01e9587c2d750d2e8a08cf3fbcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a621fb01e9587c2d750d2e8a08cf3fbcc">&#9670;&nbsp;</a></span>networkstatus_get_detached_signatures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC char* networkstatus_get_detached_signatures </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>consensuses</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a newly allocated string holding the detached-signatures document corresponding to the signatures on <b>consensuses</b>, which must contain exactly one FLAV_NS consensus, and no more than one consensus for each other flavor. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
