<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/microdesc.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">microdesc.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="microdesc_8c.html" title="Implements microdescriptors – an abbreviated description of less-frequently-changing router informat...">microdesc.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h__dep__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2microdesc_8hdep" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2microdesc_8hdep" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2microdesc_8hdep">
<area shape="rect" id="node2" href="circuitbuild_8c.html" title="Implements the details of building circuits (by chosing paths, constructing/sending create/extend cel..." alt="" coords="5,109,153,165"/>
<area shape="rect" id="node3" href="connection__or_8c.html" title="Functions to handle OR connections, TLS handshaking, and cells on the network. " alt="" coords="178,109,333,165"/>
<area shape="rect" id="node4" href="directory_8c.html" title="Code to send and fetch directories and router descriptors via HTTP. Directories use dirserv..." alt="" coords="357,109,505,165"/>
<area shape="rect" id="node5" href="dirserv_8c.html" title="Directory server core implementation. Manages directory contents and generates directories. " alt="" coords="529,109,677,165"/>
<area shape="rect" id="node6" href="dirvote_8c.html" title="Functions to compute directory consensus, and schedule voting. " alt="" coords="701,109,849,165"/>
<area shape="rect" id="node7" href="entrynodes_8c.html" title="Code to manage our fixed first nodes for various functions. " alt="" coords="873,109,1021,165"/>
<area shape="rect" id="node8" href="main_8c.html" title="Toplevel module. Handles signals, multiplexes between connections, implements main loop..." alt="" coords="1045,109,1193,165"/>
<area shape="rect" id="node9" href="microdesc_8c.html" title="Implements microdescriptors – an abbreviated description of less&#45;frequently&#45;changing router informat..." alt="" coords="1217,109,1365,165"/>
<area shape="rect" id="node10" href="networkstatus_8c.html" title="Functions and structures for handling network status documents as a client or cache. " alt="" coords="1389,109,1545,165"/>
<area shape="rect" id="node11" href="nodelist_8c.html" title="Structures and functions for tracking what we know about the routers on the Tor network, and correlating information from networkstatus, routerinfo, and microdescs. " alt="" coords="1569,109,1717,165"/>
<area shape="rect" id="node12" href="routerlist_8c.html" title="Code to maintain and access the global list of routerinfos for known servers. " alt="" coords="1741,109,1889,165"/>
<area shape="rect" id="node13" href="routerparse_8c.html" title="Code to parse and validate router descriptors, consenus directories, and similar objects. " alt="" coords="1913,109,2061,165"/>
</map>
</div>
</div>
<p><a href="microdesc_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6bed254f2d470f70313b8510b095a046"><td class="memItemLeft" align="right" valign="top"><a id="a6bed254f2d470f70313b8510b095a046"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>microdesc_free</b>(md)&#160;&#160;&#160;<a class="el" href="microdesc_8h.html#a52a0a9334629034a34d6cc36e142c2cb">microdesc_free_</a>((md), __FILE__, __LINE__)</td></tr>
<tr class="separator:a6bed254f2d470f70313b8510b095a046"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa39bb77fb19ca888eb8d2bedac93c75d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#aa39bb77fb19ca888eb8d2bedac93c75d">get_microdesc_cache</a> (void)</td></tr>
<tr class="separator:aa39bb77fb19ca888eb8d2bedac93c75d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51c02e45cc53c9e72c6b7b5a1fffd013"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#a51c02e45cc53c9e72c6b7b5a1fffd013">microdesc_check_counts</a> (void)</td></tr>
<tr class="separator:a51c02e45cc53c9e72c6b7b5a1fffd013"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c94ac08f79487c605faf8e543fc3057"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#a8c94ac08f79487c605faf8e543fc3057">microdescs_add_to_cache</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache, const char *s, const char *eos, <a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a> where, int no_save, time_t listed_at, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *requested_digests256)</td></tr>
<tr class="separator:a8c94ac08f79487c605faf8e543fc3057"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4492613165472890582c336f6e9e0c65"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#a4492613165472890582c336f6e9e0c65">microdescs_add_list_to_cache</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *descriptors, <a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a> where, int no_save)</td></tr>
<tr class="separator:a4492613165472890582c336f6e9e0c65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6dd60dcd4d473a6b0c9fce9f0f3c1c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#af6dd60dcd4d473a6b0c9fce9f0f3c1c3">microdesc_cache_clean</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache, time_t cutoff, int force)</td></tr>
<tr class="separator:af6dd60dcd4d473a6b0c9fce9f0f3c1c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55a7108c2c7b945bacfdec0edf70fbe4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#a55a7108c2c7b945bacfdec0edf70fbe4">microdesc_cache_rebuild</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache, int force)</td></tr>
<tr class="separator:a55a7108c2c7b945bacfdec0edf70fbe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7955c20e8710e1f0b377d61eaba416b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#a7955c20e8710e1f0b377d61eaba416b1">microdesc_cache_reload</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache)</td></tr>
<tr class="separator:a7955c20e8710e1f0b377d61eaba416b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6328b92665f9f78a482248609cdb2f5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#a6328b92665f9f78a482248609cdb2f5a">microdesc_cache_clear</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache)</td></tr>
<tr class="separator:a6328b92665f9f78a482248609cdb2f5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c169d48c50e48e8fe1306765f319b61"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmicrodesc__t.html">microdesc_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#a7c169d48c50e48e8fe1306765f319b61">microdesc_cache_lookup_by_digest256</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache, const char *d)</td></tr>
<tr class="separator:a7c169d48c50e48e8fe1306765f319b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ed7132c4abf5af5ba74ec1cd090878d"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#a9ed7132c4abf5af5ba74ec1cd090878d">microdesc_average_size</a> (<a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache)</td></tr>
<tr class="separator:a9ed7132c4abf5af5ba74ec1cd090878d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73c847c43e1a2bfd711718dd113261e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#a73c847c43e1a2bfd711718dd113261e5">microdesc_list_missing_digest256</a> (<a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *ns, <a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *cache, int downloadable_only, digest256map_t *skip)</td></tr>
<tr class="separator:a73c847c43e1a2bfd711718dd113261e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52a0a9334629034a34d6cc36e142c2cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#a52a0a9334629034a34d6cc36e142c2cb">microdesc_free_</a> (<a class="el" href="structmicrodesc__t.html">microdesc_t</a> *md, const char *fname, int line)</td></tr>
<tr class="separator:a52a0a9334629034a34d6cc36e142c2cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c23e8a71ff24b72d4dcfbda3ae39688"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#a1c23e8a71ff24b72d4dcfbda3ae39688">microdesc_free_all</a> (void)</td></tr>
<tr class="separator:a1c23e8a71ff24b72d4dcfbda3ae39688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad7f413d899b72e58bed8efc0162d8bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#aad7f413d899b72e58bed8efc0162d8bd">update_microdesc_downloads</a> (time_t now)</td></tr>
<tr class="separator:aad7f413d899b72e58bed8efc0162d8bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad388d518c6750dce831b4d375e0efe5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#ad388d518c6750dce831b4d375e0efe5c">update_microdescs_from_networkstatus</a> (time_t now)</td></tr>
<tr class="separator:ad388d518c6750dce831b4d375e0efe5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5747009d6ea7d834f13f07dd87034d6"><td class="memItemLeft" align="right" valign="top"><a id="aa5747009d6ea7d834f13f07dd87034d6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MOCK_DECL</b> (int, usable_consensus_flavor,(void))</td></tr>
<tr class="separator:aa5747009d6ea7d834f13f07dd87034d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9c983a76a2f31a6a843f4df9be7de1d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#ad9c983a76a2f31a6a843f4df9be7de1d">we_fetch_microdescriptors</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:ad9c983a76a2f31a6a843f4df9be7de1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2667d23ef05f514b5bf916791b4a6bbd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#a2667d23ef05f514b5bf916791b4a6bbd">we_fetch_router_descriptors</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:a2667d23ef05f514b5bf916791b4a6bbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeff3a88aa40b67ab6407bda5c941910"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microdesc_8h.html#adeff3a88aa40b67ab6407bda5c941910">we_use_microdescriptors_for_circuits</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:adeff3a88aa40b67ab6407bda5c941910"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="microdesc_8c.html" title="Implements microdescriptors – an abbreviated description of less-frequently-changing router informat...">microdesc.c</a>. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa39bb77fb19ca888eb8d2bedac93c75d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa39bb77fb19ca888eb8d2bedac93c75d">&#9670;&nbsp;</a></span>get_microdesc_cache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a>* get_microdesc_cache </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a pointer to the microdescriptor cache, loading it if necessary. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_aa39bb77fb19ca888eb8d2bedac93c75d_icgraph.png" border="0" usemap="#microdesc_8h_aa39bb77fb19ca888eb8d2bedac93c75d_icgraph" alt=""/></div>
<map name="microdesc_8h_aa39bb77fb19ca888eb8d2bedac93c75d_icgraph" id="microdesc_8h_aa39bb77fb19ca888eb8d2bedac93c75d_icgraph">
<area shape="rect" id="node2" href="dirserv_8h.html#a89dcb27b45f04c12e789dee837b90fdc" title="dirserv_have_any_microdesc" alt="" coords="433,11,623,37"/>
<area shape="rect" id="node3" href="microdesc_8h.html#a7c169d48c50e48e8fe1306765f319b61" title="microdesc_cache_lookup\l_by_digest256" alt="" coords="203,33,372,74"/>
<area shape="rect" id="node4" href="microdesc_8h.html#a9ed7132c4abf5af5ba74ec1cd090878d" title="microdesc_average_size" alt="" coords="204,99,371,125"/>
<area shape="rect" id="node6" href="microdesc_8h.html#ad388d518c6750dce831b4d375e0efe5c" title="update_microdescs_from\l_networkstatus" alt="" coords="203,150,371,191"/>
<area shape="rect" id="node5" href="dirserv_8h.html#a48cee7ff92f2da41f67b8f2a332ffa5a" title="dirserv_estimate_microdesc_size" alt="" coords="420,99,636,125"/>
</map>
</div>

</div>
</div>
<a id="a9ed7132c4abf5af5ba74ec1cd090878d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ed7132c4abf5af5ba74ec1cd090878d">&#9670;&nbsp;</a></span>microdesc_average_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t microdesc_average_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the mean size of decriptors added to <b>cache</b> since it was last cleared. Used to estimate the size of large downloads. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_a9ed7132c4abf5af5ba74ec1cd090878d_cgraph.png" border="0" usemap="#microdesc_8h_a9ed7132c4abf5af5ba74ec1cd090878d_cgraph" alt=""/></div>
<map name="microdesc_8h_a9ed7132c4abf5af5ba74ec1cd090878d_cgraph" id="microdesc_8h_a9ed7132c4abf5af5ba74ec1cd090878d_cgraph">
<area shape="rect" id="node2" href="microdesc_8c.html#aa39bb77fb19ca888eb8d2bedac93c75d" title="get_microdesc_cache" alt="" coords="220,5,369,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_a9ed7132c4abf5af5ba74ec1cd090878d_icgraph.png" border="0" usemap="#microdesc_8h_a9ed7132c4abf5af5ba74ec1cd090878d_icgraph" alt=""/></div>
<map name="microdesc_8h_a9ed7132c4abf5af5ba74ec1cd090878d_icgraph" id="microdesc_8h_a9ed7132c4abf5af5ba74ec1cd090878d_icgraph">
<area shape="rect" id="node2" href="dirserv_8h.html#a48cee7ff92f2da41f67b8f2a332ffa5a" title="dirserv_estimate_microdesc_size" alt="" coords="220,5,436,32"/>
</map>
</div>

</div>
</div>
<a id="af6dd60dcd4d473a6b0c9fce9f0f3c1c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6dd60dcd4d473a6b0c9fce9f0f3c1c3">&#9670;&nbsp;</a></span>microdesc_cache_clean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void microdesc_cache_clean </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>cutoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>force</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove all microdescriptors from <b>cache</b> that haven't been listed for a long time. Does not rebuild the cache on disk. If <b>cutoff</b> is positive, specifically remove microdescriptors that have been unlisted since <b>cutoff</b>. If <b>force</b> is true, remove microdescriptors even if we have no current live microdescriptor consensus. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_af6dd60dcd4d473a6b0c9fce9f0f3c1c3_cgraph.png" border="0" usemap="#microdesc_8h_af6dd60dcd4d473a6b0c9fce9f0f3c1c3_cgraph" alt=""/></div>
<map name="microdesc_8h_af6dd60dcd4d473a6b0c9fce9f0f3c1c3_cgraph" id="microdesc_8h_af6dd60dcd4d473a6b0c9fce9f0f3c1c3_cgraph">
<area shape="rect" id="node2" href="networkstatus_8c.html#a44accdf47b7f9f40b25c45daf2c31475" title="networkstatus_get_reasonably\l_live_consensus" alt="" coords="216,5,415,47"/>
</map>
</div>

</div>
</div>
<a id="a6328b92665f9f78a482248609cdb2f5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6328b92665f9f78a482248609cdb2f5a">&#9670;&nbsp;</a></span>microdesc_cache_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void microdesc_cache_clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove every microdescriptor in <b>cache</b>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_a6328b92665f9f78a482248609cdb2f5a_icgraph.png" border="0" usemap="#microdesc_8h_a6328b92665f9f78a482248609cdb2f5a_icgraph" alt=""/></div>
<map name="microdesc_8h_a6328b92665f9f78a482248609cdb2f5a_icgraph" id="microdesc_8h_a6328b92665f9f78a482248609cdb2f5a_icgraph">
<area shape="rect" id="node2" href="microdesc_8h.html#a7955c20e8710e1f0b377d61eaba416b1" title="microdesc_cache_reload" alt="" coords="212,5,379,32"/>
<area shape="rect" id="node3" href="microdesc_8h.html#a1c23e8a71ff24b72d4dcfbda3ae39688" title="microdesc_free_all" alt="" coords="230,56,361,83"/>
</map>
</div>

</div>
</div>
<a id="a7c169d48c50e48e8fe1306765f319b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c169d48c50e48e8fe1306765f319b61">&#9670;&nbsp;</a></span>microdesc_cache_lookup_by_digest256()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmicrodesc__t.html">microdesc_t</a>* microdesc_cache_lookup_by_digest256 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If there is a microdescriptor in <b>cache</b> whose sha256 digest is <b>d</b>, return it. Otherwise return NULL. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_a7c169d48c50e48e8fe1306765f319b61_cgraph.png" border="0" usemap="#microdesc_8h_a7c169d48c50e48e8fe1306765f319b61_cgraph" alt=""/></div>
<map name="microdesc_8h_a7c169d48c50e48e8fe1306765f319b61_cgraph" id="microdesc_8h_a7c169d48c50e48e8fe1306765f319b61_cgraph">
<area shape="rect" id="node2" href="microdesc_8c.html#aa39bb77fb19ca888eb8d2bedac93c75d" title="get_microdesc_cache" alt="" coords="223,13,372,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_a7c169d48c50e48e8fe1306765f319b61_icgraph.png" border="0" usemap="#microdesc_8h_a7c169d48c50e48e8fe1306765f319b61_icgraph" alt=""/></div>
<map name="microdesc_8h_a7c169d48c50e48e8fe1306765f319b61_icgraph" id="microdesc_8h_a7c169d48c50e48e8fe1306765f319b61_icgraph">
<area shape="rect" id="node2" href="dirserv_8h.html#a89dcb27b45f04c12e789dee837b90fdc" title="dirserv_have_any_microdesc" alt="" coords="223,13,413,39"/>
</map>
</div>

</div>
</div>
<a id="a55a7108c2c7b945bacfdec0edf70fbe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55a7108c2c7b945bacfdec0edf70fbe4">&#9670;&nbsp;</a></span>microdesc_cache_rebuild()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int microdesc_cache_rebuild </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>force</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Regenerate the main cache file for <b>cache</b>, clear the journal file, and update every <a class="el" href="structmicrodesc__t.html">microdesc_t</a> in the cache with pointers to its new location. If <b>force</b> is true, do this unconditionally. If <b>force</b> is false, do it only if we expect to save space on disk. </p>

</div>
</div>
<a id="a7955c20e8710e1f0b377d61eaba416b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7955c20e8710e1f0b377d61eaba416b1">&#9670;&nbsp;</a></span>microdesc_cache_reload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int microdesc_cache_reload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reload the contents of <b>cache</b> from disk. If it is empty, load it for the first time. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_a7955c20e8710e1f0b377d61eaba416b1_cgraph.png" border="0" usemap="#microdesc_8h_a7955c20e8710e1f0b377d61eaba416b1_cgraph" alt=""/></div>
<map name="microdesc_8h_a7955c20e8710e1f0b377d61eaba416b1_cgraph" id="microdesc_8h_a7955c20e8710e1f0b377d61eaba416b1_cgraph">
<area shape="rect" id="node2" href="microdesc_8c.html#a6328b92665f9f78a482248609cdb2f5a" title="microdesc_cache_clear" alt="" coords="220,5,379,32"/>
</map>
</div>

</div>
</div>
<a id="a51c02e45cc53c9e72c6b7b5a1fffd013"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51c02e45cc53c9e72c6b7b5a1fffd013">&#9670;&nbsp;</a></span>microdesc_check_counts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void microdesc_check_counts </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make sure that the reference count of every microdescriptor in cache is accurate. </p>

</div>
</div>
<a id="a52a0a9334629034a34d6cc36e142c2cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52a0a9334629034a34d6cc36e142c2cb">&#9670;&nbsp;</a></span>microdesc_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void microdesc_free_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__t.html">microdesc_t</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lineno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deallocate a single microdescriptor. Note: the microdescriptor MUST have previously been removed from the cache if it had ever been inserted. </p>

</div>
</div>
<a id="a1c23e8a71ff24b72d4dcfbda3ae39688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c23e8a71ff24b72d4dcfbda3ae39688">&#9670;&nbsp;</a></span>microdesc_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void microdesc_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all storage held in the <a class="el" href="microdesc_8c.html" title="Implements microdescriptors – an abbreviated description of less-frequently-changing router informat...">microdesc.c</a> module. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_a1c23e8a71ff24b72d4dcfbda3ae39688_cgraph.png" border="0" usemap="#microdesc_8h_a1c23e8a71ff24b72d4dcfbda3ae39688_cgraph" alt=""/></div>
<map name="microdesc_8h_a1c23e8a71ff24b72d4dcfbda3ae39688_cgraph" id="microdesc_8h_a1c23e8a71ff24b72d4dcfbda3ae39688_cgraph">
<area shape="rect" id="node2" href="microdesc_8c.html#a6328b92665f9f78a482248609cdb2f5a" title="microdesc_cache_clear" alt="" coords="184,5,343,32"/>
</map>
</div>

</div>
</div>
<a id="a73c847c43e1a2bfd711718dd113261e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73c847c43e1a2bfd711718dd113261e5">&#9670;&nbsp;</a></span>microdesc_list_missing_digest256()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsmartlist__t.html">smartlist_t</a>* microdesc_list_missing_digest256 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>downloadable_only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">digest256map_t *&#160;</td>
          <td class="paramname"><em>skip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a smartlist of all the sha256 digest of the microdescriptors that are listed in <b>ns</b> but not present in <b>cache</b>. Returns pointers to internals of <b>ns</b>; you should not free the members of the resulting smartlist. Omit all microdescriptors whose digest appear in <b>skip</b>. </p>

</div>
</div>
<a id="a4492613165472890582c336f6e9e0c65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4492613165472890582c336f6e9e0c65">&#9670;&nbsp;</a></span>microdescs_add_list_to_cache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsmartlist__t.html">smartlist_t</a>* microdescs_add_list_to_cache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>descriptors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a>&#160;</td>
          <td class="paramname"><em>where</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>no_save</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As microdescs_add_to_cache, but takes a list of microdescriptors instead of a string to decode. Frees any members of <b>descriptors</b> that it does not add. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_a4492613165472890582c336f6e9e0c65_cgraph.png" border="0" usemap="#microdesc_8h_a4492613165472890582c336f6e9e0c65_cgraph" alt=""/></div>
<map name="microdesc_8h_a4492613165472890582c336f6e9e0c65_cgraph" id="microdesc_8h_a4492613165472890582c336f6e9e0c65_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a5f3fb0bdeb712732f51d0f9e3b0c849c" title="start_writing_to_file" alt="" coords="195,13,329,39"/>
</map>
</div>

</div>
</div>
<a id="a8c94ac08f79487c605faf8e543fc3057"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c94ac08f79487c605faf8e543fc3057">&#9670;&nbsp;</a></span>microdescs_add_to_cache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsmartlist__t.html">smartlist_t</a>* microdescs_add_to_cache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmicrodesc__cache__t.html">microdesc_cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>eos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a>&#160;</td>
          <td class="paramname"><em>where</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>no_save</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>listed_at</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>requested_digests256</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decode the microdescriptors from the string starting at <b>s</b> and ending at <b>eos</b>, and store them in <b>cache</b>. If <b>no_save</b>, mark them as non-writable to disk. If <b>where</b> is SAVED_IN_CACHE, leave their bodies as pointers to the mmap'd cache. If where is <b>SAVED_NOWHERE</b>, do not allow annotations. If listed_at is not -1, set the last_listed field of every microdesc to listed_at. If requested_digests is non-null, then it contains a list of digests we mean to allow, so we should reject any non-requested microdesc with a different digest, and alter the list to contain only the digests of those microdescs we didn't find. Return a newly allocated list of the added microdescriptors, or NULL </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_a8c94ac08f79487c605faf8e543fc3057_cgraph.png" border="0" usemap="#microdesc_8h_a8c94ac08f79487c605faf8e543fc3057_cgraph" alt=""/></div>
<map name="microdesc_8h_a8c94ac08f79487c605faf8e543fc3057_cgraph" id="microdesc_8h_a8c94ac08f79487c605faf8e543fc3057_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#abfc52ced95cf906593bbdab812e1cd8e" title="microdescs_parse_from\l_string" alt="" coords="231,5,392,47"/>
</map>
</div>

</div>
</div>
<a id="aad7f413d899b72e58bed8efc0162d8bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad7f413d899b72e58bed8efc0162d8bd">&#9670;&nbsp;</a></span>update_microdesc_downloads()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_microdesc_downloads </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Launch download requests for microdescriptors as appropriate.</p>
<p>Specifically, we should launch download requests if we are configured to download mirodescriptors, and there are some microdescriptors listed in the current microdesc consensus that we don't have, and either we never asked for them, or we failed to download them but we're willing to retry. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_aad7f413d899b72e58bed8efc0162d8bd_cgraph.png" border="0" usemap="#microdesc_8h_aad7f413d899b72e58bed8efc0162d8bd_cgraph" alt=""/></div>
<map name="microdesc_8h_aad7f413d899b72e58bed8efc0162d8bd_cgraph" id="microdesc_8h_aad7f413d899b72e58bed8efc0162d8bd_cgraph">
<area shape="rect" id="node2" href="networkstatus_8c.html#aa278011afd1917ef43cc44fac287f7bf" title="should_delay_dir_fetches" alt="" coords="265,64,435,91"/>
<area shape="rect" id="node3" href="dirserv_8c.html#a2c5edbbd6883a33af3d72bfead4033db" title="directory_too_idle\l_to_fetch_descriptors" alt="" coords="277,115,423,157"/>
<area shape="rect" id="node13" href="networkstatus_8c.html#a44accdf47b7f9f40b25c45daf2c31475" title="networkstatus_get_reasonably\l_live_consensus" alt="" coords="251,181,449,222"/>
<area shape="rect" id="node4" href="dirserv_8c.html#a57e2ff1ad2ea65abe9b969ad3d76a418" title="directory_caches_dir_info" alt="" coords="497,64,668,91"/>
<area shape="rect" id="node8" href="rephist_8c.html#a890009e83c2e90292a435526b8111727" title="rep_hist_circbuilding\l_dormant" alt="" coords="513,174,653,215"/>
<area shape="rect" id="node5" href="router_8c.html#ab23297b12b098da9eac98126a587aa3b" title="dir_server_mode" alt="" coords="738,5,857,32"/>
<area shape="rect" id="node6" href="router_8c.html#afa75de94186fffc8f373de610ae4cab3" title="should_refuse_unknown\l_exits" alt="" coords="716,57,879,98"/>
<area shape="rect" id="node7" href="networkstatus_8c.html#aba1790be4b1cea243c3dac989ad1b05c" title="networkstatus_get_param" alt="" coords="927,64,1099,91"/>
<area shape="rect" id="node9" href="rephist_8c.html#ae234f5b5dcf88ea65ef20ff5c3512327" title="any_predicted_circuits" alt="" coords="721,123,873,149"/>
<area shape="rect" id="node10" href="router_8c.html#a8b917b11fb2945b314286a6a567e34c3" title="check_whether_orport\l_reachable" alt="" coords="722,174,873,215"/>
<area shape="rect" id="node11" href="circuituse_8c.html#ac6c1a2c715351d85ef6747ca1a4db958" title="circuit_enough_testing\l_circs" alt="" coords="721,239,873,281"/>
<area shape="rect" id="node12" href="router_8c.html#a98317a030cb30700f60c8444d676087b" title="check_whether_dirport\l_reachable" alt="" coords="721,305,874,346"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_aad7f413d899b72e58bed8efc0162d8bd_icgraph.png" border="0" usemap="#microdesc_8h_aad7f413d899b72e58bed8efc0162d8bd_icgraph" alt=""/></div>
<map name="microdesc_8h_aad7f413d899b72e58bed8efc0162d8bd_icgraph" id="microdesc_8h_aad7f413d899b72e58bed8efc0162d8bd_icgraph">
<area shape="rect" id="node2" href="routerlist_8h.html#afe7f2c6bcc3135272bc6aa66ec09cd76" title="update_all_descriptor\l_downloads" alt="" coords="251,5,396,47"/>
<area shape="rect" id="node3" href="main_8h.html#ac64189cc036980dc5785f76d85db9fa6" title="directory_info_has\l_arrived" alt="" coords="444,5,572,47"/>
</map>
</div>

</div>
</div>
<a id="ad388d518c6750dce831b4d375e0efe5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad388d518c6750dce831b4d375e0efe5c">&#9670;&nbsp;</a></span>update_microdescs_from_networkstatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_microdescs_from_networkstatus </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For every microdescriptor listed in the current microdecriptor consensus, update its last_listed field to be at least as recent as the publication time of the current microdescriptor consensus. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_ad388d518c6750dce831b4d375e0efe5c_cgraph.png" border="0" usemap="#microdesc_8h_ad388d518c6750dce831b4d375e0efe5c_cgraph" alt=""/></div>
<map name="microdesc_8h_ad388d518c6750dce831b4d375e0efe5c_cgraph" id="microdesc_8h_ad388d518c6750dce831b4d375e0efe5c_cgraph">
<area shape="rect" id="node2" href="microdesc_8c.html#aa39bb77fb19ca888eb8d2bedac93c75d" title="get_microdesc_cache" alt="" coords="246,5,395,32"/>
<area shape="rect" id="node3" href="networkstatus_8c.html#a44accdf47b7f9f40b25c45daf2c31475" title="networkstatus_get_reasonably\l_live_consensus" alt="" coords="221,57,420,98"/>
</map>
</div>

</div>
</div>
<a id="ad9c983a76a2f31a6a843f4df9be7de1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9c983a76a2f31a6a843f4df9be7de1d">&#9670;&nbsp;</a></span>we_fetch_microdescriptors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int we_fetch_microdescriptors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff we should try to download microdescriptors at all. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_ad9c983a76a2f31a6a843f4df9be7de1d_cgraph.png" border="0" usemap="#microdesc_8h_ad9c983a76a2f31a6a843f4df9be7de1d_cgraph" alt=""/></div>
<map name="microdesc_8h_ad9c983a76a2f31a6a843f4df9be7de1d_cgraph" id="microdesc_8h_ad9c983a76a2f31a6a843f4df9be7de1d_cgraph">
<area shape="rect" id="node2" href="dirserv_8c.html#a57e2ff1ad2ea65abe9b969ad3d76a418" title="directory_caches_dir_info" alt="" coords="232,64,403,91"/>
<area shape="rect" id="node6" href="microdesc_8c.html#adeff3a88aa40b67ab6407bda5c941910" title="we_use_microdescriptors\l_for_circuits" alt="" coords="232,118,403,159"/>
<area shape="rect" id="node3" href="router_8c.html#ab23297b12b098da9eac98126a587aa3b" title="dir_server_mode" alt="" coords="473,5,591,32"/>
<area shape="rect" id="node4" href="router_8c.html#afa75de94186fffc8f373de610ae4cab3" title="should_refuse_unknown\l_exits" alt="" coords="451,57,613,98"/>
<area shape="rect" id="node5" href="networkstatus_8c.html#aba1790be4b1cea243c3dac989ad1b05c" title="networkstatus_get_param" alt="" coords="661,64,833,91"/>
<area shape="rect" id="node7" href="entrynodes_8c.html#aec3f497d942ccb88742194e3fe973a49" title="any_bridge_supports\l_microdescriptors" alt="" coords="461,122,603,163"/>
</map>
</div>

</div>
</div>
<a id="a2667d23ef05f514b5bf916791b4a6bbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2667d23ef05f514b5bf916791b4a6bbd">&#9670;&nbsp;</a></span>we_fetch_router_descriptors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int we_fetch_router_descriptors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff we should try to download router descriptors at all. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_a2667d23ef05f514b5bf916791b4a6bbd_cgraph.png" border="0" usemap="#microdesc_8h_a2667d23ef05f514b5bf916791b4a6bbd_cgraph" alt=""/></div>
<map name="microdesc_8h_a2667d23ef05f514b5bf916791b4a6bbd_cgraph" id="microdesc_8h_a2667d23ef05f514b5bf916791b4a6bbd_cgraph">
<area shape="rect" id="node2" href="dirserv_8c.html#a57e2ff1ad2ea65abe9b969ad3d76a418" title="directory_caches_dir_info" alt="" coords="240,64,411,91"/>
<area shape="rect" id="node6" href="microdesc_8c.html#adeff3a88aa40b67ab6407bda5c941910" title="we_use_microdescriptors\l_for_circuits" alt="" coords="240,118,411,159"/>
<area shape="rect" id="node3" href="router_8c.html#ab23297b12b098da9eac98126a587aa3b" title="dir_server_mode" alt="" coords="481,5,599,32"/>
<area shape="rect" id="node4" href="router_8c.html#afa75de94186fffc8f373de610ae4cab3" title="should_refuse_unknown\l_exits" alt="" coords="459,57,621,98"/>
<area shape="rect" id="node5" href="networkstatus_8c.html#aba1790be4b1cea243c3dac989ad1b05c" title="networkstatus_get_param" alt="" coords="669,64,841,91"/>
<area shape="rect" id="node7" href="entrynodes_8c.html#aec3f497d942ccb88742194e3fe973a49" title="any_bridge_supports\l_microdescriptors" alt="" coords="469,122,611,163"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_a2667d23ef05f514b5bf916791b4a6bbd_icgraph.png" border="0" usemap="#microdesc_8h_a2667d23ef05f514b5bf916791b4a6bbd_icgraph" alt=""/></div>
<map name="microdesc_8h_a2667d23ef05f514b5bf916791b4a6bbd_icgraph" id="microdesc_8h_a2667d23ef05f514b5bf916791b4a6bbd_icgraph">
<area shape="rect" id="node2" href="routerlist_8h.html#a8b67f737b9ea614297414b26eb3b784c" title="update_router_descriptor\l_downloads" alt="" coords="240,5,405,47"/>
<area shape="rect" id="node3" href="routerlist_8h.html#afe7f2c6bcc3135272bc6aa66ec09cd76" title="update_all_descriptor\l_downloads" alt="" coords="453,5,599,47"/>
<area shape="rect" id="node4" href="main_8h.html#ac64189cc036980dc5785f76d85db9fa6" title="directory_info_has\l_arrived" alt="" coords="647,5,775,47"/>
</map>
</div>

</div>
</div>
<a id="adeff3a88aa40b67ab6407bda5c941910"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeff3a88aa40b67ab6407bda5c941910">&#9670;&nbsp;</a></span>we_use_microdescriptors_for_circuits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int we_use_microdescriptors_for_circuits </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff we should prefer to use microdescriptors rather than routerdescs for building circuits. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_adeff3a88aa40b67ab6407bda5c941910_cgraph.png" border="0" usemap="#microdesc_8h_adeff3a88aa40b67ab6407bda5c941910_cgraph" alt=""/></div>
<map name="microdesc_8h_adeff3a88aa40b67ab6407bda5c941910_cgraph" id="microdesc_8h_adeff3a88aa40b67ab6407bda5c941910_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#aec3f497d942ccb88742194e3fe973a49" title="any_bridge_supports\l_microdescriptors" alt="" coords="224,5,367,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="microdesc_8h_adeff3a88aa40b67ab6407bda5c941910_icgraph.png" border="0" usemap="#microdesc_8h_adeff3a88aa40b67ab6407bda5c941910_icgraph" alt=""/></div>
<map name="microdesc_8h_adeff3a88aa40b67ab6407bda5c941910_icgraph" id="microdesc_8h_adeff3a88aa40b67ab6407bda5c941910_icgraph">
<area shape="rect" id="node2" href="microdesc_8h.html#ad9c983a76a2f31a6a843f4df9be7de1d" title="we_fetch_microdescriptors" alt="" coords="228,5,407,32"/>
<area shape="rect" id="node3" href="microdesc_8h.html#a2667d23ef05f514b5bf916791b4a6bbd" title="we_fetch_router_descriptors" alt="" coords="224,56,411,83"/>
<area shape="rect" id="node7" href="microdesc_8c.html#a01ac96e92e27b924141e47289fc633b2" title="MOCK_IMPL" alt="" coords="267,107,367,133"/>
<area shape="rect" id="node4" href="routerlist_8h.html#a8b67f737b9ea614297414b26eb3b784c" title="update_router_descriptor\l_downloads" alt="" coords="459,49,624,90"/>
<area shape="rect" id="node5" href="routerlist_8h.html#afe7f2c6bcc3135272bc6aa66ec09cd76" title="update_all_descriptor\l_downloads" alt="" coords="672,49,817,90"/>
<area shape="rect" id="node6" href="main_8h.html#ac64189cc036980dc5785f76d85db9fa6" title="directory_info_has\l_arrived" alt="" coords="865,49,993,90"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
