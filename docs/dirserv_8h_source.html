<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/dirserv.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">dirserv.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="dirserv_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* Copyright (c) 2001 Matej Pfajfar.</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2001-2004, Roger Dingledine.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (c) 2004-2006, Roger Dingledine, Nick Mathewson.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Copyright (c) 2007-2017, The Tor Project, Inc. */</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/* See LICENSE for licensing information */</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#ifndef TOR_DIRSERV_H</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#define TOR_DIRSERV_H</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;testsupport.h&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="dirserv_8h.html#a460bca98a2dc94ec6f28a6ec8b9d91a7">   20</a></span>&#160;<span class="preprocessor">#define REACHABILITY_MODULO_PER_TEST 128</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="dirserv_8h.html#aa826f853ba4b903aae3f16cbed80af92">   23</a></span>&#160;<span class="preprocessor">#define REACHABILITY_TEST_INTERVAL 10</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="dirserv_8h.html#a8b38eb1a359c1bf06d5715d5e4afadb1">   26</a></span>&#160;<span class="preprocessor">#define REACHABILITY_TEST_CYCLE_PERIOD \</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">  (REACHABILITY_TEST_INTERVAL*REACHABILITY_MODULO_PER_TEST)</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="dirserv_8h.html#a14d9fd5cb272eb723bd44ae2561cc8e0">   30</a></span>&#160;<span class="preprocessor">#define MAX_EXITPOLICY_SUMMARY_LEN 1000</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="dirserv_8h.html#a4a54c4e418a55ed8ad31091843e7f171">   33</a></span>&#160;<span class="preprocessor">#define MAX_V_LINE_LEN 128</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="dirserv_8h.html#aac355320fd3daf8319b7fb1839c976d3">   36</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="dirserv_8h.html#aac355320fd3daf8319b7fb1839c976d3">dir_spool_source_t</a> {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    DIR_SPOOL_SERVER_BY_DIGEST=1, DIR_SPOOL_SERVER_BY_FP,</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    DIR_SPOOL_EXTRA_BY_DIGEST, DIR_SPOOL_EXTRA_BY_FP,</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    DIR_SPOOL_MICRODESC,</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    DIR_SPOOL_NETWORKSTATUS,</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    DIR_SPOOL_CONSENSUS_CACHE_ENTRY,</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;} <a class="code" href="dirserv_8h.html#aac355320fd3daf8319b7fb1839c976d3">dir_spool_source_t</a>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#define dir_spool_source_bitfield_t ENUM_BF(dir_spool_source_t)</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structspooled__resource__t.html">   58</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structspooled__resource__t.html">spooled_resource_t</a> {</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="structspooled__resource__t.html#a6009a0f737b78ceac268bf70756280e9">   63</a></span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="structspooled__resource__t.html#a6009a0f737b78ceac268bf70756280e9">spool_eagerly</a> : 1;</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="structspooled__resource__t.html#a40909144cdc83d2352e3e4dbbe8820c1">   67</a></span>&#160;  dir_spool_source_bitfield_t <a class="code" href="structspooled__resource__t.html#a40909144cdc83d2352e3e4dbbe8820c1">spool_source</a> : 7;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="structspooled__resource__t.html#a762bd02d32a0df2b0afa4c497b7401d9">   71</a></span>&#160;  uint8_t <a class="code" href="structspooled__resource__t.html#a762bd02d32a0df2b0afa4c497b7401d9">digest</a>[<a class="code" href="crypto__digest_8h.html#a34e055abb21d9f47b5f3d821e4beb091">DIGEST256_LEN</a>];</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structspooled__resource__t.html#acd8a13b80cdd5dc57be42cad6d654e5e">   76</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structcached__dir__t.html">cached_dir_t</a> *<a class="code" href="structspooled__resource__t.html#acd8a13b80cdd5dc57be42cad6d654e5e">cached_dir_ref</a>;</div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structspooled__resource__t.html#a9295f1a09aed2cbf0535a7418fabcd9c">   81</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structconsensus__cache__entry__t.html">consensus_cache_entry_t</a> *<a class="code" href="structspooled__resource__t.html#a9295f1a09aed2cbf0535a7418fabcd9c">consensus_cache_entry</a>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keyword">const</span> uint8_t *cce_body;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">size_t</span> cce_len;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structspooled__resource__t.html#a8aed39a139d9b5dcba95ab946738f796">   87</a></span>&#160;  off_t <a class="code" href="structspooled__resource__t.html#a8aed39a139d9b5dcba95ab946738f796">cached_dir_offset</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;} <a class="code" href="dirserv_8h.html#abf27c2014f1f1b30b7da7194945055f8">spooled_resource_t</a>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#acb9b2ed7234ed40438a3a5406c823c36">connection_dirserv_flushed_some</a>(<a class="code" href="structdir__connection__t.html">dir_connection_t</a> *conn);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a95deb3d9d5367525bb51127b82269c87">dirserv_add_own_fingerprint</a>(<a class="code" href="structcrypto__pk__t.html">crypto_pk_t</a> *pk);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a258a245ff1505a9ea50b06de2b3e490f">dirserv_load_fingerprint_file</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#a952a2a3f8acd42cdebbae8631123cf1c">dirserv_free_fingerprint_list</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keyword">enum</span> <a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a> <a class="code" href="dirserv_8h.html#a917ddd9c8bf085d8742afdf78d2a578c">dirserv_add_multiple_descriptors</a>(</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">char</span> *desc, uint8_t purpose,</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">char</span> *source,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">char</span> **msg);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">enum</span> <a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a> <a class="code" href="dirserv_8h.html#a7a1e4335b7ab9518991addf3876fb0f0">dirserv_add_descriptor</a>(<a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *ri,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">char</span> **msg,</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">char</span> *source);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#ad1772dc2a4a12cc0eb181d1f52c5a54a">dirserv_set_router_is_running</a>(<a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *router, time_t now);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a6c7009f040e0a812c40a6ae0fa6efd79">list_server_status_v1</a>(<a class="code" href="structsmartlist__t.html">smartlist_t</a> *routers, <span class="keywordtype">char</span> **router_status_out,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                          <span class="keywordtype">int</span> for_controller);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="dirserv_8h.html#a5be126c4926e7257fa5fbe5463ff4a6a">dirserv_get_flag_thresholds_line</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keywordtype">void</span> dirserv_compute_bridge_flag_thresholds(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a0b84786e17352524036694baf1955167">directory_fetches_from_authorities</a>(<span class="keyword">const</span> <a class="code" href="structor__options__t.html">or_options_t</a> *options);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#ab38d643312052d4bfdb7d49dcba344a6">directory_fetches_dir_info_early</a>(<span class="keyword">const</span> <a class="code" href="structor__options__t.html">or_options_t</a> *options);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#ab6172633152c7a88c49556085a2538f6">directory_fetches_dir_info_later</a>(<span class="keyword">const</span> <a class="code" href="structor__options__t.html">or_options_t</a> *options);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a5a9cf7f465217dbc8142aaf11384abbf">directory_caches_unknown_auth_certs</a>(<span class="keyword">const</span> <a class="code" href="structor__options__t.html">or_options_t</a> *options);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a57e2ff1ad2ea65abe9b969ad3d76a418">directory_caches_dir_info</a>(<span class="keyword">const</span> <a class="code" href="structor__options__t.html">or_options_t</a> *options);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a7923860b3a8c27fa48c4dcec6ef6939f">directory_permits_begindir_requests</a>(<span class="keyword">const</span> <a class="code" href="structor__options__t.html">or_options_t</a> *options);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a2c5edbbd6883a33af3d72bfead4033db">directory_too_idle_to_fetch_descriptors</a>(<span class="keyword">const</span> <a class="code" href="structor__options__t.html">or_options_t</a> *options,</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                            time_t now);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<a class="code" href="structcached__dir__t.html">cached_dir_t</a> *<a class="code" href="dirserv_8h.html#a0f07c36cfc3121034f466d7cb6d27630">dirserv_get_consensus</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *flavor_name);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#a4ae8f9b0f02056a69bd8c92adda96579">dirserv_set_cached_consensus_networkstatus</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *consensus,</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">char</span> *flavor_name,</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="structcommon__digests__t.html">common_digests_t</a> *digests,</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                              <span class="keyword">const</span> uint8_t *sha3_as_signed,</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                              time_t published);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keywordtype">void</span> dirserv_clear_old_networkstatuses(time_t cutoff);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a2e2cb1b422b5391b4b128813aac0971c">dirserv_get_routerdesc_spool</a>(<a class="code" href="structsmartlist__t.html">smartlist_t</a> *spools_out, <span class="keyword">const</span> <span class="keywordtype">char</span> *key,</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                 <a class="code" href="dirserv_8h.html#aac355320fd3daf8319b7fb1839c976d3">dir_spool_source_t</a> source,</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                 <span class="keywordtype">int</span> conn_is_encrypted,</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">char</span> **msg_out);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a8fca5a38cd000d8ccabe5bc73e296bb2">dirserv_get_routerdescs</a>(<a class="code" href="structsmartlist__t.html">smartlist_t</a> *descs_out, <span class="keyword">const</span> <span class="keywordtype">char</span> *key,</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">char</span> **msg);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#a2b981b610d4a3344b17a55300072ef66">dirserv_orconn_tls_done</a>(<span class="keyword">const</span> <a class="code" href="structtor__addr__t.html">tor_addr_t</a> *addr,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                             uint16_t or_port,</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">char</span> *digest_rcvd,</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                             <span class="keyword">const</span> <a class="code" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *ed_id_rcvd);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a0c97fbc43a4398a45feb2fafa3d42fc1">dirserv_should_launch_reachability_test</a>(<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *ri,</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *ri_old);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#a87235a887afe2a5f796bd9a88b474909">dirserv_single_reachability_test</a>(time_t now, <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *router);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#aac91a65fca7d877c033a594a96203ad7">dirserv_test_reachability</a>(time_t now);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#adaceacf408562b95dd1169799995bd6c">authdir_wants_to_reject_router</a>(<a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *ri, <span class="keyword">const</span> <span class="keywordtype">char</span> **msg,</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                   <span class="keywordtype">int</span> complain,</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                   <span class="keywordtype">int</span> *valid_out);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;uint32_t <a class="code" href="dirserv_8h.html#a95906070553304c94a590affb671223e">dirserv_router_get_status</a>(<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *router,</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">char</span> **msg,</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                   <span class="keywordtype">int</span> severity);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#a5f2508c28e6b8a1d7b9ae921598a9860">dirserv_set_node_flags_from_authoritative_status</a>(<a class="code" href="structnode__t.html">node_t</a> *node,</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                                      uint32_t authstatus);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#abbb851f560879781b07f4b99762f45b3">dirserv_would_reject_router</a>(<span class="keyword">const</span> <a class="code" href="structrouterstatus__t.html">routerstatus_t</a> *rs);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="dirserv_8h.html#a462a8ae7270a4bea92c8d6269e7489db">routerstatus_format_entry</a>(</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                              <span class="keyword">const</span> <a class="code" href="structrouterstatus__t.html">routerstatus_t</a> *rs,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span> *version,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span> *protocols,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                              <a class="code" href="or_8h.html#a46368555a0446803c7acfd3b8230adef">routerstatus_format_type_t</a> format,</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                              <span class="keywordtype">int</span> consensus_method,</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                              <span class="keyword">const</span> <a class="code" href="structvote__routerstatus__t.html">vote_routerstatus_t</a> *vrs);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#aa86c752d8d8f446eba40db2d0c2269a7">dirserv_free_all</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#a079db5d58a49010fe8b2944ecb3189bd">cached_dir_decref</a>(<a class="code" href="structcached__dir__t.html">cached_dir_t</a> *<a class="code" href="namespaced.html">d</a>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<a class="code" href="structcached__dir__t.html">cached_dir_t</a> *<a class="code" href="dirserv_8h.html#a1f9b702470f577e3b47d852f664e7d2b">new_cached_dir</a>(<span class="keywordtype">char</span> *s, time_t published);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#ae4f82bd716ec94f012312bf508728269">validate_recommended_package_line</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *line);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#ab83fe95748f2a7626fbb05f2ada5896e">dirserv_query_measured_bw_cache_kb</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *node_id,</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                       <span class="keywordtype">long</span> *bw_out,</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                       time_t *as_of_out);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#af70a376b32a1d064cb589d81fa2f64d3">dirserv_clear_measured_bw_cache</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#ab77a8f39d9154260c0c9ab4abcaa1a58">dirserv_has_measured_bw</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *node_id);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a2a58cd8f1b1e22a024a25ec69c3a64ac">dirserv_get_measured_bw_cache_size</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#a5bf5f153e699ad278fca9fb9371b2b0c">dirserv_count_measured_bws</a>(<span class="keyword">const</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *routers);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keywordtype">int</span> running_long_enough_to_decide_unreachable(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#a6254e57429acb014cb8026a0cd8cc087">dirserv_compute_performance_thresholds</a>(digestmap_t *omit_as_sybil);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#ifdef DIRSERV_PRIVATE</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;STATIC <span class="keywordtype">void</span> <a class="code" href="dirserv_8c.html#a1808f4f273d59d32f2e29b968165e251">dirserv_set_routerstatus_testing</a>(<a class="code" href="structrouterstatus__t.html">routerstatus_t</a> *rs);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">/* Put the MAX_MEASUREMENT_AGE #define here so unit tests can see it */</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#define MAX_MEASUREMENT_AGE (3*24*60*60) </span><span class="comment">/* 3 days */</span><span class="preprocessor"></span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;STATIC <span class="keywordtype">int</span> <a class="code" href="dirserv_8c.html#a4da6ee0ad98076b51a6009d1b4ea0833">measured_bw_line_parse</a>(measured_bw_line_t *out, <span class="keyword">const</span> <span class="keywordtype">char</span> *line);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;STATIC <span class="keywordtype">int</span> <a class="code" href="dirserv_8c.html#a9afa21451734581b626a94cb615375af">measured_bw_line_apply</a>(measured_bw_line_t *parsed_line,</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                           <a class="code" href="structsmartlist__t.html">smartlist_t</a> *routerstatuses);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;STATIC <span class="keywordtype">void</span> <a class="code" href="dirserv_8c.html#ac19029821b6c2868fd554e3b38e1ab59">dirserv_cache_measured_bw</a>(<span class="keyword">const</span> measured_bw_line_t *parsed_line,</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                               time_t as_of);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;STATIC <span class="keywordtype">void</span> <a class="code" href="dirserv_8c.html#ab797c233e08456a060af12f1f85bbe88">dirserv_expire_measured_bw_cache</a>(time_t now);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;STATIC <span class="keywordtype">int</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<a class="code" href="dirserv_8c.html#a321d38c3a8578f36a42cef18c507bc90">dirserv_read_guardfraction_file_from_str</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *guardfraction_file_str,</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                      <a class="code" href="structsmartlist__t.html">smartlist_t</a> *vote_routerstatuses);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* defined(DIRSERV_PRIVATE) */</span><span class="preprocessor"></span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#af364b236821a07880cc8dc54e98ca999">dirserv_read_measured_bandwidths</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *from_file,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                     <a class="code" href="structsmartlist__t.html">smartlist_t</a> *routerstatuses);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordtype">int</span> <a class="code" href="dirserv_8h.html#a50e06fc916d8cbcc3ccfb7f919cb6928">dirserv_read_guardfraction_file</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structconsensus__cache__entry__t.html#ae96bbe3347b319ee7bdbd1f2e2ba9f5b">fname</a>,</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                 <a class="code" href="structsmartlist__t.html">smartlist_t</a> *vote_routerstatuses);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<a class="code" href="structspooled__resource__t.html">spooled_resource_t</a> *spooled_resource_new(<a class="code" href="dirserv_8h.html#aac355320fd3daf8319b7fb1839c976d3">dir_spool_source_t</a> source,</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                         <span class="keyword">const</span> uint8_t *<a class="code" href="structspooled__resource__t.html#a762bd02d32a0df2b0afa4c497b7401d9">digest</a>,</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                         <span class="keywordtype">size_t</span> digestlen);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<a class="code" href="structspooled__resource__t.html">spooled_resource_t</a> *<a class="code" href="dirserv_8h.html#a78f90a90dabba118a3beb3130c9c66c7">spooled_resource_new_from_cache_entry</a>(</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                      <span class="keyword">struct</span> <a class="code" href="structconsensus__cache__entry__t.html">consensus_cache_entry_t</a> *entry);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#a63449de198177a1fbd1f1365bab914a2">spooled_resource_free_</a>(<a class="code" href="structspooled__resource__t.html">spooled_resource_t</a> *spooled);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#define spooled_resource_free(sp) \</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">  FREE_AND_NULL(spooled_resource_t, spooled_resource_free_, (sp))</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#a37b7370c96e2e908512aea4ea2b3f458">dirserv_spool_remove_missing_and_guess_size</a>(<a class="code" href="structdir__connection__t.html">dir_connection_t</a> *conn,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                                 time_t cutoff,</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                                 <span class="keywordtype">int</span> compression,</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                                 <span class="keywordtype">size_t</span> *size_out,</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                                 <span class="keywordtype">int</span> *n_expired_out);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#a126be24e35ded1467ae68c81afee15bf">dirserv_spool_sort</a>(<a class="code" href="structdir__connection__t.html">dir_connection_t</a> *conn);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordtype">void</span> <a class="code" href="dirserv_8h.html#a8ff1a515883ea205753feb2f410cbea6">dir_conn_clear_spool</a>(<a class="code" href="structdir__connection__t.html">dir_connection_t</a> *conn);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !defined(TOR_DIRSERV_H) */</span><span class="preprocessor"></span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="ttc" id="structspooled__resource__t_html_a40909144cdc83d2352e3e4dbbe8820c1"><div class="ttname"><a href="structspooled__resource__t.html#a40909144cdc83d2352e3e4dbbe8820c1">spooled_resource_t::spool_source</a></div><div class="ttdeci">dir_spool_source_bitfield_t spool_source</div><div class="ttdef"><b>Definition:</b> dirserv.h:67</div></div>
<div class="ttc" id="dirserv_8h_html_ad1772dc2a4a12cc0eb181d1f52c5a54a"><div class="ttname"><a href="dirserv_8h.html#ad1772dc2a4a12cc0eb181d1f52c5a54a">dirserv_set_router_is_running</a></div><div class="ttdeci">void dirserv_set_router_is_running(routerinfo_t *router, time_t now)</div><div class="ttdef"><b>Definition:</b> dirserv.c:946</div></div>
<div class="ttc" id="dirserv_8h_html_a5bf5f153e699ad278fca9fb9371b2b0c"><div class="ttname"><a href="dirserv_8h.html#a5bf5f153e699ad278fca9fb9371b2b0c">dirserv_count_measured_bws</a></div><div class="ttdeci">void dirserv_count_measured_bws(const smartlist_t *routers)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1453</div></div>
<div class="ttc" id="dirserv_8h_html_a2e2cb1b422b5391b4b128813aac0971c"><div class="ttname"><a href="dirserv_8h.html#a2e2cb1b422b5391b4b128813aac0971c">dirserv_get_routerdesc_spool</a></div><div class="ttdeci">int dirserv_get_routerdesc_spool(smartlist_t *spools_out, const char *key, dir_spool_source_t source, int conn_is_encrypted, const char **msg_out)</div><div class="ttdef"><b>Definition:</b> dirserv.c:2655</div></div>
<div class="ttc" id="dirserv_8h_html_ae4f82bd716ec94f012312bf508728269"><div class="ttname"><a href="dirserv_8h.html#ae4f82bd716ec94f012312bf508728269">validate_recommended_package_line</a></div><div class="ttdeci">int validate_recommended_package_line(const char *line)</div><div class="ttdef"><b>Definition:</b> dirserv.c:3494</div></div>
<div class="ttc" id="dirserv_8h_html_a6254e57429acb014cb8026a0cd8cc087"><div class="ttname"><a href="dirserv_8h.html#a6254e57429acb014cb8026a0cd8cc087">dirserv_compute_performance_thresholds</a></div><div class="ttdeci">void dirserv_compute_performance_thresholds(digestmap_t *omit_as_sybil)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1475</div></div>
<div class="ttc" id="dirserv_8h_html_a50e06fc916d8cbcc3ccfb7f919cb6928"><div class="ttname"><a href="dirserv_8h.html#a50e06fc916d8cbcc3ccfb7f919cb6928">dirserv_read_guardfraction_file</a></div><div class="ttdeci">int dirserv_read_guardfraction_file(const char *fname, smartlist_t *vote_routerstatuses)</div><div class="ttdef"><b>Definition:</b> dirserv.c:2433</div></div>
<div class="ttc" id="dirserv_8h_html_a079db5d58a49010fe8b2944ecb3189bd"><div class="ttname"><a href="dirserv_8h.html#a079db5d58a49010fe8b2944ecb3189bd">cached_dir_decref</a></div><div class="ttdeci">void cached_dir_decref(cached_dir_t *d)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1208</div></div>
<div class="ttc" id="structor__options__t_html"><div class="ttname"><a href="structor__options__t.html">or_options_t</a></div><div class="ttdef"><b>Definition:</b> or.h:3657</div></div>
<div class="ttc" id="dirserv_8c_html_a1808f4f273d59d32f2e29b968165e251"><div class="ttname"><a href="dirserv_8c.html#a1808f4f273d59d32f2e29b968165e251">dirserv_set_routerstatus_testing</a></div><div class="ttdeci">STATIC void dirserv_set_routerstatus_testing(routerstatus_t *rs)</div><div class="ttdef"><b>Definition:</b> dirserv.c:2107</div></div>
<div class="ttc" id="dirserv_8h_html_a2a58cd8f1b1e22a024a25ec69c3a64ac"><div class="ttname"><a href="dirserv_8h.html#a2a58cd8f1b1e22a024a25ec69c3a64ac">dirserv_get_measured_bw_cache_size</a></div><div class="ttdeci">int dirserv_get_measured_bw_cache_size(void)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1769</div></div>
<div class="ttc" id="or_8h_html_a7c96814e647f1b5b99e501ea5763842f"><div class="ttname"><a href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a></div><div class="ttdeci">was_router_added_t</div><div class="ttdef"><b>Definition:</b> or.h:5481</div></div>
<div class="ttc" id="dirserv_8h_html_a2c5edbbd6883a33af3d72bfead4033db"><div class="ttname"><a href="dirserv_8h.html#a2c5edbbd6883a33af3d72bfead4033db">directory_too_idle_to_fetch_descriptors</a></div><div class="ttdeci">int directory_too_idle_to_fetch_descriptors(const or_options_t *options, time_t now)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1191</div></div>
<div class="ttc" id="dirserv_8h_html_ab38d643312052d4bfdb7d49dcba344a6"><div class="ttname"><a href="dirserv_8h.html#ab38d643312052d4bfdb7d49dcba344a6">directory_fetches_dir_info_early</a></div><div class="ttdeci">int directory_fetches_dir_info_early(const or_options_t *options)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1127</div></div>
<div class="ttc" id="structconsensus__cache__entry__t_html_ae96bbe3347b319ee7bdbd1f2e2ba9f5b"><div class="ttname"><a href="structconsensus__cache__entry__t.html#ae96bbe3347b319ee7bdbd1f2e2ba9f5b">consensus_cache_entry_t::fname</a></div><div class="ttdeci">char * fname</div><div class="ttdef"><b>Definition:</b> conscache.c:35</div></div>
<div class="ttc" id="dirserv_8h_html_abf27c2014f1f1b30b7da7194945055f8"><div class="ttname"><a href="dirserv_8h.html#abf27c2014f1f1b30b7da7194945055f8">spooled_resource_t</a></div><div class="ttdeci">struct spooled_resource_t spooled_resource_t</div></div>
<div class="ttc" id="structnode__t_html"><div class="ttname"><a href="structnode__t.html">node_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2504</div></div>
<div class="ttc" id="dirserv_8h_html_acb9b2ed7234ed40438a3a5406c823c36"><div class="ttname"><a href="dirserv_8h.html#acb9b2ed7234ed40438a3a5406c823c36">connection_dirserv_flushed_some</a></div><div class="ttdeci">int connection_dirserv_flushed_some(dir_connection_t *conn)</div><div class="ttdef"><b>Definition:</b> dirserv.c:3417</div></div>
<div class="ttc" id="or_8h_html_a46368555a0446803c7acfd3b8230adef"><div class="ttname"><a href="or_8h.html#a46368555a0446803c7acfd3b8230adef">routerstatus_format_type_t</a></div><div class="ttdeci">routerstatus_format_type_t</div><div class="ttdef"><b>Definition:</b> or.h:5099</div></div>
<div class="ttc" id="structcommon__digests__t_html"><div class="ttname"><a href="structcommon__digests__t.html">common_digests_t</a></div><div class="ttdef"><b>Definition:</b> crypto_digest.h:74</div></div>
<div class="ttc" id="dirserv_8h_html_a63449de198177a1fbd1f1365bab914a2"><div class="ttname"><a href="dirserv_8h.html#a63449de198177a1fbd1f1365bab914a2">spooled_resource_free_</a></div><div class="ttdeci">void spooled_resource_free_(spooled_resource_t *spooled)</div><div class="ttdef"><b>Definition:</b> dirserv.c:3035</div></div>
<div class="ttc" id="structspooled__resource__t_html"><div class="ttname"><a href="structspooled__resource__t.html">spooled_resource_t</a></div><div class="ttdef"><b>Definition:</b> dirserv.h:58</div></div>
<div class="ttc" id="structed25519__public__key__t_html"><div class="ttname"><a href="structed25519__public__key__t.html">ed25519_public_key_t</a></div><div class="ttdef"><b>Definition:</b> crypto_ed25519.h:23</div></div>
<div class="ttc" id="dirserv_8h_html_a0b84786e17352524036694baf1955167"><div class="ttname"><a href="dirserv_8h.html#a0b84786e17352524036694baf1955167">directory_fetches_from_authorities</a></div><div class="ttdeci">int directory_fetches_from_authorities(const or_options_t *options)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1099</div></div>
<div class="ttc" id="dirserv_8h_html_a7a1e4335b7ab9518991addf3876fb0f0"><div class="ttname"><a href="dirserv_8h.html#a7a1e4335b7ab9518991addf3876fb0f0">dirserv_add_descriptor</a></div><div class="ttdeci">enum was_router_added_t dirserv_add_descriptor(routerinfo_t *ri, const char **msg, const char *source)</div><div class="ttdef"><b>Definition:</b> dirserv.c:664</div></div>
<div class="ttc" id="structtor__addr__t_html"><div class="ttname"><a href="structtor__addr__t.html">tor_addr_t</a></div><div class="ttdef"><b>Definition:</b> address.h:56</div></div>
<div class="ttc" id="dirserv_8h_html_a5a9cf7f465217dbc8142aaf11384abbf"><div class="ttname"><a href="dirserv_8h.html#a5a9cf7f465217dbc8142aaf11384abbf">directory_caches_unknown_auth_certs</a></div><div class="ttdeci">int directory_caches_unknown_auth_certs(const or_options_t *options)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1150</div></div>
<div class="ttc" id="dirserv_8c_html_ab797c233e08456a060af12f1f85bbe88"><div class="ttname"><a href="dirserv_8c.html#ab797c233e08456a060af12f1f85bbe88">dirserv_expire_measured_bw_cache</a></div><div class="ttdeci">STATIC void dirserv_expire_measured_bw_cache(time_t now)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1717</div></div>
<div class="ttc" id="dirserv_8h_html_a952a2a3f8acd42cdebbae8631123cf1c"><div class="ttname"><a href="dirserv_8h.html#a952a2a3f8acd42cdebbae8631123cf1c">dirserv_free_fingerprint_list</a></div><div class="ttdeci">void dirserv_free_fingerprint_list(void)</div><div class="ttdef"><b>Definition:</b> dirserv.c:460</div></div>
<div class="ttc" id="dirserv_8h_html_a5be126c4926e7257fa5fbe5463ff4a6a"><div class="ttname"><a href="dirserv_8h.html#a5be126c4926e7257fa5fbe5463ff4a6a">dirserv_get_flag_thresholds_line</a></div><div class="ttdeci">char * dirserv_get_flag_thresholds_line(void)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1809</div></div>
<div class="ttc" id="dirserv_8h_html_a57e2ff1ad2ea65abe9b969ad3d76a418"><div class="ttname"><a href="dirserv_8h.html#a57e2ff1ad2ea65abe9b969ad3d76a418">directory_caches_dir_info</a></div><div class="ttdeci">int directory_caches_dir_info(const or_options_t *options)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1165</div></div>
<div class="ttc" id="dirserv_8h_html_a0c97fbc43a4398a45feb2fafa3d42fc1"><div class="ttname"><a href="dirserv_8h.html#a0c97fbc43a4398a45feb2fafa3d42fc1">dirserv_should_launch_reachability_test</a></div><div class="ttdeci">int dirserv_should_launch_reachability_test(const routerinfo_t *ri, const routerinfo_t *ri_old)</div><div class="ttdef"><b>Definition:</b> dirserv.c:2866</div></div>
<div class="ttc" id="dirserv_8h_html_a4ae8f9b0f02056a69bd8c92adda96579"><div class="ttname"><a href="dirserv_8h.html#a4ae8f9b0f02056a69bd8c92adda96579">dirserv_set_cached_consensus_networkstatus</a></div><div class="ttdeci">void dirserv_set_cached_consensus_networkstatus(const char *consensus, const char *flavor_name, const common_digests_t *digests, const uint8_t *sha3_as_signed, time_t published)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1258</div></div>
<div class="ttc" id="dirserv_8h_html_a1f9b702470f577e3b47d852f664e7d2b"><div class="ttname"><a href="dirserv_8h.html#a1f9b702470f577e3b47d852f664e7d2b">new_cached_dir</a></div><div class="ttdeci">cached_dir_t * new_cached_dir(char *s, time_t published)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1219</div></div>
<div class="ttc" id="dirserv_8c_html_a9afa21451734581b626a94cb615375af"><div class="ttname"><a href="dirserv_8c.html#a9afa21451734581b626a94cb615375af">measured_bw_line_apply</a></div><div class="ttdeci">STATIC int measured_bw_line_apply(measured_bw_line_t *parsed_line, smartlist_t *routerstatuses)</div><div class="ttdef"><b>Definition:</b> dirserv.c:2549</div></div>
<div class="ttc" id="structconsensus__cache__entry__t_html"><div class="ttname"><a href="structconsensus__cache__entry__t.html">consensus_cache_entry_t</a></div><div class="ttdef"><b>Definition:</b> conscache.c:26</div></div>
<div class="ttc" id="structsmartlist__t_html"><div class="ttname"><a href="structsmartlist__t.html">smartlist_t</a></div><div class="ttdef"><b>Definition:</b> container.h:18</div></div>
<div class="ttc" id="dirserv_8h_html_adaceacf408562b95dd1169799995bd6c"><div class="ttname"><a href="dirserv_8h.html#adaceacf408562b95dd1169799995bd6c">authdir_wants_to_reject_router</a></div><div class="ttdeci">int authdir_wants_to_reject_router(routerinfo_t *ri, const char **msg, int complain, int *valid_out)</div><div class="ttdef"><b>Definition:</b> dirserv.c:502</div></div>
<div class="ttc" id="namespaced_html"><div class="ttname"><a href="namespaced.html">d</a></div><div class="ttdef"><b>Definition:</b> d.py:1</div></div>
<div class="ttc" id="dirserv_8h_html_ab77a8f39d9154260c0c9ab4abcaa1a58"><div class="ttname"><a href="dirserv_8h.html#ab77a8f39d9154260c0c9ab4abcaa1a58">dirserv_has_measured_bw</a></div><div class="ttdeci">int dirserv_has_measured_bw(const char *node_id)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1762</div></div>
<div class="ttc" id="structspooled__resource__t_html_a6009a0f737b78ceac268bf70756280e9"><div class="ttname"><a href="structspooled__resource__t.html#a6009a0f737b78ceac268bf70756280e9">spooled_resource_t::spool_eagerly</a></div><div class="ttdeci">unsigned spool_eagerly</div><div class="ttdef"><b>Definition:</b> dirserv.h:63</div></div>
<div class="ttc" id="dirserv_8h_html_a8fca5a38cd000d8ccabe5bc73e296bb2"><div class="ttname"><a href="dirserv_8h.html#a8fca5a38cd000d8ccabe5bc73e296bb2">dirserv_get_routerdescs</a></div><div class="ttdeci">int dirserv_get_routerdescs(smartlist_t *descs_out, const char *key, const char **msg)</div><div class="ttdef"><b>Definition:</b> dirserv.c:2734</div></div>
<div class="ttc" id="dirserv_8h_html_a462a8ae7270a4bea92c8d6269e7489db"><div class="ttname"><a href="dirserv_8h.html#a462a8ae7270a4bea92c8d6269e7489db">routerstatus_format_entry</a></div><div class="ttdeci">char * routerstatus_format_entry(const routerstatus_t *rs, const char *version, const char *protocols, routerstatus_format_type_t format, int consensus_method, const vote_routerstatus_t *vrs)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1856</div></div>
<div class="ttc" id="dirserv_8c_html_a321d38c3a8578f36a42cef18c507bc90"><div class="ttname"><a href="dirserv_8c.html#a321d38c3a8578f36a42cef18c507bc90">dirserv_read_guardfraction_file_from_str</a></div><div class="ttdeci">STATIC int dirserv_read_guardfraction_file_from_str(const char *guardfraction_file_str, smartlist_t *vote_routerstatuses)</div><div class="ttdef"><b>Definition:</b> dirserv.c:2318</div></div>
<div class="ttc" id="dirserv_8h_html_a2b981b610d4a3344b17a55300072ef66"><div class="ttname"><a href="dirserv_8h.html#a2b981b610d4a3344b17a55300072ef66">dirserv_orconn_tls_done</a></div><div class="ttdeci">void dirserv_orconn_tls_done(const tor_addr_t *addr, uint16_t or_port, const char *digest_rcvd, const ed25519_public_key_t *ed_id_rcvd)</div><div class="ttdef"><b>Definition:</b> dirserv.c:2803</div></div>
<div class="ttc" id="structspooled__resource__t_html_a8aed39a139d9b5dcba95ab946738f796"><div class="ttname"><a href="structspooled__resource__t.html#a8aed39a139d9b5dcba95ab946738f796">spooled_resource_t::cached_dir_offset</a></div><div class="ttdeci">off_t cached_dir_offset</div><div class="ttdef"><b>Definition:</b> dirserv.h:87</div></div>
<div class="ttc" id="structspooled__resource__t_html_a762bd02d32a0df2b0afa4c497b7401d9"><div class="ttname"><a href="structspooled__resource__t.html#a762bd02d32a0df2b0afa4c497b7401d9">spooled_resource_t::digest</a></div><div class="ttdeci">uint8_t digest[DIGEST256_LEN]</div><div class="ttdef"><b>Definition:</b> dirserv.h:71</div></div>
<div class="ttc" id="dirserv_8h_html_ab6172633152c7a88c49556085a2538f6"><div class="ttname"><a href="dirserv_8h.html#ab6172633152c7a88c49556085a2538f6">directory_fetches_dir_info_later</a></div><div class="ttdeci">int directory_fetches_dir_info_later(const or_options_t *options)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1139</div></div>
<div class="ttc" id="dirserv_8h_html_a87235a887afe2a5f796bd9a88b474909"><div class="ttname"><a href="dirserv_8h.html#a87235a887afe2a5f796bd9a88b474909">dirserv_single_reachability_test</a></div><div class="ttdeci">void dirserv_single_reachability_test(time_t now, routerinfo_t *router)</div><div class="ttdef"><b>Definition:</b> dirserv.c:2891</div></div>
<div class="ttc" id="dirserv_8h_html_a95906070553304c94a590affb671223e"><div class="ttname"><a href="dirserv_8h.html#a95906070553304c94a590affb671223e">dirserv_router_get_status</a></div><div class="ttdeci">uint32_t dirserv_router_get_status(const routerinfo_t *router, const char **msg, int severity)</div><div class="ttdef"><b>Definition:</b> dirserv.c:276</div></div>
<div class="ttc" id="dirserv_8h_html_aac355320fd3daf8319b7fb1839c976d3"><div class="ttname"><a href="dirserv_8h.html#aac355320fd3daf8319b7fb1839c976d3">dir_spool_source_t</a></div><div class="ttdeci">dir_spool_source_t</div><div class="ttdef"><b>Definition:</b> dirserv.h:36</div></div>
<div class="ttc" id="dirserv_8h_html_abbb851f560879781b07f4b99762f45b3"><div class="ttname"><a href="dirserv_8h.html#abbb851f560879781b07f4b99762f45b3">dirserv_would_reject_router</a></div><div class="ttdeci">int dirserv_would_reject_router(const routerstatus_t *rs)</div><div class="ttdef"><b>Definition:</b> dirserv.c:352</div></div>
<div class="ttc" id="structspooled__resource__t_html_acd8a13b80cdd5dc57be42cad6d654e5e"><div class="ttname"><a href="structspooled__resource__t.html#acd8a13b80cdd5dc57be42cad6d654e5e">spooled_resource_t::cached_dir_ref</a></div><div class="ttdeci">struct cached_dir_t * cached_dir_ref</div><div class="ttdef"><b>Definition:</b> dirserv.h:76</div></div>
<div class="ttc" id="crypto__digest_8h_html_a34e055abb21d9f47b5f3d821e4beb091"><div class="ttname"><a href="crypto__digest_8h.html#a34e055abb21d9f47b5f3d821e4beb091">DIGEST256_LEN</a></div><div class="ttdeci">#define DIGEST256_LEN</div><div class="ttdef"><b>Definition:</b> crypto_digest.h:25</div></div>
<div class="ttc" id="dirserv_8c_html_ac19029821b6c2868fd554e3b38e1ab59"><div class="ttname"><a href="dirserv_8c.html#ac19029821b6c2868fd554e3b38e1ab59">dirserv_cache_measured_bw</a></div><div class="ttdeci">STATIC void dirserv_cache_measured_bw(const measured_bw_line_t *parsed_line, time_t as_of)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1676</div></div>
<div class="ttc" id="structcached__dir__t_html"><div class="ttname"><a href="structcached__dir__t.html">cached_dir_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2018</div></div>
<div class="ttc" id="dirserv_8h_html_a7923860b3a8c27fa48c4dcec6ef6939f"><div class="ttname"><a href="dirserv_8h.html#a7923860b3a8c27fa48c4dcec6ef6939f">directory_permits_begindir_requests</a></div><div class="ttdeci">int directory_permits_begindir_requests(const or_options_t *options)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1181</div></div>
<div class="ttc" id="dirserv_8h_html_af364b236821a07880cc8dc54e98ca999"><div class="ttname"><a href="dirserv_8h.html#af364b236821a07880cc8dc54e98ca999">dirserv_read_measured_bandwidths</a></div><div class="ttdeci">int dirserv_read_measured_bandwidths(const char *from_file, smartlist_t *routerstatuses)</div><div class="ttdef"><b>Definition:</b> dirserv.c:2575</div></div>
<div class="ttc" id="dirserv_8h_html_a5f2508c28e6b8a1d7b9ae921598a9860"><div class="ttname"><a href="dirserv_8h.html#a5f2508c28e6b8a1d7b9ae921598a9860">dirserv_set_node_flags_from_authoritative_status</a></div><div class="ttdeci">void dirserv_set_node_flags_from_authoritative_status(node_t *node, uint32_t authstatus)</div><div class="ttdef"><b>Definition:</b> dirserv.c:555</div></div>
<div class="ttc" id="dirserv_8h_html_a126be24e35ded1467ae68c81afee15bf"><div class="ttname"><a href="dirserv_8h.html#a126be24e35ded1467ae68c81afee15bf">dirserv_spool_sort</a></div><div class="ttdeci">void dirserv_spool_sort(dir_connection_t *conn)</div><div class="ttdef"><b>Definition:</b> dirserv.c:3372</div></div>
<div class="ttc" id="dirserv_8h_html_aa86c752d8d8f446eba40db2d0c2269a7"><div class="ttname"><a href="dirserv_8h.html#aa86c752d8d8f446eba40db2d0c2269a7">dirserv_free_all</a></div><div class="ttdeci">void dirserv_free_all(void)</div><div class="ttdef"><b>Definition:</b> dirserv.c:3550</div></div>
<div class="ttc" id="structdir__connection__t_html"><div class="ttname"><a href="structdir__connection__t.html">dir_connection_t</a></div><div class="ttdef"><b>Definition:</b> or.h:1833</div></div>
<div class="ttc" id="dirserv_8h_html_a6c7009f040e0a812c40a6ae0fa6efd79"><div class="ttname"><a href="dirserv_8h.html#a6c7009f040e0a812c40a6ae0fa6efd79">list_server_status_v1</a></div><div class="ttdeci">int list_server_status_v1(smartlist_t *routers, char **router_status_out, int for_controller)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1015</div></div>
<div class="ttc" id="dirserv_8h_html_a258a245ff1505a9ea50b06de2b3e490f"><div class="ttname"><a href="dirserv_8h.html#a258a245ff1505a9ea50b06de2b3e490f">dirserv_load_fingerprint_file</a></div><div class="ttdeci">int dirserv_load_fingerprint_file(void)</div><div class="ttdef"><b>Definition:</b> dirserv.c:196</div></div>
<div class="ttc" id="structcrypto__pk__t_html"><div class="ttname"><a href="structcrypto__pk__t.html">crypto_pk_t</a></div><div class="ttdef"><b>Definition:</b> crypto_rsa.c:41</div></div>
<div class="ttc" id="dirserv_8h_html_a95deb3d9d5367525bb51127b82269c87"><div class="ttname"><a href="dirserv_8h.html#a95deb3d9d5367525bb51127b82269c87">dirserv_add_own_fingerprint</a></div><div class="ttdeci">int dirserv_add_own_fingerprint(crypto_pk_t *pk)</div><div class="ttdef"><b>Definition:</b> dirserv.c:177</div></div>
<div class="ttc" id="dirserv_8h_html_ab83fe95748f2a7626fbb05f2ada5896e"><div class="ttname"><a href="dirserv_8h.html#ab83fe95748f2a7626fbb05f2ada5896e">dirserv_query_measured_bw_cache_kb</a></div><div class="ttdeci">int dirserv_query_measured_bw_cache_kb(const char *node_id, long *bw_out, time_t *as_of_out)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1741</div></div>
<div class="ttc" id="dirserv_8c_html_a4da6ee0ad98076b51a6009d1b4ea0833"><div class="ttname"><a href="dirserv_8c.html#a4da6ee0ad98076b51a6009d1b4ea0833">measured_bw_line_parse</a></div><div class="ttdeci">STATIC int measured_bw_line_parse(measured_bw_line_t *out, const char *orig_line)</div><div class="ttdef"><b>Definition:</b> dirserv.c:2455</div></div>
<div class="ttc" id="structspooled__resource__t_html_a9295f1a09aed2cbf0535a7418fabcd9c"><div class="ttname"><a href="structspooled__resource__t.html#a9295f1a09aed2cbf0535a7418fabcd9c">spooled_resource_t::consensus_cache_entry</a></div><div class="ttdeci">struct consensus_cache_entry_t * consensus_cache_entry</div><div class="ttdef"><b>Definition:</b> dirserv.h:81</div></div>
<div class="ttc" id="dirserv_8h_html_af70a376b32a1d064cb589d81fa2f64d3"><div class="ttname"><a href="dirserv_8h.html#af70a376b32a1d064cb589d81fa2f64d3">dirserv_clear_measured_bw_cache</a></div><div class="ttdeci">void dirserv_clear_measured_bw_cache(void)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1706</div></div>
<div class="ttc" id="structrouterstatus__t_html"><div class="ttname"><a href="structrouterstatus__t.html">routerstatus_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2344</div></div>
<div class="ttc" id="dirserv_8h_html_a78f90a90dabba118a3beb3130c9c66c7"><div class="ttname"><a href="dirserv_8h.html#a78f90a90dabba118a3beb3130c9c66c7">spooled_resource_new_from_cache_entry</a></div><div class="ttdeci">spooled_resource_t * spooled_resource_new_from_cache_entry(struct consensus_cache_entry_t *entry)</div><div class="ttdef"><b>Definition:</b> dirserv.c:3014</div></div>
<div class="ttc" id="dirserv_8h_html_a8ff1a515883ea205753feb2f410cbea6"><div class="ttname"><a href="dirserv_8h.html#a8ff1a515883ea205753feb2f410cbea6">dir_conn_clear_spool</a></div><div class="ttdeci">void dir_conn_clear_spool(dir_connection_t *conn)</div><div class="ttdef"><b>Definition:</b> dirserv.c:3462</div></div>
<div class="ttc" id="dirserv_8h_html_a0f07c36cfc3121034f466d7cb6d27630"><div class="ttname"><a href="dirserv_8h.html#a0f07c36cfc3121034f466d7cb6d27630">dirserv_get_consensus</a></div><div class="ttdeci">cached_dir_t * dirserv_get_consensus(const char *flavor_name)</div><div class="ttdef"><b>Definition:</b> dirserv.c:1282</div></div>
<div class="ttc" id="dirserv_8h_html_a917ddd9c8bf085d8742afdf78d2a578c"><div class="ttname"><a href="dirserv_8h.html#a917ddd9c8bf085d8742afdf78d2a578c">dirserv_add_multiple_descriptors</a></div><div class="ttdeci">enum was_router_added_t dirserv_add_multiple_descriptors(const char *desc, uint8_t purpose, const char *source, const char **msg)</div><div class="ttdef"><b>Definition:</b> dirserv.c:572</div></div>
<div class="ttc" id="structvote__routerstatus__t_html"><div class="ttname"><a href="structvote__routerstatus__t.html">vote_routerstatus_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2590</div></div>
<div class="ttc" id="structrouterinfo__t_html"><div class="ttname"><a href="structrouterinfo__t.html">routerinfo_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2232</div></div>
<div class="ttc" id="dirserv_8h_html_a37b7370c96e2e908512aea4ea2b3f458"><div class="ttname"><a href="dirserv_8h.html#a37b7370c96e2e908512aea4ea2b3f458">dirserv_spool_remove_missing_and_guess_size</a></div><div class="ttdeci">void dirserv_spool_remove_missing_and_guess_size(dir_connection_t *conn, time_t cutoff, int compression, size_t *size_out, int *n_expired_out)</div><div class="ttdef"><b>Definition:</b> dirserv.c:3319</div></div>
<div class="ttc" id="dirserv_8h_html_aac91a65fca7d877c033a594a96203ad7"><div class="ttname"><a href="dirserv_8h.html#aac91a65fca7d877c033a594a96203ad7">dirserv_test_reachability</a></div><div class="ttdeci">void dirserv_test_reachability(time_t now)</div><div class="ttdef"><b>Definition:</b> dirserv.c:2944</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
