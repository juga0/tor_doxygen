<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/common/crypto_curve25519.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_b7e1585941a202f53e5249c42015d573.html">common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">crypto_curve25519.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Wrapper code for a curve25519 implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;orconfig.h&quot;</code><br />
<code>#include &quot;container.h&quot;</code><br />
<code>#include &quot;crypto_curve25519.h&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__digest_8h_source.html">crypto_digest.h</a>&quot;</code><br />
<code>#include &quot;crypto_format.h&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__rand_8h_source.html">crypto_rand.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__util_8h_source.html">crypto_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util_8h_source.html">util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="torlog_8h_source.html">torlog.h</a>&quot;</code><br />
<code>#include &quot;ed25519/donna/ed25519_donna_tor.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for crypto_curve25519.c:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2crypto__curve25519_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2crypto__curve25519_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2crypto__curve25519_8c">
<area shape="rect" id="node2" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="867,871,946,897"/>
<area shape="rect" id="node3" href="container_8h_source.html" title="container.h" alt="" coords="431,423,518,449"/>
<area shape="rect" id="node4" href="util_8h.html" title="Headers for util.c. " alt="" coords="915,497,965,524"/>
<area shape="rect" id="node18" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="738,266,881,293"/>
<area shape="rect" id="node19" href="crypto__digest_8h.html" title="Headers for crypto_digest.c. " alt="" coords="466,348,577,375"/>
<area shape="rect" id="node22" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="995,109,1109,136"/>
<area shape="rect" id="node24" href="crypto__rand_8h.html" title="Common functions for using (pseudo&#45;)random number generators. " alt="" coords="1241,423,1343,449"/>
<area shape="rect" id="node25" href="crypto__util_8h.html" title="Common functions for cryptographic routines. " alt="" coords="1384,184,1477,211"/>
<area shape="rect" id="node26" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="105,572,170,599"/>
<area shape="rect" id="node27" href="ed25519__donna__tor_8h_source.html" title="ed25519/donna/ed25519\l_donna_tor.h" alt="" coords="1468,259,1631,300"/>
<area shape="rect" id="node17" href="siphash_8h_source.html" title="siphash.h" alt="" coords="246,497,325,524"/>
<area shape="rect" id="node5" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="1171,796,1234,823"/>
<area shape="rect" id="node7" href="compat_8h_source.html" title="compat.h" alt="" coords="530,647,606,673"/>
<area shape="rect" id="node8" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="269,796,368,823"/>
<area shape="rect" id="node14" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="1018,721,1089,748"/>
<area shape="rect" id="node16" href="util__bug_8h.html" title="Macros to manage assertions, fatal and non&#45;fatal. " alt="" coords="398,572,477,599"/>
<area shape="rect" id="node10" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="637,796,745,823"/>
<area shape="rect" id="node13" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="678,721,805,748"/>
<area shape="rect" id="node20" href="crypto__openssl__mgt_8h_source.html" title="crypto_openssl_mgt.h" alt="" coords="709,423,859,449"/>
<area shape="rect" id="node23" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="939,184,1064,211"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5e7a8ab2c4c662058cadf28615d69518"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__curve25519_8c.html#a5e7a8ab2c4c662058cadf28615d69518">curve25519_impl</a> (uint8_t *output, const uint8_t *secret, const uint8_t *point)</td></tr>
<tr class="separator:a5e7a8ab2c4c662058cadf28615d69518"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af77c6aa2312f4e598306ffe516b8dfd1"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__curve25519_8c.html#af77c6aa2312f4e598306ffe516b8dfd1">curve25519_basepoint_impl</a> (uint8_t *output, const uint8_t *secret)</td></tr>
<tr class="separator:af77c6aa2312f4e598306ffe516b8dfd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9db0dc7b83fd68408e87e1a9bfd65b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__curve25519_8c.html#ae9db0dc7b83fd68408e87e1a9bfd65b3">curve25519_set_impl_params</a> (int use_ed)</td></tr>
<tr class="separator:ae9db0dc7b83fd68408e87e1a9bfd65b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b8a9c7799c40bf6db3f9d720118011c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__curve25519_8c.html#a8b8a9c7799c40bf6db3f9d720118011c">curve25519_public_key_is_ok</a> (const <a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> *key)</td></tr>
<tr class="separator:a8b8a9c7799c40bf6db3f9d720118011c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a41ce8071bcfcc3aef74d4e995e83d9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__curve25519_8c.html#a3a41ce8071bcfcc3aef74d4e995e83d9">curve25519_rand_seckey_bytes</a> (uint8_t *out, int extra_strong)</td></tr>
<tr class="separator:a3a41ce8071bcfcc3aef74d4e995e83d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33569d6170349126f87307f7a0c8c90e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__curve25519_8c.html#a33569d6170349126f87307f7a0c8c90e">curve25519_secret_key_generate</a> (<a class="el" href="structcurve25519__secret__key__t.html">curve25519_secret_key_t</a> *key_out, int extra_strong)</td></tr>
<tr class="separator:a33569d6170349126f87307f7a0c8c90e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68cbc7d4be1ea064154cbca18d51a53d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__curve25519_8c.html#a68cbc7d4be1ea064154cbca18d51a53d">curve25519_public_key_generate</a> (<a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> *key_out, const <a class="el" href="structcurve25519__secret__key__t.html">curve25519_secret_key_t</a> *seckey)</td></tr>
<tr class="separator:a68cbc7d4be1ea064154cbca18d51a53d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84cef627f00064e72f8a29196673abaf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__curve25519_8c.html#a84cef627f00064e72f8a29196673abaf">curve25519_keypair_generate</a> (<a class="el" href="structcurve25519__keypair__t.html">curve25519_keypair_t</a> *keypair_out, int extra_strong)</td></tr>
<tr class="separator:a84cef627f00064e72f8a29196673abaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a700be6ddcf2a5ddbbbf56c91f3cd7cc7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__curve25519_8c.html#a700be6ddcf2a5ddbbbf56c91f3cd7cc7">curve25519_keypair_write_to_file</a> (const <a class="el" href="structcurve25519__keypair__t.html">curve25519_keypair_t</a> *keypair, const char *fname, const char *tag)</td></tr>
<tr class="separator:a700be6ddcf2a5ddbbbf56c91f3cd7cc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fce12b8d0fef7bbe32c103aaab17412"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__curve25519_8c.html#a7fce12b8d0fef7bbe32c103aaab17412">curve25519_keypair_read_from_file</a> (<a class="el" href="structcurve25519__keypair__t.html">curve25519_keypair_t</a> *keypair_out, char **tag_out, const char *fname)</td></tr>
<tr class="separator:a7fce12b8d0fef7bbe32c103aaab17412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a000333c8503d33e0dd2d5c002a7dcd08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__curve25519_8c.html#a000333c8503d33e0dd2d5c002a7dcd08">curve25519_handshake</a> (uint8_t *output, const <a class="el" href="structcurve25519__secret__key__t.html">curve25519_secret_key_t</a> *skey, const <a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> *pkey)</td></tr>
<tr class="separator:a000333c8503d33e0dd2d5c002a7dcd08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa565e7de390f89598da5dcf2b87dd91"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__curve25519_8c.html#aaa565e7de390f89598da5dcf2b87dd91">curve25519_init</a> (void)</td></tr>
<tr class="separator:aaa565e7de390f89598da5dcf2b87dd91"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Wrapper code for a curve25519 implementation. </p>
<p>Curve25519 is an Elliptic-Curve Diffie Hellman handshake, designed by Dan Bernstein. For more information, see <a href="https://cr.yp.to/ecdh.html">https://cr.yp.to/ecdh.html</a></p>
<p>Tor uses Curve25519 as the basis of its "ntor" circuit extension handshake, and in related code. The functions in this module are used to find the most suitable available Curve25519 implementation, to provide wrappers around it, and so on. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af77c6aa2312f4e598306ffe516b8dfd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af77c6aa2312f4e598306ffe516b8dfd1">&#9670;&nbsp;</a></span>curve25519_basepoint_impl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int curve25519_basepoint_impl </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>secret</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function: Multiply the scalar "secret" by the Curve25519 basepoint (X=9), and store the result in "output". Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_af77c6aa2312f4e598306ffe516b8dfd1_icgraph.png" border="0" usemap="#crypto__curve25519_8c_af77c6aa2312f4e598306ffe516b8dfd1_icgraph" alt=""/></div>
<map name="crypto__curve25519_8c_af77c6aa2312f4e598306ffe516b8dfd1_icgraph" id="crypto__curve25519_8c_af77c6aa2312f4e598306ffe516b8dfd1_icgraph">
<area shape="rect" id="node2" href="crypto__curve25519_8c.html#a68cbc7d4be1ea064154cbca18d51a53d" title="curve25519_public_key\l_generate" alt="" coords="236,39,395,80"/>
<area shape="rect" id="node3" href="crypto__curve25519_8c.html#a84cef627f00064e72f8a29196673abaf" title="curve25519_keypair\l_generate" alt="" coords="443,5,581,47"/>
<area shape="rect" id="node4" href="crypto__curve25519_8c.html#a7fce12b8d0fef7bbe32c103aaab17412" title="curve25519_keypair\l_read_from_file" alt="" coords="443,71,581,112"/>
</map>
</div>

</div>
</div>
<a id="a000333c8503d33e0dd2d5c002a7dcd08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a000333c8503d33e0dd2d5c002a7dcd08">&#9670;&nbsp;</a></span>curve25519_handshake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void curve25519_handshake </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcurve25519__secret__key__t.html">curve25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>skey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pkey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform the curve25519 ECDH handshake with <b>skey</b> and <b>pkey</b>, writing CURVE25519_OUTPUT_LEN bytes of output into <b>output</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a000333c8503d33e0dd2d5c002a7dcd08_cgraph.png" border="0" usemap="#crypto__curve25519_8c_a000333c8503d33e0dd2d5c002a7dcd08_cgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a000333c8503d33e0dd2d5c002a7dcd08_cgraph" id="crypto__curve25519_8c_a000333c8503d33e0dd2d5c002a7dcd08_cgraph">
<area shape="rect" id="node2" href="crypto__curve25519_8c.html#a5e7a8ab2c4c662058cadf28615d69518" title="curve25519_impl" alt="" coords="212,5,332,32"/>
<area shape="rect" id="node3" href="crypto__util_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="380,5,459,32"/>
</map>
</div>

</div>
</div>
<a id="a5e7a8ab2c4c662058cadf28615d69518"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e7a8ab2c4c662058cadf28615d69518">&#9670;&nbsp;</a></span>curve25519_impl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int curve25519_impl </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>point</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function: call the most appropriate backend to compute the scalar "secret" times the point "point". Store the result in "output". Return 0 on success, negative on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a5e7a8ab2c4c662058cadf28615d69518_cgraph.png" border="0" usemap="#crypto__curve25519_8c_a5e7a8ab2c4c662058cadf28615d69518_cgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a5e7a8ab2c4c662058cadf28615d69518_cgraph" id="crypto__curve25519_8c_a5e7a8ab2c4c662058cadf28615d69518_cgraph">
<area shape="rect" id="node2" href="crypto__util_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="173,5,252,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a5e7a8ab2c4c662058cadf28615d69518_icgraph.png" border="0" usemap="#crypto__curve25519_8c_a5e7a8ab2c4c662058cadf28615d69518_icgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a5e7a8ab2c4c662058cadf28615d69518_icgraph" id="crypto__curve25519_8c_a5e7a8ab2c4c662058cadf28615d69518_icgraph">
<area shape="rect" id="node2" href="crypto__curve25519_8c.html#a000333c8503d33e0dd2d5c002a7dcd08" title="curve25519_handshake" alt="" coords="173,5,332,32"/>
</map>
</div>

</div>
</div>
<a id="aaa565e7de390f89598da5dcf2b87dd91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa565e7de390f89598da5dcf2b87dd91">&#9670;&nbsp;</a></span>curve25519_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void curve25519_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the curve25519 implementations. This is necessary if you're going to use them in a multithreaded setting, and not otherwise. </p>

</div>
</div>
<a id="a84cef627f00064e72f8a29196673abaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84cef627f00064e72f8a29196673abaf">&#9670;&nbsp;</a></span>curve25519_keypair_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int curve25519_keypair_generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcurve25519__keypair__t.html">curve25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>keypair_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>extra_strong</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Construct a new keypair in *<b>keypair_out</b>. If <b>extra_strong</b> is true, this key is possibly going to get used more than once, so use a better-than-usual RNG. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a84cef627f00064e72f8a29196673abaf_cgraph.png" border="0" usemap="#crypto__curve25519_8c_a84cef627f00064e72f8a29196673abaf_cgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a84cef627f00064e72f8a29196673abaf_cgraph" id="crypto__curve25519_8c_a84cef627f00064e72f8a29196673abaf_cgraph">
<area shape="rect" id="node2" href="crypto__curve25519_8c.html#a33569d6170349126f87307f7a0c8c90e" title="curve25519_secret_key\l_generate" alt="" coords="192,5,352,47"/>
<area shape="rect" id="node5" href="crypto__curve25519_8c.html#a68cbc7d4be1ea064154cbca18d51a53d" title="curve25519_public_key\l_generate" alt="" coords="193,71,351,112"/>
<area shape="rect" id="node3" href="crypto__curve25519_8c.html#a3a41ce8071bcfcc3aef74d4e995e83d9" title="curve25519_rand_seckey\l_bytes" alt="" coords="406,5,577,47"/>
<area shape="rect" id="node4" href="crypto__rand_8c.html#ae5356daa13494dbcca77324c6a85b9da" title="crypto_strongest_rand" alt="" coords="631,13,781,39"/>
<area shape="rect" id="node6" href="crypto__curve25519_8c.html#af77c6aa2312f4e598306ffe516b8dfd1" title="curve25519_basepoint_impl" alt="" coords="400,78,583,105"/>
</map>
</div>

</div>
</div>
<a id="a7fce12b8d0fef7bbe32c103aaab17412"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fce12b8d0fef7bbe32c103aaab17412">&#9670;&nbsp;</a></span>curve25519_keypair_read_from_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int curve25519_keypair_read_from_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcurve25519__keypair__t.html">curve25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>keypair_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>tag_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read a curve25519 keypair from a file named <b>fname</b> created by <a class="el" href="crypto__curve25519_8c.html#a700be6ddcf2a5ddbbbf56c91f3cd7cc7">curve25519_keypair_write_to_file()</a>. Store the keypair in <b>keypair_out</b>, and the associated tag string in <b>tag_out</b>. Return 0 on success, and -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a7fce12b8d0fef7bbe32c103aaab17412_cgraph.png" border="0" usemap="#crypto__curve25519_8c_a7fce12b8d0fef7bbe32c103aaab17412_cgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a7fce12b8d0fef7bbe32c103aaab17412_cgraph" id="crypto__curve25519_8c_a7fce12b8d0fef7bbe32c103aaab17412_cgraph">
<area shape="rect" id="node2" href="crypto__format_8c.html#a40e1ed638568c15cac66b16cf427b4e7" title="crypto_read_tagged\l_contents_from_file" alt="" coords="203,58,339,99"/>
<area shape="rect" id="node6" href="crypto__curve25519_8c.html#a68cbc7d4be1ea064154cbca18d51a53d" title="curve25519_public_key\l_generate" alt="" coords="192,133,351,174"/>
<area shape="rect" id="node3" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="446,5,534,32"/>
<area shape="rect" id="node4" href="util_8c.html#a28445ce92bb84e6413d5437428dae850" title="strcmpend" alt="" coords="449,56,531,83"/>
<area shape="rect" id="node5" href="util_8c.html#a7c5079074e649dc0369225eca3073f7d" title="tor_mem_is_zero" alt="" coords="429,107,551,133"/>
<area shape="rect" id="node7" href="crypto__curve25519_8c.html#af77c6aa2312f4e598306ffe516b8dfd1" title="curve25519_basepoint_impl" alt="" coords="399,157,581,184"/>
</map>
</div>

</div>
</div>
<a id="a700be6ddcf2a5ddbbbf56c91f3cd7cc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a700be6ddcf2a5ddbbbf56c91f3cd7cc7">&#9670;&nbsp;</a></span>curve25519_keypair_write_to_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int curve25519_keypair_write_to_file </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcurve25519__keypair__t.html">curve25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>keypair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Store the keypair <b>keypair</b>, including its secret and public parts, to the file <b>fname</b>. Use the string tag <b>tag</b> to distinguish this from other Curve25519 keypairs. Return 0 on success, -1 on failure.</p>
<p>See <a class="el" href="crypto__format_8c.html#a58e217ce83721c40e22a70f6f9ca1544">crypto_write_tagged_contents_to_file()</a> for more information on the metaformat used for these keys. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a700be6ddcf2a5ddbbbf56c91f3cd7cc7_cgraph.png" border="0" usemap="#crypto__curve25519_8c_a700be6ddcf2a5ddbbbf56c91f3cd7cc7_cgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a700be6ddcf2a5ddbbbf56c91f3cd7cc7_cgraph" id="crypto__curve25519_8c_a700be6ddcf2a5ddbbbf56c91f3cd7cc7_cgraph">
<area shape="rect" id="node2" href="crypto__format_8c.html#a58e217ce83721c40e22a70f6f9ca1544" title="crypto_write_tagged\l_contents_to_file" alt="" coords="192,49,331,90"/>
<area shape="rect" id="node7" href="crypto__util_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="222,115,301,141"/>
<area shape="rect" id="node3" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="406,5,493,32"/>
<area shape="rect" id="node5" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="399,56,499,83"/>
<area shape="rect" id="node6" href="util_8c.html#ae01530967d53afcfefa8227c98072e83" title="write_chunks_to_file" alt="" coords="379,107,520,133"/>
<area shape="rect" id="node4" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="568,5,663,32"/>
</map>
</div>

</div>
</div>
<a id="a68cbc7d4be1ea064154cbca18d51a53d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68cbc7d4be1ea064154cbca18d51a53d">&#9670;&nbsp;</a></span>curve25519_public_key_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void curve25519_public_key_generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>key_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcurve25519__secret__key__t.html">curve25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>seckey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a secret key in <b>seckey</b>, create the corresponding public key in <b>key_out</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a68cbc7d4be1ea064154cbca18d51a53d_cgraph.png" border="0" usemap="#crypto__curve25519_8c_a68cbc7d4be1ea064154cbca18d51a53d_cgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a68cbc7d4be1ea064154cbca18d51a53d_cgraph" id="crypto__curve25519_8c_a68cbc7d4be1ea064154cbca18d51a53d_cgraph">
<area shape="rect" id="node2" href="crypto__curve25519_8c.html#af77c6aa2312f4e598306ffe516b8dfd1" title="curve25519_basepoint_impl" alt="" coords="212,13,395,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a68cbc7d4be1ea064154cbca18d51a53d_icgraph.png" border="0" usemap="#crypto__curve25519_8c_a68cbc7d4be1ea064154cbca18d51a53d_icgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a68cbc7d4be1ea064154cbca18d51a53d_icgraph" id="crypto__curve25519_8c_a68cbc7d4be1ea064154cbca18d51a53d_icgraph">
<area shape="rect" id="node2" href="crypto__curve25519_8c.html#a84cef627f00064e72f8a29196673abaf" title="curve25519_keypair\l_generate" alt="" coords="212,5,351,47"/>
<area shape="rect" id="node3" href="crypto__curve25519_8c.html#a7fce12b8d0fef7bbe32c103aaab17412" title="curve25519_keypair\l_read_from_file" alt="" coords="212,71,351,112"/>
</map>
</div>

</div>
</div>
<a id="a8b8a9c7799c40bf6db3f9d720118011c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b8a9c7799c40bf6db3f9d720118011c">&#9670;&nbsp;</a></span>curve25519_public_key_is_ok()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int curve25519_public_key_is_ok </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff a <a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> seems valid. (It's not necessary to see if the point is on the curve, since the twist is also secure, but we do need to make sure that it isn't the point at infinity.) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a8b8a9c7799c40bf6db3f9d720118011c_cgraph.png" border="0" usemap="#crypto__curve25519_8c_a8b8a9c7799c40bf6db3f9d720118011c_cgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a8b8a9c7799c40bf6db3f9d720118011c_cgraph" id="crypto__curve25519_8c_a8b8a9c7799c40bf6db3f9d720118011c_cgraph">
<area shape="rect" id="node2" href="di__ops_8c.html#ab91c24c7e6cb9d5b9a4c5c5c359bcf75" title="safe_mem_is_zero" alt="" coords="212,13,344,39"/>
</map>
</div>

</div>
</div>
<a id="a3a41ce8071bcfcc3aef74d4e995e83d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a41ce8071bcfcc3aef74d4e995e83d9">&#9670;&nbsp;</a></span>curve25519_rand_seckey_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int curve25519_rand_seckey_bytes </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>extra_strong</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate CURVE25519_SECKEY_LEN random bytes in <b>out</b>. If <b>extra_strong</b> is true, this key is possibly going to get used more than once, so use a better-than-usual RNG. Return 0 on success, -1 on failure.</p>
<p>This function does not adjust the output of the RNG at all; the will caller will need to clear or set the appropriate bits to make curve25519 work. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a3a41ce8071bcfcc3aef74d4e995e83d9_cgraph.png" border="0" usemap="#crypto__curve25519_8c_a3a41ce8071bcfcc3aef74d4e995e83d9_cgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a3a41ce8071bcfcc3aef74d4e995e83d9_cgraph" id="crypto__curve25519_8c_a3a41ce8071bcfcc3aef74d4e995e83d9_cgraph">
<area shape="rect" id="node2" href="crypto__rand_8c.html#ae5356daa13494dbcca77324c6a85b9da" title="crypto_strongest_rand" alt="" coords="224,13,375,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a3a41ce8071bcfcc3aef74d4e995e83d9_icgraph.png" border="0" usemap="#crypto__curve25519_8c_a3a41ce8071bcfcc3aef74d4e995e83d9_icgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a3a41ce8071bcfcc3aef74d4e995e83d9_icgraph" id="crypto__curve25519_8c_a3a41ce8071bcfcc3aef74d4e995e83d9_icgraph">
<area shape="rect" id="node2" href="crypto__curve25519_8c.html#a33569d6170349126f87307f7a0c8c90e" title="curve25519_secret_key\l_generate" alt="" coords="224,5,384,47"/>
<area shape="rect" id="node3" href="crypto__curve25519_8c.html#a84cef627f00064e72f8a29196673abaf" title="curve25519_keypair\l_generate" alt="" coords="432,5,571,47"/>
</map>
</div>

</div>
</div>
<a id="a33569d6170349126f87307f7a0c8c90e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33569d6170349126f87307f7a0c8c90e">&#9670;&nbsp;</a></span>curve25519_secret_key_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int curve25519_secret_key_generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcurve25519__secret__key__t.html">curve25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>key_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>extra_strong</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate a new keypair and return the secret key. If <b>extra_strong</b> is true, this key is possibly going to get used more than once, so use a better-than-usual RNG. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a33569d6170349126f87307f7a0c8c90e_cgraph.png" border="0" usemap="#crypto__curve25519_8c_a33569d6170349126f87307f7a0c8c90e_cgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a33569d6170349126f87307f7a0c8c90e_cgraph" id="crypto__curve25519_8c_a33569d6170349126f87307f7a0c8c90e_cgraph">
<area shape="rect" id="node2" href="crypto__curve25519_8c.html#a3a41ce8071bcfcc3aef74d4e995e83d9" title="curve25519_rand_seckey\l_bytes" alt="" coords="213,5,384,47"/>
<area shape="rect" id="node3" href="crypto__rand_8c.html#ae5356daa13494dbcca77324c6a85b9da" title="crypto_strongest_rand" alt="" coords="432,13,583,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__curve25519_8c_a33569d6170349126f87307f7a0c8c90e_icgraph.png" border="0" usemap="#crypto__curve25519_8c_a33569d6170349126f87307f7a0c8c90e_icgraph" alt=""/></div>
<map name="crypto__curve25519_8c_a33569d6170349126f87307f7a0c8c90e_icgraph" id="crypto__curve25519_8c_a33569d6170349126f87307f7a0c8c90e_icgraph">
<area shape="rect" id="node2" href="crypto__curve25519_8c.html#a84cef627f00064e72f8a29196673abaf" title="curve25519_keypair\l_generate" alt="" coords="213,5,352,47"/>
</map>
</div>

</div>
</div>
<a id="ae9db0dc7b83fd68408e87e1a9bfd65b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9db0dc7b83fd68408e87e1a9bfd65b3">&#9670;&nbsp;</a></span>curve25519_set_impl_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void curve25519_set_impl_params </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>use_ed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Override the decision of whether to use the Ed25519-based basepoint multiply function. Used for testing. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
