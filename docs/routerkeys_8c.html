<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/routerkeys.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">routerkeys.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions and structures to handle generating and maintaining the set of keypairs necessary to be an OR.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__util_8h_source.html">crypto_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="router_8h_source.html">router.h</a>&quot;</code><br />
<code>#include &quot;crypto_pwbox.h&quot;</code><br />
<code>#include &quot;routerkeys.h&quot;</code><br />
<code>#include &quot;torcert.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for routerkeys.c:</div>
<div class="dyncontent">
<div class="center"><img src="routerkeys_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2routerkeys_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2routerkeys_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2routerkeys_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="1171,109,1215,136"/>
<area shape="rect" id="node41" href="config_8h.html" title="Header file for config.c. " alt="" coords="2218,707,2286,733"/>
<area shape="rect" id="node42" href="crypto__util_8h.html" title="Common functions for cryptographic routines. " alt="" coords="5,632,99,659"/>
<area shape="rect" id="node43" href="router_8h.html" title="Header file for router.c. " alt="" coords="2319,557,2385,584"/>
<area shape="rect" id="node44" href="crypto__pwbox_8h_source.html" title="crypto_pwbox.h" alt="" coords="75,707,189,733"/>
<area shape="rect" id="node45" href="routerkeys_8h_source.html" title="routerkeys.h" alt="" coords="583,184,678,211"/>
<area shape="rect" id="node46" href="torcert_8h_source.html" title="torcert.h" alt="" coords="517,109,587,136"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="1414,931,1493,957"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="517,856,579,883"/>
<area shape="rect" id="node6" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="1453,259,1523,285"/>
<area shape="rect" id="node20" href="container_8h_source.html" title="container.h" alt="" coords="535,483,622,509"/>
<area shape="rect" id="node22" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1963,483,2029,509"/>
<area shape="rect" id="node23" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1185,184,1298,211"/>
<area shape="rect" id="node24" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="1084,259,1209,285"/>
<area shape="rect" id="node25" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="741,333,883,360"/>
<area shape="rect" id="node28" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="1822,259,1885,285"/>
<area shape="rect" id="node31" href="compress_8h.html" title="Headers for compress.c. " alt="" coords="2033,184,2124,211"/>
<area shape="rect" id="node32" href="address_8h.html" title="Headers for address.h. " alt="" coords="730,408,809,435"/>
<area shape="rect" id="node33" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="2369,781,2497,808"/>
<area shape="rect" id="node34" href="ht_8h_source.html" title="ht.h" alt="" coords="2149,184,2193,211"/>
<area shape="rect" id="node35" href="confline_8h_source.html" title="confline.h" alt="" coords="265,259,343,285"/>
<area shape="rect" id="node36" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="702,184,805,211"/>
<area shape="rect" id="node37" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="829,184,920,211"/>
<area shape="rect" id="node38" href="token__bucket_8h_source.html" title="token_bucket.h" alt="" coords="1141,781,1251,808"/>
<area shape="rect" id="node39" href="util__format_8h_source.html" title="util_format.h" alt="" coords="885,781,979,808"/>
<area shape="rect" id="node40" href="hs__circuitmap_8h.html" title="Header file for hs_circuitmap.c. " alt="" coords="944,184,1059,211"/>
<area shape="rect" id="node8" href="compat_8h_source.html" title="compat.h" alt="" coords="1505,707,1581,733"/>
<area shape="rect" id="node14" href="util_8h.html" title="Headers for util.c. " alt="" coords="977,557,1028,584"/>
<area shape="rect" id="node18" href="crypto__rsa_8h.html" title="Headers for crypto_rsa.c. " alt="" coords="1618,333,1713,360"/>
<area shape="rect" id="node9" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="1928,856,2027,883"/>
<area shape="rect" id="node11" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="1530,856,1638,883"/>
<area shape="rect" id="node13" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="1327,781,1454,808"/>
<area shape="rect" id="node15" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="687,781,758,808"/>
<area shape="rect" id="node17" href="util__bug_8h.html" title="Macros to manage assertions, fatal and non&#45;fatal. " alt="" coords="1422,632,1501,659"/>
<area shape="rect" id="node19" href="crypto__digest_8h.html" title="Headers for crypto_digest.c. " alt="" coords="595,408,706,435"/>
<area shape="rect" id="node21" href="siphash_8h_source.html" title="siphash.h" alt="" coords="535,557,614,584"/>
<area shape="rect" id="node26" href="crypto__openssl__mgt_8h_source.html" title="crypto_openssl_mgt.h" alt="" coords="1041,408,1191,435"/>
<area shape="rect" id="node29" href="compat__openssl_8h.html" title="compatibility definitions for working with different openssl forks " alt="" coords="1789,333,1917,360"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a99bec0dccb148631137c319de7c5d04c"><td class="memItemLeft" align="right" valign="top"><a id="a99bec0dccb148631137c319de7c5d04c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ENC_KEY_HEADER</b>&#160;&#160;&#160;&quot;Boxed Ed25519 key&quot;</td></tr>
<tr class="separator:a99bec0dccb148631137c319de7c5d04c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f6b84f49af946753e4f8e306036d73f"><td class="memItemLeft" align="right" valign="top"><a id="a9f6b84f49af946753e4f8e306036d73f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ENC_KEY_TAG</b>&#160;&#160;&#160;&quot;master&quot;</td></tr>
<tr class="separator:a9f6b84f49af946753e4f8e306036d73f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a292ad803e75cf5ca00676b8595513ace"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>FAIL</b>(msg)</td></tr>
<tr class="separator:a292ad803e75cf5ca00676b8595513ace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab31232457fb1dae34427f8b313a09ffe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>SET_KEY</b>(key,  newval)</td></tr>
<tr class="separator:ab31232457fb1dae34427f8b313a09ffe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7571d0b2861beb3199fac9643a21f7ac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>SET_CERT</b>(cert,  newval)</td></tr>
<tr class="separator:a7571d0b2861beb3199fac9643a21f7ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a180d204fd26028c3d7a342fec43fddf0"><td class="memItemLeft" align="right" valign="top"><a id="a180d204fd26028c3d7a342fec43fddf0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>HAPPENS_SOON</b>(when,  interval)&#160;&#160;&#160;((when) &lt; now + (interval))</td></tr>
<tr class="separator:a180d204fd26028c3d7a342fec43fddf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d64025a8db5b09755b810d85669e301"><td class="memItemLeft" align="right" valign="top"><a id="a2d64025a8db5b09755b810d85669e301"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXPIRES_SOON</b>(cert,  interval)&#160;&#160;&#160;(!(cert) || HAPPENS_SOON((cert)-&gt;valid_until, (interval)))</td></tr>
<tr class="separator:a2d64025a8db5b09755b810d85669e301"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a82b8221cfce03b9a6ed43240f6c4fb17"><td class="memItemLeft" align="right" valign="top"><a id="a82b8221cfce03b9a6ed43240f6c4fb17"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>read_encrypted_secret_key</b> (<a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *out, const char *fname)</td></tr>
<tr class="separator:a82b8221cfce03b9a6ed43240f6c4fb17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d9a6842138841f2cb75bcf8d2893156"><td class="memItemLeft" align="right" valign="top"><a id="a2d9a6842138841f2cb75bcf8d2893156"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>write_encrypted_secret_key</b> (const <a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *key, const char *fname)</td></tr>
<tr class="separator:a2d9a6842138841f2cb75bcf8d2893156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae1c5a5d448a1f0460373478e6304b36"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerkeys_8c.html#aae1c5a5d448a1f0460373478e6304b36">ed_key_init_from_file</a> (const char *fname, uint32_t flags, int severity, const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *signing_key, time_t now, time_t lifetime, uint8_t cert_type, struct <a class="el" href="structtor__cert__st.html">tor_cert_st</a> **cert_out)</td></tr>
<tr class="separator:aae1c5a5d448a1f0460373478e6304b36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd4f0130cd758d8e8382d7d6b775f69d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerkeys_8c.html#afd4f0130cd758d8e8382d7d6b775f69d">ed_key_new</a> (const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *signing_key, uint32_t flags, time_t now, time_t lifetime, uint8_t cert_type, struct <a class="el" href="structtor__cert__st.html">tor_cert_st</a> **cert_out)</td></tr>
<tr class="separator:afd4f0130cd758d8e8382d7d6b775f69d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299d4e4134b411432184526e2497267d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerkeys_8c.html#a299d4e4134b411432184526e2497267d">load_ed_keys</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options, time_t now)</td></tr>
<tr class="separator:a299d4e4134b411432184526e2497267d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abebfd6b56ecfb14c8ef132e50485907e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerkeys_8c.html#abebfd6b56ecfb14c8ef132e50485907e">generate_ed_link_cert</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options, time_t now, int force)</td></tr>
<tr class="separator:abebfd6b56ecfb14c8ef132e50485907e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e95cfb2cfe890a618b7681b2f7f6c76"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerkeys_8c.html#a2e95cfb2cfe890a618b7681b2f7f6c76">should_make_new_ed_keys</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options, const time_t now)</td></tr>
<tr class="separator:a2e95cfb2cfe890a618b7681b2f7f6c76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab742cda8cfa5557e3e7828362699a143"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerkeys_8c.html#ab742cda8cfa5557e3e7828362699a143">log_cert_expiration</a> (void)</td></tr>
<tr class="separator:ab742cda8cfa5557e3e7828362699a143"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a421e38c5daf5ccdc84d019c2d05a9d88"><td class="memItemLeft" align="right" valign="top"><a id="a421e38c5daf5ccdc84d019c2d05a9d88"></a>
const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>get_master_identity_key</b> (void)</td></tr>
<tr class="separator:a421e38c5daf5ccdc84d019c2d05a9d88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32baa1ac0f83ced1415a21b99e3ba47a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerkeys_8c.html#a32baa1ac0f83ced1415a21b99e3ba47a">router_ed25519_id_is_me</a> (const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *id)</td></tr>
<tr class="separator:a32baa1ac0f83ced1415a21b99e3ba47a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c925a3d169f7bee0a72cd82f1519417"><td class="memItemLeft" align="right" valign="top"><a id="a4c925a3d169f7bee0a72cd82f1519417"></a>
const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>get_master_signing_keypair</b> (void)</td></tr>
<tr class="separator:a4c925a3d169f7bee0a72cd82f1519417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1da45ab51690adcc5551f70d480c2630"><td class="memItemLeft" align="right" valign="top"><a id="a1da45ab51690adcc5551f70d480c2630"></a>
const struct <a class="el" href="structtor__cert__st.html">tor_cert_st</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>get_master_signing_key_cert</b> (void)</td></tr>
<tr class="separator:a1da45ab51690adcc5551f70d480c2630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45089811c9a846be13e0f4a132a7a1a"><td class="memItemLeft" align="right" valign="top"><a id="ae45089811c9a846be13e0f4a132a7a1a"></a>
const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>get_current_auth_keypair</b> (void)</td></tr>
<tr class="separator:ae45089811c9a846be13e0f4a132a7a1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af48abc3b664f1b669f03a2a7166533c0"><td class="memItemLeft" align="right" valign="top"><a id="af48abc3b664f1b669f03a2a7166533c0"></a>
const <a class="el" href="structtor__cert__st.html">tor_cert_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>get_current_link_cert_cert</b> (void)</td></tr>
<tr class="separator:af48abc3b664f1b669f03a2a7166533c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fca117160a128d4a8fe2e8c5c2144fb"><td class="memItemLeft" align="right" valign="top"><a id="a6fca117160a128d4a8fe2e8c5c2144fb"></a>
const <a class="el" href="structtor__cert__st.html">tor_cert_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>get_current_auth_key_cert</b> (void)</td></tr>
<tr class="separator:a6fca117160a128d4a8fe2e8c5c2144fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a203b2e7058139258259ff97e6e3e3f80"><td class="memItemLeft" align="right" valign="top"><a id="a203b2e7058139258259ff97e6e3e3f80"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>get_master_rsa_crosscert</b> (const uint8_t **cert_out, size_t *size_out)</td></tr>
<tr class="separator:a203b2e7058139258259ff97e6e3e3f80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1142499a3f0ac31e764484c1c6bd6c6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtor__cert__st.html">tor_cert_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerkeys_8c.html#ac1142499a3f0ac31e764484c1c6bd6c6">make_ntor_onion_key_crosscert</a> (const <a class="el" href="structcurve25519__keypair__t.html">curve25519_keypair_t</a> *onion_key, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *master_id_key, time_t now, time_t lifetime, int *sign_out)</td></tr>
<tr class="separator:ac1142499a3f0ac31e764484c1c6bd6c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a501cbbf6be9a4449c5976ccacc8b2cc4"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerkeys_8c.html#a501cbbf6be9a4449c5976ccacc8b2cc4">make_tap_onion_key_crosscert</a> (const <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *onion_key, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *master_id_key, const <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *rsa_id_key, int *len_out)</td></tr>
<tr class="separator:a501cbbf6be9a4449c5976ccacc8b2cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bad2b67cd42f092d8fbb57968d88146"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerkeys_8c.html#a9bad2b67cd42f092d8fbb57968d88146">MOCK_IMPL</a> (int, check_tap_onion_key_crosscert,(const uint8_t *crosscert, int crosscert_len, const <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *onion_pkey, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *master_id_pkey, const uint8_t *rsa_id_digest))</td></tr>
<tr class="separator:a9bad2b67cd42f092d8fbb57968d88146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea0837bf06d71ee730c9b543aac408be"><td class="memItemLeft" align="right" valign="top"><a id="aea0837bf06d71ee730c9b543aac408be"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>routerkeys_free_all</b> (void)</td></tr>
<tr class="separator:aea0837bf06d71ee730c9b543aac408be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions and structures to handle generating and maintaining the set of keypairs necessary to be an OR. </p>
<p>The keys handled here now are the Ed25519 keys that Tor relays use to sign descriptors, authenticate themselves on links, and identify one another uniquely. Other keys are maintained in <a class="el" href="router_8c.html" title="Miscellaneous relay functionality, including RSA key maintenance, generating and uploading server des...">router.c</a> and <a class="el" href="rendservice_8c.html" title="The hidden-service side of rendezvous functionality. ">rendservice.c</a>.</p>
<p>(TODO: The keys in <a class="el" href="router_8c.html" title="Miscellaneous relay functionality, including RSA key maintenance, generating and uploading server des...">router.c</a> should go here too.) </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a292ad803e75cf5ca00676b8595513ace"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a292ad803e75cf5ca00676b8595513ace">&#9670;&nbsp;</a></span>FAIL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAIL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">msg</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                          \</div><div class="line">    log_warn(<a class="code" href="torlog_8h.html#a8c345cb2f7f8766b95ec58f224c2ed0f">LD_OR</a>, (msg));                     \</div><div class="line">    goto err;                                   \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div><div class="ttc" id="torlog_8h_html_a8c345cb2f7f8766b95ec58f224c2ed0f"><div class="ttname"><a href="torlog_8h.html#a8c345cb2f7f8766b95ec58f224c2ed0f">LD_OR</a></div><div class="ttdeci">#define LD_OR</div><div class="ttdef"><b>Definition:</b> torlog.h:86</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7571d0b2861beb3199fac9643a21f7ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7571d0b2861beb3199fac9643a21f7ac">&#9670;&nbsp;</a></span>SET_CERT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SET_CERT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">cert, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">newval&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {             \</div><div class="line">    if ((cert) != (newval))                     \</div><div class="line">      tor_cert_free(cert);                      \</div><div class="line">    cert = (newval);                            \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div></div><!-- fragment -->
</div>
</div>
<a id="ab31232457fb1dae34427f8b313a09ffe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab31232457fb1dae34427f8b313a09ffe">&#9670;&nbsp;</a></span>SET_KEY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SET_KEY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">key, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">newval&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {               \</div><div class="line">    if ((key) != (newval))                      \</div><div class="line">      ed25519_keypair_free(key);                \</div><div class="line">    key = (newval);                             \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aae1c5a5d448a1f0460373478e6304b36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae1c5a5d448a1f0460373478e6304b36">&#9670;&nbsp;</a></span>ed_key_init_from_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a>* ed_key_init_from_file </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>signing_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>lifetime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>cert_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtor__cert__st.html">tor_cert_st</a> **&#160;</td>
          <td class="paramname"><em>cert_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read an ed25519 key and associated certificates from files beginning with <b>fname</b>, with certificate type <b>cert_type</b>. On failure, return NULL; on success return the keypair.</p>
<p>If INIT_ED_KEY_CREATE is set in <b>flags</b>, then create the key (and certificate if requested) if it doesn't exist, and save it to disk.</p>
<p>If INIT_ED_KEY_NEEDCERT is set in <b>flags</b>, load/create a certificate too and store it in *<b>cert_out</b>. Fail if the cert can't be found/created. To create a certificate, <b>signing_key</b> must be set to the key that should sign it; <b>now</b> to the current time, and <b>lifetime</b> to the lifetime of the key.</p>
<p>If INIT_ED_KEY_REPLACE is set in <b>flags</b>, then create and save new key whether we can read the old one or not.</p>
<p>If INIT_ED_KEY_EXTRA_STRONG is set in <b>flags</b>, set the extra_strong flag when creating the secret key.</p>
<p>If INIT_ED_KEY_INCLUDE_SIGNING_KEY_IN_CERT is set in <b>flags</b>, and we create a new certificate, create it with the signing key embedded.</p>
<p>If INIT_ED_KEY_SPLIT is set in <b>flags</b>, and we create a new key, store the public key in a separate file from the secret key.</p>
<p>If INIT_ED_KEY_MISSING_SECRET_OK is set in <b>flags</b>, and we find a public key file but no secret key file, return successfully anyway.</p>
<p>If INIT_ED_KEY_OMIT_SECRET is set in <b>flags</b>, do not try to load a secret key unless no public key is found. Do not return a secret key. (but create and save one if needed).</p>
<p>If INIT_ED_KEY_NO_LOAD_SECRET is set in <b>flags</b>, don't try to load a secret key, no matter what.</p>
<p>If INIT_ED_KEY_TRY_ENCRYPTED is set, we look for an encrypted secret key and consider encrypting any new secret key.</p>
<p>If INIT_ED_KEY_NO_REPAIR is set, and there is any issue loading the keys from disk <em>other than their absence</em> (full or partial), we do not try to replace them.</p>
<p>If INIT_ED_KEY_SUGGEST_KEYGEN is set, have log messages about failures refer to the &ndash;keygen option.</p>
<p>If INIT_ED_KEY_EXPLICIT_FNAME is set, use the provided file name for the secret key file, encrypted or not. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerkeys_8c_aae1c5a5d448a1f0460373478e6304b36_cgraph.png" border="0" usemap="#routerkeys_8c_aae1c5a5d448a1f0460373478e6304b36_cgraph" alt=""/></div>
<map name="routerkeys_8c_aae1c5a5d448a1f0460373478e6304b36_cgraph" id="routerkeys_8c_aae1c5a5d448a1f0460373478e6304b36_cgraph">
<area shape="rect" id="node2" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="199,5,285,32"/>
<area shape="rect" id="node3" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="333,5,428,32"/>
</map>
</div>

</div>
</div>
<a id="afd4f0130cd758d8e8382d7d6b775f69d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd4f0130cd758d8e8382d7d6b775f69d">&#9670;&nbsp;</a></span>ed_key_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a>* ed_key_new </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>signing_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>lifetime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>cert_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtor__cert__st.html">tor_cert_st</a> **&#160;</td>
          <td class="paramname"><em>cert_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new signing key and (optionally) certficiate; do not read or write from disk. See <a class="el" href="routerkeys_8c.html#aae1c5a5d448a1f0460373478e6304b36">ed_key_init_from_file()</a> for more information. </p>

</div>
</div>
<a id="abebfd6b56ecfb14c8ef132e50485907e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abebfd6b56ecfb14c8ef132e50485907e">&#9670;&nbsp;</a></span>generate_ed_link_cert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int generate_ed_link_cert </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>force</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve our currently-in-use Ed25519 link certificate and id certificate, and, if they would expire soon (based on the time <b>now</b>, generate new certificates (without embedding the public part of the signing key inside). If <b>force</b> is true, always generate a new certificate.</p>
<p>The signed_key from the current id-&gt;signing certificate will be used to sign the new key within newly generated X509 certificate.</p>
<p>Returns -1 upon error. Otherwise, returns 0 upon success (either when the current certificate is still valid, or when a new certificate was successfully generated, or no certificate was needed). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerkeys_8c_abebfd6b56ecfb14c8ef132e50485907e_cgraph.png" border="0" usemap="#routerkeys_8c_abebfd6b56ecfb14c8ef132e50485907e_cgraph" alt=""/></div>
<map name="routerkeys_8c_abebfd6b56ecfb14c8ef132e50485907e_cgraph" id="routerkeys_8c_abebfd6b56ecfb14c8ef132e50485907e_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#a7aa93459dd4e3641e885932d682db4a0" title="tor_tls_get_my_certs" alt="" coords="203,5,347,32"/>
</map>
</div>

</div>
</div>
<a id="a299d4e4134b411432184526e2497267d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299d4e4134b411432184526e2497267d">&#9670;&nbsp;</a></span>load_ed_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int load_ed_keys </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Running as a server: load, reload, or refresh our ed25519 keys and certificates, creating and saving new ones as needed.</p>
<p>Return -1 on failure; 0 on success if the signing key was not replaced; and 1 on success if the signing key was replaced. </p>

</div>
</div>
<a id="ab742cda8cfa5557e3e7828362699a143"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab742cda8cfa5557e3e7828362699a143">&#9670;&nbsp;</a></span>log_cert_expiration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int log_cert_expiration </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log when a key certificate expires. Used when tor is given the &ndash;key-expiration command-line option.</p>
<p>If an command argument is given, which should specify the type of key to get expiry information about (currently supported arguments are "sign"), get info about that type of certificate. Otherwise, print info about the supported arguments.</p>
<p>Returns 0 on success and -1 on failure. </p>

</div>
</div>
<a id="ac1142499a3f0ac31e764484c1c6bd6c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1142499a3f0ac31e764484c1c6bd6c6">&#9670;&nbsp;</a></span>make_ntor_onion_key_crosscert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtor__cert__st.html">tor_cert_t</a>* make_ntor_onion_key_crosscert </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcurve25519__keypair__t.html">curve25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>onion_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>master_id_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>lifetime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sign_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Construct cross-certification for the master identity key with the ntor onion key. Store the sign of the corresponding ed25519 public key in *<b>sign_out</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerkeys_8c_ac1142499a3f0ac31e764484c1c6bd6c6_cgraph.png" border="0" usemap="#routerkeys_8c_ac1142499a3f0ac31e764484c1c6bd6c6_cgraph" alt=""/></div>
<map name="routerkeys_8c_ac1142499a3f0ac31e764484c1c6bd6c6_cgraph" id="routerkeys_8c_ac1142499a3f0ac31e764484c1c6bd6c6_cgraph">
<area shape="rect" id="node2" href="crypto__ed25519_8c.html#abb50b5bb9010dfe33e19a08f5cc362da" title="ed25519_keypair_from\l_curve25519_keypair" alt="" coords="203,5,356,47"/>
<area shape="rect" id="node4" href="torcert_8c.html#afa728c2dfbf24182ade2227b5dca4fe9" title="tor_cert_create" alt="" coords="225,71,334,98"/>
<area shape="rect" id="node5" href="crypto__util_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="240,122,319,149"/>
<area shape="rect" id="node3" href="crypto__digest_8c.html#aff99a8b3d871957cbefb2d9bfa116d1f" title="crypto_digest512_new" alt="" coords="404,13,556,39"/>
</map>
</div>

</div>
</div>
<a id="a501cbbf6be9a4449c5976ccacc8b2cc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a501cbbf6be9a4449c5976ccacc8b2cc4">&#9670;&nbsp;</a></span>make_tap_onion_key_crosscert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* make_tap_onion_key_crosscert </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>onion_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>master_id_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>rsa_id_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>len_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Construct and return an RSA signature for the TAP onion key to cross-certify the RSA and Ed25519 identity keys. Set <b>len_out</b> to its length. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerkeys_8c_a501cbbf6be9a4449c5976ccacc8b2cc4_cgraph.png" border="0" usemap="#routerkeys_8c_a501cbbf6be9a4449c5976ccacc8b2cc4_cgraph" alt=""/></div>
<map name="routerkeys_8c_a501cbbf6be9a4449c5976ccacc8b2cc4_cgraph" id="routerkeys_8c_a501cbbf6be9a4449c5976ccacc8b2cc4_cgraph">
<area shape="rect" id="node2" href="crypto__rsa_8c.html#a91336077a5062618ff895dae4e50079d" title="crypto_pk_get_digest" alt="" coords="203,5,350,32"/>
<area shape="rect" id="node4" href="crypto__rsa_8c.html#a5acc83e912de445c2e7f5655ec9fd031" title="crypto_pk_private_sign" alt="" coords="199,56,355,83"/>
<area shape="rect" id="node3" href="crypto__rsa_8c.html#a47b1080a7a68f04e0e745168075c235f" title="crypto_pk_keysize" alt="" coords="423,5,553,32"/>
<area shape="rect" id="node5" href="crypto__rsa_8c.html#ac98516bae03ece6a3b42bab9a02b35bc" title="crypto_pk_key_is_private" alt="" coords="403,56,573,83"/>
</map>
</div>

</div>
</div>
<a id="a9bad2b67cd42f092d8fbb57968d88146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bad2b67cd42f092d8fbb57968d88146">&#9670;&nbsp;</a></span>MOCK_IMPL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">check_tap_onion_key_crosscert&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(const uint8_t *crosscert, int crosscert_len, const <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *onion_pkey, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *master_id_pkey, const uint8_t *rsa_id_digest)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether an RSA-TAP cross-certification is correct. Return 0 if it is, -1 if it isn't. </p>

</div>
</div>
<a id="a32baa1ac0f83ced1415a21b99e3ba47a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32baa1ac0f83ced1415a21b99e3ba47a">&#9670;&nbsp;</a></span>router_ed25519_id_is_me()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_ed25519_id_is_me </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff <b>id</b> is our Ed25519 master identity key. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerkeys_8c_a32baa1ac0f83ced1415a21b99e3ba47a_cgraph.png" border="0" usemap="#routerkeys_8c_a32baa1ac0f83ced1415a21b99e3ba47a_cgraph" alt=""/></div>
<map name="routerkeys_8c_a32baa1ac0f83ced1415a21b99e3ba47a_cgraph" id="routerkeys_8c_a32baa1ac0f83ced1415a21b99e3ba47a_cgraph">
<area shape="rect" id="node2" href="crypto__ed25519_8c.html#af9396211603b40cf70b930b9ef726ed1" title="ed25519_pubkey_eq" alt="" coords="224,5,365,32"/>
<area shape="rect" id="node3" href="di__ops_8c.html#a473334ee93cca0aea10523321a444ea3" title="tor_memeq" alt="" coords="413,5,500,32"/>
</map>
</div>

</div>
</div>
<a id="a2e95cfb2cfe890a618b7681b2f7f6c76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e95cfb2cfe890a618b7681b2f7f6c76">&#9670;&nbsp;</a></span>should_make_new_ed_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int should_make_new_ed_keys </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const time_t&#160;</td>
          <td class="paramname"><em>now</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return 1 if any of the following are true:</p>
<ul>
<li>if one of our Ed25519 signing, auth, or link certificates would expire soon w.r.t. the time <b>now</b>,</li>
<li>if we do not currently have a link certificate, or</li>
<li>if our cached Ed25519 link certificate is not same as the one we're currently using.</li>
</ul>
<p>Otherwise, returns 0. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
