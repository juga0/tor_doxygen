<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/routerparse.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">routerparse.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Code to parse and validate router descriptors, consenus directories, and similar objects.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitstats_8h_source.html">circuitstats.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dirserv_8h_source.html">dirserv.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dirvote_8h_source.html">dirvote.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="policies_8h_source.html">policies.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="protover_8h_source.html">protover.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendcommon_8h_source.html">rendcommon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="router_8h_source.html">router.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerlist_8h_source.html">routerlist.h</a>&quot;</code><br />
<code>#include &quot;memarea.h&quot;</code><br />
<code>#include &quot;<a class="el" href="microdesc_8h_source.html">microdesc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="networkstatus_8h_source.html">networkstatus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rephist_8h_source.html">rephist.h</a>&quot;</code><br />
<code>#include &quot;routerkeys.h&quot;</code><br />
<code>#include &quot;<a class="el" href="routerparse_8h_source.html">routerparse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="entrynodes_8h_source.html">entrynodes.h</a>&quot;</code><br />
<code>#include &quot;torcert.h&quot;</code><br />
<code>#include &quot;<a class="el" href="sandbox_8h_source.html">sandbox.h</a>&quot;</code><br />
<code>#include &quot;shared_random.h&quot;</code><br />
<code>#include &lt;math.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for routerparse.c:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2routerparse_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2routerparse_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2routerparse_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="1249,184,1293,211"/>
<area shape="rect" id="node31" href="config_8h.html" title="Header file for config.c. " alt="" coords="2495,333,2563,360"/>
<area shape="rect" id="node32" href="circuitstats_8h.html" title="Header file for circuitstats.c. " alt="" coords="1087,109,1185,136"/>
<area shape="rect" id="node33" href="dirserv_8h.html" title="Header file for dirserv.c. " alt="" coords="2588,333,2660,360"/>
<area shape="rect" id="node34" href="dirvote_8h.html" title="Header file for dirvote.c. " alt="" coords="1965,483,2037,509"/>
<area shape="rect" id="node35" href="policies_8h.html" title="Header file for policies.c. " alt="" coords="1407,109,1484,136"/>
<area shape="rect" id="node36" href="protover_8h.html" title="Headers and type declarations for protover.c. " alt="" coords="816,184,896,211"/>
<area shape="rect" id="node37" href="rendcommon_8h.html" title="Header file for rendcommon.c. " alt="" coords="1559,109,1667,136"/>
<area shape="rect" id="node38" href="router_8h.html" title="Header file for router.c. " alt="" coords="2029,184,2096,211"/>
<area shape="rect" id="node39" href="routerlist_8h.html" title="Header file for routerlist.c. " alt="" coords="2128,333,2211,360"/>
<area shape="rect" id="node40" href="memarea_8h_source.html" title="memarea.h" alt="" coords="1794,109,1881,136"/>
<area shape="rect" id="node41" href="microdesc_8h.html" title="Header file for microdesc.c. " alt="" coords="1905,109,1999,136"/>
<area shape="rect" id="node42" href="networkstatus_8h.html" title="Header file for networkstatus.c. " alt="" coords="2287,483,2401,509"/>
<area shape="rect" id="node43" href="rephist_8h.html" title="Header file for rephist.c. " alt="" coords="2073,109,2145,136"/>
<area shape="rect" id="node44" href="routerkeys_8h_source.html" title="routerkeys.h" alt="" coords="1770,184,1865,211"/>
<area shape="rect" id="node45" href="routerparse_8h.html" title="Header file for routerparse.c. " alt="" coords="2220,109,2319,136"/>
<area shape="rect" id="node46" href="entrynodes_8h.html" title="Header file for circuitbuild.c. " alt="" coords="2343,109,2441,136"/>
<area shape="rect" id="node47" href="torcert_8h_source.html" title="torcert.h" alt="" coords="1550,184,1621,211"/>
<area shape="rect" id="node48" href="sandbox_8h.html" title="Header file for sandbox.c. " alt="" coords="5,557,88,584"/>
<area shape="rect" id="node49" href="shared__random_8h_source.html" title="shared_random.h" alt="" coords="1209,109,1332,136"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="611,707,690,733"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="654,632,717,659"/>
<area shape="rect" id="node5" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="843,408,912,435"/>
<area shape="rect" id="node13" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1531,408,1645,435"/>
<area shape="rect" id="node14" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="1765,483,1891,509"/>
<area shape="rect" id="node15" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="1817,557,1959,584"/>
<area shape="rect" id="node16" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="1018,333,1081,360"/>
<area shape="rect" id="node19" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1442,408,1507,435"/>
<area shape="rect" id="node20" href="container_8h_source.html" title="container.h" alt="" coords="737,333,823,360"/>
<area shape="rect" id="node23" href="torgzip_8h.html" title="Headers for torgzip.h. " alt="" coords="1720,259,1792,285"/>
<area shape="rect" id="node24" href="address_8h.html" title="Headers for address.h. " alt="" coords="659,259,738,285"/>
<area shape="rect" id="node25" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="1360,557,1488,584"/>
<area shape="rect" id="node27" href="ht_8h_source.html" title="ht.h" alt="" coords="1309,259,1353,285"/>
<area shape="rect" id="node28" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="1377,259,1479,285"/>
<area shape="rect" id="node29" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="1504,259,1595,285"/>
<area shape="rect" id="node30" href="util__format_8h_source.html" title="util_format.h" alt="" coords="1241,557,1335,584"/>
<area shape="rect" id="node7" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="1679,632,1777,659"/>
<area shape="rect" id="node8" href="compat_8h_source.html" title="compat.h" alt="" coords="730,483,806,509"/>
<area shape="rect" id="node10" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="470,632,578,659"/>
<area shape="rect" id="node12" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="705,557,831,584"/>
<area shape="rect" id="node17" href="compat__openssl_8h.html" title="compatability definitions for working with different openssl forks " alt="" coords="987,408,1115,435"/>
<area shape="rect" id="node21" href="util_8h.html" title="Headers for util.c. " alt="" coords="429,408,480,435"/>
<area shape="rect" id="node22" href="siphash_8h_source.html" title="siphash.h" alt="" coords="739,408,818,435"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdirectory__token__t.html">directory_token_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtoken__rule__t.html">token_rule_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad015afdcb853499520783e64379d9f90"><td class="memItemLeft" align="right" valign="top"><a id="ad015afdcb853499520783e64379d9f90"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ROUTERPARSE_PRIVATE</b></td></tr>
<tr class="separator:ad015afdcb853499520783e64379d9f90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d0dbf11b4f93725d625c4a3cc877cc3"><td class="memItemLeft" align="right" valign="top"><a id="a0d0dbf11b4f93725d625c4a3cc877cc3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIN_ANNOTATION</b>&#160;&#160;&#160;A_PURPOSE</td></tr>
<tr class="separator:a0d0dbf11b4f93725d625c4a3cc877cc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a423e4f191da40472015547fc8557b9ab"><td class="memItemLeft" align="right" valign="top"><a id="a423e4f191da40472015547fc8557b9ab"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_ANNOTATION</b>&#160;&#160;&#160;A_UNKNOWN_</td></tr>
<tr class="separator:a423e4f191da40472015547fc8557b9ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16060fc9621d986d5e8881d54261cbd2"><td class="memItemLeft" align="right" valign="top"><a id="a16060fc9621d986d5e8881d54261cbd2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>AT_START</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a16060fc9621d986d5e8881d54261cbd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b3608a04a603264c8ffa5719a1dfe9"><td class="memItemLeft" align="right" valign="top"><a id="aa3b3608a04a603264c8ffa5719a1dfe9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>AT_END</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:aa3b3608a04a603264c8ffa5719a1dfe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2876ecfd8a6f0d2f899d55b86c534462"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a2876ecfd8a6f0d2f899d55b86c534462">CERTIFICATE_MEMBERS</a></td></tr>
<tr class="separator:a2876ecfd8a6f0d2f899d55b86c534462"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a712eb63d31a6b4a7ddabe557f9d1538a"><td class="memItemLeft" align="right" valign="top"><a id="a712eb63d31a6b4a7ddabe557f9d1538a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>find_by_keyword</b>(s,  keyword)&#160;&#160;&#160;find_by_keyword_((s), (keyword), #keyword)</td></tr>
<tr class="separator:a712eb63d31a6b4a7ddabe557f9d1538a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d834ddc4587061d0d739fc8ae532e5c"><td class="memItemLeft" align="right" valign="top"><a id="a3d834ddc4587061d0d739fc8ae532e5c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TS_ANNOTATIONS_OK</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a3d834ddc4587061d0d739fc8ae532e5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4b24961e60440e9d3e551918ce65579"><td class="memItemLeft" align="right" valign="top"><a id="aa4b24961e60440e9d3e551918ce65579"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TS_NOCHECK</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:aa4b24961e60440e9d3e551918ce65579"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a3e371ed2edc30669e23360861d8439"><td class="memItemLeft" align="right" valign="top"><a id="a4a3e371ed2edc30669e23360861d8439"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TS_NO_NEW_ANNOTATIONS</b>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a4a3e371ed2edc30669e23360861d8439"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e93ef56b03297965bebfe0977b5e550"><td class="memItemLeft" align="right" valign="top"><a id="a4e93ef56b03297965bebfe0977b5e550"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CST_CHECK_AUTHORITY</b>&#160;&#160;&#160;(1&lt;&lt;0)</td></tr>
<tr class="separator:a4e93ef56b03297965bebfe0977b5e550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45a8477ae8e8059bc208fe7beb782362"><td class="memItemLeft" align="right" valign="top"><a id="a45a8477ae8e8059bc208fe7beb782362"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CST_NO_CHECK_OBJTYPE</b>&#160;&#160;&#160;(1&lt;&lt;1)</td></tr>
<tr class="separator:a45a8477ae8e8059bc208fe7beb782362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a576b5f03212c2df81e9390bdbd43c074"><td class="memItemLeft" align="right" valign="top"><a id="a576b5f03212c2df81e9390bdbd43c074"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DUMP_AREA</b>(a,  name)&#160;&#160;&#160;STMT_NIL</td></tr>
<tr class="separator:a576b5f03212c2df81e9390bdbd43c074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf89b4ab95ea3ea33b0676c04c720e1b"><td class="memItemLeft" align="right" valign="top"><a id="aaf89b4ab95ea3ea33b0676c04c720e1b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DESC_DUMP_DATADIR_SUBDIR</b>&#160;&#160;&#160;&quot;unparseable-descs&quot;</td></tr>
<tr class="separator:aaf89b4ab95ea3ea33b0676c04c720e1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abae1d92ca511ee760c29acb3cc4845a0"><td class="memItemLeft" align="right" valign="top"><a id="abae1d92ca511ee760c29acb3cc4845a0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DESC_DUMP_BASE_FILENAME</b>&#160;&#160;&#160;&quot;unparseable-desc&quot;</td></tr>
<tr class="separator:abae1d92ca511ee760c29acb3cc4845a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e2b96b4327a0013e34367114ffdc68d"><td class="memItemLeft" align="right" valign="top"><a id="a4e2b96b4327a0013e34367114ffdc68d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BEGIN_END_OVERHEAD_LEN</b>&#160;&#160;&#160;64</td></tr>
<tr class="separator:a4e2b96b4327a0013e34367114ffdc68d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac36e99659724054400dd39f398c297bf"><td class="memItemLeft" align="right" valign="top"><a id="ac36e99659724054400dd39f398c297bf"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_CERT_SIZE</b>&#160;&#160;&#160;(128*1024)</td></tr>
<tr class="separator:ac36e99659724054400dd39f398c297bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac6e2e555b7978ff9d0d5a07a28c341c"><td class="memItemLeft" align="right" valign="top"><a id="aac6e2e555b7978ff9d0d5a07a28c341c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ALLOC_ZERO</b>(sz)&#160;&#160;&#160;<a class="el" href="memarea_8c.html#afe8736114c98d9206a3705919a9e231b">memarea_alloc_zero</a>(area,sz)</td></tr>
<tr class="separator:aac6e2e555b7978ff9d0d5a07a28c341c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc6e551002d63211969c3eb71cd6cea7"><td class="memItemLeft" align="right" valign="top"><a id="acc6e551002d63211969c3eb71cd6cea7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ALLOC</b>(sz)&#160;&#160;&#160;<a class="el" href="memarea_8c.html#ab03a77a8bbd935b4b33bb1016079c3a3">memarea_alloc</a>(area,sz)</td></tr>
<tr class="separator:acc6e551002d63211969c3eb71cd6cea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5adf545e22ba035dbd9410d968d3585e"><td class="memItemLeft" align="right" valign="top"><a id="a5adf545e22ba035dbd9410d968d3585e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>STRDUP</b>(str)&#160;&#160;&#160;<a class="el" href="memarea_8c.html#ae6aeabfc89cb75df17df4e799fd34bf2">memarea_strdup</a>(area,str)</td></tr>
<tr class="separator:a5adf545e22ba035dbd9410d968d3585e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c703af509e56ebcc586700e2bfb275a"><td class="memItemLeft" align="right" valign="top"><a id="a1c703af509e56ebcc586700e2bfb275a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>STRNDUP</b>(str,  n)&#160;&#160;&#160;<a class="el" href="memarea_8c.html#ae2324c51c63afbce99ef1e56ee0bff87">memarea_strndup</a>(area,(str),(n))</td></tr>
<tr class="separator:a1c703af509e56ebcc586700e2bfb275a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03aec34c81d48472c37bfa009b8ba804"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>RET_ERR</b>(msg)</td></tr>
<tr class="separator:a03aec34c81d48472c37bfa009b8ba804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29b7451465deac204c5f7cb1f9c6e1fc"><td class="memItemLeft" align="right" valign="top"><a id="a29b7451465deac204c5f7cb1f9c6e1fc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_ARGS</b>&#160;&#160;&#160;512</td></tr>
<tr class="separator:a29b7451465deac204c5f7cb1f9c6e1fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e2db9afefdfa95ab18fa54a8031385a"><td class="memItemLeft" align="right" valign="top"><a id="a3e2db9afefdfa95ab18fa54a8031385a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_UNPARSED_OBJECT_SIZE</b>&#160;&#160;&#160;(128*1024)</td></tr>
<tr class="separator:a3e2db9afefdfa95ab18fa54a8031385a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0f2173e3b202ddf5756531b4471dcb2"><td class="memItemLeft" align="right" valign="top"><a id="af0f2173e3b202ddf5756531b4471dcb2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_LINE_LENGTH</b>&#160;&#160;&#160;(128*1024)</td></tr>
<tr class="separator:af0f2173e3b202ddf5756531b4471dcb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f2aa73b748fc53ad4ed33105addab3c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHECK_LENGTH</b>()</td></tr>
<tr class="separator:a0f2aa73b748fc53ad4ed33105addab3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4667583c6e310db5d8f20c601607f2de"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>NEXT_LINE</b>()</td></tr>
<tr class="separator:a4667583c6e310db5d8f20c601607f2de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acee98c0946da0a18c3164f1df9328e7b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>NUMBER</b>(m)</td></tr>
<tr class="separator:acee98c0946da0a18c3164f1df9328e7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58094c9d9e60820923633a753f7a9b3f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>DOT</b>()</td></tr>
<tr class="separator:a58094c9d9e60820923633a753f7a9b3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed703b01b922c16fc2e6653b18b96a03"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>CMP</b>(field)</td></tr>
<tr class="separator:aed703b01b922c16fc2e6653b18b96a03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">macros for defining token rules</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Helper macros to define token tables. 's' is a string, 't' is a directory_keyword, 'a' is a trio of argument multiplicities, and 'o' is an object syntax. </p>
</div></td></tr>
<tr class="memitem:af8968fb550fc29e699e69eee215fa8c5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#af8968fb550fc29e699e69eee215fa8c5">END_OF_TABLE</a>&#160;&#160;&#160;{ NULL, NIL_, 0,0,0, <a class="el" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa96edd6efecfc4c1078cfd69961fd88de">NO_OBJ</a>, 0, INT_MAX, 0, 0 }</td></tr>
<tr class="separator:af8968fb550fc29e699e69eee215fa8c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab691bd2eed9864879c6f851bda3168a8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#ab691bd2eed9864879c6f851bda3168a8">T</a>(s,  t,  a,  o)&#160;&#160;&#160;{ s, t, a, o, 0, INT_MAX, 0, 0 }</td></tr>
<tr class="separator:ab691bd2eed9864879c6f851bda3168a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00a2dd52132434068cae97fae79051c1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a00a2dd52132434068cae97fae79051c1">T0N</a>(s,  t,  a,  o)&#160;&#160;&#160;{ s, t, a, o, 0, INT_MAX, 0, 0 }</td></tr>
<tr class="separator:a00a2dd52132434068cae97fae79051c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6aad5272b3293c0c2da05040c987f82"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#ae6aad5272b3293c0c2da05040c987f82">T1</a>(s,  t,  a,  o)&#160;&#160;&#160;{ s, t, a, o, 1, 1, 0, 0 }</td></tr>
<tr class="separator:ae6aad5272b3293c0c2da05040c987f82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdd7cf17519f7b27cb4a09e3490f87cc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#abdd7cf17519f7b27cb4a09e3490f87cc">T1_START</a>(s,  t,  a,  o)&#160;&#160;&#160;{ s, t, a, o, 1, 1, AT_START, 0 }</td></tr>
<tr class="separator:abdd7cf17519f7b27cb4a09e3490f87cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ccf1009187481033960804159f74c22"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a3ccf1009187481033960804159f74c22">T1_END</a>(s,  t,  a,  o)&#160;&#160;&#160;{ s, t, a, o, 1, 1, AT_END, 0 }</td></tr>
<tr class="separator:a3ccf1009187481033960804159f74c22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac663434e84c1e6f83ac2bc6405c0dce6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#ac663434e84c1e6f83ac2bc6405c0dce6">T1N</a>(s,  t,  a,  o)&#160;&#160;&#160;{ s, t, a, o, 1, INT_MAX, 0, 0 }</td></tr>
<tr class="separator:ac663434e84c1e6f83ac2bc6405c0dce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06e4c394dcac68b8298bb91a25a300fa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a06e4c394dcac68b8298bb91a25a300fa">T01</a>(s,  t,  a,  o)&#160;&#160;&#160;{ s, t, a, o, 0, 1, 0, 0 }</td></tr>
<tr class="separator:a06e4c394dcac68b8298bb91a25a300fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e792cb84995596a3ac229a4eeee6808"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a2e792cb84995596a3ac229a4eeee6808">A01</a>(s,  t,  a,  o)&#160;&#160;&#160;{ s, t, a, o, 0, 1, 0, 1 }</td></tr>
<tr class="separator:a2e792cb84995596a3ac229a4eeee6808"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff1b09d6630c6c0942f78171e74c1b9d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#aff1b09d6630c6c0942f78171e74c1b9d">ARGS</a>&#160;&#160;&#160;0,INT_MAX,0</td></tr>
<tr class="separator:aff1b09d6630c6c0942f78171e74c1b9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a110201fc08b08c73366dbaf433bb8e89"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a110201fc08b08c73366dbaf433bb8e89">NO_ARGS</a>&#160;&#160;&#160;0,0,0</td></tr>
<tr class="separator:a110201fc08b08c73366dbaf433bb8e89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9b24fa99a331d88ec53d9a421bfa49b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#ac9b24fa99a331d88ec53d9a421bfa49b">CONCAT_ARGS</a>&#160;&#160;&#160;1,1,1</td></tr>
<tr class="separator:ac9b24fa99a331d88ec53d9a421bfa49b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac99d0223594938476212e184082954fc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#ac99d0223594938476212e184082954fc">GE</a>(n)&#160;&#160;&#160;n,INT_MAX,0</td></tr>
<tr class="separator:ac99d0223594938476212e184082954fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb5fffc954e58891b5408914f7560611"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#aeb5fffc954e58891b5408914f7560611">EQ</a>(n)&#160;&#160;&#160;n,n,0</td></tr>
<tr class="separator:aeb5fffc954e58891b5408914f7560611"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aeb0504130fd2814d23600fbc91e2f6e9"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structdirectory__token__t.html">directory_token_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#aeb0504130fd2814d23600fbc91e2f6e9">directory_token_t</a></td></tr>
<tr class="separator:aeb0504130fd2814d23600fbc91e2f6e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af400135e5b32b3935b819247e4b65d30"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structtoken__rule__t.html">token_rule_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#af400135e5b32b3935b819247e4b65d30">token_rule_t</a></td></tr>
<tr class="separator:af400135e5b32b3935b819247e4b65d30"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ab1bde6077f822b75a2b4d3916aa53014"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#ab1bde6077f822b75a2b4d3916aa53014">directory_keyword</a> { <br />
&#160;&#160;<b>K_ACCEPT</b> = 0, 
<b>K_ACCEPT6</b>, 
<b>K_DIRECTORY_SIGNATURE</b>, 
<b>K_RECOMMENDED_SOFTWARE</b>, 
<br />
&#160;&#160;<b>K_REJECT</b>, 
<b>K_REJECT6</b>, 
<b>K_ROUTER</b>, 
<b>K_SIGNED_DIRECTORY</b>, 
<br />
&#160;&#160;<b>K_SIGNING_KEY</b>, 
<b>K_ONION_KEY</b>, 
<b>K_ONION_KEY_NTOR</b>, 
<b>K_ROUTER_SIGNATURE</b>, 
<br />
&#160;&#160;<b>K_PUBLISHED</b>, 
<b>K_RUNNING_ROUTERS</b>, 
<b>K_ROUTER_STATUS</b>, 
<b>K_PLATFORM</b>, 
<br />
&#160;&#160;<b>K_PROTO</b>, 
<b>K_OPT</b>, 
<b>K_BANDWIDTH</b>, 
<b>K_CONTACT</b>, 
<br />
&#160;&#160;<b>K_NETWORK_STATUS</b>, 
<b>K_UPTIME</b>, 
<b>K_DIR_SIGNING_KEY</b>, 
<b>K_FAMILY</b>, 
<br />
&#160;&#160;<b>K_FINGERPRINT</b>, 
<b>K_HIBERNATING</b>, 
<b>K_READ_HISTORY</b>, 
<b>K_WRITE_HISTORY</b>, 
<br />
&#160;&#160;<b>K_NETWORK_STATUS_VERSION</b>, 
<b>K_DIR_SOURCE</b>, 
<b>K_DIR_OPTIONS</b>, 
<b>K_CLIENT_VERSIONS</b>, 
<br />
&#160;&#160;<b>K_SERVER_VERSIONS</b>, 
<b>K_RECOMMENDED_CLIENT_PROTOCOLS</b>, 
<b>K_RECOMMENDED_RELAY_PROTOCOLS</b>, 
<b>K_REQUIRED_CLIENT_PROTOCOLS</b>, 
<br />
&#160;&#160;<b>K_REQUIRED_RELAY_PROTOCOLS</b>, 
<b>K_OR_ADDRESS</b>, 
<b>K_ID</b>, 
<b>K_P</b>, 
<br />
&#160;&#160;<b>K_P6</b>, 
<b>K_R</b>, 
<b>K_A</b>, 
<b>K_S</b>, 
<br />
&#160;&#160;<b>K_V</b>, 
<b>K_W</b>, 
<b>K_M</b>, 
<b>K_EXTRA_INFO</b>, 
<br />
&#160;&#160;<b>K_EXTRA_INFO_DIGEST</b>, 
<b>K_CACHES_EXTRA_INFO</b>, 
<b>K_HIDDEN_SERVICE_DIR</b>, 
<b>K_ALLOW_SINGLE_HOP_EXITS</b>, 
<br />
&#160;&#160;<b>K_IPV6_POLICY</b>, 
<b>K_ROUTER_SIG_ED25519</b>, 
<b>K_IDENTITY_ED25519</b>, 
<b>K_MASTER_KEY_ED25519</b>, 
<br />
&#160;&#160;<b>K_ONION_KEY_CROSSCERT</b>, 
<b>K_NTOR_ONION_KEY_CROSSCERT</b>, 
<b>K_DIRREQ_END</b>, 
<b>K_DIRREQ_V2_IPS</b>, 
<br />
&#160;&#160;<b>K_DIRREQ_V3_IPS</b>, 
<b>K_DIRREQ_V2_REQS</b>, 
<b>K_DIRREQ_V3_REQS</b>, 
<b>K_DIRREQ_V2_SHARE</b>, 
<br />
&#160;&#160;<b>K_DIRREQ_V3_SHARE</b>, 
<b>K_DIRREQ_V2_RESP</b>, 
<b>K_DIRREQ_V3_RESP</b>, 
<b>K_DIRREQ_V2_DIR</b>, 
<br />
&#160;&#160;<b>K_DIRREQ_V3_DIR</b>, 
<b>K_DIRREQ_V2_TUN</b>, 
<b>K_DIRREQ_V3_TUN</b>, 
<b>K_ENTRY_END</b>, 
<br />
&#160;&#160;<b>K_ENTRY_IPS</b>, 
<b>K_CELL_END</b>, 
<b>K_CELL_PROCESSED</b>, 
<b>K_CELL_QUEUED</b>, 
<br />
&#160;&#160;<b>K_CELL_TIME</b>, 
<b>K_CELL_CIRCS</b>, 
<b>K_EXIT_END</b>, 
<b>K_EXIT_WRITTEN</b>, 
<br />
&#160;&#160;<b>K_EXIT_READ</b>, 
<b>K_EXIT_OPENED</b>, 
<b>K_DIR_KEY_CERTIFICATE_VERSION</b>, 
<b>K_DIR_IDENTITY_KEY</b>, 
<br />
&#160;&#160;<b>K_DIR_KEY_PUBLISHED</b>, 
<b>K_DIR_KEY_EXPIRES</b>, 
<b>K_DIR_KEY_CERTIFICATION</b>, 
<b>K_DIR_KEY_CROSSCERT</b>, 
<br />
&#160;&#160;<b>K_DIR_ADDRESS</b>, 
<b>K_DIR_TUNNELLED</b>, 
<b>K_VOTE_STATUS</b>, 
<b>K_VALID_AFTER</b>, 
<br />
&#160;&#160;<b>K_FRESH_UNTIL</b>, 
<b>K_VALID_UNTIL</b>, 
<b>K_VOTING_DELAY</b>, 
<b>K_KNOWN_FLAGS</b>, 
<br />
&#160;&#160;<b>K_PARAMS</b>, 
<b>K_BW_WEIGHTS</b>, 
<b>K_VOTE_DIGEST</b>, 
<b>K_CONSENSUS_DIGEST</b>, 
<br />
&#160;&#160;<b>K_ADDITIONAL_DIGEST</b>, 
<b>K_ADDITIONAL_SIGNATURE</b>, 
<b>K_CONSENSUS_METHODS</b>, 
<b>K_CONSENSUS_METHOD</b>, 
<br />
&#160;&#160;<b>K_LEGACY_DIR_KEY</b>, 
<b>K_DIRECTORY_FOOTER</b>, 
<b>K_SIGNING_CERT_ED</b>, 
<b>K_SR_FLAG</b>, 
<br />
&#160;&#160;<b>K_COMMIT</b>, 
<b>K_PREVIOUS_SRV</b>, 
<b>K_CURRENT_SRV</b>, 
<b>K_PACKAGE</b>, 
<br />
&#160;&#160;<b>A_PURPOSE</b>, 
<b>A_LAST_LISTED</b>, 
<b>A_UNKNOWN_</b>, 
<b>R_RENDEZVOUS_SERVICE_DESCRIPTOR</b>, 
<br />
&#160;&#160;<b>R_VERSION</b>, 
<b>R_PERMANENT_KEY</b>, 
<b>R_SECRET_ID_PART</b>, 
<b>R_PUBLICATION_TIME</b>, 
<br />
&#160;&#160;<b>R_PROTOCOL_VERSIONS</b>, 
<b>R_INTRODUCTION_POINTS</b>, 
<b>R_SIGNATURE</b>, 
<b>R_IPO_IDENTIFIER</b>, 
<br />
&#160;&#160;<b>R_IPO_IP_ADDRESS</b>, 
<b>R_IPO_ONION_PORT</b>, 
<b>R_IPO_ONION_KEY</b>, 
<b>R_IPO_SERVICE_KEY</b>, 
<br />
&#160;&#160;<b>C_CLIENT_NAME</b>, 
<b>C_DESCRIPTOR_COOKIE</b>, 
<b>C_CLIENT_KEY</b>, 
<b>ERR_</b>, 
<br />
&#160;&#160;<b>EOF_</b>, 
<b>NIL_</b>
<br />
 }</td></tr>
<tr class="separator:ab1bde6077f822b75a2b4d3916aa53014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf3587e2ef140d0c28a664dce0d701ca"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701ca">obj_syntax</a> { <br />
&#160;&#160;<a class="el" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa96edd6efecfc4c1078cfd69961fd88de">NO_OBJ</a>, 
<a class="el" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caacdb0e1cfa06c47be275e0473804a1f75">NEED_OBJ</a>, 
<a class="el" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa020c823722acaad64c7b47c03dedcfb0">NEED_SKEY_1024</a>, 
<a class="el" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caaf9e55fe241c5b953d9c74bb51aa9344c">NEED_KEY_1024</a>, 
<br />
&#160;&#160;<a class="el" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa02e17140fecda61f5c4cb30c053dbc40">NEED_KEY</a>, 
<a class="el" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa632e902e7d2c9955c96b1876eca68589">OBJ_OK</a>
<br />
 }</td></tr>
<tr class="separator:aaf3587e2ef140d0c28a664dce0d701ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a87185b16e92ff1ca520cd5293c20531d"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a87185b16e92ff1ca520cd5293c20531d">dump_desc_fifo_cleanup</a> (void)</td></tr>
<tr class="separator:a87185b16e92ff1ca520cd5293c20531d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a8bb1810ff691f0bf5f99301b975242"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a2a8bb1810ff691f0bf5f99301b975242">MOCK_IMPL</a> (STATIC dumped_desc_t *, dump_desc_populate_one_file,(const char *dirname, const char *f))</td></tr>
<tr class="separator:a2a8bb1810ff691f0bf5f99301b975242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00034876736f1a369464efde04b892ea"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a00034876736f1a369464efde04b892ea">dump_desc_populate_fifo_from_directory</a> (const char *dirname)</td></tr>
<tr class="separator:a00034876736f1a369464efde04b892ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed319ab6887b0eb56eff46fd83684017"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#aed319ab6887b0eb56eff46fd83684017">dump_desc</a> (const char *desc, const char *type)</td></tr>
<tr class="separator:aed319ab6887b0eb56eff46fd83684017"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9c94e2b40578dbed4b4e38a5ebe2c65"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#ae9c94e2b40578dbed4b4e38a5ebe2c65">router_get_dir_hash</a> (const char *s, char *digest)</td></tr>
<tr class="separator:ae9c94e2b40578dbed4b4e38a5ebe2c65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88a39471f268a31b09e1677d5e57506a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a88a39471f268a31b09e1677d5e57506a">router_get_router_hash</a> (const char *s, size_t s_len, char *digest)</td></tr>
<tr class="separator:a88a39471f268a31b09e1677d5e57506a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6105fa03c7a751d474a380de5016360b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a6105fa03c7a751d474a380de5016360b">router_get_networkstatus_v3_hashes</a> (const char *s, <a class="el" href="structcommon__digests__t.html">common_digests_t</a> *digests)</td></tr>
<tr class="separator:a6105fa03c7a751d474a380de5016360b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38ef1e01c3b561811bc4bd4f0777eb3e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a38ef1e01c3b561811bc4bd4f0777eb3e">router_get_extrainfo_hash</a> (const char *s, size_t s_len, char *digest)</td></tr>
<tr class="separator:a38ef1e01c3b561811bc4bd4f0777eb3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada91c927ebf9cb2a3b92b285198f172a"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#ada91c927ebf9cb2a3b92b285198f172a">router_get_dirobj_signature</a> (const char *digest, size_t digest_len, const <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *private_key)</td></tr>
<tr class="separator:ada91c927ebf9cb2a3b92b285198f172a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a594cb966cbb2893822d931ffe955b53d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a594cb966cbb2893822d931ffe955b53d">router_append_dirobj_signature</a> (char *buf, size_t buf_len, const char *digest, size_t digest_len, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *private_key)</td></tr>
<tr class="separator:a594cb966cbb2893822d931ffe955b53d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef22cc5550ef14cb0cf8fd3bca4dbd69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="or_8h.html#a00fd54618330b1d6b76e7571d84d90ce">version_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#aef22cc5550ef14cb0cf8fd3bca4dbd69">tor_version_is_obsolete</a> (const char *myversion, const char *versionlist)</td></tr>
<tr class="separator:aef22cc5550ef14cb0cf8fd3bca4dbd69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a258ef1ce82ccf0fe39682829018a749e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a258ef1ce82ccf0fe39682829018a749e">router_parse_list_from_string</a> (const char **s, const char *eos, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *dest, <a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a> saved_location, int want_extrainfo, int allow_annotations, const char *prepend_annotations, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *invalid_digests_out)</td></tr>
<tr class="separator:a258ef1ce82ccf0fe39682829018a749e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae652ccb5411f5cb5eae101cd26ac4d6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#ae652ccb5411f5cb5eae101cd26ac4d6b">dump_distinct_digest_count</a> (int severity)</td></tr>
<tr class="separator:ae652ccb5411f5cb5eae101cd26ac4d6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ed67129e89fe64d2f329a1e94063f48"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrouterinfo__t.html">routerinfo_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a6ed67129e89fe64d2f329a1e94063f48">router_parse_entry_from_string</a> (const char *s, const char *end, int cache_copy, int allow_annotations, const char *prepend_annotations, int *can_dl_again_out)</td></tr>
<tr class="separator:a6ed67129e89fe64d2f329a1e94063f48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c7183356964eccb2338e4ce2c80eb36"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structextrainfo__t.html">extrainfo_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a5c7183356964eccb2338e4ce2c80eb36">extrainfo_parse_entry_from_string</a> (const char *s, const char *end, int cache_copy, struct digest_ri_map_t *routermap, int *can_dl_again_out)</td></tr>
<tr class="separator:a5c7183356964eccb2338e4ce2c80eb36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e030201d6bc0307036313ed138a0b63"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structauthority__cert__t.html">authority_cert_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a6e030201d6bc0307036313ed138a0b63">authority_cert_parse_from_string</a> (const char *s, const char **end_of_string)</td></tr>
<tr class="separator:a6e030201d6bc0307036313ed138a0b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5182e7b61c8640ef94186a19760d90c"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#aa5182e7b61c8640ef94186a19760d90c">routerstatus_parse_guardfraction</a> (const char *guardfraction_str, <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *vote, <a class="el" href="structvote__routerstatus__t.html">vote_routerstatus_t</a> *vote_rs, <a class="el" href="structrouterstatus__t.html">routerstatus_t</a> *rs)</td></tr>
<tr class="separator:aa5182e7b61c8640ef94186a19760d90c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a894e0e7f9cc445e418328701266572ca"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="structrouterstatus__t.html">routerstatus_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a894e0e7f9cc445e418328701266572ca">routerstatus_parse_entry_from_string</a> (<a class="el" href="structmemarea__t.html">memarea_t</a> *area, const char **s, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *tokens, <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *vote, <a class="el" href="structvote__routerstatus__t.html">vote_routerstatus_t</a> *vote_rs, int consensus_method, <a class="el" href="or_8h.html#ada0879620550843533b891a49543b109">consensus_flavor_t</a> flav)</td></tr>
<tr class="separator:a894e0e7f9cc445e418328701266572ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9d5e58f345dc2f0f63a9ca03d025d1f"><td class="memItemLeft" align="right" valign="top"><a id="ab9d5e58f345dc2f0f63a9ca03d025d1f"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>compare_vote_routerstatus_entries</b> (const void **_a, const void **_b)</td></tr>
<tr class="separator:ab9d5e58f345dc2f0f63a9ca03d025d1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a318846a3f10eacf7fe55df71d9f509f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a318846a3f10eacf7fe55df71d9f509f7">networkstatus_verify_bw_weights</a> (<a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *ns, int consensus_method)</td></tr>
<tr class="separator:a318846a3f10eacf7fe55df71d9f509f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65f051065986f87c9969726c07d761be"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a65f051065986f87c9969726c07d761be">networkstatus_parse_vote_from_string</a> (const char *s, const char **eos_out, <a class="el" href="or_8h.html#a4cc3535cd1c60e55a79683e1b3ae8814">networkstatus_type_t</a> ns_type)</td></tr>
<tr class="separator:a65f051065986f87c9969726c07d761be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37b894a8c8b42685b0f542ea86dc42ff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structns__detached__signatures__t.html">ns_detached_signatures_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a37b894a8c8b42685b0f542ea86dc42ff">networkstatus_parse_detached_signatures</a> (const char *s, const char *eos)</td></tr>
<tr class="separator:a37b894a8c8b42685b0f542ea86dc42ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65294e0f578a21d0e10431bf4ef1d038"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a65294e0f578a21d0e10431bf4ef1d038">MOCK_IMPL</a> (<a class="el" href="structaddr__policy__t.html">addr_policy_t</a> *, router_parse_addr_policy_item_from_string,(const char *s, int assume_action, int *malformed_list))</td></tr>
<tr class="separator:a65294e0f578a21d0e10431bf4ef1d038"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63f57b5cfc965a1ff91680f19b5d833e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a63f57b5cfc965a1ff91680f19b5d833e">assert_addr_policy_ok</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *lst)</td></tr>
<tr class="separator:a63f57b5cfc965a1ff91680f19b5d833e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfc52ced95cf906593bbdab812e1cd8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#abfc52ced95cf906593bbdab812e1cd8e">microdescs_parse_from_string</a> (const char *s, const char *eos, int allow_annotations, <a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a> where, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *invalid_digests_out)</td></tr>
<tr class="separator:abfc52ced95cf906593bbdab812e1cd8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dfff3debca0046c946d947c8c0a922f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a7dfff3debca0046c946d947c8c0a922f">tor_version_parse_platform</a> (const char *platform, <a class="el" href="structtor__version__t.html">tor_version_t</a> *router_version, int strict)</td></tr>
<tr class="separator:a7dfff3debca0046c946d947c8c0a922f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34e1f6d4f6429bcf1d565f54a1dfcd5c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a34e1f6d4f6429bcf1d565f54a1dfcd5c">tor_version_as_new_as</a> (const char *platform, const char *cutoff)</td></tr>
<tr class="separator:a34e1f6d4f6429bcf1d565f54a1dfcd5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace4c11b51ca67a4f140ed41ae3d47b6d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#ace4c11b51ca67a4f140ed41ae3d47b6d">tor_version_parse</a> (const char *s, <a class="el" href="structtor__version__t.html">tor_version_t</a> *out)</td></tr>
<tr class="separator:ace4c11b51ca67a4f140ed41ae3d47b6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86ae08e44b4d585ae18040e96e98a92c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a86ae08e44b4d585ae18040e96e98a92c">tor_version_compare</a> (<a class="el" href="structtor__version__t.html">tor_version_t</a> *a, <a class="el" href="structtor__version__t.html">tor_version_t</a> *b)</td></tr>
<tr class="separator:a86ae08e44b4d585ae18040e96e98a92c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed569b83c27fc31ecf6c7aa2af2751d7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#aed569b83c27fc31ecf6c7aa2af2751d7">tor_version_same_series</a> (<a class="el" href="structtor__version__t.html">tor_version_t</a> *a, <a class="el" href="structtor__version__t.html">tor_version_t</a> *b)</td></tr>
<tr class="separator:aed569b83c27fc31ecf6c7aa2af2751d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54739e9600d1d7d0941e77c8ddc53970"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a54739e9600d1d7d0941e77c8ddc53970">sort_version_list</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *versions, int remove_duplicates)</td></tr>
<tr class="separator:a54739e9600d1d7d0941e77c8ddc53970"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2faba4db0eeeb6f97d9ba56983390b37"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a2faba4db0eeeb6f97d9ba56983390b37">rend_parse_v2_service_descriptor</a> (<a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> **parsed_out, char *desc_id_out, char **intro_points_encrypted_out, size_t *intro_points_encrypted_size_out, size_t *encoded_size_out, const char **next_out, const char *desc, int as_hsdir)</td></tr>
<tr class="separator:a2faba4db0eeeb6f97d9ba56983390b37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ece24495c2fa4a93440cc849e6a0702"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a7ece24495c2fa4a93440cc849e6a0702">rend_decrypt_introduction_points</a> (char **ipos_decrypted, size_t *ipos_decrypted_size, const char *descriptor_cookie, const char *ipos_encrypted, size_t ipos_encrypted_size)</td></tr>
<tr class="separator:a7ece24495c2fa4a93440cc849e6a0702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23b22c9a5a626774e68f0c7678221028"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a23b22c9a5a626774e68f0c7678221028">rend_parse_introduction_points</a> (<a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> *parsed, const char *intro_points_encoded, size_t intro_points_encoded_size)</td></tr>
<tr class="separator:a23b22c9a5a626774e68f0c7678221028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bceb114ff28749f6890038b2b18849d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a6bceb114ff28749f6890038b2b18849d">rend_parse_client_keys</a> (strmap_t *parsed_clients, const char *ckstr)</td></tr>
<tr class="separator:a6bceb114ff28749f6890038b2b18849d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ca055512bee2e709f53a889cd2dd84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#ab4ca055512bee2e709f53a889cd2dd84">routerparse_init</a> (void)</td></tr>
<tr class="separator:ab4ca055512bee2e709f53a889cd2dd84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa960633d43eaf0a653b3d45d9e7e5f92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#aa960633d43eaf0a653b3d45d9e7e5f92">routerparse_free_all</a> (void)</td></tr>
<tr class="separator:aa960633d43eaf0a653b3d45d9e7e5f92"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a45a515fe3fac61539ae2eeb8e7e1fcb3"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#a45a515fe3fac61539ae2eeb8e7e1fcb3">descs_dumped</a> = NULL</td></tr>
<tr class="separator:a45a515fe3fac61539ae2eeb8e7e1fcb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed5330a26e9738c12e49ecf033de49f3"><td class="memItemLeft" align="right" valign="top">STATIC uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8c.html#aed5330a26e9738c12e49ecf033de49f3">len_descs_dumped</a> = 0</td></tr>
<tr class="separator:aed5330a26e9738c12e49ecf033de49f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Code to parse and validate router descriptors, consenus directories, and similar objects. </p>
<p>The objects parsed by this module use a common text-based metaformat, documented in dir-spec.txt in torspec.git. This module is itself divided into two major kinds of function: code to handle the metaformat, and code to convert from particular instances of the metaformat into the objects that Tor uses.</p>
<p>The generic parsing code works by calling a table-based tokenizer on the input string. Each token corresponds to a single line with a token, plus optional arguments on that line, plus an optional base-64 encoded object after that line. Each token has a definition in a table of <a class="el" href="structtoken__rule__t.html">token_rule_t</a> entries that describes how many arguments it can take, whether it takes an object, how many times it may appear, whether it must appear first, and so on.</p>
<p>The tokenizer function tokenize_string() converts its string input into a smartlist full of instances of <a class="el" href="structdirectory__token__t.html">directory_token_t</a>, according to a provided table of <a class="el" href="structtoken__rule__t.html">token_rule_t</a>.</p>
<p>The generic parts of this module additionally include functions for finding the start and end of signed information inside a signed object, and computing the digest that will be signed.</p>
<p>There are also functions for saving objects to disk that have caused parsing to fail.</p>
<p>The specific parts of this module describe conversions between particular lists of <a class="el" href="structdirectory__token__t.html">directory_token_t</a> and particular objects. The kinds of objects that can be parsed here are: </p><ul>
<li>
router descriptors (managed from <a class="el" href="routerlist_8c.html" title="Code to maintain and access the global list of routerinfos for known servers. ">routerlist.c</a>) </li>
<li>
extra-info documents (managed from <a class="el" href="routerlist_8c.html" title="Code to maintain and access the global list of routerinfos for known servers. ">routerlist.c</a>) </li>
<li>
microdescriptors (managed from <a class="el" href="microdesc_8c.html" title="Implements microdescriptors – an abbreviated description of less-frequently-changing router informat...">microdesc.c</a>) </li>
<li>
vote and consensus networkstatus documents, and the <a class="el" href="structrouterstatus__t.html">routerstatus_t</a> objects that they comprise (managed from <a class="el" href="networkstatus_8c.html" title="Functions and structures for handling network status documents as a client or cache. ">networkstatus.c</a>) </li>
<li>
detached-signature objects used by authorities for gathering signatures on the networkstatus consensus (managed from <a class="el" href="dirvote_8c.html" title="Functions to compute directory consensus, and schedule voting. ">dirvote.c</a>) </li>
<li>
authority key certificates (managed from <a class="el" href="routerlist_8c.html" title="Code to maintain and access the global list of routerinfos for known servers. ">routerlist.c</a>) </li>
<li>
hidden service descriptors (managed from <a class="el" href="rendcommon_8c.html" title="Rendezvous implementation: shared code between introducers, services, clients, and rendezvous points...">rendcommon.c</a> and <a class="el" href="rendcache_8c.html" title="Hidden service descriptor cache. ">rendcache.c</a>) </li>
</ul>
<p>For no terribly good reason, the functions to <em>generate</em> signatures on the above directory objects are also in this module. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a2e792cb84995596a3ac229a4eeee6808"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e792cb84995596a3ac229a4eeee6808">&#9670;&nbsp;</a></span>A01</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define A01</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{ s, t, a, o, 0, 1, 0, 1 }</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An annotation that must appear no more than once </p>

</div>
</div>
<a id="aff1b09d6630c6c0942f78171e74c1b9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff1b09d6630c6c0942f78171e74c1b9d">&#9670;&nbsp;</a></span>ARGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARGS&#160;&#160;&#160;0,INT_MAX,0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Argument multiplicity: any number of arguments. </p>

</div>
</div>
<a id="a2876ecfd8a6f0d2f899d55b86c534462"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2876ecfd8a6f0d2f899d55b86c534462">&#9670;&nbsp;</a></span>CERTIFICATE_MEMBERS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CERTIFICATE_MEMBERS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><a class="code" href="routerparse_8c.html#ae6aad5272b3293c0c2da05040c987f82">T1</a>(<span class="stringliteral">&quot;dir-key-certificate-version&quot;</span>, K_DIR_KEY_CERTIFICATE_VERSION,           \</div><div class="line">                                                     <a class="code" href="routerparse_8c.html#ac99d0223594938476212e184082954fc">GE</a>(1),       <a class="code" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa96edd6efecfc4c1078cfd69961fd88de">NO_OBJ</a> ),  \</div><div class="line">  T1(<span class="stringliteral">&quot;dir-identity-key&quot;</span>, K_DIR_IDENTITY_KEY,         <a class="code" href="routerparse_8c.html#a110201fc08b08c73366dbaf433bb8e89">NO_ARGS</a>,     <a class="code" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa02e17140fecda61f5c4cb30c053dbc40">NEED_KEY</a> ),\</div><div class="line">  T1(<span class="stringliteral">&quot;dir-key-published&quot;</span>,K_DIR_KEY_PUBLISHED,        <a class="code" href="routerparse_8c.html#ac9b24fa99a331d88ec53d9a421bfa49b">CONCAT_ARGS</a>, <a class="code" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa96edd6efecfc4c1078cfd69961fd88de">NO_OBJ</a>),   \</div><div class="line">  T1(<span class="stringliteral">&quot;dir-key-expires&quot;</span>,  K_DIR_KEY_EXPIRES,          <a class="code" href="routerparse_8c.html#ac9b24fa99a331d88ec53d9a421bfa49b">CONCAT_ARGS</a>, <a class="code" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa96edd6efecfc4c1078cfd69961fd88de">NO_OBJ</a>),   \</div><div class="line">  T1(<span class="stringliteral">&quot;dir-signing-key&quot;</span>,  K_DIR_SIGNING_KEY,          <a class="code" href="routerparse_8c.html#a110201fc08b08c73366dbaf433bb8e89">NO_ARGS</a>,     <a class="code" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa02e17140fecda61f5c4cb30c053dbc40">NEED_KEY</a> ),\</div><div class="line">  T1(<span class="stringliteral">&quot;dir-key-crosscert&quot;</span>, K_DIR_KEY_CROSSCERT,       <a class="code" href="routerparse_8c.html#a110201fc08b08c73366dbaf433bb8e89">NO_ARGS</a>,     <a class="code" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caacdb0e1cfa06c47be275e0473804a1f75">NEED_OBJ</a> ),\</div><div class="line">  T1(<span class="stringliteral">&quot;dir-key-certification&quot;</span>, K_DIR_KEY_CERTIFICATION,                       \</div><div class="line">                                                     <a class="code" href="routerparse_8c.html#a110201fc08b08c73366dbaf433bb8e89">NO_ARGS</a>,     <a class="code" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caacdb0e1cfa06c47be275e0473804a1f75">NEED_OBJ</a>), \</div><div class="line">  T01(<span class="stringliteral">&quot;dir-address&quot;</span>,     K_DIR_ADDRESS,              <a class="code" href="routerparse_8c.html#ac99d0223594938476212e184082954fc">GE</a>(1),       <a class="code" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa96edd6efecfc4c1078cfd69961fd88de">NO_OBJ</a>),</div><div class="ttc" id="routerparse_8c_html_aaf3587e2ef140d0c28a664dce0d701caa02e17140fecda61f5c4cb30c053dbc40"><div class="ttname"><a href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa02e17140fecda61f5c4cb30c053dbc40">NEED_KEY</a></div><div class="ttdef"><b>Definition:</b> routerparse.c:272</div></div>
<div class="ttc" id="routerparse_8c_html_a110201fc08b08c73366dbaf433bb8e89"><div class="ttname"><a href="routerparse_8c.html#a110201fc08b08c73366dbaf433bb8e89">NO_ARGS</a></div><div class="ttdeci">#define NO_ARGS</div><div class="ttdef"><b>Definition:</b> routerparse.c:336</div></div>
<div class="ttc" id="routerparse_8c_html_ac9b24fa99a331d88ec53d9a421bfa49b"><div class="ttname"><a href="routerparse_8c.html#ac9b24fa99a331d88ec53d9a421bfa49b">CONCAT_ARGS</a></div><div class="ttdeci">#define CONCAT_ARGS</div><div class="ttdef"><b>Definition:</b> routerparse.c:338</div></div>
<div class="ttc" id="routerparse_8c_html_ac99d0223594938476212e184082954fc"><div class="ttname"><a href="routerparse_8c.html#ac99d0223594938476212e184082954fc">GE</a></div><div class="ttdeci">#define GE(n)</div><div class="ttdef"><b>Definition:</b> routerparse.c:340</div></div>
<div class="ttc" id="routerparse_8c_html_aaf3587e2ef140d0c28a664dce0d701caa96edd6efecfc4c1078cfd69961fd88de"><div class="ttname"><a href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa96edd6efecfc4c1078cfd69961fd88de">NO_OBJ</a></div><div class="ttdef"><b>Definition:</b> routerparse.c:268</div></div>
<div class="ttc" id="routerparse_8c_html_ae6aad5272b3293c0c2da05040c987f82"><div class="ttname"><a href="routerparse_8c.html#ae6aad5272b3293c0c2da05040c987f82">T1</a></div><div class="ttdeci">#define T1(s, t, a, o)</div><div class="ttdef"><b>Definition:</b> routerparse.c:321</div></div>
<div class="ttc" id="routerparse_8c_html_aaf3587e2ef140d0c28a664dce0d701caacdb0e1cfa06c47be275e0473804a1f75"><div class="ttname"><a href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caacdb0e1cfa06c47be275e0473804a1f75">NEED_OBJ</a></div><div class="ttdef"><b>Definition:</b> routerparse.c:269</div></div>
</div><!-- fragment --><p>List of tokens common to V3 authority certificates and V3 consensuses. </p>

</div>
</div>
<a id="a0f2aa73b748fc53ad4ed33105addab3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f2aa73b748fc53ad4ed33105addab3c">&#9670;&nbsp;</a></span>CHECK_LENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECK_LENGTH</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">STMT_BEGIN \</div><div class="line">    if (s+32 &gt; eos)               \</div><div class="line">      return NULL;                \</div><div class="line">  STMT_END</div></div><!-- fragment -->
</div>
</div>
<a id="aed703b01b922c16fc2e6653b18b96a03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed703b01b922c16fc2e6653b18b96a03">&#9670;&nbsp;</a></span>CMP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">field</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                               \</div><div class="line">    unsigned aval = (unsigned) a-&gt;field;              \</div><div class="line">    <span class="keywordtype">unsigned</span> bval = (<span class="keywordtype">unsigned</span>) b-&gt;field;              \</div><div class="line">    int result = (int) (aval - bval);                 \</div><div class="line">    if (result &lt; 0)                                   \</div><div class="line">      return -1;                                      \</div><div class="line">    else <span class="keywordflow">if</span> (result &gt; 0)                              \</div><div class="line">      return 1;                                       \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div></div><!-- fragment -->
</div>
</div>
<a id="ac9b24fa99a331d88ec53d9a421bfa49b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9b24fa99a331d88ec53d9a421bfa49b">&#9670;&nbsp;</a></span>CONCAT_ARGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONCAT_ARGS&#160;&#160;&#160;1,1,1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Argument multiplicity: concatenate all arguments. </p>

</div>
</div>
<a id="a58094c9d9e60820923633a753f7a9b3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58094c9d9e60820923633a753f7a9b3f">&#9670;&nbsp;</a></span>DOT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DOT</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                                          \</div><div class="line">    if (*cp != <span class="charliteral">&#39;.&#39;</span>)                             \</div><div class="line">      return -1;                                \</div><div class="line">    ++cp;                                       \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div></div><!-- fragment -->
</div>
</div>
<a id="af8968fb550fc29e699e69eee215fa8c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8968fb550fc29e699e69eee215fa8c5">&#9670;&nbsp;</a></span>END_OF_TABLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define END_OF_TABLE&#160;&#160;&#160;{ NULL, NIL_, 0,0,0, <a class="el" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701caa96edd6efecfc4c1078cfd69961fd88de">NO_OBJ</a>, 0, INT_MAX, 0, 0 }</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Appears to indicate the end of a table. </p>

</div>
</div>
<a id="aeb5fffc954e58891b5408914f7560611"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb5fffc954e58891b5408914f7560611">&#9670;&nbsp;</a></span>EQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EQ</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n</td><td>)</td>
          <td>&#160;&#160;&#160;n,n,0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Argument multiplicity: exactly <b>n</b> arguments. </p>

</div>
</div>
<a id="ac99d0223594938476212e184082954fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac99d0223594938476212e184082954fc">&#9670;&nbsp;</a></span>GE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n</td><td>)</td>
          <td>&#160;&#160;&#160;n,INT_MAX,0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Argument multiplicity: at least <b>n</b> arguments. </p>

</div>
</div>
<a id="a4667583c6e310db5d8f20c601607f2de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4667583c6e310db5d8f20c601607f2de">&#9670;&nbsp;</a></span>NEXT_LINE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NEXT_LINE</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">STMT_BEGIN            \</div><div class="line">    s = memchr(s, <span class="charliteral">&#39;\n&#39;</span>, eos-s);           \</div><div class="line">    if (!s || s+1 &gt;= eos)                 \</div><div class="line">      return NULL;                        \</div><div class="line">    s++;                                  \</div><div class="line">  STMT_END</div></div><!-- fragment -->
</div>
</div>
<a id="a110201fc08b08c73366dbaf433bb8e89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a110201fc08b08c73366dbaf433bb8e89">&#9670;&nbsp;</a></span>NO_ARGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NO_ARGS&#160;&#160;&#160;0,0,0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Argument multiplicity: no arguments. </p>

</div>
</div>
<a id="acee98c0946da0a18c3164f1df9328e7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acee98c0946da0a18c3164f1df9328e7b">&#9670;&nbsp;</a></span>NUMBER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUMBER</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                                          \</div><div class="line">    if (!cp || *cp &lt; &#39;0&#39; || *cp &gt; <span class="charliteral">&#39;9&#39;</span>)          \</div><div class="line">      return -1;                                \</div><div class="line">    out-&gt;m = (int)<a class="code" href="util_8c.html#a0fa6261bbc231af861f420e8411e0f03">tor_parse_uint64</a>(cp, 10, 0, INT32_MAX, &amp;ok, &amp;eos);    \</div><div class="line">    if (!ok)                                    \</div><div class="line">      return -1;                                \</div><div class="line">    if (!eos || eos == cp)                      \</div><div class="line">      return -1;                                \</div><div class="line">    cp = eos;                                   \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div><div class="ttc" id="util_8c_html_a0fa6261bbc231af861f420e8411e0f03"><div class="ttname"><a href="util_8c.html#a0fa6261bbc231af861f420e8411e0f03">tor_parse_uint64</a></div><div class="ttdeci">uint64_t tor_parse_uint64(const char *s, int base, uint64_t min, uint64_t max, int *ok, char **next)</div><div class="ttdef"><b>Definition:</b> util.c:1215</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a03aec34c81d48472c37bfa009b8ba804"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03aec34c81d48472c37bfa009b8ba804">&#9670;&nbsp;</a></span>RET_ERR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RET_ERR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">msg</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">STMT_BEGIN                                                       \</div><div class="line">    if (tok) token_clear(tok);                                      \</div><div class="line">    tok = ALLOC_ZERO(<span class="keyword">sizeof</span>(<a class="code" href="structdirectory__token__t.html">directory_token_t</a>));                   \</div><div class="line">    tok-&gt;tp = ERR_;                                                \</div><div class="line">    tok-&gt;error = STRDUP(msg);                                      \</div><div class="line">    goto done_tokenizing;                                          \</div><div class="line">  STMT_END</div><div class="ttc" id="structdirectory__token__t_html"><div class="ttname"><a href="structdirectory__token__t.html">directory_token_t</a></div><div class="ttdef"><b>Definition:</b> routerparse.c:248</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab691bd2eed9864879c6f851bda3168a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab691bd2eed9864879c6f851bda3168a8">&#9670;&nbsp;</a></span>T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{ s, t, a, o, 0, INT_MAX, 0, 0 }</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An item with no restrictions: used for obsolete document types </p>

</div>
</div>
<a id="a06e4c394dcac68b8298bb91a25a300fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06e4c394dcac68b8298bb91a25a300fa">&#9670;&nbsp;</a></span>T01</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T01</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{ s, t, a, o, 0, 1, 0, 0 }</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An item that must appear no more than once </p>

</div>
</div>
<a id="a00a2dd52132434068cae97fae79051c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00a2dd52132434068cae97fae79051c1">&#9670;&nbsp;</a></span>T0N</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T0N</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{ s, t, a, o, 0, INT_MAX, 0, 0 }</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An item with no restrictions on multiplicity or location. </p>

</div>
</div>
<a id="ae6aad5272b3293c0c2da05040c987f82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6aad5272b3293c0c2da05040c987f82">&#9670;&nbsp;</a></span>T1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T1</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{ s, t, a, o, 1, 1, 0, 0 }</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An item that must appear exactly once </p>

</div>
</div>
<a id="a3ccf1009187481033960804159f74c22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ccf1009187481033960804159f74c22">&#9670;&nbsp;</a></span>T1_END</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T1_END</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{ s, t, a, o, 1, 1, AT_END, 0 }</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An item that must appear exactly once, at the end of the document </p>

</div>
</div>
<a id="abdd7cf17519f7b27cb4a09e3490f87cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdd7cf17519f7b27cb4a09e3490f87cc">&#9670;&nbsp;</a></span>T1_START</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T1_START</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{ s, t, a, o, 1, 1, AT_START, 0 }</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An item that must appear exactly once, at the start of the document </p>

</div>
</div>
<a id="ac663434e84c1e6f83ac2bc6405c0dce6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac663434e84c1e6f83ac2bc6405c0dce6">&#9670;&nbsp;</a></span>T1N</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T1N</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{ s, t, a, o, 1, INT_MAX, 0, 0 }</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An item that must appear one or more times </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="aeb0504130fd2814d23600fbc91e2f6e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb0504130fd2814d23600fbc91e2f6e9">&#9670;&nbsp;</a></span>directory_token_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structdirectory__token__t.html">directory_token_t</a>  <a class="el" href="structdirectory__token__t.html">directory_token_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Structure to hold a single directory token.</p>
<p>We parse a directory by breaking it into "tokens", each consisting of a keyword, a line full of arguments, and a binary object. The arguments and object are both optional, depending on the keyword type.</p>
<p>This structure is only allocated in memareas; do not allocate it on the heap, or token_clear() won't work. </p>

</div>
</div>
<a id="af400135e5b32b3935b819247e4b65d30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af400135e5b32b3935b819247e4b65d30">&#9670;&nbsp;</a></span>token_rule_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structtoken__rule__t.html">token_rule_t</a>  <a class="el" href="structtoken__rule__t.html">token_rule_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determines the parsing rules for a single token type. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ab1bde6077f822b75a2b4d3916aa53014"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1bde6077f822b75a2b4d3916aa53014">&#9670;&nbsp;</a></span>directory_keyword</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="routerparse_8c.html#ab1bde6077f822b75a2b4d3916aa53014">directory_keyword</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enumeration of possible token types. The ones starting with K_ correspond to directory 'keywords'. A_ is for an annotation, R or C is related to hidden services, ERR_ is an error in the tokenizing process, EOF_ is an end-of-file marker, and NIL_ is used to encode not-a-token. </p>

</div>
</div>
<a id="aaf3587e2ef140d0c28a664dce0d701ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf3587e2ef140d0c28a664dce0d701ca">&#9670;&nbsp;</a></span>obj_syntax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="routerparse_8c.html#aaf3587e2ef140d0c28a664dce0d701ca">obj_syntax</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We use a table of rules to decide how to parse each token type. Rules for whether the keyword needs an object. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aaf3587e2ef140d0c28a664dce0d701caa96edd6efecfc4c1078cfd69961fd88de"></a>NO_OBJ&#160;</td><td class="fielddoc"><p>No object, ever. </p>
</td></tr>
<tr><td class="fieldname"><a id="aaf3587e2ef140d0c28a664dce0d701caacdb0e1cfa06c47be275e0473804a1f75"></a>NEED_OBJ&#160;</td><td class="fielddoc"><p>Object is required. </p>
</td></tr>
<tr><td class="fieldname"><a id="aaf3587e2ef140d0c28a664dce0d701caa020c823722acaad64c7b47c03dedcfb0"></a>NEED_SKEY_1024&#160;</td><td class="fielddoc"><p>Object is required, and must be a 1024 bit private key </p>
</td></tr>
<tr><td class="fieldname"><a id="aaf3587e2ef140d0c28a664dce0d701caaf9e55fe241c5b953d9c74bb51aa9344c"></a>NEED_KEY_1024&#160;</td><td class="fielddoc"><p>Object is required, and must be a 1024 bit public key </p>
</td></tr>
<tr><td class="fieldname"><a id="aaf3587e2ef140d0c28a664dce0d701caa02e17140fecda61f5c4cb30c053dbc40"></a>NEED_KEY&#160;</td><td class="fielddoc"><p>Object is required, and must be a public key. </p>
</td></tr>
<tr><td class="fieldname"><a id="aaf3587e2ef140d0c28a664dce0d701caa632e902e7d2c9955c96b1876eca68589"></a>OBJ_OK&#160;</td><td class="fielddoc"><p>Object is optional. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a63f57b5cfc965a1ff91680f19b5d833e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63f57b5cfc965a1ff91680f19b5d833e">&#9670;&nbsp;</a></span>assert_addr_policy_ok()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void assert_addr_policy_ok </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>lst</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log and exit if <b>t</b> is malformed </p>

</div>
</div>
<a id="a6e030201d6bc0307036313ed138a0b63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e030201d6bc0307036313ed138a0b63">&#9670;&nbsp;</a></span>authority_cert_parse_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structauthority__cert__t.html">authority_cert_t</a>* authority_cert_parse_from_string </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>end_of_string</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a key certificate from <b>s</b>; point <b>end-of-string</b> to the first character after the certificate. </p>
<p>Reject any certificate at least this big; it is probably an overflow, an attack, a bug, or some other nonsense. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a6e030201d6bc0307036313ed138a0b63_cgraph.png" border="0" usemap="#routerparse_8c_a6e030201d6bc0307036313ed138a0b63_cgraph" alt=""/></div>
<map name="routerparse_8c_a6e030201d6bc0307036313ed138a0b63_cgraph" id="routerparse_8c_a6e030201d6bc0307036313ed138a0b63_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a69faf166aa0aa9164d2134419c81ba1b" title="eat_whitespace" alt="" coords="193,13,307,39"/>
</map>
</div>

</div>
</div>
<a id="aed319ab6887b0eb56eff46fd83684017"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed319ab6887b0eb56eff46fd83684017">&#9670;&nbsp;</a></span>dump_desc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void dump_desc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For debugging purposes, dump unparseable descriptor *<b>desc</b> of type *<b>type</b> to file $DATADIR/unparseable-desc. Do not write more than one descriptor to disk per minute. If there is already such a file in the data directory, overwrite it. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_aed319ab6887b0eb56eff46fd83684017_cgraph.png" border="0" usemap="#routerparse_8c_aed319ab6887b0eb56eff46fd83684017_cgraph" alt=""/></div>
<map name="routerparse_8c_aed319ab6887b0eb56eff46fd83684017_cgraph" id="routerparse_8c_aed319ab6887b0eb56eff46fd83684017_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a42ff4ac7df6e3158f3a1a32d75081c32" title="crypto_digest256" alt="" coords="143,5,264,32"/>
</map>
</div>

</div>
</div>
<a id="a87185b16e92ff1ca520cd5293c20531d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87185b16e92ff1ca520cd5293c20531d">&#9670;&nbsp;</a></span>dump_desc_fifo_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void dump_desc_fifo_cleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clean up on exit; just memory, leave the dumps behind </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a87185b16e92ff1ca520cd5293c20531d_icgraph.png" border="0" usemap="#routerparse_8c_a87185b16e92ff1ca520cd5293c20531d_icgraph" alt=""/></div>
<map name="routerparse_8c_a87185b16e92ff1ca520cd5293c20531d_icgraph" id="routerparse_8c_a87185b16e92ff1ca520cd5293c20531d_icgraph">
<area shape="rect" id="node2" href="routerparse_8h.html#aa960633d43eaf0a653b3d45d9e7e5f92" title="routerparse_free_all" alt="" coords="220,5,356,32"/>
</map>
</div>

</div>
</div>
<a id="a00034876736f1a369464efde04b892ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00034876736f1a369464efde04b892ea">&#9670;&nbsp;</a></span>dump_desc_populate_fifo_from_directory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void dump_desc_populate_fifo_from_directory </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Scan the contents of the directory, and update FIFO/counters; this will consistency-check descriptor dump filenames against hashes of descriptor dump file content, and remove any inconsistent/unreadable dumps, and then reconstruct the dump FIFO as closely as possible for the last time the tor process shut down. If a previous dump was repeated more than once and moved ahead in the FIFO, the mtime will not have been updated and the reconstructed order will be wrong, but will always be a permutation of the original. </p>

</div>
</div>
<a id="ae652ccb5411f5cb5eae101cd26ac4d6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae652ccb5411f5cb5eae101cd26ac4d6b">&#9670;&nbsp;</a></span>dump_distinct_digest_count()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dump_distinct_digest_count </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log the total count of the number of distinct router digests we've ever verified. When compared to the number of times we've verified routerdesc signatures <em>in toto</em>, this will tell us if we're doing too much multiple-verification. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_ae652ccb5411f5cb5eae101cd26ac4d6b_cgraph.png" border="0" usemap="#routerparse_8c_ae652ccb5411f5cb5eae101cd26ac4d6b_cgraph" alt=""/></div>
<map name="routerparse_8c_ae652ccb5411f5cb5eae101cd26ac4d6b_cgraph" id="routerparse_8c_ae652ccb5411f5cb5eae101cd26ac4d6b_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="199,13,260,39"/>
</map>
</div>

</div>
</div>
<a id="a5c7183356964eccb2338e4ce2c80eb36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c7183356964eccb2338e4ce2c80eb36">&#9670;&nbsp;</a></span>extrainfo_parse_entry_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structextrainfo__t.html">extrainfo_t</a>* extrainfo_parse_entry_from_string </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cache_copy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct digest_ri_map_t *&#160;</td>
          <td class="paramname"><em>routermap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>can_dl_again_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a single extrainfo entry from the string <b>s</b>, ending at <b>end</b>. (If <b>end</b> is NULL, parse up to the end of <b>s</b>.) If <b>cache_copy</b> is true, make a copy of the extra-info document in the cache_info fields of the result. If <b>routermap</b> is provided, use it as a map from router identity to <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> when looking up signing keys.</p>
<p>If <b>can_dl_again_out</b> is provided, set *<b>can_dl_again_out</b> to 1 if it's okay to try to download an extrainfo with this same digest again, and 0 if it isn't. (It might not be okay to download it again if part of the part covered by the digest is invalid.) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a5c7183356964eccb2338e4ce2c80eb36_cgraph.png" border="0" usemap="#routerparse_8c_a5c7183356964eccb2338e4ce2c80eb36_cgraph" alt=""/></div>
<map name="routerparse_8c_a5c7183356964eccb2338e4ce2c80eb36_cgraph" id="routerparse_8c_a5c7183356964eccb2338e4ce2c80eb36_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#a38ef1e01c3b561811bc4bd4f0777eb3e" title="router_get_extrainfo_hash" alt="" coords="200,13,372,39"/>
</map>
</div>

</div>
</div>
<a id="abfc52ced95cf906593bbdab812e1cd8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfc52ced95cf906593bbdab812e1cd8e">&#9670;&nbsp;</a></span>microdescs_parse_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsmartlist__t.html">smartlist_t</a>* microdescs_parse_from_string </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>eos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allow_annotations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a>&#160;</td>
          <td class="paramname"><em>where</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>invalid_digests_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse as many microdescriptors as are found from the string starting at <b>s</b> and ending at <b>eos</b>. If allow_annotations is set, read any annotations we recognize and ignore ones we don't.</p>
<p>If <b>saved_location</b> isn't SAVED_IN_CACHE, make a local copy of each descriptor in the body field of each <a class="el" href="structmicrodesc__t.html">microdesc_t</a>.</p>
<p>Return all newly parsed microdescriptors in a newly allocated <a class="el" href="structsmartlist__t.html">smartlist_t</a>. If <b>invalid_disgests_out</b> is provided, add a SHA256 microdesc digest to it for every microdesc that we found to be badly formed. (This may cause duplicates) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_abfc52ced95cf906593bbdab812e1cd8e_icgraph.png" border="0" usemap="#routerparse_8c_abfc52ced95cf906593bbdab812e1cd8e_icgraph" alt=""/></div>
<map name="routerparse_8c_abfc52ced95cf906593bbdab812e1cd8e_icgraph" id="routerparse_8c_abfc52ced95cf906593bbdab812e1cd8e_icgraph">
<area shape="rect" id="node2" href="dirvote_8h.html#a97feb95be6e8e94295fa6775355318ee" title="dirvote_create_microdescriptor" alt="" coords="215,5,415,32"/>
<area shape="rect" id="node3" href="microdesc_8h.html#a8c94ac08f79487c605faf8e543fc3057" title="microdescs_add_to_cache" alt="" coords="226,56,403,83"/>
</map>
</div>

</div>
</div>
<a id="a2a8bb1810ff691f0bf5f99301b975242"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a8bb1810ff691f0bf5f99301b975242">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC dumped_desc_t *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dump_desc_populate_one_file&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(const char *dirname, const char *f)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle one file for <a class="el" href="routerparse_8c.html#a00034876736f1a369464efde04b892ea">dump_desc_populate_fifo_from_directory()</a>; make sure the filename is sensibly formed and matches the file content, and either return a dumped_desc_t for it or remove the file and return NULL. </p>

</div>
</div>
<a id="a65294e0f578a21d0e10431bf4ef1d038"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65294e0f578a21d0e10431bf4ef1d038">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaddr__policy__t.html">addr_policy_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">router_parse_addr_policy_item_from_string&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(const char *s, int assume_action, int *malformed_list)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the addr policy in the string <b>s</b> and return it. If assume_action is nonnegative, then insert its action (ADDR_POLICY_ACCEPT or ADDR_POLICY_REJECT) for items that specify no action.</p>
<p>Returns NULL on policy errors.</p>
<p>Set *<b>malformed_list</b> to true if the entire policy list should be discarded. Otherwise, set it to false, and only this item should be ignored on error - the rest of the policy list can continue to be processed and used.</p>
<p>The <a class="el" href="structaddr__policy__t.html">addr_policy_t</a> returned by this function can have its address set to AF_UNSPEC for '*'. Use <a class="el" href="policies_8c.html#aaffa8bf1f1c83afa828faf84d0cb97d1">policy_expand_unspec()</a> to turn this into a pair of AF_INET and AF_INET6 items. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a65294e0f578a21d0e10431bf4ef1d038_cgraph.png" border="0" usemap="#routerparse_8c_a65294e0f578a21d0e10431bf4ef1d038_cgraph" alt=""/></div>
<map name="routerparse_8c_a65294e0f578a21d0e10431bf4ef1d038_cgraph" id="routerparse_8c_a65294e0f578a21d0e10431bf4ef1d038_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a69faf166aa0aa9164d2134419c81ba1b" title="eat_whitespace" alt="" coords="153,5,267,32"/>
<area shape="rect" id="node3" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="167,56,253,83"/>
<area shape="rect" id="node4" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="315,56,409,83"/>
</map>
</div>

</div>
</div>
<a id="a37b894a8c8b42685b0f542ea86dc42ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37b894a8c8b42685b0f542ea86dc42ff">&#9670;&nbsp;</a></span>networkstatus_parse_detached_signatures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structns__detached__signatures__t.html">ns_detached_signatures_t</a>* networkstatus_parse_detached_signatures </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>eos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a detached v3 networkstatus signature document between <b>s</b> and <b>eos</b> and return the result. Return -1 on failure. </p>

</div>
</div>
<a id="a65f051065986f87c9969726c07d761be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65f051065986f87c9969726c07d761be">&#9670;&nbsp;</a></span>networkstatus_parse_vote_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a>* networkstatus_parse_vote_from_string </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>eos_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a4cc3535cd1c60e55a79683e1b3ae8814">networkstatus_type_t</a>&#160;</td>
          <td class="paramname"><em>ns_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a v3 networkstatus vote, opinion, or consensus (depending on ns_type), from <b>s</b>, and return the result. Return NULL on failure. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a65f051065986f87c9969726c07d761be_icgraph.png" border="0" usemap="#routerparse_8c_a65f051065986f87c9969726c07d761be_icgraph" alt=""/></div>
<map name="routerparse_8c_a65f051065986f87c9969726c07d761be_icgraph" id="routerparse_8c_a65f051065986f87c9969726c07d761be_icgraph">
<area shape="rect" id="node2" href="dirvote_8h.html#a41039a7c25c1f8a8be7d042dd256a4ad" title="dirvote_add_vote" alt="" coords="196,13,317,39"/>
</map>
</div>

</div>
</div>
<a id="a318846a3f10eacf7fe55df71d9f509f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a318846a3f10eacf7fe55df71d9f509f7">&#9670;&nbsp;</a></span>networkstatus_verify_bw_weights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int networkstatus_verify_bw_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>consensus_method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verify the bandwidth weights of a network status document </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a318846a3f10eacf7fe55df71d9f509f7_cgraph.png" border="0" usemap="#routerparse_8c_a318846a3f10eacf7fe55df71d9f509f7_cgraph" alt=""/></div>
<map name="routerparse_8c_a318846a3f10eacf7fe55df71d9f509f7_cgraph" id="routerparse_8c_a318846a3f10eacf7fe55df71d9f509f7_cgraph">
<area shape="rect" id="node2" href="networkstatus_8c.html#afda0b094982877af4c11b127167acb9e" title="networkstatus_get_weight\l_scale_param" alt="" coords="397,5,572,47"/>
<area shape="rect" id="node4" href="networkstatus_8c.html#a77165f72d7e9e6e99fce27ee87a063a9" title="networkstatus_get_bw\l_weight" alt="" coords="196,35,349,76"/>
<area shape="rect" id="node3" href="networkstatus_8c.html#aba1790be4b1cea243c3dac989ad1b05c" title="networkstatus_get_param" alt="" coords="620,13,792,39"/>
</map>
</div>

</div>
</div>
<a id="a7ece24495c2fa4a93440cc849e6a0702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ece24495c2fa4a93440cc849e6a0702">&#9670;&nbsp;</a></span>rend_decrypt_introduction_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_decrypt_introduction_points </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>ipos_decrypted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>ipos_decrypted_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>descriptor_cookie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ipos_encrypted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ipos_encrypted_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt the encrypted introduction points in <b>ipos_encrypted</b> of length <b>ipos_encrypted_size</b> using <b>descriptor_cookie</b> and write the result to a newly allocated string that is pointed to by <b>ipos_decrypted</b> and its length to <b>ipos_decrypted_size</b>. Return 0 if decryption was successful and -1 otherwise. </p>

</div>
</div>
<a id="a6bceb114ff28749f6890038b2b18849d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bceb114ff28749f6890038b2b18849d">&#9670;&nbsp;</a></span>rend_parse_client_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_parse_client_keys </td>
          <td>(</td>
          <td class="paramtype">strmap_t *&#160;</td>
          <td class="paramname"><em>parsed_clients</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ckstr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the content of a client_key file in <b>ckstr</b> and add <a class="el" href="structrend__authorized__client__t.html">rend_authorized_client_t</a>'s for each parsed client to <b>parsed_clients</b>. Return the number of parsed clients as result or -1 for failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a6bceb114ff28749f6890038b2b18849d_cgraph.png" border="0" usemap="#routerparse_8c_a6bceb114ff28749f6890038b2b18849d_cgraph" alt=""/></div>
<map name="routerparse_8c_a6bceb114ff28749f6890038b2b18849d_cgraph" id="routerparse_8c_a6bceb114ff28749f6890038b2b18849d_cgraph">
<area shape="rect" id="node2" href="memarea_8c.html#a9bc481c5060ff6280cfb1e5eaaa915f4" title="memarea_new" alt="" coords="215,5,322,32"/>
<area shape="rect" id="node3" href="util_8c.html#a69faf166aa0aa9164d2134419c81ba1b" title="eat_whitespace" alt="" coords="212,56,325,83"/>
<area shape="rect" id="node4" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="225,107,313,133"/>
</map>
</div>

</div>
</div>
<a id="a23b22c9a5a626774e68f0c7678221028"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23b22c9a5a626774e68f0c7678221028">&#9670;&nbsp;</a></span>rend_parse_introduction_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_parse_introduction_points </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> *&#160;</td>
          <td class="paramname"><em>parsed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>intro_points_encoded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>intro_points_encoded_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the encoded introduction points in <b>intro_points_encoded</b> of length <b>intro_points_encoded_size</b> and write the result to the descriptor in <b>parsed</b>; return the number of successfully parsed introduction points or -1 in case of a failure. </p>
<p>Function may only be invoked once. </p>

</div>
</div>
<a id="a2faba4db0eeeb6f97d9ba56983390b37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2faba4db0eeeb6f97d9ba56983390b37">&#9670;&nbsp;</a></span>rend_parse_v2_service_descriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_parse_v2_service_descriptor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> **&#160;</td>
          <td class="paramname"><em>parsed_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>desc_id_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>intro_points_encrypted_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>intro_points_encrypted_size_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>encoded_size_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>next_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>as_hsdir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse and validate the ASCII-encoded v2 descriptor in <b>desc</b>, write the parsed descriptor to the newly allocated *<b>parsed_out</b>, the binary descriptor ID of length DIGEST_LEN to <b>desc_id_out</b>, the encrypted introduction points to the newly allocated *<b>intro_points_encrypted_out</b>, their encrypted size to *<b>intro_points_encrypted_size_out</b>, the size of the encoded descriptor to *<b>encoded_size_out</b>, and a pointer to the possibly next descriptor to *<b>next_out</b>; return 0 for success (including validation) and -1 for failure.</p>
<p>If <b>as_hsdir</b> is 1, we're parsing this as an HSDir, and we should be strict about time formats. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a2faba4db0eeeb6f97d9ba56983390b37_icgraph.png" border="0" usemap="#routerparse_8c_a2faba4db0eeeb6f97d9ba56983390b37_icgraph" alt=""/></div>
<map name="routerparse_8c_a2faba4db0eeeb6f97d9ba56983390b37_icgraph" id="routerparse_8c_a2faba4db0eeeb6f97d9ba56983390b37_icgraph">
<area shape="rect" id="node2" href="rendcache_8h.html#a0029729f71187fd666fb549197645b7e" title="rend_cache_store_v2\l_desc_as_dir" alt="" coords="209,5,356,47"/>
</map>
</div>

</div>
</div>
<a id="a594cb966cbb2893822d931ffe955b53d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a594cb966cbb2893822d931ffe955b53d">&#9670;&nbsp;</a></span>router_append_dirobj_signature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_append_dirobj_signature </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buf_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>digest_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>private_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: used to generate signatures for routers, directories and network-status objects. Given a digest in <b>digest</b> and a secret <b>private_key</b>, generate a PKCS1-padded signature, BASE64-encode it, surround it with --&mdash;BEGIN/END--&mdash; pairs, and write it to the <b>buf_len</b>-byte buffer at <b>buf</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a594cb966cbb2893822d931ffe955b53d_cgraph.png" border="0" usemap="#routerparse_8c_a594cb966cbb2893822d931ffe955b53d_cgraph" alt=""/></div>
<map name="routerparse_8c_a594cb966cbb2893822d931ffe955b53d_cgraph" id="routerparse_8c_a594cb966cbb2893822d931ffe955b53d_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#ada91c927ebf9cb2a3b92b285198f172a" title="router_get_dirobj_signature" alt="" coords="196,13,375,39"/>
<area shape="rect" id="node3" href="crypto_8c.html#a47b1080a7a68f04e0e745168075c235f" title="crypto_pk_keysize" alt="" coords="423,13,553,39"/>
</map>
</div>

</div>
</div>
<a id="ae9c94e2b40578dbed4b4e38a5ebe2c65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9c94e2b40578dbed4b4e38a5ebe2c65">&#9670;&nbsp;</a></span>router_get_dir_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_get_dir_hash </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>digest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>digest</b> to the SHA-1 digest of the hash of the directory in <b>s</b>. Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="ada91c927ebf9cb2a3b92b285198f172a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada91c927ebf9cb2a3b92b285198f172a">&#9670;&nbsp;</a></span>router_get_dirobj_signature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* router_get_dirobj_signature </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>digest_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>private_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: used to generate signatures for routers, directories and network-status objects. Given a <b>digest_len</b>-byte digest in <b>digest</b> and a secret <b>private_key</b>, generate an PKCS1-padded signature, BASE64-encode it, surround it with --&mdash;BEGIN/END--&mdash; pairs, and return the new signature on success or NULL on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_ada91c927ebf9cb2a3b92b285198f172a_cgraph.png" border="0" usemap="#routerparse_8c_ada91c927ebf9cb2a3b92b285198f172a_cgraph" alt=""/></div>
<map name="routerparse_8c_ada91c927ebf9cb2a3b92b285198f172a_cgraph" id="routerparse_8c_ada91c927ebf9cb2a3b92b285198f172a_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a47b1080a7a68f04e0e745168075c235f" title="crypto_pk_keysize" alt="" coords="232,5,363,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_ada91c927ebf9cb2a3b92b285198f172a_icgraph.png" border="0" usemap="#routerparse_8c_ada91c927ebf9cb2a3b92b285198f172a_icgraph" alt=""/></div>
<map name="routerparse_8c_ada91c927ebf9cb2a3b92b285198f172a_icgraph" id="routerparse_8c_ada91c927ebf9cb2a3b92b285198f172a_icgraph">
<area shape="rect" id="node2" href="routerparse_8h.html#a594cb966cbb2893822d931ffe955b53d" title="router_append_dirobj\l_signature" alt="" coords="232,5,375,47"/>
</map>
</div>

</div>
</div>
<a id="a38ef1e01c3b561811bc4bd4f0777eb3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38ef1e01c3b561811bc4bd4f0777eb3e">&#9670;&nbsp;</a></span>router_get_extrainfo_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_get_extrainfo_hash </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>s_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>digest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>digest</b> to the SHA-1 digest of the hash of the <b>s_len</b>-byte extrainfo string at <b>s</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a38ef1e01c3b561811bc4bd4f0777eb3e_icgraph.png" border="0" usemap="#routerparse_8c_a38ef1e01c3b561811bc4bd4f0777eb3e_icgraph" alt=""/></div>
<map name="routerparse_8c_a38ef1e01c3b561811bc4bd4f0777eb3e_icgraph" id="routerparse_8c_a38ef1e01c3b561811bc4bd4f0777eb3e_icgraph">
<area shape="rect" id="node2" href="routerparse_8h.html#a5c7183356964eccb2338e4ce2c80eb36" title="extrainfo_parse_entry\l_from_string" alt="" coords="225,5,372,47"/>
</map>
</div>

</div>
</div>
<a id="a6105fa03c7a751d474a380de5016360b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6105fa03c7a751d474a380de5016360b">&#9670;&nbsp;</a></span>router_get_networkstatus_v3_hashes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_get_networkstatus_v3_hashes </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcommon__digests__t.html">common_digests_t</a> *&#160;</td>
          <td class="paramname"><em>digests</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>digests</b> to all the digests of the consensus document in <b>s</b> </p>

</div>
</div>
<a id="a88a39471f268a31b09e1677d5e57506a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88a39471f268a31b09e1677d5e57506a">&#9670;&nbsp;</a></span>router_get_router_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_get_router_hash </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>s_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>digest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>digest</b> to the SHA-1 digest of the hash of the first router in <b>s</b>. Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="a6ed67129e89fe64d2f329a1e94063f48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ed67129e89fe64d2f329a1e94063f48">&#9670;&nbsp;</a></span>router_parse_entry_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrouterinfo__t.html">routerinfo_t</a>* router_parse_entry_from_string </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cache_copy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allow_annotations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prepend_annotations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>can_dl_again_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function: reads a single router entry from *<b>s</b> ... *<b>end</b>. Mallocs a new router and returns it if all goes well, else returns NULL. If <b>cache_copy</b> is true, duplicate the contents of s through end into the signed_descriptor_body of the resulting <a class="el" href="structrouterinfo__t.html">routerinfo_t</a>.</p>
<p>If <b>end</b> is NULL, <b>s</b> must be properly NUL-terminated.</p>
<p>If <b>allow_annotations</b>, it's okay to encounter annotations in <b>s</b> before the router; if it's false, reject the router if it's annotated. If <b>prepend_annotations</b> is set, it should contain some annotations: append them to the front of the router before parsing it, and keep them around when caching the router.</p>
<p>Only one of allow_annotations and prepend_annotations may be set.</p>
<p>If <b>can_dl_again_out</b> is provided, set *<b>can_dl_again_out</b> to 1 if it's okay to try to download a descriptor with this same digest again, and 0 if it isn't. (It might not be okay to download it again if part of the part covered by the digest is invalid.) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a6ed67129e89fe64d2f329a1e94063f48_cgraph.png" border="0" usemap="#routerparse_8c_a6ed67129e89fe64d2f329a1e94063f48_cgraph" alt=""/></div>
<map name="routerparse_8c_a6ed67129e89fe64d2f329a1e94063f48_cgraph" id="routerparse_8c_a6ed67129e89fe64d2f329a1e94063f48_cgraph">
<area shape="rect" id="node2" href="memarea_8c.html#a9bc481c5060ff6280cfb1e5eaaa915f4" title="memarea_new" alt="" coords="184,13,291,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a6ed67129e89fe64d2f329a1e94063f48_icgraph.png" border="0" usemap="#routerparse_8c_a6ed67129e89fe64d2f329a1e94063f48_icgraph" alt=""/></div>
<map name="routerparse_8c_a6ed67129e89fe64d2f329a1e94063f48_icgraph" id="routerparse_8c_a6ed67129e89fe64d2f329a1e94063f48_icgraph">
<area shape="rect" id="node2" href="routerlist_8h.html#a7b194ad6a42e8fb2ef4f3aa1cf135830" title="router_load_single\l_router" alt="" coords="184,5,311,47"/>
</map>
</div>

</div>
</div>
<a id="a258ef1ce82ccf0fe39682829018a749e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a258ef1ce82ccf0fe39682829018a749e">&#9670;&nbsp;</a></span>router_parse_list_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_parse_list_from_string </td>
          <td>(</td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>eos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a>&#160;</td>
          <td class="paramname"><em>saved_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>want_extrainfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allow_annotations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prepend_annotations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>invalid_digests_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a string *<b>s</b> containing a concatenated sequence of router descriptors (or extra-info documents if <b>is_extrainfo</b> is set), parses them and stores the result in <b>dest</b>. All routers are marked running and valid. Advances *s to a point immediately following the last router entry. Ignore any trailing router entries that are not complete.</p>
<p>If <b>saved_location</b> isn't SAVED_IN_CACHE, make a local copy of each descriptor in the signed_descriptor_body field of each <a class="el" href="structrouterinfo__t.html">routerinfo_t</a>. If it isn't SAVED_NOWHERE, remember the offset of each descriptor.</p>
<p>Returns 0 on success and -1 on failure. Adds a digest to <b>invalid_digests_out</b> for every entry that was unparseable or invalid. (This may cause duplicate entries.) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a258ef1ce82ccf0fe39682829018a749e_icgraph.png" border="0" usemap="#routerparse_8c_a258ef1ce82ccf0fe39682829018a749e_icgraph" alt=""/></div>
<map name="routerparse_8c_a258ef1ce82ccf0fe39682829018a749e_icgraph" id="routerparse_8c_a258ef1ce82ccf0fe39682829018a749e_icgraph">
<area shape="rect" id="node2" href="routerlist_8h.html#ae08c5697c58be20a7bb11b34ca9aba5e" title="router_load_routers\l_from_string" alt="" coords="209,5,342,47"/>
<area shape="rect" id="node3" href="routerlist_8h.html#a373b610cd5f3f54650e6e7d47ae70263" title="router_load_extrainfo\l_from_string" alt="" coords="204,71,347,112"/>
</map>
</div>

</div>
</div>
<a id="aa960633d43eaf0a653b3d45d9e7e5f92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa960633d43eaf0a653b3d45d9e7e5f92">&#9670;&nbsp;</a></span>routerparse_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void routerparse_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clean up all data structures used by <a class="el" href="routerparse_8c.html" title="Code to parse and validate router descriptors, consenus directories, and similar objects. ">routerparse.c</a> at exit </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_aa960633d43eaf0a653b3d45d9e7e5f92_cgraph.png" border="0" usemap="#routerparse_8c_aa960633d43eaf0a653b3d45d9e7e5f92_cgraph" alt=""/></div>
<map name="routerparse_8c_aa960633d43eaf0a653b3d45d9e7e5f92_cgraph" id="routerparse_8c_aa960633d43eaf0a653b3d45d9e7e5f92_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#a87185b16e92ff1ca520cd5293c20531d" title="dump_desc_fifo_cleanup" alt="" coords="189,5,356,32"/>
</map>
</div>

</div>
</div>
<a id="ab4ca055512bee2e709f53a889cd2dd84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4ca055512bee2e709f53a889cd2dd84">&#9670;&nbsp;</a></span>routerparse_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void routerparse_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called on startup; right now we just handle scanning the unparseable descriptor dumps, but hang anything else we might need to do in the future here as well. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_ab4ca055512bee2e709f53a889cd2dd84_cgraph.png" border="0" usemap="#routerparse_8c_ab4ca055512bee2e709f53a889cd2dd84_cgraph" alt=""/></div>
<map name="routerparse_8c_ab4ca055512bee2e709f53a889cd2dd84_cgraph" id="routerparse_8c_ab4ca055512bee2e709f53a889cd2dd84_cgraph">
<area shape="rect" id="node2" href="sandbox_8c.html#accea9203c614b0ca61ae5f3da44e0f56" title="sandbox_is_active" alt="" coords="164,5,295,32"/>
</map>
</div>

</div>
</div>
<a id="a894e0e7f9cc445e418328701266572ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a894e0e7f9cc445e418328701266572ca">&#9670;&nbsp;</a></span>routerstatus_parse_entry_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="structrouterstatus__t.html">routerstatus_t</a>* routerstatus_parse_entry_from_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemarea__t.html">memarea_t</a> *&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>tokens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>vote</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvote__routerstatus__t.html">vote_routerstatus_t</a> *&#160;</td>
          <td class="paramname"><em>vote_rs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>consensus_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#ada0879620550843533b891a49543b109">consensus_flavor_t</a>&#160;</td>
          <td class="paramname"><em>flav</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a string at *<b>s</b>, containing a routerstatus object, and an empty smartlist at <b>tokens</b>, parse and return the first router status object in the string, and advance *<b>s</b> to just after the end of the router status. Return NULL and advance *<b>s</b> on error.</p>
<p>If <b>vote</b> and <b>vote_rs</b> are provided, don't allocate a fresh routerstatus but use <b>vote_rs</b> instead.</p>
<p>If <b>consensus_method</b> is nonzero, this routerstatus is part of a consensus, and we should parse it according to the method used to make that consensus.</p>
<p>Parse according to the syntax used by the consensus flavor <b>flav</b>. </p>

</div>
</div>
<a id="aa5182e7b61c8640ef94186a19760d90c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5182e7b61c8640ef94186a19760d90c">&#9670;&nbsp;</a></span>routerstatus_parse_guardfraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int routerstatus_parse_guardfraction </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>guardfraction_str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>vote</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvote__routerstatus__t.html">vote_routerstatus_t</a> *&#160;</td>
          <td class="paramname"><em>vote_rs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrouterstatus__t.html">routerstatus_t</a> *&#160;</td>
          <td class="paramname"><em>rs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the GuardFraction string from a consensus or vote.</p>
<p>If <b>vote</b> or <b>vote_rs</b> are set the document getting parsed is a vote routerstatus. Otherwise it's a consensus. This is the same semantic as in <a class="el" href="routerparse_8c.html#a894e0e7f9cc445e418328701266572ca">routerstatus_parse_entry_from_string()</a>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_aa5182e7b61c8640ef94186a19760d90c_cgraph.png" border="0" usemap="#routerparse_8c_aa5182e7b61c8640ef94186a19760d90c_cgraph" alt=""/></div>
<map name="routerparse_8c_aa5182e7b61c8640ef94186a19760d90c_cgraph" id="routerparse_8c_aa5182e7b61c8640ef94186a19760d90c_cgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#abcf00389e72807f2534ffd3da3de31e6" title="should_apply_guardfraction" alt="" coords="184,5,364,32"/>
<area shape="rect" id="node4" href="util_8c.html#a8c315755a2fb518d47d7397a14e506de" title="tor_parse_ulong" alt="" coords="217,56,331,83"/>
<area shape="rect" id="node3" href="networkstatus_8c.html#aba1790be4b1cea243c3dac989ad1b05c" title="networkstatus_get_param" alt="" coords="412,5,584,32"/>
</map>
</div>

</div>
</div>
<a id="a54739e9600d1d7d0941e77c8ddc53970"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54739e9600d1d7d0941e77c8ddc53970">&#9670;&nbsp;</a></span>sort_version_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sort_version_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>versions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>remove_duplicates</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sort a list of string-representations of versions in ascending order. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a54739e9600d1d7d0941e77c8ddc53970_cgraph.png" border="0" usemap="#routerparse_8c_a54739e9600d1d7d0941e77c8ddc53970_cgraph" alt=""/></div>
<map name="routerparse_8c_a54739e9600d1d7d0941e77c8ddc53970_cgraph" id="routerparse_8c_a54739e9600d1d7d0941e77c8ddc53970_cgraph">
<area shape="rect" id="node2" href="container_8c.html#adeb0528c65b62117acb2b8f6e2b0e910" title="smartlist_sort" alt="" coords="171,5,272,32"/>
</map>
</div>

</div>
</div>
<a id="a34e1f6d4f6429bcf1d565f54a1dfcd5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34e1f6d4f6429bcf1d565f54a1dfcd5c">&#9670;&nbsp;</a></span>tor_version_as_new_as()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_version_as_new_as </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>platform</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cutoff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the Tor version of the platform string <b>platform</b>, and compare it to the version in <b>cutoff</b>. Return 1 if the router is at least as new as the cutoff, else return 0. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a34e1f6d4f6429bcf1d565f54a1dfcd5c_cgraph.png" border="0" usemap="#routerparse_8c_a34e1f6d4f6429bcf1d565f54a1dfcd5c_cgraph" alt=""/></div>
<map name="routerparse_8c_a34e1f6d4f6429bcf1d565f54a1dfcd5c_cgraph" id="routerparse_8c_a34e1f6d4f6429bcf1d565f54a1dfcd5c_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#ace4c11b51ca67a4f140ed41ae3d47b6d" title="tor_version_parse" alt="" coords="212,5,337,32"/>
<area shape="rect" id="node3" href="util_8c.html#a1d095be5cec365a93ac90501390f70fa" title="strcasecmpstart" alt="" coords="385,5,501,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a34e1f6d4f6429bcf1d565f54a1dfcd5c_icgraph.png" border="0" usemap="#routerparse_8c_a34e1f6d4f6429bcf1d565f54a1dfcd5c_icgraph" alt=""/></div>
<map name="routerparse_8c_a34e1f6d4f6429bcf1d565f54a1dfcd5c_icgraph" id="routerparse_8c_a34e1f6d4f6429bcf1d565f54a1dfcd5c_icgraph">
<area shape="rect" id="node2" href="protover_8h.html#a14cfeb2deba8e3104fc9ca36778312d9" title="protover_compute_for\l_old_tor" alt="" coords="212,5,360,47"/>
</map>
</div>

</div>
</div>
<a id="a86ae08e44b4d585ae18040e96e98a92c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86ae08e44b4d585ae18040e96e98a92c">&#9670;&nbsp;</a></span>tor_version_compare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_version_compare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtor__version__t.html">tor_version_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtor__version__t.html">tor_version_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compare two tor versions; Return &lt;0 if a &lt; b; 0 if a ==b, &gt;0 if a &gt; b. </p>

</div>
</div>
<a id="aef22cc5550ef14cb0cf8fd3bca4dbd69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef22cc5550ef14cb0cf8fd3bca4dbd69">&#9670;&nbsp;</a></span>tor_version_is_obsolete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="or_8h.html#a00fd54618330b1d6b76e7571d84d90ce">version_status_t</a> tor_version_is_obsolete </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>myversion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>versionlist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return VS_RECOMMENDED if <b>myversion</b> is contained in <b>versionlist</b>. Else, return VS_EMPTY if versionlist has no entries. Else, return VS_OLD if every member of <b>versionlist</b> is newer than <b>myversion</b>. Else, return VS_NEW_IN_SERIES if there is at least one member of <b>versionlist</b> in the same series (major.minor.micro) as <b>myversion</b>, but no such member is newer than <b>myversion.</b>. Else, return VS_NEW if every member of <b>versionlist</b> is older than <b>myversion</b>. Else, return VS_UNRECOMMENDED.</p>
<p>(versionlist is a comma-separated list of version strings, optionally prefixed with "Tor". Versions that can't be parsed are ignored.) </p>

</div>
</div>
<a id="ace4c11b51ca67a4f140ed41ae3d47b6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace4c11b51ca67a4f140ed41ae3d47b6d">&#9670;&nbsp;</a></span>tor_version_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_version_parse </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtor__version__t.html">tor_version_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a tor version from <b>s</b>, and store the result in <b>out</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_ace4c11b51ca67a4f140ed41ae3d47b6d_cgraph.png" border="0" usemap="#routerparse_8c_ace4c11b51ca67a4f140ed41ae3d47b6d_cgraph" alt=""/></div>
<map name="routerparse_8c_ace4c11b51ca67a4f140ed41ae3d47b6d_cgraph" id="routerparse_8c_ace4c11b51ca67a4f140ed41ae3d47b6d_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a1d095be5cec365a93ac90501390f70fa" title="strcasecmpstart" alt="" coords="179,5,295,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_ace4c11b51ca67a4f140ed41ae3d47b6d_icgraph.png" border="0" usemap="#routerparse_8c_ace4c11b51ca67a4f140ed41ae3d47b6d_icgraph" alt=""/></div>
<map name="routerparse_8c_ace4c11b51ca67a4f140ed41ae3d47b6d_icgraph" id="routerparse_8c_ace4c11b51ca67a4f140ed41ae3d47b6d_icgraph">
<area shape="rect" id="node2" href="routerparse_8h.html#a47c9a3cf5868b2133b4e5a582ca69aa6" title="tor_version_parse_platform" alt="" coords="179,5,357,32"/>
<area shape="rect" id="node3" href="routerparse_8h.html#a34e1f6d4f6429bcf1d565f54a1dfcd5c" title="tor_version_as_new_as" alt="" coords="189,56,347,83"/>
<area shape="rect" id="node4" href="protover_8h.html#a14cfeb2deba8e3104fc9ca36778312d9" title="protover_compute_for\l_old_tor" alt="" coords="405,49,553,90"/>
</map>
</div>

</div>
</div>
<a id="a7dfff3debca0046c946d947c8c0a922f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dfff3debca0046c946d947c8c0a922f">&#9670;&nbsp;</a></span>tor_version_parse_platform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_version_parse_platform </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>platform</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtor__version__t.html">tor_version_t</a> *&#160;</td>
          <td class="paramname"><em>router_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>strict</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extract a Tor version from a <b>platform</b> line from a router descriptor, and place the result in <b>router_version</b>.</p>
<p>Return 1 on success, -1 on parsing failure, and 0 if the platform line does not indicate some version of Tor.</p>
<p>If <b>strict</b> is non-zero, finding any weird version components (like negative numbers) counts as a parsing failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8c_a7dfff3debca0046c946d947c8c0a922f_cgraph.png" border="0" usemap="#routerparse_8c_a7dfff3debca0046c946d947c8c0a922f_cgraph" alt=""/></div>
<map name="routerparse_8c_a7dfff3debca0046c946d947c8c0a922f_cgraph" id="routerparse_8c_a7dfff3debca0046c946d947c8c0a922f_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="251,5,339,32"/>
<area shape="rect" id="node3" href="util_8c.html#a69faf166aa0aa9164d2134419c81ba1b" title="eat_whitespace" alt="" coords="238,56,351,83"/>
<area shape="rect" id="node4" href="util_8c.html#a34984f08eb3eef95438b8e65226dff8e" title="find_whitespace" alt="" coords="237,107,353,133"/>
<area shape="rect" id="node5" href="routerparse_8c.html#ace4c11b51ca67a4f140ed41ae3d47b6d" title="tor_version_parse" alt="" coords="232,157,357,184"/>
<area shape="rect" id="node6" href="util_8c.html#a1d095be5cec365a93ac90501390f70fa" title="strcasecmpstart" alt="" coords="405,157,521,184"/>
</map>
</div>

</div>
</div>
<a id="aed569b83c27fc31ecf6c7aa2af2751d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed569b83c27fc31ecf6c7aa2af2751d7">&#9670;&nbsp;</a></span>tor_version_same_series()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_version_same_series </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtor__version__t.html">tor_version_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtor__version__t.html">tor_version_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff versions <b>a</b> and <b>b</b> belong to the same series. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a45a515fe3fac61539ae2eeb8e7e1fcb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45a515fe3fac61539ae2eeb8e7e1fcb3">&#9670;&nbsp;</a></span>descs_dumped</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="structsmartlist__t.html">smartlist_t</a>* descs_dumped = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>List of dumped descriptors for FIFO cleanup purposes </p>

</div>
</div>
<a id="aed5330a26e9738c12e49ecf033de49f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed5330a26e9738c12e49ecf033de49f3">&#9670;&nbsp;</a></span>len_descs_dumped</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC uint64_t len_descs_dumped = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Total size of dumped descriptors for FIFO cleanup </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
