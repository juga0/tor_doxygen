<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="http://ed25519.cr.yp.to/">ed25519</a> is an <a href="http://en.wikipedia.org/wiki/Elliptic_Curve_DSA">Elliptic Curve Digital Signature Algortithm</a>, developed by <a href="http://cr.yp.to/djb.html">Dan Bernstein</a>, <a href="http://www.nielsduif.nl/">Niels Duif</a>, <a href="http://hyperelliptic.org/tanja">Tanja Lange</a>, <a href="http://www.cryptojedi.org/users/peter/">Peter Schwabe</a>, and <a href="http://www.iis.sinica.edu.tw/pages/byyang/">Bo-Yin Yang</a>.</p>
<p>This project provides performant, portable 32-bit &amp; 64-bit implementations. All implementations are of course constant time in regard to secret data.</p>
<h4>Performance</h4>
<p>SSE2 code and benches have not been updated yet. I will do those next.</p>
<p>Compilers versions are gcc 4.6.3, icc 13.1.1, clang 3.4-1~exp1.</p>
<p>Batch verification time (in parentheses) is the average time per 1 verification in a batch of 64 signatures. Counts are in thousands of cycles.</p>
<p>Note that SSE2 performance may be less impressive on AMD &amp; older CPUs with slower SSE ops!</p>
<p>Visual Studio performance for <code>ge25519_scalarmult_base_niels</code> will lag behind a bit until optimized assembler versions of <code>ge25519_scalarmult_base_choose_niels</code> are made.</p>
<h5>E5200 @ 2.5ghz, march=core2</h5>
<table class="doxtable">
</table>
<p>Implementation</p>
<p>Sign</p>
<p>gcc</p>
<p>icc</p>
<p>clang</p>
<p>Verify</p>
<p>gcc</p>
<p>icc</p>
<p>clang&lt;/thead&gt; &lt;tbody&gt; </p>
<p>ed25519-donna 64bit </p>
<p>100k</p>
<p>110k</p>
<p>137k</p>
<p>327k (144k) </p>
<p>342k (163k) </p>
<p>422k (194k)  </p>
<p>amd64-64-24k </p>
<p>102k</p>
<p>355k (158k) </p>
<p>ed25519-donna-sse2 64bit</p>
<p>108k</p>
<p>111k</p>
<p>116k</p>
<p>353k (155k) </p>
<p>345k (154k) </p>
<p>360k (161k)  </p>
<p>amd64-51-32k </p>
<p>116k</p>
<p>380k (175k) </p>
<p>ed25519-donna-sse2 32bit</p>
<p>147k</p>
<p>147k</p>
<p>156k</p>
<p>380k (178k) </p>
<p>381k (173k) </p>
<p>430k (192k)  </p>
<p>ed25519-donna 32bit </p>
<p>597k</p>
<p>335k</p>
<p>380k</p>
<p>1693k (720k)</p>
<p>1052k (453k)</p>
<p>1141k (493k) &lt;/tbody&gt; </p>
<h5>E3-1270 @ 3.4ghz, march=corei7-avx</h5>
<table class="doxtable">
</table>
<p>Implementation</p>
<p>Sign</p>
<p>gcc</p>
<p>icc</p>
<p>clang</p>
<p>Verify</p>
<p>gcc</p>
<p>icc</p>
<p>clang&lt;/thead&gt; &lt;tbody&gt; </p>
<p>amd64-64-24k </p>
<p>68k</p>
<p>225k (104k) </p>
<p>ed25519-donna 64bit </p>
<p>71k</p>
<p>75k</p>
<p>90k</p>
<p>226k (105k) </p>
<p>226k (112k) </p>
<p>277k (125k)  </p>
<p>amd64-51-32k </p>
<p>72k</p>
<p>218k (107k) </p>
<p>ed25519-donna-sse2 64bit</p>
<p>79k</p>
<p>82k</p>
<p>92k</p>
<p>252k (122k) </p>
<p>259k (124k) </p>
<p>282k (131k)  </p>
<p>ed25519-donna-sse2 32bit</p>
<p>94k</p>
<p>95k</p>
<p>103k</p>
<p>296k (146k) </p>
<p>294k (137k) </p>
<p>306k (147k)  </p>
<p>ed25519-donna 32bit </p>
<p>525k</p>
<p>299k</p>
<p>316k</p>
<p>1502k (645k)</p>
<p>959k (418k) </p>
<p>954k (416k)  &lt;/tbody&gt; </p>
<h4>Compilation</h4>
<p>No configuration is needed <b>if you are compiling against OpenSSL</b>.</p>
<h5>Hash Options</h5>
<p>If you are not compiling aginst OpenSSL, you will need a hash function.</p>
<p>To use a simple/**slow** implementation of SHA-512, use <code>-DED25519_REFHASH</code> when compiling <code>ed25519.c</code>. This should never be used except to verify the code works when OpenSSL is not available.</p>
<p>To use a custom hash function, use <code>-DED25519_CUSTOMHASH</code> when compiling <code>ed25519.c</code> and put your custom hash implementation in <a class="el" href="ed25519-hash-custom_8h_source.html">ed25519-hash-custom.h</a>. The hash must have a 512bit digest and implement </p><pre class="fragment">struct ed25519_hash_context;

void ed25519_hash_init(ed25519_hash_context *ctx);
void ed25519_hash_update(ed25519_hash_context *ctx, const uint8_t *in, size_t inlen);
void ed25519_hash_final(ed25519_hash_context *ctx, uint8_t *hash);
void ed25519_hash(uint8_t *hash, const uint8_t *in, size_t inlen);
</pre><h5>Random Options</h5>
<p>If you are not compiling aginst OpenSSL, you will need a random function for batch verification.</p>
<p>To use a custom random function, use <code>-DED25519_CUSTOMRANDOM</code> when compiling <code>ed25519.c</code> and put your custom hash implementation in <a class="el" href="ed25519-randombytes-custom_8h_source.html">ed25519-randombytes-custom.h</a>. The random function must implement: </p><pre class="fragment">void ED25519_FN(ed25519_randombytes_unsafe) (void *p, size_t len);
</pre><p>Use <code>-DED25519_TEST</code> when compiling <code>ed25519.c</code> to use a deterministically seeded, non-thread safe CSPRNG variant of Bob Jenkins <a href="http://en.wikipedia.org/wiki/ISAAC_%28cipher%29">ISAAC</a></p>
<h5>Minor options</h5>
<p>Use <code>-DED25519_INLINE_ASM</code> to disable the use of custom assembler routines and instead rely on portable C.</p>
<p>Use <code>-DED25519_FORCE_32BIT</code> to force the use of 32 bit routines even when compiling for 64 bit.</p>
<h5>32-bit</h5>
<pre class="fragment">gcc ed25519.c -m32 -O3 -c
</pre><h5>64-bit</h5>
<pre class="fragment">gcc ed25519.c -m64 -O3 -c
</pre><h5>SSE2</h5>
<pre class="fragment">gcc ed25519.c -m32 -O3 -c -DED25519_SSE2 -msse2
gcc ed25519.c -m64 -O3 -c -DED25519_SSE2
</pre><p>clang and icc are also supported</p>
<h4>Usage</h4>
<p>To use the code, link against <code>ed25519.o -mbits</code> and: </p><pre class="fragment">#include "ed25519.h"
</pre><p>Add <code>-lssl -lcrypto</code> when using OpenSSL (Some systems don't need -lcrypto? It might be trial and error).</p>
<p>To generate a private key, simply generate 32 bytes from a secure cryptographic source: </p><pre class="fragment">ed25519_secret_key sk;
randombytes(sk, sizeof(ed25519_secret_key));
</pre><p>To generate a public key: </p><pre class="fragment">ed25519_public_key pk;
ed25519_publickey(sk, pk);
</pre><p>To sign a message: </p><pre class="fragment">ed25519_signature sig;
ed25519_sign(message, message_len, sk, pk, signature);
</pre><p>To verify a signature: </p><pre class="fragment">int valid = ed25519_sign_open(message, message_len, pk, signature) == 0;
</pre><p>To batch verify signatures: </p><pre class="fragment">const unsigned char *mp[num] = {message1, message2..}
size_t ml[num] = {message_len1, message_len2..}
const unsigned char *pkp[num] = {pk1, pk2..}
const unsigned char *sigp[num] = {signature1, signature2..}
int valid[num]

/* valid[i] will be set to 1 if the individual signature was valid, 0 otherwise */
int all_valid = ed25519_sign_open_batch(mp, ml, pkp, sigp, num, valid) == 0;
</pre><p><b>Note</b>: Batch verification uses <code>ed25519_randombytes_unsafe</code>, implemented in <code><a class="el" href="ed25519-randombytes_8h_source.html">ed25519-randombytes.h</a></code>, to generate random scalars for the verification code. The default implementation now uses OpenSSLs <code>RAND_bytes</code>.</p>
<p>Unlike the <a href="http://bench.cr.yp.to/supercop.html">SUPERCOP</a> version, signatures are not appended to messages, and there is no need for padding in front of messages. Additionally, the secret key does not contain a copy of the public key, so it is 32 bytes instead of 64 bytes, and the public key must be provided to the signing function.</p>
<h5>Curve25519</h5>
<p>Curve25519 public keys can be generated thanks to <a href="http://www.imperialviolet.org/2013/05/10/fastercurve25519.html">Adam Langley</a> leveraging Ed25519's precomputed basepoint scalar multiplication. </p><pre class="fragment">curved25519_key sk, pk;
randombytes(sk, sizeof(curved25519_key));
curved25519_scalarmult_basepoint(pk, sk);
</pre><p>Note the name is curved25519, a combination of curve and ed25519, to prevent name clashes. Performance is slightly faster than short message ed25519 signing due to both using the same code for the scalar multiply.</p>
<h4>Testing</h4>
<p>Fuzzing against reference implemenations is now available. See fuzz/README.</p>
<p>Building <code>ed25519.c</code> with <code>-DED25519_TEST</code> and linking with <code>test.c</code> will run basic sanity tests and benchmark each function. <code>test-batch.c</code> has been incorporated in to <code>test.c</code>.</p>
<p><code>test-internals.c</code> is standalone and built the same way as <code>ed25519.c</code>. It tests the math primitives with extreme values to ensure they function correctly. SSE2 is now supported.</p>
<h4>Papers</h4>
<p><a href="http://ed25519.cr.yp.to/papers.html">Available on the Ed25519 website</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
