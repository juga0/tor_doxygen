<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/circuitbuild.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">circuitbuild.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements the details of building circuits (by chosing paths, constructing/sending create/extend cells, and so on).  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="channel_8h_source.html">channel.h</a>&quot;</code><br />
<code>#include &quot;circpathbias.h&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitbuild_8h_source.html">circuitbuild.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitlist_8h_source.html">circuitlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitstats_8h_source.html">circuitstats.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuituse_8h_source.html">circuituse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="command_8h_source.html">command.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;confparse.h&quot;</code><br />
<code>#include &quot;<a class="el" href="connection_8h_source.html">connection.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="connection__edge_8h_source.html">connection_edge.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="connection__or_8h_source.html">connection_or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="control_8h_source.html">control.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto_8h_source.html">crypto.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="directory_8h_source.html">directory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="entrynodes_8h_source.html">entrynodes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="main_8h_source.html">main.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="microdesc_8h_source.html">microdesc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="networkstatus_8h_source.html">networkstatus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nodelist_8h_source.html">nodelist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="onion_8h_source.html">onion.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="onion__tap_8h_source.html">onion_tap.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="onion__fast_8h_source.html">onion_fast.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="policies_8h_source.html">policies.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="relay_8h_source.html">relay.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendcommon_8h_source.html">rendcommon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rephist_8h_source.html">rephist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="router_8h_source.html">router.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerlist_8h_source.html">routerlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerparse_8h_source.html">routerparse.h</a>&quot;</code><br />
<code>#include &quot;routerset.h&quot;</code><br />
<code>#include &quot;<a class="el" href="transports_8h_source.html">transports.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for circuitbuild.c:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2circuitbuild_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2circuitbuild_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2circuitbuild_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="542,333,586,360"/>
<area shape="rect" id="node5" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="5,483,75,509"/>
<area shape="rect" id="node19" href="channel_8h.html" title="Header file for channel.c. " alt="" coords="502,184,581,211"/>
<area shape="rect" id="node21" href="circpathbias_8h_source.html" title="circpathbias.h" alt="" coords="601,109,703,136"/>
<area shape="rect" id="node22" href="circuitbuild_8h.html" title="Header file for circuitbuild.c. " alt="" coords="727,109,822,136"/>
<area shape="rect" id="node23" href="circuitlist_8h.html" title="Header file for circuitlist.c. " alt="" coords="847,109,932,136"/>
<area shape="rect" id="node24" href="circuitstats_8h.html" title="Header file for circuitstats.c. " alt="" coords="957,109,1054,136"/>
<area shape="rect" id="node25" href="circuituse_8h.html" title="Header file for circuituse.c. " alt="" coords="1078,109,1167,136"/>
<area shape="rect" id="node26" href="command_8h.html" title="Header file for command.c. " alt="" coords="435,109,525,136"/>
<area shape="rect" id="node27" href="config_8h.html" title="Header file for config.c. " alt="" coords="1191,109,1259,136"/>
<area shape="rect" id="node28" href="confparse_8h_source.html" title="confparse.h" alt="" coords="1284,109,1375,136"/>
<area shape="rect" id="node29" href="connection_8h.html" title="Header file for connection.c. " alt="" coords="1399,109,1495,136"/>
<area shape="rect" id="node30" href="connection__edge_8h.html" title="Header file for connection_edge.c. " alt="" coords="1519,109,1649,136"/>
<area shape="rect" id="node31" href="connection__or_8h.html" title="Header file for connection_or.c. " alt="" coords="1673,109,1788,136"/>
<area shape="rect" id="node32" href="control_8h.html" title="Header file for control.c. " alt="" coords="1812,109,1884,136"/>
<area shape="rect" id="node33" href="directory_8h.html" title="Header file for directory.c. " alt="" coords="1908,109,1991,136"/>
<area shape="rect" id="node34" href="entrynodes_8h.html" title="Header file for circuitbuild.c. " alt="" coords="2015,109,2113,136"/>
<area shape="rect" id="node35" href="main_8h.html" title="Header file for main.c. " alt="" coords="2137,109,2199,136"/>
<area shape="rect" id="node36" href="microdesc_8h.html" title="Header file for microdesc.c. " alt="" coords="2223,109,2316,136"/>
<area shape="rect" id="node37" href="networkstatus_8h.html" title="Header file for networkstatus.c. " alt="" coords="2340,109,2455,136"/>
<area shape="rect" id="node38" href="nodelist_8h.html" title="Header file for nodelist.c. " alt="" coords="2479,109,2558,136"/>
<area shape="rect" id="node39" href="onion_8h.html" title="Header file for onion.c. " alt="" coords="2583,109,2647,136"/>
<area shape="rect" id="node40" href="onion__tap_8h.html" title="Header file for onion_tap.c. " alt="" coords="2671,109,2761,136"/>
<area shape="rect" id="node41" href="onion__fast_8h.html" title="Header file for onion_fast.c. " alt="" coords="2785,109,2879,136"/>
<area shape="rect" id="node42" href="policies_8h.html" title="Header file for policies.c. " alt="" coords="2903,109,2980,136"/>
<area shape="rect" id="node43" href="relay_8h.html" title="Header file for relay.c. " alt="" coords="3004,109,3065,136"/>
<area shape="rect" id="node44" href="rendcommon_8h.html" title="Header file for rendcommon.c. " alt="" coords="3090,109,3198,136"/>
<area shape="rect" id="node45" href="rephist_8h.html" title="Header file for rephist.c. " alt="" coords="3223,109,3295,136"/>
<area shape="rect" id="node46" href="router_8h.html" title="Header file for router.c. " alt="" coords="3319,109,3385,136"/>
<area shape="rect" id="node47" href="routerlist_8h.html" title="Header file for routerlist.c. " alt="" coords="3409,109,3492,136"/>
<area shape="rect" id="node48" href="routerparse_8h.html" title="Header file for routerparse.c. " alt="" coords="3516,109,3615,136"/>
<area shape="rect" id="node49" href="routerset_8h_source.html" title="routerset.h" alt="" coords="3639,109,3723,136"/>
<area shape="rect" id="node50" href="transports_8h.html" title="Headers for transports.c. " alt="" coords="3748,109,3839,136"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="562,707,641,733"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="313,632,375,659"/>
<area shape="rect" id="node6" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="183,408,297,435"/>
<area shape="rect" id="node7" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="193,483,319,509"/>
<area shape="rect" id="node8" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="201,557,343,584"/>
<area shape="rect" id="node9" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="45,408,107,435"/>
<area shape="rect" id="node10" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="679,408,745,435"/>
<area shape="rect" id="node11" href="container_8h_source.html" title="container.h" alt="" coords="639,483,726,509"/>
<area shape="rect" id="node12" href="torgzip_8h.html" title="Headers for torgzip.h. " alt="" coords="769,408,841,435"/>
<area shape="rect" id="node13" href="address_8h.html" title="Headers for address.h. " alt="" coords="525,408,603,435"/>
<area shape="rect" id="node14" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="857,632,985,659"/>
<area shape="rect" id="node15" href="ht_8h_source.html" title="ht.h" alt="" coords="866,408,910,435"/>
<area shape="rect" id="node16" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="934,408,1037,435"/>
<area shape="rect" id="node17" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="1061,408,1152,435"/>
<area shape="rect" id="node18" href="util__format_8h_source.html" title="util_format.h" alt="" coords="367,557,462,584"/>
<area shape="rect" id="node20" href="circuitmux_8h.html" title="Header file for circuitmux.c. " alt="" coords="475,259,568,285"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a23f84756b87be3dfd9502f81d5cff37a"><td class="memItemLeft" align="right" valign="top"><a id="a23f84756b87be3dfd9502f81d5cff37a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CIRCUITBUILD_PRIVATE</b></td></tr>
<tr class="separator:a23f84756b87be3dfd9502f81d5cff37a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23f84756b87be3dfd9502f81d5cff37a"><td class="memItemLeft" align="right" valign="top"><a id="a23f84756b87be3dfd9502f81d5cff37a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CIRCUITBUILD_PRIVATE</b></td></tr>
<tr class="separator:a23f84756b87be3dfd9502f81d5cff37a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09a93cba218e829f669c449dbfed0274"><td class="memItemLeft" align="right" valign="top"><a id="a09a93cba218e829f669c449dbfed0274"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_CIRCID_ATTEMPTS</b>&#160;&#160;&#160;64</td></tr>
<tr class="separator:a09a93cba218e829f669c449dbfed0274"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a47a64590349d3779873b1364ea57f493"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="or_8h.html#a6607d3e1cd2b5deca02212435116a2ac">circid_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a47a64590349d3779873b1364ea57f493">get_unique_circ_id_by_chan</a> (<a class="el" href="structchannel__s.html">channel_t</a> *chan)</td></tr>
<tr class="separator:a47a64590349d3779873b1364ea57f493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f985be42c44b9f401f9538b18a43b58"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a1f985be42c44b9f401f9538b18a43b58">circuit_list_path</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ, int verbose)</td></tr>
<tr class="separator:a1f985be42c44b9f401f9538b18a43b58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63c73dbf853d0e5ee7bbd00009c94e57"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a63c73dbf853d0e5ee7bbd00009c94e57">circuit_list_path_for_controller</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:a63c73dbf853d0e5ee7bbd00009c94e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40cc65f3c1820f93996af79209385f7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a40cc65f3c1820f93996af79209385f7c">circuit_log_path</a> (int severity, unsigned int domain, <a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:a40cc65f3c1820f93996af79209385f7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf0a845654a793ae2d771696ef42ca7d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#acf0a845654a793ae2d771696ef42ca7d">circuit_rep_hist_note_result</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:acf0a845654a793ae2d771696ef42ca7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8532320d2ec89a1d23738911ef3673f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#ac8532320d2ec89a1d23738911ef3673f">origin_circuit_init</a> (uint8_t purpose, int flags)</td></tr>
<tr class="separator:ac8532320d2ec89a1d23738911ef3673f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39fa414f8544e3924490ea2a40b540af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a39fa414f8544e3924490ea2a40b540af">circuit_establish_circuit</a> (uint8_t purpose, <a class="el" href="structextend__info__t.html">extend_info_t</a> *exit_ei, int flags)</td></tr>
<tr class="separator:a39fa414f8544e3924490ea2a40b540af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b5e1718bcb6aebffa4925124d34a3f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a31b5e1718bcb6aebffa4925124d34a3f">circuit_handle_first_hop</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:a31b5e1718bcb6aebffa4925124d34a3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fa06f5bb2ee0edfd8f7a82776574133"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a9fa06f5bb2ee0edfd8f7a82776574133">circuit_n_chan_done</a> (<a class="el" href="structchannel__s.html">channel_t</a> *chan, int status, int close_origin_circuits)</td></tr>
<tr class="separator:a9fa06f5bb2ee0edfd8f7a82776574133"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acccfc2539c7dd13ca9db049b3decc386"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#acccfc2539c7dd13ca9db049b3decc386">inform_testing_reachability</a> (void)</td></tr>
<tr class="separator:acccfc2539c7dd13ca9db049b3decc386"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4c79689688591a1952b279dcdac792f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#ae4c79689688591a1952b279dcdac792f">circuit_timeout_want_to_count_circ</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:ae4c79689688591a1952b279dcdac792f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad10a43182d0912b72adbbc2c1911e81c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#ad10a43182d0912b72adbbc2c1911e81c">circuit_send_next_onion_skin</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:ad10a43182d0912b72adbbc2c1911e81c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9850a0ba60e6a62bc0a7267343418235"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a9850a0ba60e6a62bc0a7267343418235">circuit_note_clock_jumped</a> (int seconds_elapsed)</td></tr>
<tr class="separator:a9850a0ba60e6a62bc0a7267343418235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3767c914fa8ea632b4aa9cd4843072eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a3767c914fa8ea632b4aa9cd4843072eb">circuit_extend</a> (<a class="el" href="structcell__t.html">cell_t</a> *cell, <a class="el" href="structcircuit__t.html">circuit_t</a> *circ)</td></tr>
<tr class="separator:a3767c914fa8ea632b4aa9cd4843072eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6e1de1a8a6bb7f32b780321e1d7745d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#ad6e1de1a8a6bb7f32b780321e1d7745d">circuit_init_cpath_crypto</a> (<a class="el" href="structcrypt__path__t.html">crypt_path_t</a> *cpath, const char *key_data, int reverse)</td></tr>
<tr class="separator:ad6e1de1a8a6bb7f32b780321e1d7745d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3a0059a90a05da5003290fdf0274f0d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#ad3a0059a90a05da5003290fdf0274f0d">circuit_finish_handshake</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ, const <a class="el" href="structcreated__cell__t.html">created_cell_t</a> *reply)</td></tr>
<tr class="separator:ad3a0059a90a05da5003290fdf0274f0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ae61681570706f3a27c9d77cee2af95"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a1ae61681570706f3a27c9d77cee2af95">circuit_truncated</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ, <a class="el" href="structcrypt__path__t.html">crypt_path_t</a> *layer, int reason)</td></tr>
<tr class="separator:a1ae61681570706f3a27c9d77cee2af95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0580c51628841ddaa2bf99d4475881bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a0580c51628841ddaa2bf99d4475881bf">onionskin_answer</a> (<a class="el" href="structor__circuit__t.html">or_circuit_t</a> *circ, const <a class="el" href="structcreated__cell__t.html">created_cell_t</a> *created_cell, const char *keys, const uint8_t *rend_circ_nonce)</td></tr>
<tr class="separator:a0580c51628841ddaa2bf99d4475881bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca4049f7852fb4f700bd919db39eceaf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#aca4049f7852fb4f700bd919db39eceaf">circuit_all_predicted_ports_handled</a> (time_t now, int *need_uptime, int *need_capacity)</td></tr>
<tr class="separator:aca4049f7852fb4f700bd919db39eceaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4ff606c3095afbd215def0474fdf544"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#ad4ff606c3095afbd215def0474fdf544">circuit_append_new_exit</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ, <a class="el" href="structextend__info__t.html">extend_info_t</a> *exit_ei)</td></tr>
<tr class="separator:ad4ff606c3095afbd215def0474fdf544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bed2f113a04b642c707529d8c853aff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a1bed2f113a04b642c707529d8c853aff">circuit_extend_to_new_exit</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ, <a class="el" href="structextend__info__t.html">extend_info_t</a> *exit_ei)</td></tr>
<tr class="separator:a1bed2f113a04b642c707529d8c853aff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11af4b3e748a9ab1ea4274f4ffcd168a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a11af4b3e748a9ab1ea4274f4ffcd168a">onion_append_to_cpath</a> (<a class="el" href="structcrypt__path__t.html">crypt_path_t</a> **head_ptr, <a class="el" href="structcrypt__path__t.html">crypt_path_t</a> *new_hop)</td></tr>
<tr class="separator:a11af4b3e748a9ab1ea4274f4ffcd168a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a550f632e8e414c563bd41e35dbd820db"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structnode__t.html">node_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a550f632e8e414c563bd41e35dbd820db">choose_good_entry_server</a> (uint8_t purpose, <a class="el" href="structcpath__build__state__t.html">cpath_build_state_t</a> *state)</td></tr>
<tr class="separator:a550f632e8e414c563bd41e35dbd820db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a117b09cbcdcf8f43a6b61226c83d7b93"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structextend__info__t.html">extend_info_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a117b09cbcdcf8f43a6b61226c83d7b93">extend_info_new</a> (const char *nickname, const char *digest, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *onion_key, const <a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> *curve25519_key, const <a class="el" href="structtor__addr__t.html">tor_addr_t</a> *addr, uint16_t port)</td></tr>
<tr class="separator:a117b09cbcdcf8f43a6b61226c83d7b93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75ef69147a75a28106140ff64dc49cd8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structextend__info__t.html">extend_info_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a75ef69147a75a28106140ff64dc49cd8">extend_info_from_node</a> (const <a class="el" href="structnode__t.html">node_t</a> *node, int for_direct_connect)</td></tr>
<tr class="separator:a75ef69147a75a28106140ff64dc49cd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ee63ec586b7d4f06830954b9aefb037"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a2ee63ec586b7d4f06830954b9aefb037">extend_info_free</a> (<a class="el" href="structextend__info__t.html">extend_info_t</a> *info)</td></tr>
<tr class="separator:a2ee63ec586b7d4f06830954b9aefb037"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab87b30981d1baacf8452ccca39edc7ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structextend__info__t.html">extend_info_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#ab87b30981d1baacf8452ccca39edc7ae">extend_info_dup</a> (<a class="el" href="structextend__info__t.html">extend_info_t</a> *info)</td></tr>
<tr class="separator:ab87b30981d1baacf8452ccca39edc7ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a670517df044b68c0ec0db07a2447b29c"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structnode__t.html">node_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a670517df044b68c0ec0db07a2447b29c">build_state_get_exit_node</a> (<a class="el" href="structcpath__build__state__t.html">cpath_build_state_t</a> *state)</td></tr>
<tr class="separator:a670517df044b68c0ec0db07a2447b29c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0509680051f34495e2fcb706ea5c994e"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#a0509680051f34495e2fcb706ea5c994e">build_state_get_exit_nickname</a> (<a class="el" href="structcpath__build__state__t.html">cpath_build_state_t</a> *state)</td></tr>
<tr class="separator:a0509680051f34495e2fcb706ea5c994e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af294fbb6c7b0647de3407c028ee0e2c1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitbuild_8c.html#af294fbb6c7b0647de3407c028ee0e2c1">extend_info_addr_is_allowed</a> (const <a class="el" href="structtor__addr__t.html">tor_addr_t</a> *addr)</td></tr>
<tr class="separator:af294fbb6c7b0647de3407c028ee0e2c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69ab9d6ff0b650461a933e1908783ee3"><td class="memItemLeft" align="right" valign="top"><a id="a69ab9d6ff0b650461a933e1908783ee3"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>extend_info_supports_tap</b> (const <a class="el" href="structextend__info__t.html">extend_info_t</a> *ei)</td></tr>
<tr class="separator:a69ab9d6ff0b650461a933e1908783ee3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5ea65130569d610c761aea3fc61f102"><td class="memItemLeft" align="right" valign="top"><a id="aa5ea65130569d610c761aea3fc61f102"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>extend_info_supports_ntor</b> (const <a class="el" href="structextend__info__t.html">extend_info_t</a> *ei)</td></tr>
<tr class="separator:aa5ea65130569d610c761aea3fc61f102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a089103c0c67c0928462299e08299502b"><td class="memItemLeft" align="right" valign="top"><a id="a089103c0c67c0928462299e08299502b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>circuit_can_use_tap</b> (const <a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:a089103c0c67c0928462299e08299502b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a785dbaa9e899ee6e76223fe709760a79"><td class="memItemLeft" align="right" valign="top"><a id="a785dbaa9e899ee6e76223fe709760a79"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>circuit_has_usable_onion_key</b> (const <a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:a785dbaa9e899ee6e76223fe709760a79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66bf9c184153afb3f509a0f22b9b68d0"><td class="memItemLeft" align="right" valign="top"><a id="a66bf9c184153afb3f509a0f22b9b68d0"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>extend_info_has_preferred_onion_key</b> (const <a class="el" href="structextend__info__t.html">extend_info_t</a> *ei)</td></tr>
<tr class="separator:a66bf9c184153afb3f509a0f22b9b68d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements the details of building circuits (by chosing paths, constructing/sending create/extend cells, and so on). </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0509680051f34495e2fcb706ea5c994e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0509680051f34495e2fcb706ea5c994e">&#9670;&nbsp;</a></span>build_state_get_exit_nickname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* build_state_get_exit_nickname </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcpath__build__state__t.html">cpath_build_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the nickname for the chosen exit router in <b>state</b>. If there is no chosen exit, or if we don't know the <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> for the chosen exit, return NULL. </p>

</div>
</div>
<a id="a670517df044b68c0ec0db07a2447b29c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a670517df044b68c0ec0db07a2447b29c">&#9670;&nbsp;</a></span>build_state_get_exit_node()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structnode__t.html">node_t</a>* build_state_get_exit_node </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcpath__build__state__t.html">cpath_build_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> for the chosen exit router in <b>state</b>. If there is no chosen exit, or if we don't know the <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> for the chosen exit, return NULL. </p>

</div>
</div>
<a id="a550f632e8e414c563bd41e35dbd820db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a550f632e8e414c563bd41e35dbd820db">&#9670;&nbsp;</a></span>choose_good_entry_server()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structnode__t.html">node_t</a>* choose_good_entry_server </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcpath__build__state__t.html">cpath_build_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pick a good entry server for the circuit to be built according to <b>state</b>. Don't reuse a chosen exit (if any), don't use this router (if we're an OR), and respect firewall settings; if we're configured to use entry guards, return one.</p>
<p>If <b>state</b> is NULL, we're choosing a router to serve as an entry guard, not for any particular circuit. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_a550f632e8e414c563bd41e35dbd820db_icgraph.png" border="0" usemap="#circuitbuild_8c_a550f632e8e414c563bd41e35dbd820db_icgraph" alt=""/></div>
<map name="circuitbuild_8c_a550f632e8e414c563bd41e35dbd820db_icgraph" id="circuitbuild_8c_a550f632e8e414c563bd41e35dbd820db_icgraph">
<area shape="rect" id="node2" href="entrynodes_8c.html#a12aaa196d99fc0a6a4416c17f8274e76" title="add_an_entry_guard" alt="" coords="232,5,371,32"/>
</map>
</div>

</div>
</div>
<a id="aca4049f7852fb4f700bd919db39eceaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca4049f7852fb4f700bd919db39eceaf">&#9670;&nbsp;</a></span>circuit_all_predicted_ports_handled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_all_predicted_ports_handled </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>need_uptime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>need_capacity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return 1 if we already have circuits present or on the way for all anticipated ports. Return 0 if we should make more.</p>
<p>If we're returning 0, set need_uptime and need_capacity to indicate any requirements that the unhandled ports have. </p>

</div>
</div>
<a id="ad4ff606c3095afbd215def0474fdf544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4ff606c3095afbd215def0474fdf544">&#9670;&nbsp;</a></span>circuit_append_new_exit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_append_new_exit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structextend__info__t.html">extend_info_t</a> *&#160;</td>
          <td class="paramname"><em>exit_ei</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Give <b>circ</b> a new exit destination to <b>exit</b>, and add a hop to the cpath reflecting this. Don't send the next extend cell &ndash; the caller will do this if it wants to. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_ad4ff606c3095afbd215def0474fdf544_cgraph.png" border="0" usemap="#circuitbuild_8c_ad4ff606c3095afbd215def0474fdf544_cgraph" alt=""/></div>
<map name="circuitbuild_8c_ad4ff606c3095afbd215def0474fdf544_cgraph" id="circuitbuild_8c_ad4ff606c3095afbd215def0474fdf544_cgraph">
<area shape="rect" id="node2" href="circuitbuild_8c.html#a2ee63ec586b7d4f06830954b9aefb037" title="extend_info_free" alt="" coords="219,5,337,32"/>
<area shape="rect" id="node4" href="circuitbuild_8c.html#ab87b30981d1baacf8452ccca39edc7ae" title="extend_info_dup" alt="" coords="219,56,337,83"/>
<area shape="rect" id="node3" href="crypto_8c.html#a2a5f687763115d7c79f977a0abfddaff" title="crypto_pk_free" alt="" coords="385,5,493,32"/>
</map>
</div>

</div>
</div>
<a id="a39fa414f8544e3924490ea2a40b540af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39fa414f8544e3924490ea2a40b540af">&#9670;&nbsp;</a></span>circuit_establish_circuit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a>* circuit_establish_circuit </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structextend__info__t.html">extend_info_t</a> *&#160;</td>
          <td class="paramname"><em>exit_ei</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Build a new circuit for <b>purpose</b>. If <b>exit</b> is defined, then use that as your exit router, else choose a suitable exit node.</p>
<p>Also launch a connection to the first OR in the chosen path, if it's not open already. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_a39fa414f8544e3924490ea2a40b540af_cgraph.png" border="0" usemap="#circuitbuild_8c_a39fa414f8544e3924490ea2a40b540af_cgraph" alt=""/></div>
<map name="circuitbuild_8c_a39fa414f8544e3924490ea2a40b540af_cgraph" id="circuitbuild_8c_a39fa414f8544e3924490ea2a40b540af_cgraph">
<area shape="rect" id="node2" href="circuitbuild_8c.html#ac8532320d2ec89a1d23738911ef3673f" title="origin_circuit_init" alt="" coords="212,31,331,57"/>
<area shape="rect" id="node3" href="circuitlist_8c.html#a543a0ac445cdd07bd65cd176092a48a8" title="origin_circuit_new" alt="" coords="379,5,505,32"/>
<area shape="rect" id="node4" href="circuitlist_8c.html#a59a56e94fe3ac816942314b7172c3b30" title="circuit_set_state" alt="" coords="383,56,501,83"/>
<area shape="rect" id="node5" href="container_8c.html#ad318adf5db2ec229a43c0c567e1f6fce" title="smartlist_remove" alt="" coords="553,31,676,57"/>
<area shape="rect" id="node6" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="565,81,665,108"/>
</map>
</div>

</div>
</div>
<a id="a3767c914fa8ea632b4aa9cd4843072eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3767c914fa8ea632b4aa9cd4843072eb">&#9670;&nbsp;</a></span>circuit_extend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_extend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcell__t.html">cell_t</a> *&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcircuit__t.html">circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Take the 'extend' <b>cell</b>, pull out addr/port plus the onion skin and identity digest for the next hop. If we're already connected, pass the onion skin to the next hop using a create cell; otherwise launch a new OR connection, and <b>circ</b> will notice when the connection succeeds or fails.</p>
<p>Return -1 if we want to warn and tear down the circuit, else return 0. </p>

</div>
</div>
<a id="a1bed2f113a04b642c707529d8c853aff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bed2f113a04b642c707529d8c853aff">&#9670;&nbsp;</a></span>circuit_extend_to_new_exit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_extend_to_new_exit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structextend__info__t.html">extend_info_t</a> *&#160;</td>
          <td class="paramname"><em>exit_ei</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Take an open <b>circ</b>, and add a new hop at the end, based on <b>info</b>. Set its state back to CIRCUIT_STATE_BUILDING, and then send the next extend cell to begin connecting to that hop. </p>

</div>
</div>
<a id="ad3a0059a90a05da5003290fdf0274f0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3a0059a90a05da5003290fdf0274f0d">&#9670;&nbsp;</a></span>circuit_finish_handshake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_finish_handshake </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcreated__cell__t.html">created_cell_t</a> *&#160;</td>
          <td class="paramname"><em>reply</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A "created" cell <b>reply</b> came back to us on circuit <b>circ</b>. (The body of <b>reply</b> varies depending on what sort of handshake this is.)</p>
<p>Calculate the appropriate keys and digests, make sure KH is correct, and initialize this hop of the cpath.</p>
<p>Return - reason if we want to mark circ for close, else return 0. </p>

</div>
</div>
<a id="a31b5e1718bcb6aebffa4925124d34a3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31b5e1718bcb6aebffa4925124d34a3f">&#9670;&nbsp;</a></span>circuit_handle_first_hop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_handle_first_hop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Start establishing the first hop of our circuit. Figure out what OR we should connect to, and if necessary start the connection to it. If we're already connected, then send the 'create' cell. Return 0 for ok, -reason if circ should be marked-for-close. </p>

</div>
</div>
<a id="ad6e1de1a8a6bb7f32b780321e1d7745d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6e1de1a8a6bb7f32b780321e1d7745d">&#9670;&nbsp;</a></span>circuit_init_cpath_crypto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_init_cpath_crypto </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypt__path__t.html">crypt_path_t</a> *&#160;</td>
          <td class="paramname"><em>cpath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reverse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize cpath-&gt;{f|b}_{crypto|digest} from the key material in key_data. key_data must contain CPATH_KEY_MATERIAL bytes, which are used as follows:</p><ul>
<li>20 to initialize f_digest</li>
<li>20 to initialize b_digest</li>
<li>16 to key f_crypto</li>
<li>16 to key b_crypto</li>
</ul>
<p>(If 'reverse' is true, then f_XX and b_XX are swapped.) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_ad6e1de1a8a6bb7f32b780321e1d7745d_cgraph.png" border="0" usemap="#circuitbuild_8c_ad6e1de1a8a6bb7f32b780321e1d7745d_cgraph" alt=""/></div>
<map name="circuitbuild_8c_ad6e1de1a8a6bb7f32b780321e1d7745d_cgraph" id="circuitbuild_8c_ad6e1de1a8a6bb7f32b780321e1d7745d_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#ae92ffdfbeff07ba661ed65ca7791915d" title="crypto_digest_new" alt="" coords="191,5,322,32"/>
<area shape="rect" id="node3" href="crypto_8c.html#af702bc434eed2203f9dd1894ef5f5326" title="crypto_digest_add_bytes" alt="" coords="173,56,340,83"/>
<area shape="rect" id="node4" href="crypto_8c.html#a1a44157cdf50927218728fde6e863b1e" title="crypto_cipher_new" alt="" coords="191,107,322,133"/>
<area shape="rect" id="node5" href="crypto_8c.html#a5b2ea7a09521e9e4616f3452ca08eac4" title="crypto_cipher_new_with_bits" alt="" coords="388,107,579,133"/>
<area shape="rect" id="node6" href="crypto_8c.html#aacd663e7c452d602918a12bc666466a8" title="crypto_cipher_new_with\l_iv_and_bits" alt="" coords="627,99,789,141"/>
<area shape="rect" id="node7" href="aes_8c.html#a8e756990f15546ededa5afd6835eba06" title="aes_new_cipher" alt="" coords="837,107,953,133"/>
</map>
</div>

</div>
</div>
<a id="a1f985be42c44b9f401f9538b18a43b58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f985be42c44b9f401f9538b18a43b58">&#9670;&nbsp;</a></span>circuit_list_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* circuit_list_path </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If <b>verbose</b> is false, allocate and return a comma-separated list of the currently built elements of <b>circ</b>. If <b>verbose</b> is true, also list information about link status in a more verbose format using spaces. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_a1f985be42c44b9f401f9538b18a43b58_icgraph.png" border="0" usemap="#circuitbuild_8c_a1f985be42c44b9f401f9538b18a43b58_icgraph" alt=""/></div>
<map name="circuitbuild_8c_a1f985be42c44b9f401f9538b18a43b58_icgraph" id="circuitbuild_8c_a1f985be42c44b9f401f9538b18a43b58_icgraph">
<area shape="rect" id="node2" href="circuitbuild_8h.html#a40cc65f3c1820f93996af79209385f7c" title="circuit_log_path" alt="" coords="167,5,280,32"/>
</map>
</div>

</div>
</div>
<a id="a63c73dbf853d0e5ee7bbd00009c94e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63c73dbf853d0e5ee7bbd00009c94e57">&#9670;&nbsp;</a></span>circuit_list_path_for_controller()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* circuit_list_path_for_controller </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and return a comma-separated list of the currently built elements of <b>circ</b>, giving each as a verbose nickname. </p>

</div>
</div>
<a id="a40cc65f3c1820f93996af79209385f7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40cc65f3c1820f93996af79209385f7c">&#9670;&nbsp;</a></span>circuit_log_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_log_path </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log, at severity <b>severity</b>, the nicknames of each router in <b>circ</b>'s cpath. Also log the length of the cpath, and the intended exit point. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_a40cc65f3c1820f93996af79209385f7c_cgraph.png" border="0" usemap="#circuitbuild_8c_a40cc65f3c1820f93996af79209385f7c_cgraph" alt=""/></div>
<map name="circuitbuild_8c_a40cc65f3c1820f93996af79209385f7c_cgraph" id="circuitbuild_8c_a40cc65f3c1820f93996af79209385f7c_cgraph">
<area shape="rect" id="node2" href="circuitbuild_8c.html#a1f985be42c44b9f401f9538b18a43b58" title="circuit_list_path" alt="" coords="167,5,280,32"/>
<area shape="rect" id="node3" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="193,56,254,83"/>
</map>
</div>

</div>
</div>
<a id="a9fa06f5bb2ee0edfd8f7a82776574133"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fa06f5bb2ee0edfd8f7a82776574133">&#9670;&nbsp;</a></span>circuit_n_chan_done()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_n_chan_done </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structchannel__s.html">channel_t</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>close_origin_circuits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find any circuits that are waiting on <b>or_conn</b> to become open and get them to send their create cells forward.</p>
<p>Status is 1 if connect succeeded, or 0 if connect failed.</p>
<p>Close_origin_circuits is 1 if we should close all the origin circuits through this channel, or 0 otherwise. (This happens when we want to retry an older guard.) </p>

</div>
</div>
<a id="a9850a0ba60e6a62bc0a7267343418235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9850a0ba60e6a62bc0a7267343418235">&#9670;&nbsp;</a></span>circuit_note_clock_jumped()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_note_clock_jumped </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seconds_elapsed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Our clock just jumped by <b>seconds_elapsed</b>. Assume something has also gone wrong with our network: notify the user, and abandon all not-yet-used circuits. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_a9850a0ba60e6a62bc0a7267343418235_cgraph.png" border="0" usemap="#circuitbuild_8c_a9850a0ba60e6a62bc0a7267343418235_cgraph" alt=""/></div>
<map name="circuitbuild_8c_a9850a0ba60e6a62bc0a7267343418235_cgraph" id="circuitbuild_8c_a9850a0ba60e6a62bc0a7267343418235_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="231,5,292,32"/>
<area shape="rect" id="node3" href="control_8c.html#a1bd4001ec6bb62a01e1d6d6c3f3bf44a" title="control_event_general\l_status" alt="" coords="187,57,336,98"/>
<area shape="rect" id="node4" href="main_8c.html#a3c379175a5113f3cb9972ab5f4c4be7c" title="note_that_we_maybe\l_cant_complete_circuits" alt="" coords="180,122,343,163"/>
<area shape="rect" id="node5" href="control_8c.html#a92de51ab68d72df3bf43754758ba5c00" title="control_event_client\l_status" alt="" coords="192,187,331,229"/>
<area shape="rect" id="node6" href="circuitlist_8c.html#afbc3a3bf5eccd42bc5dc3f75d5aec392" title="circuit_mark_all_unused\l_circs" alt="" coords="180,253,343,294"/>
<area shape="rect" id="node7" href="circuitlist_8c.html#a52c4991dce45efd8d927b6092e3c85be" title="circuit_mark_all_dirty\l_circs_as_unusable" alt="" coords="189,318,334,359"/>
<area shape="rect" id="node10" href="main_8c.html#aa79d6ccbf076c44946971ac8dbbb5e1d" title="reset_all_main_loop\l_timers" alt="" coords="193,383,330,425"/>
<area shape="rect" id="node8" href="circuituse_8c.html#adf36645f7a473ad622918668f2f5ba33" title="mark_circuit_unusable\l_for_new_conns" alt="" coords="403,318,555,359"/>
<area shape="rect" id="node9" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="615,325,708,352"/>
<area shape="rect" id="node11" href="periodic_8c.html#ad9c12c89ef415b3c131f39f68534a974" title="periodic_event_reschedule" alt="" coords="391,391,567,417"/>
</map>
</div>

</div>
</div>
<a id="acf0a845654a793ae2d771696ef42ca7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf0a845654a793ae2d771696ef42ca7d">&#9670;&nbsp;</a></span>circuit_rep_hist_note_result()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_rep_hist_note_result </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tell the rep(utation)hist(ory) module about the status of the links in <b>circ</b>. Hops that have become OPEN are marked as successfully extended; the <em>first</em> hop that isn't open (if any) is marked as unable to extend. </p>

</div>
</div>
<a id="ad10a43182d0912b72adbbc2c1911e81c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad10a43182d0912b72adbbc2c1911e81c">&#9670;&nbsp;</a></span>circuit_send_next_onion_skin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_send_next_onion_skin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the backbone function for building circuits.</p>
<p>If circ's first hop is closed, then we need to build a create cell and send it forward.</p>
<p>Otherwise, we need to build a relay extend cell and send it forward.</p>
<p>Return -reason if we want to tear down circ, else return 0. </p>

</div>
</div>
<a id="ae4c79689688591a1952b279dcdac792f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4c79689688591a1952b279dcdac792f">&#9670;&nbsp;</a></span>circuit_timeout_want_to_count_circ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_timeout_want_to_count_circ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true if <b>circ</b> is the type of circuit we want to count timeouts from. In particular, we want it to have not completed yet (already completing indicates we cannibalized it), and we want it to have exactly three hops. </p>

</div>
</div>
<a id="a1ae61681570706f3a27c9d77cee2af95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ae61681570706f3a27c9d77cee2af95">&#9670;&nbsp;</a></span>circuit_truncated()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_truncated </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypt__path__t.html">crypt_path_t</a> *&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We received a relay truncated cell on circ.</p>
<p>Since we don't send truncates currently, getting a truncated means that a connection broke or an extend failed. For now, just give up: force circ to close, and return 0. </p>

</div>
</div>
<a id="af294fbb6c7b0647de3407c028ee0e2c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af294fbb6c7b0647de3407c028ee0e2c1">&#9670;&nbsp;</a></span>extend_info_addr_is_allowed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int extend_info_addr_is_allowed </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtor__addr__t.html">tor_addr_t</a> *&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff the given address can be used to extend to. </p>

</div>
</div>
<a id="ab87b30981d1baacf8452ccca39edc7ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab87b30981d1baacf8452ccca39edc7ae">&#9670;&nbsp;</a></span>extend_info_dup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structextend__info__t.html">extend_info_t</a>* extend_info_dup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structextend__info__t.html">extend_info_t</a> *&#160;</td>
          <td class="paramname"><em>info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and return a new <a class="el" href="structextend__info__t.html">extend_info_t</a> with the same contents as <b>info</b>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_ab87b30981d1baacf8452ccca39edc7ae_icgraph.png" border="0" usemap="#circuitbuild_8c_ab87b30981d1baacf8452ccca39edc7ae_icgraph" alt=""/></div>
<map name="circuitbuild_8c_ab87b30981d1baacf8452ccca39edc7ae_icgraph" id="circuitbuild_8c_ab87b30981d1baacf8452ccca39edc7ae_icgraph">
<area shape="rect" id="node2" href="circuitbuild_8h.html#aa05d447828e5c9a73d52a507314de966" title="circuit_append_new_exit" alt="" coords="171,5,336,32"/>
</map>
</div>

</div>
</div>
<a id="a2ee63ec586b7d4f06830954b9aefb037"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ee63ec586b7d4f06830954b9aefb037">&#9670;&nbsp;</a></span>extend_info_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void extend_info_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structextend__info__t.html">extend_info_t</a> *&#160;</td>
          <td class="paramname"><em>info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release storage held by an <a class="el" href="structextend__info__t.html">extend_info_t</a> struct. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_a2ee63ec586b7d4f06830954b9aefb037_cgraph.png" border="0" usemap="#circuitbuild_8c_a2ee63ec586b7d4f06830954b9aefb037_cgraph" alt=""/></div>
<map name="circuitbuild_8c_a2ee63ec586b7d4f06830954b9aefb037_cgraph" id="circuitbuild_8c_a2ee63ec586b7d4f06830954b9aefb037_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a2a5f687763115d7c79f977a0abfddaff" title="crypto_pk_free" alt="" coords="172,5,280,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_a2ee63ec586b7d4f06830954b9aefb037_icgraph.png" border="0" usemap="#circuitbuild_8c_a2ee63ec586b7d4f06830954b9aefb037_icgraph" alt=""/></div>
<map name="circuitbuild_8c_a2ee63ec586b7d4f06830954b9aefb037_icgraph" id="circuitbuild_8c_a2ee63ec586b7d4f06830954b9aefb037_icgraph">
<area shape="rect" id="node2" href="circuitbuild_8h.html#aa05d447828e5c9a73d52a507314de966" title="circuit_append_new_exit" alt="" coords="172,5,337,32"/>
<area shape="rect" id="node3" href="rendcommon_8h.html#a61dd29c390c943442cdd965fa9a31916" title="rend_intro_point_free" alt="" coords="183,56,326,83"/>
<area shape="rect" id="node8" href="rendservice_8h.html#ab1e1ab28c3798f2915cd7520110b37a1" title="rend_service_free_intro" alt="" coords="176,107,333,133"/>
<area shape="rect" id="node4" href="rendcommon_8h.html#a91927fc14b63a83089d9b0ee22184498" title="rend_service_descriptor_free" alt="" coords="385,31,575,57"/>
<area shape="rect" id="node6" href="rendservice_8c.html#a8cd5cb06a8e03c07ed7d120f90cee388" title="rend_service_free" alt="" coords="637,81,763,108"/>
<area shape="rect" id="node5" href="rendcache_8c.html#a2c5eb5e8ecaa713ec73cebc5ad4df905" title="rend_cache_entry_free" alt="" coords="623,31,777,57"/>
<area shape="rect" id="node7" href="rendservice_8h.html#ade90973329e24160017a04e0503397bd" title="rend_service_free_all" alt="" coords="825,81,971,108"/>
</map>
</div>

</div>
</div>
<a id="a75ef69147a75a28106140ff64dc49cd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75ef69147a75a28106140ff64dc49cd8">&#9670;&nbsp;</a></span>extend_info_from_node()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structextend__info__t.html">extend_info_t</a>* extend_info_from_node </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structnode__t.html">node_t</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>for_direct_connect</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and return a new extend_info that can be used to build a circuit to or through the node <b>node</b>. Use the primary address of the node (i.e. its IPv4 address) unless <b>for_direct_connect</b> is true, in which case the preferred address is used instead. May return NULL if there is not enough info about <b>node</b> to extend to it&ndash;for example, if there is no <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> or <a class="el" href="structmicrodesc__t.html">microdesc_t</a>, or if for_direct_connect is true and none of the node's addresses are allowed by tor's firewall and IP version config. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_a75ef69147a75a28106140ff64dc49cd8_cgraph.png" border="0" usemap="#circuitbuild_8c_a75ef69147a75a28106140ff64dc49cd8_cgraph" alt=""/></div>
<map name="circuitbuild_8c_a75ef69147a75a28106140ff64dc49cd8_cgraph" id="circuitbuild_8c_a75ef69147a75a28106140ff64dc49cd8_cgraph">
<area shape="rect" id="node2" href="policies_8c.html#a1f36bc146b27988b048c665c1d969ed8" title="fascist_firewall_choose\l_address_node" alt="" coords="211,5,369,47"/>
</map>
</div>

</div>
</div>
<a id="a117b09cbcdcf8f43a6b61226c83d7b93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a117b09cbcdcf8f43a6b61226c83d7b93">&#9670;&nbsp;</a></span>extend_info_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structextend__info__t.html">extend_info_t</a>* extend_info_new </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>nickname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>onion_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>curve25519_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtor__addr__t.html">tor_addr_t</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate a new extend_info object based on the various arguments. </p>

</div>
</div>
<a id="a47a64590349d3779873b1364ea57f493"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47a64590349d3779873b1364ea57f493">&#9670;&nbsp;</a></span>get_unique_circ_id_by_chan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="or_8h.html#a6607d3e1cd2b5deca02212435116a2ac">circid_t</a> get_unique_circ_id_by_chan </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structchannel__s.html">channel_t</a> *&#160;</td>
          <td class="paramname"><em>chan</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Search for a value for circ_id that we can use on <b>chan</b> for an outbound circuit, until we get a circ_id that is not in use by any other circuit on that conn.</p>
<p>Return it, or 0 if can't get a unique circ_id. </p>

</div>
</div>
<a id="acccfc2539c7dd13ca9db049b3decc386"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acccfc2539c7dd13ca9db049b3decc386">&#9670;&nbsp;</a></span>inform_testing_reachability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int inform_testing_reachability </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We've decided to start our reachability testing. If all is set, log this to the user. Return 1 if we did, or 0 if we chose not to log anything. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_acccfc2539c7dd13ca9db049b3decc386_cgraph.png" border="0" usemap="#circuitbuild_8c_acccfc2539c7dd13ca9db049b3decc386_cgraph" alt=""/></div>
<map name="circuitbuild_8c_acccfc2539c7dd13ca9db049b3decc386_cgraph" id="circuitbuild_8c_acccfc2539c7dd13ca9db049b3decc386_cgraph">
<area shape="rect" id="node2" href="address_8c.html#a8f295ab5aa41d0ada9f87607c7632d9c" title="tor_dup_ip" alt="" coords="261,56,343,83"/>
<area shape="rect" id="node5" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="712,56,799,83"/>
<area shape="rect" id="node7" href="control_8c.html#a744e1e120d455e1662fdbb4704a1be20" title="control_event_server\l_status" alt="" coords="231,158,373,199"/>
<area shape="rect" id="node3" href="compat_8c.html#aaf2add8a435d6a782f057562de228637" title="tor_inet_ntop" alt="" coords="421,56,519,83"/>
<area shape="rect" id="node4" href="address_8c.html#a78e7adae7e6b4e12cff810f6bd3a4e71" title="tor_inet_ntoa" alt="" coords="567,5,664,32"/>
<area shape="rect" id="node6" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="847,56,941,83"/>
</map>
</div>

</div>
</div>
<a id="a11af4b3e748a9ab1ea4274f4ffcd168a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11af4b3e748a9ab1ea4274f4ffcd168a">&#9670;&nbsp;</a></span>onion_append_to_cpath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void onion_append_to_cpath </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypt__path__t.html">crypt_path_t</a> **&#160;</td>
          <td class="paramname"><em>head_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypt__path__t.html">crypt_path_t</a> *&#160;</td>
          <td class="paramname"><em>new_hop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add <b>new_hop</b> to the end of the doubly-linked-list <b>head_ptr</b>. This function is used to extend cpath by another hop. </p>

</div>
</div>
<a id="a0580c51628841ddaa2bf99d4475881bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0580c51628841ddaa2bf99d4475881bf">&#9670;&nbsp;</a></span>onionskin_answer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int onionskin_answer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__circuit__t.html">or_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcreated__cell__t.html">created_cell_t</a> *&#160;</td>
          <td class="paramname"><em>created_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>rend_circ_nonce</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a response payload and keys, initialize, then send a created cell back. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_a0580c51628841ddaa2bf99d4475881bf_cgraph.png" border="0" usemap="#circuitbuild_8c_a0580c51628841ddaa2bf99d4475881bf_cgraph" alt=""/></div>
<map name="circuitbuild_8c_a0580c51628841ddaa2bf99d4475881bf_cgraph" id="circuitbuild_8c_a0580c51628841ddaa2bf99d4475881bf_cgraph">
<area shape="rect" id="node2" href="onion_8c.html#aba35efe0f395f7d1b20ad194a1488178" title="created_cell_format" alt="" coords="180,5,316,32"/>
</map>
</div>

</div>
</div>
<a id="ac8532320d2ec89a1d23738911ef3673f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8532320d2ec89a1d23738911ef3673f">&#9670;&nbsp;</a></span>origin_circuit_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a>* origin_circuit_init </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create and return a new origin circuit. Initialize its purpose and build-state based on our arguments. The <b>flags</b> argument is a bitfield of CIRCLAUNCH_* flags. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_ac8532320d2ec89a1d23738911ef3673f_cgraph.png" border="0" usemap="#circuitbuild_8c_ac8532320d2ec89a1d23738911ef3673f_cgraph" alt=""/></div>
<map name="circuitbuild_8c_ac8532320d2ec89a1d23738911ef3673f_cgraph" id="circuitbuild_8c_ac8532320d2ec89a1d23738911ef3673f_cgraph">
<area shape="rect" id="node2" href="circuitlist_8c.html#a543a0ac445cdd07bd65cd176092a48a8" title="origin_circuit_new" alt="" coords="172,5,299,32"/>
<area shape="rect" id="node3" href="circuitlist_8c.html#a59a56e94fe3ac816942314b7172c3b30" title="circuit_set_state" alt="" coords="176,56,295,83"/>
<area shape="rect" id="node4" href="container_8c.html#ad318adf5db2ec229a43c0c567e1f6fce" title="smartlist_remove" alt="" coords="347,31,469,57"/>
<area shape="rect" id="node5" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="358,81,458,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitbuild_8c_ac8532320d2ec89a1d23738911ef3673f_icgraph.png" border="0" usemap="#circuitbuild_8c_ac8532320d2ec89a1d23738911ef3673f_icgraph" alt=""/></div>
<map name="circuitbuild_8c_ac8532320d2ec89a1d23738911ef3673f_icgraph" id="circuitbuild_8c_ac8532320d2ec89a1d23738911ef3673f_icgraph">
<area shape="rect" id="node2" href="circuitbuild_8h.html#ad080a73b41f96d923417f2b5b3535f50" title="circuit_establish_circuit" alt="" coords="172,5,331,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
