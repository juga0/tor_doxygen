<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/hs_descriptor.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_95039623eb1ebeaf46c028778b39de98.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">hs_descriptor.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Handle hidden service descriptor encoding/decoding.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;ed25519_cert.h&quot;</code><br />
<code>#include &quot;<a class="el" href="hs__descriptor_8h_source.html">hs_descriptor.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitbuild_8h_source.html">circuitbuild.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="parsecommon_8h_source.html">parsecommon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendcache_8h_source.html">rendcache.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hs__cache_8h_source.html">hs_cache.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hs__config_8h_source.html">hs_config.h</a>&quot;</code><br />
<code>#include &quot;torcert.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for hs_descriptor.c:</div>
<div class="dyncontent">
<div class="center"><img src="hs__descriptor_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2hs__descriptor_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2hs__descriptor_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2hs__descriptor_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="1087,259,1131,285"/>
<area shape="rect" id="node37" href="ed25519__cert_8h_source.html" title="ed25519_cert.h" alt="" coords="2159,259,2270,285"/>
<area shape="rect" id="node41" href="hs__descriptor_8h.html" title="Header file for hs_descriptor.c. " alt="" coords="1693,184,1803,211"/>
<area shape="rect" id="node42" href="torcert_8h_source.html" title="torcert.h" alt="" coords="2013,259,2083,285"/>
<area shape="rect" id="node43" href="circuitbuild_8h.html" title="Header file for circuitbuild.c. " alt="" coords="2261,109,2355,136"/>
<area shape="rect" id="node44" href="parsecommon_8h.html" title="Header file for parsecommon.c. " alt="" coords="5,333,120,360"/>
<area shape="rect" id="node46" href="rendcache_8h.html" title="Header file for rendcache.c. " alt="" coords="1568,109,1661,136"/>
<area shape="rect" id="node48" href="hs__cache_8h.html" title="Header file for hs_cache.c. " alt="" coords="1822,109,1911,136"/>
<area shape="rect" id="node50" href="hs__config_8h.html" title="Header file containing configuration ABI/API for the HS subsytem. " alt="" coords="1213,184,1302,211"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="889,1020,967,1047"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="1634,945,1697,972"/>
<area shape="rect" id="node6" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="1841,408,1911,435"/>
<area shape="rect" id="node17" href="container_8h_source.html" title="container.h" alt="" coords="703,632,790,659"/>
<area shape="rect" id="node19" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="530,632,595,659"/>
<area shape="rect" id="node21" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1479,333,1593,360"/>
<area shape="rect" id="node22" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="1985,408,2111,435"/>
<area shape="rect" id="node23" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="1593,483,1735,509"/>
<area shape="rect" id="node25" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="713,408,775,435"/>
<area shape="rect" id="node27" href="compress_8h.html" title="Headers for compress.c. " alt="" coords="813,333,904,360"/>
<area shape="rect" id="node28" href="address_8h.html" title="Headers for address.h. " alt="" coords="851,557,930,584"/>
<area shape="rect" id="node29" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="67,871,195,897"/>
<area shape="rect" id="node30" href="ht_8h_source.html" title="ht.h" alt="" coords="929,333,973,360"/>
<area shape="rect" id="node31" href="confline_8h_source.html" title="confline.h" alt="" coords="646,483,725,509"/>
<area shape="rect" id="node32" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="997,333,1099,360"/>
<area shape="rect" id="node33" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="1124,333,1215,360"/>
<area shape="rect" id="node34" href="token__bucket_8h_source.html" title="token_bucket.h" alt="" coords="541,871,651,897"/>
<area shape="rect" id="node35" href="util__format_8h_source.html" title="util_format.h" alt="" coords="422,871,517,897"/>
<area shape="rect" id="node36" href="hs__circuitmap_8h.html" title="Header file for hs_circuitmap.c. " alt="" coords="1239,333,1353,360"/>
<area shape="rect" id="node8" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="640,945,739,972"/>
<area shape="rect" id="node9" href="compat_8h_source.html" title="compat.h" alt="" coords="898,789,974,815"/>
<area shape="rect" id="node14" href="util_8h.html" title="Headers for util.c. " alt="" coords="1253,707,1304,733"/>
<area shape="rect" id="node15" href="crypto__rsa_8h.html" title="Headers for crypto_rsa.c. " alt="" coords="1089,483,1183,509"/>
<area shape="rect" id="node20" href="keccak-tiny_8h_source.html" title="keccak&#45;tiny/keccak\l&#45;tiny.h" alt="" coords="2058,781,2193,823"/>
<area shape="rect" id="node11" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="829,945,937,972"/>
<area shape="rect" id="node13" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="879,871,1006,897"/>
<area shape="rect" id="node16" href="crypto__digest_8h.html" title="Headers for crypto_digest.c. " alt="" coords="1474,557,1585,584"/>
<area shape="rect" id="node18" href="siphash_8h_source.html" title="siphash.h" alt="" coords="707,707,786,733"/>
<area shape="rect" id="node24" href="crypto__openssl__mgt_8h_source.html" title="crypto_openssl_mgt.h" alt="" coords="1322,632,1473,659"/>
<area shape="rect" id="node26" href="compat__openssl_8h.html" title="compatibility definitions for working with different openssl forks " alt="" coords="1321,557,1449,584"/>
<area shape="rect" id="node39" href="trunnel_8h_source.html" title="trunnel.h" alt="" coords="2179,333,2251,360"/>
<area shape="rect" id="node45" href="memarea_8h_source.html" title="memarea.h" alt="" coords="33,408,119,435"/>
<area shape="rect" id="node47" href="rendcommon_8h.html" title="Header file for rendcommon.c. " alt="" coords="1561,184,1669,211"/>
<area shape="rect" id="node49" href="hs__common_8h.html" title="Header file containing common data for the whole HS subsytem. " alt="" coords="1929,184,2033,211"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af39a5f56871823d7cda85024b17c4ae8"><td class="memItemLeft" align="right" valign="top"><a id="af39a5f56871823d7cda85024b17c4ae8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>HS_DESCRIPTOR_PRIVATE</b></td></tr>
<tr class="separator:af39a5f56871823d7cda85024b17c4ae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae76afa77aa12233e08f0dd5bc413ceca"><td class="memItemLeft" align="right" valign="top"><a id="ae76afa77aa12233e08f0dd5bc413ceca"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_hs_desc</b>&#160;&#160;&#160;&quot;hs-descriptor&quot;</td></tr>
<tr class="separator:ae76afa77aa12233e08f0dd5bc413ceca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d9c07c482a5e92ea141cc04884c0d84"><td class="memItemLeft" align="right" valign="top"><a id="a1d9c07c482a5e92ea141cc04884c0d84"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_desc_cert</b>&#160;&#160;&#160;&quot;descriptor-signing-key-cert&quot;</td></tr>
<tr class="separator:a1d9c07c482a5e92ea141cc04884c0d84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a987ba1dd5d94c4ba522f688e2e7407"><td class="memItemLeft" align="right" valign="top"><a id="a8a987ba1dd5d94c4ba522f688e2e7407"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_rev_counter</b>&#160;&#160;&#160;&quot;revision-counter&quot;</td></tr>
<tr class="separator:a8a987ba1dd5d94c4ba522f688e2e7407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae38ac13d17f73cc6f010dd372fe8579d"><td class="memItemLeft" align="right" valign="top"><a id="ae38ac13d17f73cc6f010dd372fe8579d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_superencrypted</b>&#160;&#160;&#160;&quot;superencrypted&quot;</td></tr>
<tr class="separator:ae38ac13d17f73cc6f010dd372fe8579d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4645171480bb06ffbc170357cfdb2b8a"><td class="memItemLeft" align="right" valign="top"><a id="a4645171480bb06ffbc170357cfdb2b8a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_encrypted</b>&#160;&#160;&#160;&quot;encrypted&quot;</td></tr>
<tr class="separator:a4645171480bb06ffbc170357cfdb2b8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5613ce71be0cc4ed244f322bc30088fb"><td class="memItemLeft" align="right" valign="top"><a id="a5613ce71be0cc4ed244f322bc30088fb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_signature</b>&#160;&#160;&#160;&quot;signature&quot;</td></tr>
<tr class="separator:a5613ce71be0cc4ed244f322bc30088fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affa4952dc538962859014f4aaa266be3"><td class="memItemLeft" align="right" valign="top"><a id="affa4952dc538962859014f4aaa266be3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_lifetime</b>&#160;&#160;&#160;&quot;descriptor-lifetime&quot;</td></tr>
<tr class="separator:affa4952dc538962859014f4aaa266be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a032d47e104886122e0bf1a3d2935d1de"><td class="memItemLeft" align="right" valign="top"><a id="a032d47e104886122e0bf1a3d2935d1de"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_create2_formats</b>&#160;&#160;&#160;&quot;create2-formats&quot;</td></tr>
<tr class="separator:a032d47e104886122e0bf1a3d2935d1de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a202da1b0e049a14b08c65d831f4bba37"><td class="memItemLeft" align="right" valign="top"><a id="a202da1b0e049a14b08c65d831f4bba37"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_intro_auth_required</b>&#160;&#160;&#160;&quot;intro-auth-required&quot;</td></tr>
<tr class="separator:a202da1b0e049a14b08c65d831f4bba37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae132b93c144994c2229b1ec4bc763da7"><td class="memItemLeft" align="right" valign="top"><a id="ae132b93c144994c2229b1ec4bc763da7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_single_onion</b>&#160;&#160;&#160;&quot;single-onion-service&quot;</td></tr>
<tr class="separator:ae132b93c144994c2229b1ec4bc763da7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e29360606abf5e0671881e646c53025"><td class="memItemLeft" align="right" valign="top"><a id="a4e29360606abf5e0671881e646c53025"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_intro_point</b>&#160;&#160;&#160;&quot;introduction-point&quot;</td></tr>
<tr class="separator:a4e29360606abf5e0671881e646c53025"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a062dcca415a8ccae6ac0b23691a9e113"><td class="memItemLeft" align="right" valign="top"><a id="a062dcca415a8ccae6ac0b23691a9e113"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_ip_onion_key</b>&#160;&#160;&#160;&quot;onion-key&quot;</td></tr>
<tr class="separator:a062dcca415a8ccae6ac0b23691a9e113"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b5e5602d9e99fccd5dfe495aa20408c"><td class="memItemLeft" align="right" valign="top"><a id="a5b5e5602d9e99fccd5dfe495aa20408c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_ip_auth_key</b>&#160;&#160;&#160;&quot;auth-key&quot;</td></tr>
<tr class="separator:a5b5e5602d9e99fccd5dfe495aa20408c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d731023b3b7bbed47c689a76e80200e"><td class="memItemLeft" align="right" valign="top"><a id="a5d731023b3b7bbed47c689a76e80200e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_ip_enc_key</b>&#160;&#160;&#160;&quot;enc-key&quot;</td></tr>
<tr class="separator:a5d731023b3b7bbed47c689a76e80200e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f4e0182f741703e3eb8c8c1e36e52b1"><td class="memItemLeft" align="right" valign="top"><a id="a4f4e0182f741703e3eb8c8c1e36e52b1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_ip_enc_key_cert</b>&#160;&#160;&#160;&quot;enc-key-cert&quot;</td></tr>
<tr class="separator:a4f4e0182f741703e3eb8c8c1e36e52b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af77cca2fc28ba0a2f8cbf2a41b876a60"><td class="memItemLeft" align="right" valign="top"><a id="af77cca2fc28ba0a2f8cbf2a41b876a60"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_ip_legacy_key</b>&#160;&#160;&#160;&quot;legacy-key&quot;</td></tr>
<tr class="separator:af77cca2fc28ba0a2f8cbf2a41b876a60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a733acc48a6917a78bc63abf43a903020"><td class="memItemLeft" align="right" valign="top"><a id="a733acc48a6917a78bc63abf43a903020"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_ip_legacy_key_cert</b>&#160;&#160;&#160;&quot;legacy-key-cert&quot;</td></tr>
<tr class="separator:a733acc48a6917a78bc63abf43a903020"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fce6d3d36b718e96735f4e48b8deb97"><td class="memItemLeft" align="right" valign="top"><a id="a6fce6d3d36b718e96735f4e48b8deb97"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_intro_point_start</b>&#160;&#160;&#160;&quot;\n&quot; str_intro_point &quot; &quot;</td></tr>
<tr class="separator:a6fce6d3d36b718e96735f4e48b8deb97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9324a24702fe5300681129362c6eaf5a"><td class="memItemLeft" align="right" valign="top"><a id="a9324a24702fe5300681129362c6eaf5a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_enc_const_superencryption</b>&#160;&#160;&#160;&quot;hsdir-superencrypted-data&quot;</td></tr>
<tr class="separator:a9324a24702fe5300681129362c6eaf5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3b13c5dbbdf1ab12ba59cb6447d6a04"><td class="memItemLeft" align="right" valign="top"><a id="ad3b13c5dbbdf1ab12ba59cb6447d6a04"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_enc_const_encryption</b>&#160;&#160;&#160;&quot;hsdir-encrypted-data&quot;</td></tr>
<tr class="separator:ad3b13c5dbbdf1ab12ba59cb6447d6a04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcf0fc833ab53075e3f56d76f70e7657"><td class="memItemLeft" align="right" valign="top"><a id="abcf0fc833ab53075e3f56d76f70e7657"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_desc_sig_prefix</b>&#160;&#160;&#160;&quot;Tor onion service descriptor sig v3&quot;</td></tr>
<tr class="separator:abcf0fc833ab53075e3f56d76f70e7657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95b0fa7627906ca492bb6cc1bbf93012"><td class="memItemLeft" align="right" valign="top"><a id="a95b0fa7627906ca492bb6cc1bbf93012"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_desc_auth_type</b>&#160;&#160;&#160;&quot;desc-auth-type&quot;</td></tr>
<tr class="separator:a95b0fa7627906ca492bb6cc1bbf93012"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bc112298aabc82539d16f8a10598d43"><td class="memItemLeft" align="right" valign="top"><a id="a9bc112298aabc82539d16f8a10598d43"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_desc_auth_key</b>&#160;&#160;&#160;&quot;desc-auth-ephemeral-key&quot;</td></tr>
<tr class="separator:a9bc112298aabc82539d16f8a10598d43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3921f450c7b4c2233491881f4cceb9"><td class="memItemLeft" align="right" valign="top"><a id="a5e3921f450c7b4c2233491881f4cceb9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_desc_auth_client</b>&#160;&#160;&#160;&quot;auth-client&quot;</td></tr>
<tr class="separator:a5e3921f450c7b4c2233491881f4cceb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4645171480bb06ffbc170357cfdb2b8a"><td class="memItemLeft" align="right" valign="top"><a id="a4645171480bb06ffbc170357cfdb2b8a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>str_encrypted</b>&#160;&#160;&#160;&quot;encrypted&quot;</td></tr>
<tr class="separator:a4645171480bb06ffbc170357cfdb2b8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29ba31833e324399da956aef73b44dd4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>FILL_WITH_FAKE_DATA_AND_BASE64</b>(field)</td></tr>
<tr class="separator:a29ba31833e324399da956aef73b44dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8656464781dc3067e807fb225d29803c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hs__descriptor_8c.html#a8656464781dc3067e807fb225d29803c">CLIENT_AUTH_ENTRIES_BLOCK_SIZE</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a8656464781dc3067e807fb225d29803c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a068aff612796ca60dbed54b0dd7d41a4"><td class="memItemLeft" align="right" valign="top"><a id="a068aff612796ca60dbed54b0dd7d41a4"></a>
STATIC void&#160;</td><td class="memItemRight" valign="bottom"><b>desc_plaintext_data_free_contents</b> (<a class="el" href="strucths__desc__plaintext__data__t.html">hs_desc_plaintext_data_t</a> *desc)</td></tr>
<tr class="separator:a068aff612796ca60dbed54b0dd7d41a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d33a88bb5b5f6eca92e74fc940b8803"><td class="memItemLeft" align="right" valign="top"><a id="a6d33a88bb5b5f6eca92e74fc940b8803"></a>
STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><b>encode_link_specifiers</b> (const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *specs)</td></tr>
<tr class="separator:a6d33a88bb5b5f6eca92e74fc940b8803"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74aeebba225367734aafc154baad6030"><td class="memItemLeft" align="right" valign="top"><a id="a74aeebba225367734aafc154baad6030"></a>
STATIC size_t&#160;</td><td class="memItemRight" valign="bottom"><b>build_plaintext_padding</b> (const char *plaintext, size_t plaintext_len, uint8_t **padded_out)</td></tr>
<tr class="separator:a74aeebba225367734aafc154baad6030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48d0ea296e9c6e5f618f68b0ccd84b69"><td class="memItemLeft" align="right" valign="top"><a id="a48d0ea296e9c6e5f618f68b0ccd84b69"></a>
STATIC <a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>decode_link_specifiers</b> (const char *encoded)</td></tr>
<tr class="separator:a48d0ea296e9c6e5f618f68b0ccd84b69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded60336a9aba69dc18a573c5bf4280d"><td class="memItemLeft" align="right" valign="top"><a id="aded60336a9aba69dc18a573c5bf4280d"></a>
STATIC int&#160;</td><td class="memItemRight" valign="bottom"><b>cert_is_valid</b> (<a class="el" href="structtor__cert__st.html">tor_cert_t</a> *cert, uint8_t type, const char *log_obj_type)</td></tr>
<tr class="separator:aded60336a9aba69dc18a573c5bf4280d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9903b6f98a84b4768481b13cc09f4d07"><td class="memItemLeft" align="right" valign="top"><a id="a9903b6f98a84b4768481b13cc09f4d07"></a>
STATIC int&#160;</td><td class="memItemRight" valign="bottom"><b>encrypted_data_length_is_valid</b> (size_t len)</td></tr>
<tr class="separator:a9903b6f98a84b4768481b13cc09f4d07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae27bcb12a191d6c84b2bb1247d93be28"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hs__descriptor_8c.html#ae27bcb12a191d6c84b2bb1247d93be28">MOCK_IMPL</a> (STATIC size_t, decrypt_desc_layer,(const <a class="el" href="strucths__descriptor__t.html">hs_descriptor_t</a> *desc, const uint8_t *encrypted_blob, size_t encrypted_blob_size, int is_superencrypted_layer, char **decrypted_out))</td></tr>
<tr class="separator:ae27bcb12a191d6c84b2bb1247d93be28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6720cfaf0296f5550b071da45d5194fe"><td class="memItemLeft" align="right" valign="top"><a id="a6720cfaf0296f5550b071da45d5194fe"></a>
STATIC size_t&#160;</td><td class="memItemRight" valign="bottom"><b>decode_superencrypted</b> (const char *message, size_t message_len, uint8_t **encrypted_out)</td></tr>
<tr class="separator:a6720cfaf0296f5550b071da45d5194fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2f1ace49d05b5ce1839338a1b9cf7d2"><td class="memItemLeft" align="right" valign="top"><a id="af2f1ace49d05b5ce1839338a1b9cf7d2"></a>
STATIC <a class="el" href="strucths__desc__intro__point__t.html">hs_desc_intro_point_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>decode_introduction_point</b> (const <a class="el" href="strucths__descriptor__t.html">hs_descriptor_t</a> *desc, const char *start)</td></tr>
<tr class="separator:af2f1ace49d05b5ce1839338a1b9cf7d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c320518853338495f8306ac302ba95b"><td class="memItemLeft" align="right" valign="top"><a id="a4c320518853338495f8306ac302ba95b"></a>
STATIC int&#160;</td><td class="memItemRight" valign="bottom"><b>desc_sig_is_valid</b> (const char *b64_sig, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *signing_pubkey, const char *encoded_desc, size_t encoded_len)</td></tr>
<tr class="separator:a4c320518853338495f8306ac302ba95b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35e3d7b0b60b827838a231bee2a411df"><td class="memItemLeft" align="right" valign="top"><a id="a35e3d7b0b60b827838a231bee2a411df"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>hs_desc_decode_encrypted</b> (const <a class="el" href="strucths__descriptor__t.html">hs_descriptor_t</a> *desc, <a class="el" href="strucths__desc__encrypted__data__t.html">hs_desc_encrypted_data_t</a> *desc_encrypted)</td></tr>
<tr class="separator:a35e3d7b0b60b827838a231bee2a411df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a699490e52a6a084478e0cd0e353f2a7d"><td class="memItemLeft" align="right" valign="top"><a id="a699490e52a6a084478e0cd0e353f2a7d"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>hs_desc_decode_plaintext</b> (const char *encoded, <a class="el" href="strucths__desc__plaintext__data__t.html">hs_desc_plaintext_data_t</a> *plaintext)</td></tr>
<tr class="separator:a699490e52a6a084478e0cd0e353f2a7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7959d3d69fcaafa59657a4615d8a18b1"><td class="memItemLeft" align="right" valign="top"><a id="a7959d3d69fcaafa59657a4615d8a18b1"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>hs_desc_decode_descriptor</b> (const char *encoded, const uint8_t *subcredential, <a class="el" href="strucths__descriptor__t.html">hs_descriptor_t</a> **desc_out)</td></tr>
<tr class="separator:a7959d3d69fcaafa59657a4615d8a18b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0b60fed556c4cbd201a32d49f874005"><td class="memItemLeft" align="right" valign="top"><a id="ac0b60fed556c4cbd201a32d49f874005"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MOCK_IMPL</b> (int, hs_desc_encode_descriptor,(const <a class="el" href="strucths__descriptor__t.html">hs_descriptor_t</a> *desc, const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *signing_kp, char **encoded_out))</td></tr>
<tr class="separator:ac0b60fed556c4cbd201a32d49f874005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a1ef8446296bd4928c8d61a135b234"><td class="memItemLeft" align="right" valign="top"><a id="a20a1ef8446296bd4928c8d61a135b234"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>hs_desc_plaintext_data_free_</b> (<a class="el" href="strucths__desc__plaintext__data__t.html">hs_desc_plaintext_data_t</a> *desc)</td></tr>
<tr class="separator:a20a1ef8446296bd4928c8d61a135b234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad29a722deeb721ddded4faff69bf16a3"><td class="memItemLeft" align="right" valign="top"><a id="ad29a722deeb721ddded4faff69bf16a3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>hs_desc_encrypted_data_free_</b> (<a class="el" href="strucths__desc__encrypted__data__t.html">hs_desc_encrypted_data_t</a> *desc)</td></tr>
<tr class="separator:ad29a722deeb721ddded4faff69bf16a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80db7bdba3c892403a8cbb3d6fbe48ee"><td class="memItemLeft" align="right" valign="top"><a id="a80db7bdba3c892403a8cbb3d6fbe48ee"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>hs_descriptor_free_</b> (<a class="el" href="strucths__descriptor__t.html">hs_descriptor_t</a> *desc)</td></tr>
<tr class="separator:a80db7bdba3c892403a8cbb3d6fbe48ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a348d11321c32fc6f5ced7667aa9288ee"><td class="memItemLeft" align="right" valign="top"><a id="a348d11321c32fc6f5ced7667aa9288ee"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>hs_desc_plaintext_obj_size</b> (const <a class="el" href="strucths__desc__plaintext__data__t.html">hs_desc_plaintext_data_t</a> *data)</td></tr>
<tr class="separator:a348d11321c32fc6f5ced7667aa9288ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a7f8a2f1dd92f8a7f3d37c71b80e429"><td class="memItemLeft" align="right" valign="top"><a id="a5a7f8a2f1dd92f8a7f3d37c71b80e429"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>hs_desc_obj_size</b> (const <a class="el" href="strucths__descriptor__t.html">hs_descriptor_t</a> *data)</td></tr>
<tr class="separator:a5a7f8a2f1dd92f8a7f3d37c71b80e429"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05919436dfad6b5baf1ceda2f806927d"><td class="memItemLeft" align="right" valign="top"><a id="a05919436dfad6b5baf1ceda2f806927d"></a>
<a class="el" href="strucths__desc__intro__point__t.html">hs_desc_intro_point_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>hs_desc_intro_point_new</b> (void)</td></tr>
<tr class="separator:a05919436dfad6b5baf1ceda2f806927d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fa8c14a07374bd51c6cc4ae0e931fc0"><td class="memItemLeft" align="right" valign="top"><a id="a7fa8c14a07374bd51c6cc4ae0e931fc0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>hs_desc_intro_point_free_</b> (<a class="el" href="strucths__desc__intro__point__t.html">hs_desc_intro_point_t</a> *ip)</td></tr>
<tr class="separator:a7fa8c14a07374bd51c6cc4ae0e931fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64e658f32497a90c8432b10b95ac30d7"><td class="memItemLeft" align="right" valign="top"><a id="a64e658f32497a90c8432b10b95ac30d7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>hs_desc_link_specifier_free_</b> (<a class="el" href="strucths__desc__link__specifier__t.html">hs_desc_link_specifier_t</a> *ls)</td></tr>
<tr class="separator:a64e658f32497a90c8432b10b95ac30d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addb37a3f08379a31c83179b5d5bf3291"><td class="memItemLeft" align="right" valign="top"><a id="addb37a3f08379a31c83179b5d5bf3291"></a>
<a class="el" href="strucths__desc__link__specifier__t.html">hs_desc_link_specifier_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>hs_desc_link_specifier_new</b> (const <a class="el" href="structextend__info__t.html">extend_info_t</a> *info, uint8_t type)</td></tr>
<tr class="separator:addb37a3f08379a31c83179b5d5bf3291"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af34ba475947391833ef7b20bd6d423e3"><td class="memItemLeft" align="right" valign="top"><a id="af34ba475947391833ef7b20bd6d423e3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>hs_descriptor_clear_intro_points</b> (<a class="el" href="strucths__descriptor__t.html">hs_descriptor_t</a> *desc)</td></tr>
<tr class="separator:af34ba475947391833ef7b20bd6d423e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49f6a6635856b59da193318902fd7f06"><td class="memItemLeft" align="right" valign="top"><a id="a49f6a6635856b59da193318902fd7f06"></a>
<a class="el" href="structlink__specifier__st.html">link_specifier_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>hs_desc_lspec_to_trunnel</b> (const <a class="el" href="strucths__desc__link__specifier__t.html">hs_desc_link_specifier_t</a> *spec)</td></tr>
<tr class="separator:a49f6a6635856b59da193318902fd7f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Handle hidden service descriptor encoding/decoding. </p>
<p>Here is a graphical depiction of an HS descriptor and its layers: </p><pre class="fragment"> +------------------------------------------------------+
 |DESCRIPTOR HEADER:                                    |
 |  hs-descriptor 3                                     |
 |  descriptor-lifetime 180                             |
 |  ...                                                 |
 |  superencrypted                                      |
 |+---------------------------------------------------+ |
 ||SUPERENCRYPTED LAYER (aka OUTER ENCRYPTED LAYER):  | |
 ||  desc-auth-type x25519                            | |
 ||  desc-auth-ephemeral-key                          | |
 ||  auth-client                                      | |
 ||  auth-client                                      | |
 ||  ...                                              | |
 ||  encrypted                                        | |
 ||+-------------------------------------------------+| |
 |||ENCRYPTED LAYER (aka INNER ENCRYPTED LAYER):     || |
 |||  create2-formats                                || |
 |||  intro-auth-required                            || |
 |||  introduction-point                             || |
 |||  introduction-point                             || |
 |||  ...                                            || |
 ||+-------------------------------------------------+| |
 |+---------------------------------------------------+ |
 +------------------------------------------------------+
</pre><p>The DESCRIPTOR HEADER section is completely unencrypted and contains generic descriptor metadata.</p>
<p>The SUPERENCRYPTED LAYER section is the first layer of encryption, and it's encrypted using the blinded public key of the hidden service to protect against entities who don't know its onion address. The clients of the hidden service know its onion address and blinded public key, whereas third-parties (like HSDirs) don't know it (except if it's a public hidden service).</p>
<p>The ENCRYPTED LAYER section is the second layer of encryption, and it's encrypted using the client authorization key material (if those exist). When client authorization is enabled, this second layer of encryption protects the descriptor content from unauthorized entities. If client authorization is disabled, this second layer of encryption does not provide any extra security but is still present. The plaintext of this layer contains all the information required to connect to the hidden service like its list of introduction points. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a8656464781dc3067e807fb225d29803c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8656464781dc3067e807fb225d29803c">&#9670;&nbsp;</a></span>CLIENT_AUTH_ENTRIES_BLOCK_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CLIENT_AUTH_ENTRIES_BLOCK_SIZE&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many lines of "client-auth" we want in our descriptors; fake or not. </p>

</div>
</div>
<a id="a29ba31833e324399da956aef73b44dd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29ba31833e324399da956aef73b44dd4">&#9670;&nbsp;</a></span>FILL_WITH_FAKE_DATA_AND_BASE64</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FILL_WITH_FAKE_DATA_AND_BASE64</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">field</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">STMT_BEGIN         \</div><div class="line">  crypto_rand((<span class="keywordtype">char</span> *)field, <span class="keyword">sizeof</span>(field));                     \</div><div class="line">  retval = <a class="code" href="util__format_8c.html#a3f919cffd152c1dc1383c93ea6aa2c91">base64_encode_nopad</a>(field##_b64, <span class="keyword">sizeof</span>(field##_b64), \</div><div class="line">                               field, <span class="keyword">sizeof</span>(field));            \</div><div class="line">  tor_assert(retval &gt; 0);                                        \</div><div class="line">  STMT_END</div><div class="ttc" id="util__format_8c_html_a3f919cffd152c1dc1383c93ea6aa2c91"><div class="ttname"><a href="util__format_8c.html#a3f919cffd152c1dc1383c93ea6aa2c91">base64_encode_nopad</a></div><div class="ttdeci">int base64_encode_nopad(char *dest, size_t destlen, const uint8_t *src, size_t srclen)</div><div class="ttdef"><b>Definition:</b> util_format.c:296</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae27bcb12a191d6c84b2bb1247d93be28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae27bcb12a191d6c84b2bb1247d93be28">&#9670;&nbsp;</a></span>MOCK_IMPL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC&#160;</td>
          <td class="paramname"><em>size_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">decrypt_desc_layer&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(const <a class="el" href="strucths__descriptor__t.html">hs_descriptor_t</a> *desc, const uint8_t *encrypted_blob, size_t encrypted_blob_size, int is_superencrypted_layer, char **decrypted_out)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt an encrypted descriptor layer at <b>encrypted_blob</b> of size <b>encrypted_blob_size</b>. Use the descriptor object <b>desc</b> to generate the right decryption keys; set <b>decrypted_out</b> to the plaintext. If <b>is_superencrypted_layer</b> is set, this is the outter encrypted layer of the descriptor.</p>
<p>On any error case, including an empty output, return 0 and set *<b>decrypted_out</b> to NULL. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
