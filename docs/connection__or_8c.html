<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/connection_or.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">connection_or.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to handle OR connections, TLS handshaking, and cells on the network.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="bridges_8h_source.html">bridges.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buffers_8h_source.html">buffers.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="channel_8h_source.html">channel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="channeltls_8h_source.html">channeltls.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitbuild_8h_source.html">circuitbuild.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitlist_8h_source.html">circuitlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitstats_8h_source.html">circuitstats.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="command_8h_source.html">command.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="connection_8h_source.html">connection.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="connection__or_8h_source.html">connection_or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="control_8h_source.html">control.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__rand_8h_source.html">crypto_rand.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__util_8h_source.html">crypto_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dirserv_8h_source.html">dirserv.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="entrynodes_8h_source.html">entrynodes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="geoip_8h_source.html">geoip.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="main_8h_source.html">main.h</a>&quot;</code><br />
<code>#include &quot;link_handshake.h&quot;</code><br />
<code>#include &quot;<a class="el" href="microdesc_8h_source.html">microdesc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="networkstatus_8h_source.html">networkstatus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nodelist_8h_source.html">nodelist.h</a>&quot;</code><br />
<code>#include &quot;proto_cell.h&quot;</code><br />
<code>#include &quot;<a class="el" href="reasons_8h_source.html">reasons.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="relay_8h_source.html">relay.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rephist_8h_source.html">rephist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="router_8h_source.html">router.h</a>&quot;</code><br />
<code>#include &quot;routerkeys.h&quot;</code><br />
<code>#include &quot;<a class="el" href="routerlist_8h_source.html">routerlist.h</a>&quot;</code><br />
<code>#include &quot;ext_orport.h&quot;</code><br />
<code>#include &quot;<a class="el" href="scheduler_8h_source.html">scheduler.h</a>&quot;</code><br />
<code>#include &quot;torcert.h&quot;</code><br />
<code>#include &quot;channelpadding.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for connection_or.c:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2connection__or_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2connection__or_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2connection__or_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="663,259,707,285"/>
<area shape="rect" id="node18" href="bridges_8h.html" title="Header file for circuitbuild.c. " alt="" coords="120,109,195,136"/>
<area shape="rect" id="node19" href="buffers_8h.html" title="Header file for buffers.c. " alt="" coords="1285,184,1358,211"/>
<area shape="rect" id="node20" href="channel_8h.html" title="Header file for channel.c. " alt="" coords="275,184,354,211"/>
<area shape="rect" id="node21" href="channeltls_8h.html" title="Header file for channeltls.c. " alt="" coords="383,109,475,136"/>
<area shape="rect" id="node22" href="circuitbuild_8h.html" title="Header file for circuitbuild.c. " alt="" coords="499,109,594,136"/>
<area shape="rect" id="node23" href="circuitlist_8h.html" title="Header file for circuitlist.c. " alt="" coords="619,109,704,136"/>
<area shape="rect" id="node24" href="circuitstats_8h.html" title="Header file for circuitstats.c. " alt="" coords="729,109,826,136"/>
<area shape="rect" id="node25" href="command_8h.html" title="Header file for command.c. " alt="" coords="5,109,96,136"/>
<area shape="rect" id="node26" href="config_8h.html" title="Header file for config.c. " alt="" coords="902,109,970,136"/>
<area shape="rect" id="node27" href="connection_8h.html" title="Header file for connection.c. " alt="" coords="1280,109,1376,136"/>
<area shape="rect" id="node28" href="connection__or_8h.html" title="Header file for connection_or.c. " alt="" coords="1045,109,1160,136"/>
<area shape="rect" id="node29" href="control_8h.html" title="Header file for control.c. " alt="" coords="1184,109,1256,136"/>
<area shape="rect" id="node30" href="crypto__rand_8h.html" title="Common functions for using (pseudo&#45;)random number generators. " alt="" coords="2979,259,3080,285"/>
<area shape="rect" id="node31" href="crypto__util_8h.html" title="Common functions for cryptographic routines. " alt="" coords="2887,408,2980,435"/>
<area shape="rect" id="node32" href="dirserv_8h.html" title="Header file for dirserv.c. " alt="" coords="1451,109,1523,136"/>
<area shape="rect" id="node33" href="entrynodes_8h.html" title="Header file for circuitbuild.c. " alt="" coords="1547,109,1645,136"/>
<area shape="rect" id="node34" href="geoip_8h.html" title="Header file for geoip.c. " alt="" coords="1669,109,1733,136"/>
<area shape="rect" id="node35" href="main_8h.html" title="Header file for main.c. " alt="" coords="1757,109,1819,136"/>
<area shape="rect" id="node36" href="link__handshake_8h_source.html" title="link_handshake.h" alt="" coords="1843,109,1965,136"/>
<area shape="rect" id="node37" href="microdesc_8h.html" title="Header file for microdesc.c. " alt="" coords="1989,109,2083,136"/>
<area shape="rect" id="node38" href="networkstatus_8h.html" title="Header file for networkstatus.c. " alt="" coords="2107,109,2221,136"/>
<area shape="rect" id="node39" href="nodelist_8h.html" title="Header file for nodelist.c. " alt="" coords="2246,109,2325,136"/>
<area shape="rect" id="node40" href="proto__cell_8h_source.html" title="proto_cell.h" alt="" coords="2349,109,2438,136"/>
<area shape="rect" id="node41" href="reasons_8h.html" title="Header file for reasons.c. " alt="" coords="2462,109,2541,136"/>
<area shape="rect" id="node42" href="relay_8h.html" title="Header file for relay.c. " alt="" coords="2565,109,2627,136"/>
<area shape="rect" id="node43" href="rephist_8h.html" title="Header file for rephist.c. " alt="" coords="2651,109,2723,136"/>
<area shape="rect" id="node44" href="router_8h.html" title="Header file for router.c. " alt="" coords="2747,109,2813,136"/>
<area shape="rect" id="node45" href="routerkeys_8h_source.html" title="routerkeys.h" alt="" coords="2461,259,2555,285"/>
<area shape="rect" id="node46" href="routerlist_8h.html" title="Header file for routerlist.c. " alt="" coords="2888,109,2971,136"/>
<area shape="rect" id="node47" href="ext__orport_8h_source.html" title="ext_orport.h" alt="" coords="2995,109,3085,136"/>
<area shape="rect" id="node48" href="scheduler_8h.html" title="Header file for scheduler*.c. " alt="" coords="270,109,359,136"/>
<area shape="rect" id="node49" href="torcert_8h_source.html" title="torcert.h" alt="" coords="1385,184,1455,211"/>
<area shape="rect" id="node50" href="channelpadding_8h_source.html" title="channelpadding.h" alt="" coords="3211,109,3333,136"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="543,632,622,659"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="1185,557,1247,584"/>
<area shape="rect" id="node5" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="632,483,701,509"/>
<area shape="rect" id="node6" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1170,333,1283,360"/>
<area shape="rect" id="node7" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="1359,408,1484,435"/>
<area shape="rect" id="node8" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="1090,483,1233,509"/>
<area shape="rect" id="node9" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="201,333,263,360"/>
<area shape="rect" id="node10" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="287,333,353,360"/>
<area shape="rect" id="node11" href="container_8h_source.html" title="container.h" alt="" coords="777,408,863,435"/>
<area shape="rect" id="node12" href="compress_8h.html" title="Headers for compress.c. " alt="" coords="428,333,519,360"/>
<area shape="rect" id="node13" href="address_8h.html" title="Headers for address.h. " alt="" coords="543,333,622,360"/>
<area shape="rect" id="node14" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="163,557,291,584"/>
<area shape="rect" id="node15" href="ht_8h_source.html" title="ht.h" alt="" coords="749,333,793,360"/>
<area shape="rect" id="node16" href="confline_8h_source.html" title="confline.h" alt="" coords="646,333,725,360"/>
<area shape="rect" id="node17" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="869,333,971,360"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbroken__state__count__t.html">broken_state_count_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structor__connect__failure__entry__t.html">or_connect_failure_entry_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab2eda2cfbeb176ae5a0ed6613d53022a"><td class="memItemLeft" align="right" valign="top"><a id="ab2eda2cfbeb176ae5a0ed6613d53022a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_CHANNEL_INTERNAL_</b></td></tr>
<tr class="separator:ab2eda2cfbeb176ae5a0ed6613d53022a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accf11de692d782e6860b253dfea8ad4b"><td class="memItemLeft" align="right" valign="top"><a id="accf11de692d782e6860b253dfea8ad4b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CONNECTION_OR_PRIVATE</b></td></tr>
<tr class="separator:accf11de692d782e6860b253dfea8ad4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85d6c0e2e0590e0cc5c1ec9303cfd14c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a85d6c0e2e0590e0cc5c1ec9303cfd14c">MAX_REASONS_TO_REPORT</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a85d6c0e2e0590e0cc5c1ec9303cfd14c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acba9a39260d631b312ca35fa20593546"><td class="memItemLeft" align="right" valign="top"><a id="acba9a39260d631b312ca35fa20593546"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_OR_INBUF_WHEN_NONOPEN</b>&#160;&#160;&#160;0</td></tr>
<tr class="separator:acba9a39260d631b312ca35fa20593546"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb4589f111a4ef5508c1dedb06aa5820"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#afb4589f111a4ef5508c1dedb06aa5820">TIME_BEFORE_OR_CONN_IS_TOO_OLD</a>&#160;&#160;&#160;(60*60*24*7)</td></tr>
<tr class="separator:afb4589f111a4ef5508c1dedb06aa5820"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7dcb8a07279970aecce1f1b88b338e9"><td class="memItemLeft" align="right" valign="top"><a id="ac7dcb8a07279970aecce1f1b88b338e9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>OR_CONNECT_FAILURE_LIFETIME</b>&#160;&#160;&#160;60</td></tr>
<tr class="separator:ac7dcb8a07279970aecce1f1b88b338e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1399d402142872e80ff4daa05263e83e"><td class="memItemLeft" align="right" valign="top"><a id="a1399d402142872e80ff4daa05263e83e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>OR_CONNECT_FAILURE_CLEANUP_INTERVAL</b>&#160;&#160;&#160;60</td></tr>
<tr class="separator:a1399d402142872e80ff4daa05263e83e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dcb1c64ff2d5f2e662ed844f670201b"><td class="memItemLeft" align="right" valign="top"><a id="a0dcb1c64ff2d5f2e662ed844f670201b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>certs_cell_ed25519_disabled_for_testing</b>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a0dcb1c64ff2d5f2e662ed844f670201b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a7c4fee93ea184453cf4ea4f4e44add5d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structbroken__state__count__t.html">broken_state_count_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a7c4fee93ea184453cf4ea4f4e44add5d">broken_state_count_t</a></td></tr>
<tr class="separator:a7c4fee93ea184453cf4ea4f4e44add5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a886c956f73e08abf0308fdab9884aaf9"><td class="memItemLeft" align="right" valign="top"><a id="a886c956f73e08abf0308fdab9884aaf9"></a>
typedef struct <a class="el" href="structor__connect__failure__entry__t.html">or_connect_failure_entry_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>or_connect_failure_entry_t</b></td></tr>
<tr class="separator:a886c956f73e08abf0308fdab9884aaf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a203fccfbc180a939bcf81b19f8e567d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a203fccfbc180a939bcf81b19f8e567d4">connection_or_clear_identity</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a203fccfbc180a939bcf81b19f8e567d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af395c50f9f998656fe273222574dadeb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#af395c50f9f998656fe273222574dadeb">connection_or_clear_identity_map</a> (void)</td></tr>
<tr class="separator:af395c50f9f998656fe273222574dadeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7e49a59759436fa3e35e9cfd541e018"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#ab7e49a59759436fa3e35e9cfd541e018">connection_or_remove_from_ext_or_id_map</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:ab7e49a59759436fa3e35e9cfd541e018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4643144162fb16fe61bdbcf9a0fc439b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a4643144162fb16fe61bdbcf9a0fc439b">connection_or_get_by_ext_or_id</a> (const char *id)</td></tr>
<tr class="separator:a4643144162fb16fe61bdbcf9a0fc439b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab6f65b4fc0ab76e08b6e40f83dfa9ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#aab6f65b4fc0ab76e08b6e40f83dfa9ab">connection_or_clear_ext_or_id_map</a> (void)</td></tr>
<tr class="separator:aab6f65b4fc0ab76e08b6e40f83dfa9ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ad5485d3d553595f598242d862b20a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a8ad5485d3d553595f598242d862b20a0">connection_or_set_ext_or_identifier</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a8ad5485d3d553595f598242d862b20a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64189cdd19a783fa9a0f24b7d9ade932"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a64189cdd19a783fa9a0f24b7d9ade932">clear_broken_connection_map</a> (int stop_recording)</td></tr>
<tr class="separator:a64189cdd19a783fa9a0f24b7d9ade932"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7feaa6ab5ddfb6f1c64357cffbd5e70d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a7feaa6ab5ddfb6f1c64357cffbd5e70d">connection_or_report_broken_states</a> (int severity, int domain)</td></tr>
<tr class="separator:a7feaa6ab5ddfb6f1c64357cffbd5e70d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91065ac60ede0c2ccdaf7d2ff4892d5d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a91065ac60ede0c2ccdaf7d2ff4892d5d">MOCK_IMPL</a> (int, connection_or_get_num_circuits,(<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn))</td></tr>
<tr class="separator:a91065ac60ede0c2ccdaf7d2ff4892d5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3452210724078c52a047cff4fecf264a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a3452210724078c52a047cff4fecf264a">cell_pack</a> (<a class="el" href="structpacked__cell__t.html">packed_cell_t</a> *dst, const <a class="el" href="structcell__t.html">cell_t</a> *src, int wide_circ_ids)</td></tr>
<tr class="separator:a3452210724078c52a047cff4fecf264a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61c229ce284577c48c7a51f9532d8e15"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a61c229ce284577c48c7a51f9532d8e15">var_cell_pack_header</a> (const <a class="el" href="structvar__cell__t.html">var_cell_t</a> *cell, char *hdr_out, int wide_circ_ids)</td></tr>
<tr class="separator:a61c229ce284577c48c7a51f9532d8e15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e8e7d75e478e23ba78046d4bf17088"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structvar__cell__t.html">var_cell_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a23e8e7d75e478e23ba78046d4bf17088">var_cell_new</a> (uint16_t payload_len)</td></tr>
<tr class="separator:a23e8e7d75e478e23ba78046d4bf17088"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70378434d9f152969cf835cb7df59de1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structvar__cell__t.html">var_cell_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a70378434d9f152969cf835cb7df59de1">var_cell_copy</a> (const <a class="el" href="structvar__cell__t.html">var_cell_t</a> *src)</td></tr>
<tr class="separator:a70378434d9f152969cf835cb7df59de1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c750321029bdf8f4083f6226102c6c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a6c750321029bdf8f4083f6226102c6c2">var_cell_free_</a> (<a class="el" href="structvar__cell__t.html">var_cell_t</a> *cell)</td></tr>
<tr class="separator:a6c750321029bdf8f4083f6226102c6c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11cff8523e1f4b95674f2b227a46c862"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a11cff8523e1f4b95674f2b227a46c862">connection_or_reached_eof</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a11cff8523e1f4b95674f2b227a46c862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c9c08479c7f8118438c42edb7046d32"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a1c9c08479c7f8118438c42edb7046d32">connection_or_process_inbuf</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a1c9c08479c7f8118438c42edb7046d32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e6891862efd73402fed97a4353b2b24"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a8e6891862efd73402fed97a4353b2b24">connection_or_flushed_some</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a8e6891862efd73402fed97a4353b2b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7f9c88b79431319b84a9094761372be"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#ae7f9c88b79431319b84a9094761372be">connection_or_num_cells_writeable</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:ae7f9c88b79431319b84a9094761372be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61f2d552138b0e015906710a045a6c55"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a61f2d552138b0e015906710a045a6c55">connection_or_finished_flushing</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a61f2d552138b0e015906710a045a6c55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add4f61d9c86887815a64fefae9d0ea6f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#add4f61d9c86887815a64fefae9d0ea6f">connection_or_finished_connecting</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *or_conn)</td></tr>
<tr class="separator:add4f61d9c86887815a64fefae9d0ea6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addc9d5046e536f6c2aae4f73168e9bae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#addc9d5046e536f6c2aae4f73168e9bae">connection_or_about_to_close</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *or_conn)</td></tr>
<tr class="separator:addc9d5046e536f6c2aae4f73168e9bae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8573b49df7ffc3ad6df0faa6e7a12f10"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a8573b49df7ffc3ad6df0faa6e7a12f10">connection_or_digest_is_known_relay</a> (const char *id_digest)</td></tr>
<tr class="separator:a8573b49df7ffc3ad6df0faa6e7a12f10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb65c80b10f299f06144b83628e74ce1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#abb65c80b10f299f06144b83628e74ce1">connection_or_update_token_buckets</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *conns, const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:abb65c80b10f299f06144b83628e74ce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69e2ac3bf5089e2a988c8ab994c4893e"><td class="memItemLeft" align="right" valign="top"><a id="a69e2ac3bf5089e2a988c8ab994c4893e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>connection_or_set_canonical</b> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *or_conn, int is_canonical)</td></tr>
<tr class="separator:a69e2ac3bf5089e2a988c8ab994c4893e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a886ddcdf832a3d3ccc18184ee4d7dd26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a886ddcdf832a3d3ccc18184ee4d7dd26">connection_or_init_conn_from_address</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, const <a class="el" href="structtor__addr__t.html">tor_addr_t</a> *addr, uint16_t port, const char *id_digest, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *ed_id, int started_here)</td></tr>
<tr class="separator:a886ddcdf832a3d3ccc18184ee4d7dd26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d119bfc7d08a4cf060280c100860560"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a6d119bfc7d08a4cf060280c100860560">connection_or_single_set_badness_</a> (time_t now, <a class="el" href="structor__connection__t.html">or_connection_t</a> *or_conn, int force)</td></tr>
<tr class="separator:a6d119bfc7d08a4cf060280c100860560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac067ffdc1b5006a8ab7a3a18e760ade7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#ac067ffdc1b5006a8ab7a3a18e760ade7">connection_or_group_set_badness_</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *group, int force)</td></tr>
<tr class="separator:ac067ffdc1b5006a8ab7a3a18e760ade7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a983b93cd08e8aa2efa92be9bf80bbe69"><td class="memItemLeft" align="right" valign="top"><a id="a983b93cd08e8aa2efa92be9bf80bbe69"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>HT_PROTOTYPE</b> (HT_GENERATE2(or_connect_failure_ht, HT_GENERATE2(<a class="el" href="structor__connect__failure__entry__t.html">or_connect_failure_entry_t</a>, HT_GENERATE2(node, HT_GENERATE2(or_connect_failure_ht_hash, HT_GENERATE2(or_connect_failure_ht_eq)</td></tr>
<tr class="separator:a983b93cd08e8aa2efa92be9bf80bbe69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada5cad268fa75da899770cfda5d15828"><td class="memItemLeft" align="right" valign="top"><a id="ada5cad268fa75da899770cfda5d15828"></a>
STATIC void&#160;</td><td class="memItemRight" valign="bottom"><b>note_or_connect_failed</b> (const <a class="el" href="structor__connection__t.html">or_connection_t</a> *or_conn)</td></tr>
<tr class="separator:ada5cad268fa75da899770cfda5d15828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a5386c82e78ccc5fdbaeb6b91a5026"><td class="memItemLeft" align="right" valign="top"><a id="ae8a5386c82e78ccc5fdbaeb6b91a5026"></a>
STATIC int&#160;</td><td class="memItemRight" valign="bottom"><b>should_connect_to_relay</b> (const <a class="el" href="structor__connection__t.html">or_connection_t</a> *or_conn)</td></tr>
<tr class="separator:ae8a5386c82e78ccc5fdbaeb6b91a5026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a75b0592cc90f11549ed8899454a1f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a6a75b0592cc90f11549ed8899454a1f0">connection_or_connect_failed</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, int reason, const char *msg)</td></tr>
<tr class="separator:a6a75b0592cc90f11549ed8899454a1f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1782f56c8e2a13ef3db44eed29c83d28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a1782f56c8e2a13ef3db44eed29c83d28">connection_or_notify_error</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, int reason, const char *msg)</td></tr>
<tr class="separator:a1782f56c8e2a13ef3db44eed29c83d28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fdf1e7144b7f497802d60f0f6a076fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a9fdf1e7144b7f497802d60f0f6a076fc">MOCK_IMPL</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *, connection_or_connect,(const <a class="el" href="structtor__addr__t.html">tor_addr_t</a> *_addr, uint16_t port, const char *id_digest, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *ed_id, channel_tls_t *chan))</td></tr>
<tr class="separator:a9fdf1e7144b7f497802d60f0f6a076fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4d087b0c7ef9745ce0296b5e28160c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#af4d087b0c7ef9745ce0296b5e28160c7">connection_or_close_normally</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *orconn, int flush)</td></tr>
<tr class="separator:af4d087b0c7ef9745ce0296b5e28160c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cffbd09fb670b958a09e5d65982d560"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a7cffbd09fb670b958a09e5d65982d560">MOCK_IMPL</a> (void, connection_or_close_for_error,(<a class="el" href="structor__connection__t.html">or_connection_t</a> *orconn, int flush))</td></tr>
<tr class="separator:a7cffbd09fb670b958a09e5d65982d560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b039b5bbe0c7cd361769189ce4d2238"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a4b039b5bbe0c7cd361769189ce4d2238">MOCK_IMPL</a> (int, connection_tls_start_handshake,(<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, int receiving))</td></tr>
<tr class="separator:a4b039b5bbe0c7cd361769189ce4d2238"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecfd6590f4dd5c079f371e48eb1e09f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#aecfd6590f4dd5c079f371e48eb1e09f2">connection_or_block_renegotiation</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:aecfd6590f4dd5c079f371e48eb1e09f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15ee02cde3308ff45253cd8832bf9dfd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a15ee02cde3308ff45253cd8832bf9dfd">connection_tls_continue_handshake</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a15ee02cde3308ff45253cd8832bf9dfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9874fc9cd6f255b931cbbcfc534702b7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a9874fc9cd6f255b931cbbcfc534702b7">connection_or_nonopen_was_started_here</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a9874fc9cd6f255b931cbbcfc534702b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25311bc6d11b48d5f281528453c53ab0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a25311bc6d11b48d5f281528453c53ab0">connection_or_client_learned_peer_id</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, const uint8_t *rsa_peer_id, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *ed_peer_id)</td></tr>
<tr class="separator:a25311bc6d11b48d5f281528453c53ab0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28d99e23c45ae40c245a0474ef4cfb98"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a28d99e23c45ae40c245a0474ef4cfb98">connection_or_client_used</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a28d99e23c45ae40c245a0474ef4cfb98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb9044e4d4dd0ad7d56e37ff633c223d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#aeb9044e4d4dd0ad7d56e37ff633c223d">connection_init_or_handshake_state</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, int started_here)</td></tr>
<tr class="separator:aeb9044e4d4dd0ad7d56e37ff633c223d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a543b7dc735432b7107d590ff058008b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a543b7dc735432b7107d590ff058008b0">or_handshake_state_free_</a> (<a class="el" href="structor__handshake__state__t.html">or_handshake_state_t</a> *state)</td></tr>
<tr class="separator:a543b7dc735432b7107d590ff058008b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a741e61a567306a7cc5aaaf9634ecda4e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a741e61a567306a7cc5aaaf9634ecda4e">or_handshake_state_record_cell</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, <a class="el" href="structor__handshake__state__t.html">or_handshake_state_t</a> *state, const <a class="el" href="structcell__t.html">cell_t</a> *cell, int incoming)</td></tr>
<tr class="separator:a741e61a567306a7cc5aaaf9634ecda4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eac340c62c1d3844d69235a6a53c15e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a5eac340c62c1d3844d69235a6a53c15e">or_handshake_state_record_var_cell</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, <a class="el" href="structor__handshake__state__t.html">or_handshake_state_t</a> *state, const <a class="el" href="structvar__cell__t.html">var_cell_t</a> *cell, int incoming)</td></tr>
<tr class="separator:a5eac340c62c1d3844d69235a6a53c15e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10910510a0e668c958457783ccf154c9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a10910510a0e668c958457783ccf154c9">connection_or_set_state_open</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a10910510a0e668c958457783ccf154c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a80590d68a6d8ea9b011ae44245929b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a1a80590d68a6d8ea9b011ae44245929b">connection_or_write_cell_to_buf</a> (const <a class="el" href="structcell__t.html">cell_t</a> *cell, <a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a1a80590d68a6d8ea9b011ae44245929b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf43644cf527a6655657b8f4aa1d1e1e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#aaf43644cf527a6655657b8f4aa1d1e1e">MOCK_IMPL</a> (void, connection_or_write_var_cell_to_buf,(const <a class="el" href="structvar__cell__t.html">var_cell_t</a> *cell, <a class="el" href="structor__connection__t.html">or_connection_t</a> *conn))</td></tr>
<tr class="separator:aaf43644cf527a6655657b8f4aa1d1e1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1050c4f55437f7f68627c637a3dbc0e9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a1050c4f55437f7f68627c637a3dbc0e9">is_or_protocol_version_known</a> (uint16_t v)</td></tr>
<tr class="separator:a1050c4f55437f7f68627c637a3dbc0e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23cfebfdf4ea8cb551ab8d243b56b811"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a23cfebfdf4ea8cb551ab8d243b56b811">connection_or_send_versions</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, int v3_plus)</td></tr>
<tr class="separator:a23cfebfdf4ea8cb551ab8d243b56b811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab27b40a47b0943bf613f31427ad7b30c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#ab27b40a47b0943bf613f31427ad7b30c">MOCK_IMPL</a> (int, connection_or_send_netinfo,(<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn))</td></tr>
<tr class="separator:ab27b40a47b0943bf613f31427ad7b30c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a373bc2ce63f7b8a6530d1b16e420f7c4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a373bc2ce63f7b8a6530d1b16e420f7c4">connection_or_send_certs_cell</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a373bc2ce63f7b8a6530d1b16e420f7c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a730cf41ffc419e07bc10ec3dda904b7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a730cf41ffc419e07bc10ec3dda904b7b">authchallenge_type_is_supported</a> (uint16_t challenge_type)</td></tr>
<tr class="separator:a730cf41ffc419e07bc10ec3dda904b7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a3464c60e24d80f67248c6089221673"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a2a3464c60e24d80f67248c6089221673">authchallenge_type_is_better</a> (uint16_t challenge_type_a, uint16_t challenge_type_b)</td></tr>
<tr class="separator:a2a3464c60e24d80f67248c6089221673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda2ead17f44091558bb27dd084517b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#acda2ead17f44091558bb27dd084517b9">connection_or_send_auth_challenge_cell</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:acda2ead17f44091558bb27dd084517b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299125b246f5c829b4af2cef1efa7378"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structvar__cell__t.html">var_cell_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a299125b246f5c829b4af2cef1efa7378">connection_or_compute_authenticate_cell_body</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, const int authtype, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *signing_key, const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *ed_signing_key, int server)</td></tr>
<tr class="separator:a299125b246f5c829b4af2cef1efa7378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e89fff0e71d905b83cae2583a7bc49f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection__or_8c.html#a0e89fff0e71d905b83cae2583a7bc49f">MOCK_IMPL</a> (int, connection_or_send_authenticate_cell,(<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, int authtype))</td></tr>
<tr class="separator:a0e89fff0e71d905b83cae2583a7bc49f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions to handle OR connections, TLS handshaking, and cells on the network. </p>
<p>An <a class="el" href="structor__connection__t.html">or_connection_t</a> is a subtype of <a class="el" href="structconnection__t.html">connection_t</a> (as implemented in <a class="el" href="connection_8c.html" title="General high-level functions to handle reading and writing on connections. ">connection.c</a>) that uses a TLS connection to send and receive cells on the Tor network. (By sending and receiving cells <a class="el" href="connection__or_8c.html" title="Functions to handle OR connections, TLS handshaking, and cells on the network. ">connection_or.c</a>, it cooperates with <a class="el" href="channeltls_8c.html" title="A concrete subclass of channel_t using or_connection_t to transfer cells between Tor instances...">channeltls.c</a> to implement a the channel interface of <a class="el" href="channel_8c.html" title="OR/OP-to-OR channel abstraction layer. A channel&#39;s job is to transfer cells from Tor instance to Tor ...">channel.c</a>.)</p>
<p>Every OR connection has an underlying tortls_t object (as implemented in <a class="el" href="tortls_8c.html" title="Wrapper functions to present a consistent interface to TLS, SSL, and X.509 functions from OpenSSL...">tortls.c</a>) which it uses as its TLS stream. It is responsible for sending and receiving cells over that TLS.</p>
<p>This module also implements the client side of the v3 Tor link handshake, </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a85d6c0e2e0590e0cc5c1ec9303cfd14c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85d6c0e2e0590e0cc5c1ec9303cfd14c">&#9670;&nbsp;</a></span>MAX_REASONS_TO_REPORT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_REASONS_TO_REPORT&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Upper limit on the number of different states to report for connection failure. </p>

</div>
</div>
<a id="afb4589f111a4ef5508c1dedb06aa5820"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb4589f111a4ef5508c1dedb06aa5820">&#9670;&nbsp;</a></span>TIME_BEFORE_OR_CONN_IS_TOO_OLD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIME_BEFORE_OR_CONN_IS_TOO_OLD&#160;&#160;&#160;(60*60*24*7)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How old do we let a connection to an OR get before deciding it's too old for new circuits? </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a7c4fee93ea184453cf4ea4f4e44add5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c4fee93ea184453cf4ea4f4e44add5d">&#9670;&nbsp;</a></span>broken_state_count_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structbroken__state__count__t.html">broken_state_count_t</a>  <a class="el" href="structbroken__state__count__t.html">broken_state_count_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper type used to sort connection states and find the most frequent. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2a3464c60e24d80f67248c6089221673"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a3464c60e24d80f67248c6089221673">&#9670;&nbsp;</a></span>authchallenge_type_is_better()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int authchallenge_type_is_better </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>challenge_type_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>challenge_type_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff <b>challenge_type_a</b> is one that we would rather use than <b>challenge_type_b</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a2a3464c60e24d80f67248c6089221673_cgraph.png" border="0" usemap="#connection__or_8c_a2a3464c60e24d80f67248c6089221673_cgraph" alt=""/></div>
<map name="connection__or_8c_a2a3464c60e24d80f67248c6089221673_cgraph" id="connection__or_8c_a2a3464c60e24d80f67248c6089221673_cgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a730cf41ffc419e07bc10ec3dda904b7b" title="authchallenge_type\l_is_supported" alt="" coords="188,5,323,47"/>
</map>
</div>

</div>
</div>
<a id="a730cf41ffc419e07bc10ec3dda904b7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a730cf41ffc419e07bc10ec3dda904b7b">&#9670;&nbsp;</a></span>authchallenge_type_is_supported()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int authchallenge_type_is_supported </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>challenge_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff <b>challenge_type</b> is an AUTHCHALLENGE type that we can send and receive. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a730cf41ffc419e07bc10ec3dda904b7b_icgraph.png" border="0" usemap="#connection__or_8c_a730cf41ffc419e07bc10ec3dda904b7b_icgraph" alt=""/></div>
<map name="connection__or_8c_a730cf41ffc419e07bc10ec3dda904b7b_icgraph" id="connection__or_8c_a730cf41ffc419e07bc10ec3dda904b7b_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#a2a3464c60e24d80f67248c6089221673" title="authchallenge_type\l_is_better" alt="" coords="188,5,323,47"/>
</map>
</div>

</div>
</div>
<a id="a3452210724078c52a047cff4fecf264a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3452210724078c52a047cff4fecf264a">&#9670;&nbsp;</a></span>cell_pack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cell_pack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structpacked__cell__t.html">packed_cell_t</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcell__t.html">cell_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wide_circ_ids</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pack the <a class="el" href="structcell__t.html">cell_t</a> host-order structure <b>src</b> into network-order in the buffer <b>dest</b>. See tor-spec.txt for details about the wire format.</p>
<p>Note that this function doesn't touch <b>dst</b>-&gt;next: the caller should set it or clear it as appropriate. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a3452210724078c52a047cff4fecf264a_cgraph.png" border="0" usemap="#connection__or_8c_a3452210724078c52a047cff4fecf264a_cgraph" alt=""/></div>
<map name="connection__or_8c_a3452210724078c52a047cff4fecf264a_cgraph" id="connection__or_8c_a3452210724078c52a047cff4fecf264a_cgraph">
<area shape="rect" id="node2" href="compat_8c.html#ac4d2010c31db105982e47dc345116b5f" title="set_uint32" alt="" coords="131,5,213,32"/>
<area shape="rect" id="node3" href="compat_8c.html#adbf52deccd4f2b9244d6911488b907f3" title="set_uint16" alt="" coords="131,56,213,83"/>
</map>
</div>

</div>
</div>
<a id="a64189cdd19a783fa9a0f24b7d9ade932"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64189cdd19a783fa9a0f24b7d9ade932">&#9670;&nbsp;</a></span>clear_broken_connection_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clear_broken_connection_map </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stop_recording</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Forget all recorded states for failed connections. If <b>stop_recording</b> is true, don't record any more. </p>

</div>
</div>
<a id="aeb9044e4d4dd0ad7d56e37ff633c223d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb9044e4d4dd0ad7d56e37ff633c223d">&#9670;&nbsp;</a></span>connection_init_or_handshake_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_init_or_handshake_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>started_here</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate a new connection handshake state for the connection <b>conn</b>. Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="addc9d5046e536f6c2aae4f73168e9bae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addc9d5046e536f6c2aae4f73168e9bae">&#9670;&nbsp;</a></span>connection_or_about_to_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_about_to_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>or_conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we're about to finally unlink and free an OR connection: perform necessary accounting and cleanup </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_addc9d5046e536f6c2aae4f73168e9bae_cgraph.png" border="0" usemap="#connection__or_8c_addc9d5046e536f6c2aae4f73168e9bae_cgraph" alt=""/></div>
<map name="connection__or_8c_addc9d5046e536f6c2aae4f73168e9bae_cgraph" id="connection__or_8c_addc9d5046e536f6c2aae4f73168e9bae_cgraph">
<area shape="rect" id="node2" href="channel_8c.html#a41a07dcb3da5d642570a8ed069c27450" title="channel_closed" alt="" coords="196,13,308,39"/>
</map>
</div>

</div>
</div>
<a id="aecfd6590f4dd5c079f371e48eb1e09f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecfd6590f4dd5c079f371e48eb1e09f2">&#9670;&nbsp;</a></span>connection_or_block_renegotiation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_block_renegotiation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Block all future attempts to renegotiate on 'conn' </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_aecfd6590f4dd5c079f371e48eb1e09f2_cgraph.png" border="0" usemap="#connection__or_8c_aecfd6590f4dd5c079f371e48eb1e09f2_cgraph" alt=""/></div>
<map name="connection__or_8c_aecfd6590f4dd5c079f371e48eb1e09f2_cgraph" id="connection__or_8c_aecfd6590f4dd5c079f371e48eb1e09f2_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#a5823cfa710f0f7987d09dfececae28d0" title="tor_tls_set_renegotiate\l_callback" alt="" coords="206,39,361,80"/>
<area shape="rect" id="node5" href="tortls_8c.html#a08342968552b84d5dfbd6493338f6058" title="tor_tls_block_renegotiation" alt="" coords="195,105,372,131"/>
<area shape="rect" id="node3" href="tortls_8c.html#a3b0c0880a231328e1b5d7faa01fddcd9" title="tor_tls_server_info\l_callback" alt="" coords="423,5,553,47"/>
<area shape="rect" id="node4" href="tortls_8c.html#a6f66b1039c2f3e00e4d4602f19d5ab02" title="tor_tls_debug_state\l_callback" alt="" coords="420,71,556,112"/>
</map>
</div>

</div>
</div>
<a id="aab6f65b4fc0ab76e08b6e40f83dfa9ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab6f65b4fc0ab76e08b6e40f83dfa9ab">&#9670;&nbsp;</a></span>connection_or_clear_ext_or_id_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_clear_ext_or_id_map </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deallocate the global Extended ORPort identifier list </p>

</div>
</div>
<a id="a203fccfbc180a939bcf81b19f8e567d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a203fccfbc180a939bcf81b19f8e567d4">&#9670;&nbsp;</a></span>connection_or_clear_identity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_clear_identity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clear clear conn-&gt;identity_digest and update other data structures as appropriate. </p>

</div>
</div>
<a id="af395c50f9f998656fe273222574dadeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af395c50f9f998656fe273222574dadeb">&#9670;&nbsp;</a></span>connection_or_clear_identity_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_clear_identity_map </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clear all identities in OR conns. </p>

</div>
</div>
<a id="a25311bc6d11b48d5f281528453c53ab0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25311bc6d11b48d5f281528453c53ab0">&#9670;&nbsp;</a></span>connection_or_client_learned_peer_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_client_learned_peer_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>rsa_peer_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>ed_peer_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we (as a connection initiator) have definitively, authenticatedly, learned that ID of the Tor instance on the other side of <b>conn</b> is <b>rsa_peer_id</b> and optionally <b>ed_peer_id</b>. For v1 and v2 handshakes, this is right after we get a certificate chain in a TLS handshake or renegotiation. For v3+ handshakes, this is right after we get a certificate chain in a CERTS cell.</p>
<p>If we did not know the ID before, record the one we got.</p>
<p>If we wanted an ID, but we didn't get the one we expected, log a message and return -1. On relays:</p><ul>
<li>log a protocol warning whenever the fingerprints don't match; On clients:</li>
<li>if a relay's fingerprint doesn't match, log a warning;</li>
<li>if we don't have updated relay fingerprints from a recent consensus, and a fallback directory mirror's hard-coded fingerprint has changed, log an info explaining that we will try another fallback.</li>
</ul>
<p>If we're testing reachability, remember what we learned.</p>
<p>Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a25311bc6d11b48d5f281528453c53ab0_cgraph.png" border="0" usemap="#connection__or_8c_a25311bc6d11b48d5f281528453c53ab0_cgraph" alt=""/></div>
<map name="connection__or_8c_a25311bc6d11b48d5f281528453c53ab0_cgraph" id="connection__or_8c_a25311bc6d11b48d5f281528453c53ab0_cgraph">
<area shape="rect" id="node2" href="channeltls_8c.html#a103e1b5acee3f7892a537d0c6f143752" title="channel_tls_to_base" alt="" coords="195,5,336,32"/>
<area shape="rect" id="node3" href="util_8c.html#add0703747195c2abd042572426e80266" title="tor_digest_is_zero" alt="" coords="201,56,329,83"/>
<area shape="rect" id="node5" href="crypto__ed25519_8c.html#a1d56281a358363aa105b7032aebc46e4" title="ed25519_public_key\l_is_zero" alt="" coords="195,107,335,149"/>
<area shape="rect" id="node4" href="di__ops_8c.html#a473334ee93cca0aea10523321a444ea3" title="tor_memeq" alt="" coords="402,56,489,83"/>
<area shape="rect" id="node6" href="util_8c.html#a7c5079074e649dc0369225eca3073f7d" title="tor_mem_is_zero" alt="" coords="384,115,507,141"/>
</map>
</div>

</div>
</div>
<a id="a28d99e23c45ae40c245a0474ef4cfb98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28d99e23c45ae40c245a0474ef4cfb98">&#9670;&nbsp;</a></span>connection_or_client_used()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t connection_or_client_used </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return when we last used this channel for client activity (origin circuits). This is called from <a class="el" href="connection_8c.html" title="General high-level functions to handle reading and writing on connections. ">connection.c</a>, since client_used is now one of the timestamps in channel_t </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a28d99e23c45ae40c245a0474ef4cfb98_cgraph.png" border="0" usemap="#connection__or_8c_a28d99e23c45ae40c245a0474ef4cfb98_cgraph" alt=""/></div>
<map name="connection__or_8c_a28d99e23c45ae40c245a0474ef4cfb98_cgraph" id="connection__or_8c_a28d99e23c45ae40c245a0474ef4cfb98_cgraph">
<area shape="rect" id="node2" href="channel_8c.html#a7c7c9bb52317ac2f0189a286108bdc7e" title="channel_when_last_client" alt="" coords="229,5,400,32"/>
</map>
</div>

</div>
</div>
<a id="af4d087b0c7ef9745ce0296b5e28160c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4d087b0c7ef9745ce0296b5e28160c7">&#9670;&nbsp;</a></span>connection_or_close_normally()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_close_normally </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>orconn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flush</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mark orconn for close and transition the associated channel, if any, to the closing state.</p>
<p>It's safe to call this and connection_or_close_for_error() any time, and channel layer will treat it as a connection closing for reasons outside its control, like the remote end closing it. It can also be a local reason that's specific to connection_t/or_connection_t rather than the channel mechanism, such as expiration of old connections in run_connection_housekeeping(). If you want to close a channel_t from somewhere that logically works in terms of generic channels rather than connections, use <a class="el" href="channel_8c.html#ac5c51ad12ff89e0f63cc386ccda8493f">channel_mark_for_close()</a>; see also the comment on that function in <a class="el" href="channel_8c.html" title="OR/OP-to-OR channel abstraction layer. A channel&#39;s job is to transfer cells from Tor instance to Tor ...">channel.c</a>. </p>

</div>
</div>
<a id="a299125b246f5c829b4af2cef1efa7378"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299125b246f5c829b4af2cef1efa7378">&#9670;&nbsp;</a></span>connection_or_compute_authenticate_cell_body()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structvar__cell__t.html">var_cell_t</a>* connection_or_compute_authenticate_cell_body </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>authtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>signing_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>ed_signing_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>server</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the main body of an AUTHENTICATE cell that a client can use to authenticate itself on a v3 handshake for <b>conn</b>. Return it in a <a class="el" href="structvar__cell__t.html">var_cell_t</a>.</p>
<p>If <b>server</b> is true, only calculate the first V3_AUTH_FIXED_PART_LEN bytes &ndash; the part of the authenticator that's determined by the rest of the handshake, and which match the provided value exactly.</p>
<p>If <b>server</b> is false and <b>signing_key</b> is NULL, calculate the first V3_AUTH_BODY_LEN bytes of the authenticator (that is, everything that should be signed), but don't actually sign it.</p>
<p>If <b>server</b> is false and <b>signing_key</b> is provided, calculate the entire authenticator, signed with <b>signing_key</b>.</p>
<p>Return the length of the cell body on success, and -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a299125b246f5c829b4af2cef1efa7378_cgraph.png" border="0" usemap="#connection__or_8c_a299125b246f5c829b4af2cef1efa7378_cgraph" alt=""/></div>
<map name="connection__or_8c_a299125b246f5c829b4af2cef1efa7378_cgraph" id="connection__or_8c_a299125b246f5c829b4af2cef1efa7378_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#a7aa93459dd4e3641e885932d682db4a0" title="tor_tls_get_my_certs" alt="" coords="216,5,360,32"/>
<area shape="rect" id="node3" href="tortls_8c.html#aeb4713a168234b69a9d25312a3a15770" title="tor_x509_cert_get_id\l_digests" alt="" coords="217,57,359,98"/>
</map>
</div>

</div>
</div>
<a id="a6a75b0592cc90f11549ed8899454a1f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a75b0592cc90f11549ed8899454a1f0">&#9670;&nbsp;</a></span>connection_or_connect_failed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_connect_failed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reason</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><b>conn</b> is in the 'connecting' state, and it failed to complete a TCP connection. Send notifications appropriately.</p>
<p><b>reason</b> specifies the or_conn_end_reason for the failure; <b>msg</b> specifies the strerror-style error message. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a6a75b0592cc90f11549ed8899454a1f0_cgraph.png" border="0" usemap="#connection__or_8c_a6a75b0592cc90f11549ed8899454a1f0_cgraph" alt=""/></div>
<map name="connection__or_8c_a6a75b0592cc90f11549ed8899454a1f0_cgraph" id="connection__or_8c_a6a75b0592cc90f11549ed8899454a1f0_cgraph">
<area shape="rect" id="node2" href="control_8c.html#a7ec5a96f0e43d4719b7992819bb3f1ac" title="control_event_or_conn\l_status" alt="" coords="209,5,363,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a6a75b0592cc90f11549ed8899454a1f0_icgraph.png" border="0" usemap="#connection__or_8c_a6a75b0592cc90f11549ed8899454a1f0_icgraph" alt=""/></div>
<map name="connection__or_8c_a6a75b0592cc90f11549ed8899454a1f0_icgraph" id="connection__or_8c_a6a75b0592cc90f11549ed8899454a1f0_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#a1782f56c8e2a13ef3db44eed29c83d28" title="connection_or_notify\l_error" alt="" coords="209,5,352,47"/>
</map>
</div>

</div>
</div>
<a id="a8573b49df7ffc3ad6df0faa6e7a12f10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8573b49df7ffc3ad6df0faa6e7a12f10">&#9670;&nbsp;</a></span>connection_or_digest_is_known_relay()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_digest_is_known_relay </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id_digest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return 1 if identity digest <b>id_digest</b> is known to be a currently or recently running relay. Otherwise return 0. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a8573b49df7ffc3ad6df0faa6e7a12f10_cgraph.png" border="0" usemap="#connection__or_8c_a8573b49df7ffc3ad6df0faa6e7a12f10_cgraph" alt=""/></div>
<map name="connection__or_8c_a8573b49df7ffc3ad6df0faa6e7a12f10_cgraph" id="connection__or_8c_a8573b49df7ffc3ad6df0faa6e7a12f10_cgraph">
<area shape="rect" id="node2" href="networkstatus_8c.html#a810a06fe9e7c7bd3a1c5c5ee8cc13b52" title="router_get_consensus\l_status_by_id" alt="" coords="203,30,354,71"/>
<area shape="rect" id="node8" href="routerlist_8c.html#a9eb1861cedcb477a2e455b6c02eb56d8" title="router_get_by_id_digest" alt="" coords="199,97,359,124"/>
<area shape="rect" id="node3" href="networkstatus_8c.html#abeb917388a503fd5c8e727d7a6bd675f" title="router_get_mutable\l_consensus_status_by_id" alt="" coords="407,27,580,69"/>
<area shape="rect" id="node4" href="container_8c.html#a6722b8c6ca501b524958b3cdac2bc70c" title="smartlist_bsearch" alt="" coords="669,5,795,32"/>
<area shape="rect" id="node6" href="networkstatus_8c.html#a998a1af9202b3a8eec2327819b84bcee" title="compare_digest_to_routerstatus\l_entry" alt="" coords="628,57,836,98"/>
<area shape="rect" id="node5" href="container_8c.html#af0f195f396d7f97e7f2f2367453da119" title="smartlist_bsearch_idx" alt="" coords="884,5,1033,32"/>
<area shape="rect" id="node7" href="di__ops_8c.html#a47393c6ace65b9b2173d60ac6ae119aa" title="tor_memcmp" alt="" coords="909,64,1008,91"/>
<area shape="rect" id="node9" href="routerlist_8c.html#a848eea1698b3361538f190f55f2cc0e6" title="router_get_mutable\l_by_digest" alt="" coords="427,93,560,134"/>
</map>
</div>

</div>
</div>
<a id="add4f61d9c86887815a64fefae9d0ea6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add4f61d9c86887815a64fefae9d0ea6f">&#9670;&nbsp;</a></span>connection_or_finished_connecting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_finished_connecting </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>or_conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Connected handler for OR connections: begin the TLS handshake. </p>

</div>
</div>
<a id="a61f2d552138b0e015906710a045a6c55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61f2d552138b0e015906710a045a6c55">&#9670;&nbsp;</a></span>connection_or_finished_flushing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_finished_flushing </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Connection <b>conn</b> has finished writing and has no bytes left on its outbuf.</p>
<p>Otherwise it's in state "open": stop writing and return.</p>
<p>If <b>conn</b> is broken, mark it for close and return -1, else return 0. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a61f2d552138b0e015906710a045a6c55_cgraph.png" border="0" usemap="#connection__or_8c_a61f2d552138b0e015906710a045a6c55_cgraph" alt=""/></div>
<map name="connection__or_8c_a61f2d552138b0e015906710a045a6c55_cgraph" id="connection__or_8c_a61f2d552138b0e015906710a045a6c55_cgraph">
<area shape="rect" id="node2" href="connection_8c.html#a738d9e7ef0c4a101c2adbd4cade35475" title="assert_connection_ok" alt="" coords="208,13,357,39"/>
</map>
</div>

</div>
</div>
<a id="a8e6891862efd73402fed97a4353b2b24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e6891862efd73402fed97a4353b2b24">&#9670;&nbsp;</a></span>connection_or_flushed_some()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_flushed_some </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called whenever we have flushed some data on an or_conn: add more data from active circuits. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a8e6891862efd73402fed97a4353b2b24_cgraph.png" border="0" usemap="#connection__or_8c_a8e6891862efd73402fed97a4353b2b24_cgraph" alt=""/></div>
<map name="connection__or_8c_a8e6891862efd73402fed97a4353b2b24_cgraph" id="connection__or_8c_a8e6891862efd73402fed97a4353b2b24_cgraph">
<area shape="rect" id="node2" href="channel_8c.html#a08dea4276de8427cb789cda94be8eea7" title="channel_timestamp_active" alt="" coords="244,5,421,32"/>
</map>
</div>

</div>
</div>
<a id="a4643144162fb16fe61bdbcf9a0fc439b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4643144162fb16fe61bdbcf9a0fc439b">&#9670;&nbsp;</a></span>connection_or_get_by_ext_or_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structor__connection__t.html">or_connection_t</a>* connection_or_get_by_ext_or_id </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the connection whose ext_or_id is <b>id</b>. Return NULL if no such connection is found. </p>

</div>
</div>
<a id="ac067ffdc1b5006a8ab7a3a18e760ade7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac067ffdc1b5006a8ab7a3a18e760ade7">&#9670;&nbsp;</a></span>connection_or_group_set_badness_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_group_set_badness_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>force</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a list of all the or_connections with a given identity, set elements of that list as is_bad_for_new_circs as appropriate. Helper for connection_or_set_bad_connections().</p>
<p>Specifically, we set the is_bad_for_new_circs flag on:</p><ul>
<li>all connections if <b>force</b> is true.</li>
<li>all connections that are too old.</li>
<li>all open non-canonical connections for which a canonical connection exists to the same router.</li>
<li>all open canonical connections for which a 'better' canonical connection exists to the same router.</li>
<li>all open non-canonical connections for which a 'better' non-canonical connection exists to the same router at the same address.</li>
</ul>
<p>See <a class="el" href="channel_8c.html#a098e7f8cd053cab6477b2ff9dcbd7190">channel_is_better()</a> in <a class="el" href="channel_8c.html" title="OR/OP-to-OR channel abstraction layer. A channel&#39;s job is to transfer cells from Tor instance to Tor ...">channel.c</a> for our idea of what makes one OR connection better than another. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_ac067ffdc1b5006a8ab7a3a18e760ade7_cgraph.png" border="0" usemap="#connection__or_8c_ac067ffdc1b5006a8ab7a3a18e760ade7_cgraph" alt=""/></div>
<map name="connection__or_8c_ac067ffdc1b5006a8ab7a3a18e760ade7_cgraph" id="connection__or_8c_ac067ffdc1b5006a8ab7a3a18e760ade7_cgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a6d119bfc7d08a4cf060280c100860560" title="connection_or_single\l_set_badness_" alt="" coords="196,5,340,47"/>
</map>
</div>

</div>
</div>
<a id="a886ddcdf832a3d3ccc18184ee4d7dd26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a886ddcdf832a3d3ccc18184ee4d7dd26">&#9670;&nbsp;</a></span>connection_or_init_conn_from_address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_init_conn_from_address </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtor__addr__t.html">tor_addr_t</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>ed_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>started_here</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If we don't necessarily know the router we're connecting to, but we have an addr/port/id_digest, then fill in as much as we can. Start by checking to see if this describes a router we know. <b>started_here</b> is 1 if we are the initiator of <b>conn</b> and 0 if it's an incoming connection. </p>

</div>
</div>
<a id="a9874fc9cd6f255b931cbbcfc534702b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9874fc9cd6f255b931cbbcfc534702b7">&#9670;&nbsp;</a></span>connection_or_nonopen_was_started_here()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_nonopen_was_started_here </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return 1 if we initiated this connection, or 0 if it started out as an incoming connection. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a9874fc9cd6f255b931cbbcfc534702b7_cgraph.png" border="0" usemap="#connection__or_8c_a9874fc9cd6f255b931cbbcfc534702b7_cgraph" alt=""/></div>
<map name="connection__or_8c_a9874fc9cd6f255b931cbbcfc534702b7_cgraph" id="connection__or_8c_a9874fc9cd6f255b931cbbcfc534702b7_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#a89dbecf04240626af4b070b1b83c9f56" title="tor_tls_is_server" alt="" coords="212,13,331,39"/>
</map>
</div>

</div>
</div>
<a id="a1782f56c8e2a13ef3db44eed29c83d28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1782f56c8e2a13ef3db44eed29c83d28">&#9670;&nbsp;</a></span>connection_or_notify_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_notify_error </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reason</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><b>conn</b> got an error in connection_handle_read_impl() or connection_handle_write_impl() and is going to die soon.</p>
<p><b>reason</b> specifies the or_conn_end_reason for the failure; <b>msg</b> specifies the strerror-style error message. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a1782f56c8e2a13ef3db44eed29c83d28_cgraph.png" border="0" usemap="#connection__or_8c_a1782f56c8e2a13ef3db44eed29c83d28_cgraph" alt=""/></div>
<map name="connection__or_8c_a1782f56c8e2a13ef3db44eed29c83d28_cgraph" id="connection__or_8c_a1782f56c8e2a13ef3db44eed29c83d28_cgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a6a75b0592cc90f11549ed8899454a1f0" title="connection_or_connect\l_failed" alt="" coords="196,5,352,47"/>
<area shape="rect" id="node3" href="control_8c.html#a7ec5a96f0e43d4719b7992819bb3f1ac" title="control_event_or_conn\l_status" alt="" coords="400,5,553,47"/>
</map>
</div>

</div>
</div>
<a id="ae7f9c88b79431319b84a9094761372be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7f9c88b79431319b84a9094761372be">&#9670;&nbsp;</a></span>connection_or_num_cells_writeable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t connection_or_num_cells_writeable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is for <a class="el" href="channeltls_8c.html" title="A concrete subclass of channel_t using or_connection_t to transfer cells between Tor instances...">channeltls.c</a> to ask how many cells we could accept if they were available. </p>

</div>
</div>
<a id="a1c9c08479c7f8118438c42edb7046d32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c9c08479c7f8118438c42edb7046d32">&#9670;&nbsp;</a></span>connection_or_process_inbuf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_process_inbuf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle any new bytes that have come in on connection <b>conn</b>. If conn is in 'open' state, hand it to connection_or_process_cells_from_inbuf() (else do nothing). </p>
<p>Don't let the inbuf of a nonopen OR connection grow beyond this many bytes: it's either a broken client, a non-Tor client, or a DOS attempt. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a1c9c08479c7f8118438c42edb7046d32_cgraph.png" border="0" usemap="#connection__or_8c_a1c9c08479c7f8118438c42edb7046d32_cgraph" alt=""/></div>
<map name="connection__or_8c_a1c9c08479c7f8118438c42edb7046d32_cgraph" id="connection__or_8c_a1c9c08479c7f8118438c42edb7046d32_cgraph">
<area shape="rect" id="node2" href="connection_8c.html#a762af8c79046607b86c5be3a403c736b" title="connection_read_proxy\l_handshake" alt="" coords="209,5,365,47"/>
</map>
</div>

</div>
</div>
<a id="a11cff8523e1f4b95674f2b227a46c862"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11cff8523e1f4b95674f2b227a46c862">&#9670;&nbsp;</a></span>connection_or_reached_eof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_reached_eof </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We've received an EOF from <b>conn</b>. Mark it for close and return. </p>

</div>
</div>
<a id="ab7e49a59759436fa3e35e9cfd541e018"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7e49a59759436fa3e35e9cfd541e018">&#9670;&nbsp;</a></span>connection_or_remove_from_ext_or_id_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_remove_from_ext_or_id_map </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove the Extended ORPort identifier of <b>conn</b> from the global identifier list. Also, clear the identifier from the connection itself. </p>

</div>
</div>
<a id="a7feaa6ab5ddfb6f1c64357cffbd5e70d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7feaa6ab5ddfb6f1c64357cffbd5e70d">&#9670;&nbsp;</a></span>connection_or_report_broken_states()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_report_broken_states </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Report a list of the top states for failed OR connections at log level <b>severity</b>, in log domain <b>domain</b>. </p>

</div>
</div>
<a id="acda2ead17f44091558bb27dd084517b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acda2ead17f44091558bb27dd084517b9">&#9670;&nbsp;</a></span>connection_or_send_auth_challenge_cell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_send_auth_challenge_cell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send an AUTH_CHALLENGE cell on the connection <b>conn</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_acda2ead17f44091558bb27dd084517b9_cgraph.png" border="0" usemap="#connection__or_8c_acda2ead17f44091558bb27dd084517b9_cgraph" alt=""/></div>
<map name="connection__or_8c_acda2ead17f44091558bb27dd084517b9_cgraph" id="connection__or_8c_acda2ead17f44091558bb27dd084517b9_cgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a23e8e7d75e478e23ba78046d4bf17088" title="var_cell_new" alt="" coords="196,13,295,39"/>
</map>
</div>

</div>
</div>
<a id="a373bc2ce63f7b8a6530d1b16e420f7c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a373bc2ce63f7b8a6530d1b16e420f7c4">&#9670;&nbsp;</a></span>connection_or_send_certs_cell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_send_certs_cell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send a CERTS cell on the connection <b>conn</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a373bc2ce63f7b8a6530d1b16e420f7c4_cgraph.png" border="0" usemap="#connection__or_8c_a373bc2ce63f7b8a6530d1b16e420f7c4_cgraph" alt=""/></div>
<map name="connection__or_8c_a373bc2ce63f7b8a6530d1b16e420f7c4_cgraph" id="connection__or_8c_a373bc2ce63f7b8a6530d1b16e420f7c4_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#a7aa93459dd4e3641e885932d682db4a0" title="tor_tls_get_my_certs" alt="" coords="192,13,336,39"/>
</map>
</div>

</div>
</div>
<a id="a23cfebfdf4ea8cb551ab8d243b56b811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23cfebfdf4ea8cb551ab8d243b56b811">&#9670;&nbsp;</a></span>connection_or_send_versions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_send_versions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>v3_plus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send a VERSIONS cell on <b>conn</b>, telling the other host about the link protocol versions that this Tor can support.</p>
<p>If <b>v3_plus</b>, this is part of a V3 protocol handshake, so only allow protocol version v3 or later. If not <b>v3_plus</b>, this is not part of a v3 protocol handshake, so don't allow protocol v3 or later. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a23cfebfdf4ea8cb551ab8d243b56b811_cgraph.png" border="0" usemap="#connection__or_8c_a23cfebfdf4ea8cb551ab8d243b56b811_cgraph" alt=""/></div>
<map name="connection__or_8c_a23cfebfdf4ea8cb551ab8d243b56b811_cgraph" id="connection__or_8c_a23cfebfdf4ea8cb551ab8d243b56b811_cgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a23e8e7d75e478e23ba78046d4bf17088" title="var_cell_new" alt="" coords="192,13,291,39"/>
</map>
</div>

</div>
</div>
<a id="a8ad5485d3d553595f598242d862b20a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ad5485d3d553595f598242d862b20a0">&#9670;&nbsp;</a></span>connection_or_set_ext_or_identifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_set_ext_or_identifier </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates an Extended ORPort identifier for <b>conn</b> and deposits it into the global list of identifiers. </p>

</div>
</div>
<a id="a10910510a0e668c958457783ccf154c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10910510a0e668c958457783ccf154c9">&#9670;&nbsp;</a></span>connection_or_set_state_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_set_state_open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>conn</b>'s state to OR_CONN_STATE_OPEN, and tell other subsystems as appropriate. Called when we are done with all TLS and OR handshaking. </p>

</div>
</div>
<a id="a6d119bfc7d08a4cf060280c100860560"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d119bfc7d08a4cf060280c100860560">&#9670;&nbsp;</a></span>connection_or_single_set_badness_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_or_single_set_badness_ </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>or_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>force</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Expire an or_connection if it is too old. Helper for connection_or_group_set_badness_ and fast path for channel_rsa_id_group_set_badness.</p>
<p>Returns 1 if the connection was already expired, else 0. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a6d119bfc7d08a4cf060280c100860560_icgraph.png" border="0" usemap="#connection__or_8c_a6d119bfc7d08a4cf060280c100860560_icgraph" alt=""/></div>
<map name="connection__or_8c_a6d119bfc7d08a4cf060280c100860560_icgraph" id="connection__or_8c_a6d119bfc7d08a4cf060280c100860560_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#ac067ffdc1b5006a8ab7a3a18e760ade7" title="connection_or_group\l_set_badness_" alt="" coords="197,5,340,47"/>
</map>
</div>

</div>
</div>
<a id="abb65c80b10f299f06144b83628e74ce1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb65c80b10f299f06144b83628e74ce1">&#9670;&nbsp;</a></span>connection_or_update_token_buckets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_update_token_buckets </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>conns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Either our set of relays or our per-conn rate limits have changed. Go through all the OR connections and update their token buckets to make sure they don't exceed their maximum values. </p>

</div>
</div>
<a id="a1a80590d68a6d8ea9b011ae44245929b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a80590d68a6d8ea9b011ae44245929b">&#9670;&nbsp;</a></span>connection_or_write_cell_to_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_or_write_cell_to_buf </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcell__t.html">cell_t</a> *&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pack <b>cell</b> into wire-format, and write it onto <b>conn</b>'s outbuf. For cells that use or affect a circuit, this should only be called by connection_or_flush_from_first_active_circuit(). </p>

</div>
</div>
<a id="a15ee02cde3308ff45253cd8832bf9dfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15ee02cde3308ff45253cd8832bf9dfd">&#9670;&nbsp;</a></span>connection_tls_continue_handshake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_tls_continue_handshake </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Move forward with the tls handshake. If it finishes, hand <b>conn</b> to connection_tls_finish_handshake().</p>
<p>Return -1 if <b>conn</b> is broken, else return 0. </p>

</div>
</div>
<a id="a1050c4f55437f7f68627c637a3dbc0e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1050c4f55437f7f68627c637a3dbc0e9">&#9670;&nbsp;</a></span>is_or_protocol_version_known()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int is_or_protocol_version_known </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff <b>v</b> is a link protocol version that this Tor implementation believes it can support. </p>

</div>
</div>
<a id="a91065ac60ede0c2ccdaf7d2ff4892d5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91065ac60ede0c2ccdaf7d2ff4892d5d">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[1/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">connection_or_get_num_circuits&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of circuits using an <a class="el" href="structor__connection__t.html">or_connection_t</a>; this used to be an <a class="el" href="structor__connection__t.html">or_connection_t</a> field, but it got moved to channel_t and we shouldn't maintain two copies. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a91065ac60ede0c2ccdaf7d2ff4892d5d_cgraph.png" border="0" usemap="#connection__or_8c_a91065ac60ede0c2ccdaf7d2ff4892d5d_cgraph" alt=""/></div>
<map name="connection__or_8c_a91065ac60ede0c2ccdaf7d2ff4892d5d_cgraph" id="connection__or_8c_a91065ac60ede0c2ccdaf7d2ff4892d5d_cgraph">
<area shape="rect" id="node2" href="channel_8c.html#ae541683374c3002a6218c576c9775910" title="channel_num_circuits" alt="" coords="153,5,301,32"/>
</map>
</div>

</div>
</div>
<a id="a9fdf1e7144b7f497802d60f0f6a076fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fdf1e7144b7f497802d60f0f6a076fc">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[2/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">connection_or_connect&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(const <a class="el" href="structtor__addr__t.html">tor_addr_t</a> *_addr, uint16_t port, const char *id_digest, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *ed_id, channel_tls_t *chan)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Launch a new OR connection to <b>addr</b>:<b>port</b> and expect to handshake with an OR with identity digest <b>id_digest</b>. Optionally, pass in a pointer to a channel using this connection.</p>
<p>If <b>id_digest</b> is me, do nothing. If we're already connected to it, return that connection. If the connect() is in progress, set the new conn's state to 'connecting' and return it. If connect() succeeds, call connection_tls_start_handshake() on it.</p>
<p>This function is called from router_retry_connections(), for ORs connecting to ORs, and <a class="el" href="circuitbuild_8c.html#a39fa414f8544e3924490ea2a40b540af">circuit_establish_circuit()</a>, for OPs connecting to ORs.</p>
<p>Return the launched conn, or NULL if it failed. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a9fdf1e7144b7f497802d60f0f6a076fc_cgraph.png" border="0" usemap="#connection__or_8c_a9fdf1e7144b7f497802d60f0f6a076fc_cgraph" alt=""/></div>
<map name="connection__or_8c_a9fdf1e7144b7f497802d60f0f6a076fc_cgraph" id="connection__or_8c_a9fdf1e7144b7f497802d60f0f6a076fc_cgraph">
<area shape="rect" id="node2" href="address_8c.html#a139ff425c957e4eed3a766cb48f55f93" title="tor_addr_copy" alt="" coords="171,5,275,32"/>
<area shape="rect" id="node3" href="router_8c.html#abeb0f38915a46f77352900604075d82f" title="router_digest_is_me" alt="" coords="153,56,292,83"/>
<area shape="rect" id="node4" href="di__ops_8c.html#a473334ee93cca0aea10523321a444ea3" title="tor_memeq" alt="" coords="340,56,427,83"/>
</map>
</div>

</div>
</div>
<a id="a7cffbd09fb670b958a09e5d65982d560"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cffbd09fb670b958a09e5d65982d560">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[3/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">connection_or_close_for_error&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(<a class="el" href="structor__connection__t.html">or_connection_t</a> *orconn, int flush)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mark orconn for close and transition the associated channel, if any, to the error state. </p>

</div>
</div>
<a id="a4b039b5bbe0c7cd361769189ce4d2238"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b039b5bbe0c7cd361769189ce4d2238">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[4/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">connection_tls_start_handshake&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, int receiving)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Begin the tls handshake with <b>conn</b>. <b>receiving</b> is 0 if we initiated the connection, else it's 1.</p>
<p>Assign a new tls object to conn-&gt;tls, begin reading on <b>conn</b>, and pass <b>conn</b> to <a class="el" href="connection__or_8c.html#a15ee02cde3308ff45253cd8832bf9dfd">connection_tls_continue_handshake()</a>.</p>
<p>Return -1 if <b>conn</b> is broken, else return 0. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a4b039b5bbe0c7cd361769189ce4d2238_cgraph.png" border="0" usemap="#connection__or_8c_a4b039b5bbe0c7cd361769189ce4d2238_cgraph" alt=""/></div>
<map name="connection__or_8c_a4b039b5bbe0c7cd361769189ce4d2238_cgraph" id="connection__or_8c_a4b039b5bbe0c7cd361769189ce4d2238_cgraph">
<area shape="rect" id="node2" href="channeltls_8c.html#a3fbe32c536a922af8a1aa588a239055b" title="channel_tls_get_listener" alt="" coords="157,5,320,32"/>
<area shape="rect" id="node3" href="channeltls_8c.html#a8e1f9831dfe17a5cebcc49982597d2d5" title="channel_tls_start_listener" alt="" coords="153,56,324,83"/>
<area shape="rect" id="node4" href="command_8c.html#ac66f67199b0fb1b309bc92a29c66a28c" title="command_setup_listener" alt="" coords="155,107,322,133"/>
<area shape="rect" id="node5" href="channeltls_8c.html#af227caf294fbde3eeffa7588e1dd2a69" title="channel_tls_handle\l_incoming" alt="" coords="172,158,305,199"/>
<area shape="rect" id="node6" href="channel_8c.html#a54f08cb6c0828f43f1253018f9fe3650" title="channel_listener_queue\l_incoming" alt="" coords="159,223,318,265"/>
</map>
</div>

</div>
</div>
<a id="aaf43644cf527a6655657b8f4aa1d1e1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf43644cf527a6655657b8f4aa1d1e1e">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[5/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">connection_or_write_var_cell_to_buf&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(const <a class="el" href="structvar__cell__t.html">var_cell_t</a> *cell, <a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pack a variable-length <b>cell</b> into wire-format, and write it onto <b>conn</b>'s outbuf. Right now, this <em>DOES NOT</em> support cells that affect a circuit. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_aaf43644cf527a6655657b8f4aa1d1e1e_cgraph.png" border="0" usemap="#connection__or_8c_aaf43644cf527a6655657b8f4aa1d1e1e_cgraph" alt=""/></div>
<map name="connection__or_8c_aaf43644cf527a6655657b8f4aa1d1e1e_cgraph" id="connection__or_8c_aaf43644cf527a6655657b8f4aa1d1e1e_cgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a61c229ce284577c48c7a51f9532d8e15" title="var_cell_pack_header" alt="" coords="153,31,301,57"/>
<area shape="rect" id="node3" href="compat_8c.html#ac4d2010c31db105982e47dc345116b5f" title="set_uint32" alt="" coords="349,5,432,32"/>
<area shape="rect" id="node4" href="compat_8c.html#adbf52deccd4f2b9244d6911488b907f3" title="set_uint16" alt="" coords="349,56,432,83"/>
</map>
</div>

</div>
</div>
<a id="ab27b40a47b0943bf613f31427ad7b30c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab27b40a47b0943bf613f31427ad7b30c">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[6/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">connection_or_send_netinfo&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send a NETINFO cell on <b>conn</b>, telling the other server what we know about their address, our address, and the current time. </p>

</div>
</div>
<a id="a0e89fff0e71d905b83cae2583a7bc49f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e89fff0e71d905b83cae2583a7bc49f">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[7/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">connection_or_send_authenticate_cell&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, int authtype)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send an AUTHENTICATE cell on the connection <b>conn</b>. Return 0 on success, -1 on failure </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a0e89fff0e71d905b83cae2583a7bc49f_cgraph.png" border="0" usemap="#connection__or_8c_a0e89fff0e71d905b83cae2583a7bc49f_cgraph" alt=""/></div>
<map name="connection__or_8c_a0e89fff0e71d905b83cae2583a7bc49f_cgraph" id="connection__or_8c_a0e89fff0e71d905b83cae2583a7bc49f_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#a7cc46ce9e214e2055861f7cacdfdfca2" title="tor_tls_get_my_client\l_auth_key" alt="" coords="153,5,300,47"/>
</map>
</div>

</div>
</div>
<a id="a543b7dc735432b7107d590ff058008b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a543b7dc735432b7107d590ff058008b0">&#9670;&nbsp;</a></span>or_handshake_state_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void or_handshake_state_free_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__handshake__state__t.html">or_handshake_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all storage held by <b>state</b>. </p>

</div>
</div>
<a id="a741e61a567306a7cc5aaaf9634ecda4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a741e61a567306a7cc5aaaf9634ecda4e">&#9670;&nbsp;</a></span>or_handshake_state_record_cell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void or_handshake_state_record_cell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structor__handshake__state__t.html">or_handshake_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcell__t.html">cell_t</a> *&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>incoming</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remember that <b>cell</b> has been transmitted (if <b>incoming</b> is false) or received (if <b>incoming</b> is true) during a V3 handshake using <b>state</b>.</p>
<p>(We don't record the cell, but we keep a digest of everything sent or received during the v3 handshake, and the client signs it in an authenticate cell.) </p>

</div>
</div>
<a id="a5eac340c62c1d3844d69235a6a53c15e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eac340c62c1d3844d69235a6a53c15e">&#9670;&nbsp;</a></span>or_handshake_state_record_var_cell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void or_handshake_state_record_var_cell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structor__handshake__state__t.html">or_handshake_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structvar__cell__t.html">var_cell_t</a> *&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>incoming</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remember that a variable-length <b>cell</b> has been transmitted (if <b>incoming</b> is false) or received (if <b>incoming</b> is true) during a V3 handshake using <b>state</b>.</p>
<p>(We don't record the cell, but we keep a digest of everything sent or received during the v3 handshake, and the client signs it in an authenticate cell.) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a5eac340c62c1d3844d69235a6a53c15e_cgraph.png" border="0" usemap="#connection__or_8c_a5eac340c62c1d3844d69235a6a53c15e_cgraph" alt=""/></div>
<map name="connection__or_8c_a5eac340c62c1d3844d69235a6a53c15e_cgraph" id="connection__or_8c_a5eac340c62c1d3844d69235a6a53c15e_cgraph">
<area shape="rect" id="node2" href="crypto__digest_8c.html#ab13a3ab6f6ca1febd6a1f0e0c7f52966" title="crypto_digest256_new" alt="" coords="192,13,344,39"/>
</map>
</div>

</div>
</div>
<a id="a70378434d9f152969cf835cb7df59de1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70378434d9f152969cf835cb7df59de1">&#9670;&nbsp;</a></span>var_cell_copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structvar__cell__t.html">var_cell_t</a>* var_cell_copy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structvar__cell__t.html">var_cell_t</a> *&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy a <a class="el" href="structvar__cell__t.html">var_cell_t</a> </p>

</div>
</div>
<a id="a6c750321029bdf8f4083f6226102c6c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c750321029bdf8f4083f6226102c6c2">&#9670;&nbsp;</a></span>var_cell_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void var_cell_free_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvar__cell__t.html">var_cell_t</a> *&#160;</td>
          <td class="paramname"><em>cell</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all space held by <b>cell</b>. </p>

</div>
</div>
<a id="a23e8e7d75e478e23ba78046d4bf17088"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23e8e7d75e478e23ba78046d4bf17088">&#9670;&nbsp;</a></span>var_cell_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structvar__cell__t.html">var_cell_t</a>* var_cell_new </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>payload_len</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and return a new <a class="el" href="structvar__cell__t.html">var_cell_t</a> with <b>payload_len</b> bytes of payload space. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a23e8e7d75e478e23ba78046d4bf17088_icgraph.png" border="0" usemap="#connection__or_8c_a23e8e7d75e478e23ba78046d4bf17088_icgraph" alt=""/></div>
<map name="connection__or_8c_a23e8e7d75e478e23ba78046d4bf17088_icgraph" id="connection__or_8c_a23e8e7d75e478e23ba78046d4bf17088_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#a23cfebfdf4ea8cb551ab8d243b56b811" title="connection_or_send\l_versions" alt="" coords="154,5,293,47"/>
<area shape="rect" id="node3" href="connection__or_8h.html#acda2ead17f44091558bb27dd084517b9" title="connection_or_send\l_auth_challenge_cell" alt="" coords="152,71,295,112"/>
</map>
</div>

</div>
</div>
<a id="a61c229ce284577c48c7a51f9532d8e15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61c229ce284577c48c7a51f9532d8e15">&#9670;&nbsp;</a></span>var_cell_pack_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int var_cell_pack_header </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structvar__cell__t.html">var_cell_t</a> *&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>hdr_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wide_circ_ids</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write the header of <b>cell</b> into the first VAR_CELL_MAX_HEADER_SIZE bytes of <b>hdr_out</b>. Returns number of bytes used. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a61c229ce284577c48c7a51f9532d8e15_cgraph.png" border="0" usemap="#connection__or_8c_a61c229ce284577c48c7a51f9532d8e15_cgraph" alt=""/></div>
<map name="connection__or_8c_a61c229ce284577c48c7a51f9532d8e15_cgraph" id="connection__or_8c_a61c229ce284577c48c7a51f9532d8e15_cgraph">
<area shape="rect" id="node2" href="compat_8c.html#ac4d2010c31db105982e47dc345116b5f" title="set_uint32" alt="" coords="201,5,284,32"/>
<area shape="rect" id="node3" href="compat_8c.html#adbf52deccd4f2b9244d6911488b907f3" title="set_uint16" alt="" coords="201,56,284,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="connection__or_8c_a61c229ce284577c48c7a51f9532d8e15_icgraph.png" border="0" usemap="#connection__or_8c_a61c229ce284577c48c7a51f9532d8e15_icgraph" alt=""/></div>
<map name="connection__or_8c_a61c229ce284577c48c7a51f9532d8e15_icgraph" id="connection__or_8c_a61c229ce284577c48c7a51f9532d8e15_icgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#aaf43644cf527a6655657b8f4aa1d1e1e" title="MOCK_IMPL" alt="" coords="201,5,301,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
