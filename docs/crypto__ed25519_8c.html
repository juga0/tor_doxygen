<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/common/crypto_ed25519.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_b7e1585941a202f53e5249c42015d573.html">common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">crypto_ed25519.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Wrapper code for an ed25519 implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;orconfig.h&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto_8h_source.html">crypto.h</a>&quot;</code><br />
<code>#include &quot;crypto_curve25519.h&quot;</code><br />
<code>#include &quot;crypto_ed25519.h&quot;</code><br />
<code>#include &quot;crypto_format.h&quot;</code><br />
<code>#include &quot;<a class="el" href="torlog_8h_source.html">torlog.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util_8h_source.html">util.h</a>&quot;</code><br />
<code>#include &quot;ed25519/ref10/ed25519_ref10.h&quot;</code><br />
<code>#include &quot;ed25519/donna/ed25519_donna_tor.h&quot;</code><br />
<code>#include &lt;openssl/sha.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for crypto_ed25519.c:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2crypto__ed25519_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2crypto__ed25519_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2crypto__ed25519_8c">
<area shape="rect" id="node2" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="1470,512,1549,539"/>
<area shape="rect" id="node3" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="744,199,813,225"/>
<area shape="rect" id="node12" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="441,363,583,389"/>
<area shape="rect" id="node13" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="443,281,568,307"/>
<area shape="rect" id="node14" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="450,199,563,225"/>
<area shape="rect" id="node15" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="838,199,903,225"/>
<area shape="rect" id="node16" href="util_8h.html" title="Headers for util.c. " alt="" coords="1068,117,1119,143"/>
<area shape="rect" id="node20" href="ed25519__ref10_8h_source.html" title="ed25519/ref10/ed25519\l_ref10.h" alt="" coords="5,273,163,315"/>
<area shape="rect" id="node21" href="ed25519__donna__tor_8h_source.html" title="ed25519/donna/ed25519\l_donna_tor.h" alt="" coords="223,109,385,151"/>
<area shape="rect" id="node5" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="481,437,543,464"/>
<area shape="rect" id="node6" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="825,437,924,464"/>
<area shape="rect" id="node7" href="compat_8h_source.html" title="compat.h" alt="" coords="1201,281,1277,307"/>
<area shape="rect" id="node9" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="1547,437,1655,464"/>
<area shape="rect" id="node11" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="1195,363,1322,389"/>
<area shape="rect" id="node17" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="913,363,983,389"/>
<area shape="rect" id="node19" href="util__bug_8h.html" title="util_bug.h" alt="" coords="1243,199,1322,225"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structed25519__impl__t.html">ed25519_impl_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a49e4d1af4428ee01de5a0d0b409d0459"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a49e4d1af4428ee01de5a0d0b409d0459">ed25519_secret_key_generate</a> (<a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *seckey_out, int extra_strong)</td></tr>
<tr class="separator:a49e4d1af4428ee01de5a0d0b409d0459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6166bdc946f83db639c67aa5f44bb35"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#ae6166bdc946f83db639c67aa5f44bb35">ed25519_secret_key_from_seed</a> (<a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *seckey_out, const uint8_t *seed)</td></tr>
<tr class="separator:ae6166bdc946f83db639c67aa5f44bb35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a250f7c3af49aabe2d1173325ae0841f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a250f7c3af49aabe2d1173325ae0841f5">ed25519_public_key_generate</a> (<a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey_out, const <a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *seckey)</td></tr>
<tr class="separator:a250f7c3af49aabe2d1173325ae0841f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53329d0f576211570b7481ad2a3cac04"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a53329d0f576211570b7481ad2a3cac04">ed25519_keypair_generate</a> (<a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *keypair_out, int extra_strong)</td></tr>
<tr class="separator:a53329d0f576211570b7481ad2a3cac04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a372c6a68ee684f2c73a2dfd89864bd44"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a372c6a68ee684f2c73a2dfd89864bd44">ed25519_sign</a> (<a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *signature_out, const uint8_t *msg, size_t len, const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *keypair)</td></tr>
<tr class="separator:a372c6a68ee684f2c73a2dfd89864bd44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d11e62a5ade103498362de1d41a9cdc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a7d11e62a5ade103498362de1d41a9cdc">ed25519_sign_prefixed</a> (<a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *signature_out, const uint8_t *msg, size_t msg_len, const char *prefix_str, const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *keypair)</td></tr>
<tr class="separator:a7d11e62a5ade103498362de1d41a9cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6638c201fc31127634b6e04cec6abe79"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a6638c201fc31127634b6e04cec6abe79">ed25519_checksig</a> (const <a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *signature, const uint8_t *msg, size_t len, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey)</td></tr>
<tr class="separator:a6638c201fc31127634b6e04cec6abe79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a005195c17a15a9b7cc8cf3b82709800e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a005195c17a15a9b7cc8cf3b82709800e">ed25519_checksig_prefixed</a> (const <a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *signature, const uint8_t *msg, size_t msg_len, const char *prefix_str, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey)</td></tr>
<tr class="separator:a005195c17a15a9b7cc8cf3b82709800e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3328c534892b47f310d62d5c3479d175"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a3328c534892b47f310d62d5c3479d175">ed25519_checksig_batch</a> (int *okay_out, const <a class="el" href="structed25519__checkable__t.html">ed25519_checkable_t</a> *checkable, int n_checkable)</td></tr>
<tr class="separator:a3328c534892b47f310d62d5c3479d175"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb50b5bb9010dfe33e19a08f5cc362da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#abb50b5bb9010dfe33e19a08f5cc362da">ed25519_keypair_from_curve25519_keypair</a> (<a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *out, int *signbit_out, const <a class="el" href="structcurve25519__keypair__t.html">curve25519_keypair_t</a> *inp)</td></tr>
<tr class="separator:abb50b5bb9010dfe33e19a08f5cc362da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c15f72552477f36fca48340e53644e9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a8c15f72552477f36fca48340e53644e9">ed25519_public_key_from_curve25519_public_key</a> (<a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey, const <a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> *pubkey_in, int signbit)</td></tr>
<tr class="separator:a8c15f72552477f36fca48340e53644e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b704dfeb238e199f7d1cf5d6ff8b349"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a5b704dfeb238e199f7d1cf5d6ff8b349">ed25519_keypair_blind</a> (<a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *out, const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *inp, const uint8_t *param)</td></tr>
<tr class="separator:a5b704dfeb238e199f7d1cf5d6ff8b349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93deb0ce2adfc0236be5934191568e66"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a93deb0ce2adfc0236be5934191568e66">ed25519_public_blind</a> (<a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *out, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *inp, const uint8_t *param)</td></tr>
<tr class="separator:a93deb0ce2adfc0236be5934191568e66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91a3f7e13f15a365d83bcb418daaaf7d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a91a3f7e13f15a365d83bcb418daaaf7d">ed25519_seckey_write_to_file</a> (const <a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *seckey, const char *filename, const char *tag)</td></tr>
<tr class="separator:a91a3f7e13f15a365d83bcb418daaaf7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34a8bd7b192871bd1e5b778961ba2efb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a34a8bd7b192871bd1e5b778961ba2efb">ed25519_seckey_read_from_file</a> (<a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *seckey_out, char **tag_out, const char *filename)</td></tr>
<tr class="separator:a34a8bd7b192871bd1e5b778961ba2efb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7619807bfd3a082c5bba11d43f9f63ee"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a7619807bfd3a082c5bba11d43f9f63ee">ed25519_pubkey_write_to_file</a> (const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey, const char *filename, const char *tag)</td></tr>
<tr class="separator:a7619807bfd3a082c5bba11d43f9f63ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa33c6bb447b0042745d6d2938a12dda4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#aa33c6bb447b0042745d6d2938a12dda4">ed25519_pubkey_read_from_file</a> (<a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey_out, char **tag_out, const char *filename)</td></tr>
<tr class="separator:aa33c6bb447b0042745d6d2938a12dda4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb6d235525b50eceac6cd3dd5b5b2fc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#adb6d235525b50eceac6cd3dd5b5b2fc6">ed25519_keypair_free</a> (<a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *kp)</td></tr>
<tr class="separator:adb6d235525b50eceac6cd3dd5b5b2fc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9396211603b40cf70b930b9ef726ed1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#af9396211603b40cf70b930b9ef726ed1">ed25519_pubkey_eq</a> (const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *key1, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *key2)</td></tr>
<tr class="separator:af9396211603b40cf70b930b9ef726ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac524189e9fe43d0040e5be28bdf1c430"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#ac524189e9fe43d0040e5be28bdf1c430">ed25519_set_impl_params</a> (int use_donna)</td></tr>
<tr class="separator:ac524189e9fe43d0040e5be28bdf1c430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61ab2fd9af857351a18486b7a35572c4"><td class="memItemLeft" align="right" valign="top"><a id="a61ab2fd9af857351a18486b7a35572c4"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ed25519_init</b> (void)</td></tr>
<tr class="separator:a61ab2fd9af857351a18486b7a35572c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Wrapper code for an ed25519 implementation. </p>
<p>Ed25519 is a Schnorr signature on a Twisted Edwards curve, defined by Dan Bernstein. For more information, see <a href="https://ed25519.cr.yp.to/">https://ed25519.cr.yp.to/</a></p>
<p>This module wraps our choice of Ed25519 backend, and provides a few convenience functions for checking and generating signatures. It also provides Tor-specific tools for key blinding and for converting Ed25519 keys to and from the corresponding Curve25519 keys. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6638c201fc31127634b6e04cec6abe79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6638c201fc31127634b6e04cec6abe79">&#9670;&nbsp;</a></span>ed25519_checksig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_checksig </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether if <b>signature</b> is a valid signature for the <b>len</b>-byte message in <b>msg</b> made with the key <b>pubkey</b>.</p>
<p>Return 0 if the signature is valid; -1 if it isn't. </p>

</div>
</div>
<a id="a3328c534892b47f310d62d5c3479d175"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3328c534892b47f310d62d5c3479d175">&#9670;&nbsp;</a></span>ed25519_checksig_batch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_checksig_batch </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>okay_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__checkable__t.html">ed25519_checkable_t</a> *&#160;</td>
          <td class="paramname"><em>checkable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_checkable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Validate every signature among those in <b>checkable</b>, which contains exactly <b>n_checkable</b> elements. If <b>okay_out</b> is non-NULL, set the i'th element of <b>okay_out</b> to 1 if the i'th element of <b>checkable</b> is valid, and to 0 otherwise. Return 0 if every signature was valid. Otherwise return -N, where N is the number of invalid signatures. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a3328c534892b47f310d62d5c3479d175_icgraph.png" border="0" usemap="#crypto__ed25519_8c_a3328c534892b47f310d62d5c3479d175_icgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a3328c534892b47f310d62d5c3479d175_icgraph" id="crypto__ed25519_8c_a3328c534892b47f310d62d5c3479d175_icgraph">
<area shape="rect" id="node2" href="torcert_8c.html#a3fdcb671425022b0510132ebb2e1e4fa" title="tor_cert_checksig" alt="" coords="223,5,348,32"/>
</map>
</div>

</div>
</div>
<a id="a005195c17a15a9b7cc8cf3b82709800e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a005195c17a15a9b7cc8cf3b82709800e">&#9670;&nbsp;</a></span>ed25519_checksig_prefixed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_checksig_prefixed </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>msg_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prefix_str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Like ed2519_checksig(), but also prefix <b>msg</b> with <b>prefix_str</b> before verifying signature. <b>prefix_str</b> must be a NUL-terminated string. </p>

</div>
</div>
<a id="a5b704dfeb238e199f7d1cf5d6ff8b349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b704dfeb238e199f7d1cf5d6ff8b349">&#9670;&nbsp;</a></span>ed25519_keypair_blind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_keypair_blind </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given an ed25519 keypair in <b>inp</b>, generate a corresponding ed25519 keypair in <b>out</b>, blinded by the corresponding 32-byte input in 'param'.</p>
<p>Tor uses key blinding for the "next-generation" hidden services design: service descriptors are encrypted with a key derived from the service's long-term public key, and then signed with (and stored at a position indexed by) a short-term key derived by blinding the long-term keys. </p>

</div>
</div>
<a id="adb6d235525b50eceac6cd3dd5b5b2fc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb6d235525b50eceac6cd3dd5b5b2fc6">&#9670;&nbsp;</a></span>ed25519_keypair_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ed25519_keypair_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>kp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all storage held for <b>kp</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_adb6d235525b50eceac6cd3dd5b5b2fc6_cgraph.png" border="0" usemap="#crypto__ed25519_8c_adb6d235525b50eceac6cd3dd5b5b2fc6_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_adb6d235525b50eceac6cd3dd5b5b2fc6_cgraph" id="crypto__ed25519_8c_adb6d235525b50eceac6cd3dd5b5b2fc6_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="203,5,281,32"/>
</map>
</div>

</div>
</div>
<a id="abb50b5bb9010dfe33e19a08f5cc362da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb50b5bb9010dfe33e19a08f5cc362da">&#9670;&nbsp;</a></span>ed25519_keypair_from_curve25519_keypair()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_keypair_from_curve25519_keypair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>signbit_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcurve25519__keypair__t.html">curve25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>inp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a curve25519 keypair in <b>inp</b>, generate a corresponding ed25519 keypair in <b>out</b>, and set <b>signbit_out</b> to the sign bit of the X coordinate of the ed25519 key.</p>
<p>NOTE THAT IT IS PROBABLY NOT SAFE TO USE THE GENERATED KEY FOR ANYTHING OUTSIDE OF WHAT'S PRESENTED IN PROPOSAL 228. In particular, it's probably not a great idea to use it to sign attacker-supplied anything. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_cgraph.png" border="0" usemap="#crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_cgraph" id="crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_cgraph">
<area shape="rect" id="node2" href="crypto__ed25519_8c.html#a250f7c3af49aabe2d1173325ae0841f5" title="ed25519_public_key\l_generate" alt="" coords="236,5,376,47"/>
<area shape="rect" id="node3" href="crypto__ed25519_8c.html#a8c15f72552477f36fca48340e53644e9" title="ed25519_public_key\l_from_curve25519_public_key" alt="" coords="207,71,405,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_icgraph.png" border="0" usemap="#crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_icgraph" alt=""/></div>
<map name="crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_icgraph" id="crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_icgraph">
<area shape="rect" id="node2" href="routerkeys_8c.html#ac1142499a3f0ac31e764484c1c6bd6c6" title="make_ntor_onion_key\l_crosscert" alt="" coords="207,5,356,47"/>
</map>
</div>

</div>
</div>
<a id="a53329d0f576211570b7481ad2a3cac04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53329d0f576211570b7481ad2a3cac04">&#9670;&nbsp;</a></span>ed25519_keypair_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_keypair_generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>keypair_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>extra_strong</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate a new ed25519 keypair in <b>keypair_out</b>. If <b>extra_strong</b> is set, try to mix some system entropy into the key generation process. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a53329d0f576211570b7481ad2a3cac04_cgraph.png" border="0" usemap="#crypto__ed25519_8c_a53329d0f576211570b7481ad2a3cac04_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a53329d0f576211570b7481ad2a3cac04_cgraph" id="crypto__ed25519_8c_a53329d0f576211570b7481ad2a3cac04_cgraph">
<area shape="rect" id="node2" href="crypto__ed25519_8c.html#a49e4d1af4428ee01de5a0d0b409d0459" title="ed25519_secret_key\l_generate" alt="" coords="231,5,373,47"/>
<area shape="rect" id="node4" href="crypto__ed25519_8c.html#a250f7c3af49aabe2d1173325ae0841f5" title="ed25519_public_key\l_generate" alt="" coords="232,71,372,112"/>
<area shape="rect" id="node3" href="crypto_8c.html#ae5356daa13494dbcca77324c6a85b9da" title="crypto_strongest_rand" alt="" coords="421,13,572,39"/>
</map>
</div>

</div>
</div>
<a id="af9396211603b40cf70b930b9ef726ed1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9396211603b40cf70b930b9ef726ed1">&#9670;&nbsp;</a></span>ed25519_pubkey_eq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_pubkey_eq </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>key1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>key2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff <b>key1</b> and <b>key2</b> are the same public key. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_af9396211603b40cf70b930b9ef726ed1_cgraph.png" border="0" usemap="#crypto__ed25519_8c_af9396211603b40cf70b930b9ef726ed1_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_af9396211603b40cf70b930b9ef726ed1_cgraph" id="crypto__ed25519_8c_af9396211603b40cf70b930b9ef726ed1_cgraph">
<area shape="rect" id="node2" href="di__ops_8c.html#a473334ee93cca0aea10523321a444ea3" title="tor_memeq" alt="" coords="195,5,281,32"/>
</map>
</div>

</div>
</div>
<a id="aa33c6bb447b0042745d6d2938a12dda4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa33c6bb447b0042745d6d2938a12dda4">&#9670;&nbsp;</a></span>ed25519_pubkey_read_from_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_pubkey_read_from_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>tag_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Store pubkey unencrypted to <b>filename</b>, marking it with <b>tag</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_aa33c6bb447b0042745d6d2938a12dda4_cgraph.png" border="0" usemap="#crypto__ed25519_8c_aa33c6bb447b0042745d6d2938a12dda4_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_aa33c6bb447b0042745d6d2938a12dda4_cgraph" id="crypto__ed25519_8c_aa33c6bb447b0042745d6d2938a12dda4_cgraph">
<area shape="rect" id="node2" href="crypto__format_8c.html#a40e1ed638568c15cac66b16cf427b4e7" title="crypto_read_tagged\l_contents_from_file" alt="" coords="205,49,341,90"/>
<area shape="rect" id="node3" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="407,5,495,32"/>
<area shape="rect" id="node4" href="util_8c.html#a28445ce92bb84e6413d5437428dae850" title="strcmpend" alt="" coords="409,56,492,83"/>
<area shape="rect" id="node5" href="util_8c.html#a7c5079074e649dc0369225eca3073f7d" title="tor_mem_is_zero" alt="" coords="389,107,512,133"/>
</map>
</div>

</div>
</div>
<a id="a7619807bfd3a082c5bba11d43f9f63ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7619807bfd3a082c5bba11d43f9f63ee">&#9670;&nbsp;</a></span>ed25519_pubkey_write_to_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_pubkey_write_to_file </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Store pubkey unencrypted to <b>filename</b>, marking it with <b>tag</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a7619807bfd3a082c5bba11d43f9f63ee_cgraph.png" border="0" usemap="#crypto__ed25519_8c_a7619807bfd3a082c5bba11d43f9f63ee_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a7619807bfd3a082c5bba11d43f9f63ee_cgraph" id="crypto__ed25519_8c_a7619807bfd3a082c5bba11d43f9f63ee_cgraph">
<area shape="rect" id="node2" href="crypto__format_8c.html#a58e217ce83721c40e22a70f6f9ca1544" title="crypto_write_tagged\l_contents_to_file" alt="" coords="208,49,347,90"/>
<area shape="rect" id="node3" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="422,5,509,32"/>
<area shape="rect" id="node5" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="415,56,515,83"/>
<area shape="rect" id="node6" href="util_8c.html#ae01530967d53afcfefa8227c98072e83" title="write_chunks_to_file" alt="" coords="395,107,536,133"/>
<area shape="rect" id="node4" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="584,5,679,32"/>
</map>
</div>

</div>
</div>
<a id="a93deb0ce2adfc0236be5934191568e66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93deb0ce2adfc0236be5934191568e66">&#9670;&nbsp;</a></span>ed25519_public_blind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_public_blind </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given an ed25519 public key in <b>inp</b>, generate a corresponding blinded public key in <b>out</b>, blinded with the 32-byte parameter in <b>param</b>. Return 0 on sucess, -1 on railure. </p>

</div>
</div>
<a id="a8c15f72552477f36fca48340e53644e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c15f72552477f36fca48340e53644e9">&#9670;&nbsp;</a></span>ed25519_public_key_from_curve25519_public_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_public_key_from_curve25519_public_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>signbit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a curve25519 public key and sign bit of X coordinate of the ed25519 public key, generate the corresponding ed25519 public key. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a8c15f72552477f36fca48340e53644e9_icgraph.png" border="0" usemap="#crypto__ed25519_8c_a8c15f72552477f36fca48340e53644e9_icgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a8c15f72552477f36fca48340e53644e9_icgraph" id="crypto__ed25519_8c_a8c15f72552477f36fca48340e53644e9_icgraph">
<area shape="rect" id="node2" href="crypto__ed25519_8c.html#abb50b5bb9010dfe33e19a08f5cc362da" title="ed25519_keypair_from\l_curve25519_keypair" alt="" coords="252,5,405,47"/>
<area shape="rect" id="node3" href="routerkeys_8c.html#ac1142499a3f0ac31e764484c1c6bd6c6" title="make_ntor_onion_key\l_crosscert" alt="" coords="453,5,603,47"/>
</map>
</div>

</div>
</div>
<a id="a250f7c3af49aabe2d1173325ae0841f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a250f7c3af49aabe2d1173325ae0841f5">&#9670;&nbsp;</a></span>ed25519_public_key_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_public_key_generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>seckey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a secret key in <b>seckey</b>, expand it into an ed25519 public key. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a250f7c3af49aabe2d1173325ae0841f5_icgraph.png" border="0" usemap="#crypto__ed25519_8c_a250f7c3af49aabe2d1173325ae0841f5_icgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a250f7c3af49aabe2d1173325ae0841f5_icgraph" id="crypto__ed25519_8c_a250f7c3af49aabe2d1173325ae0841f5_icgraph">
<area shape="rect" id="node2" href="crypto__ed25519_8c.html#a53329d0f576211570b7481ad2a3cac04" title="ed25519_keypair_generate" alt="" coords="193,5,371,32"/>
<area shape="rect" id="node3" href="crypto__ed25519_8c.html#abb50b5bb9010dfe33e19a08f5cc362da" title="ed25519_keypair_from\l_curve25519_keypair" alt="" coords="205,57,359,98"/>
<area shape="rect" id="node4" href="routerkeys_8c.html#ac1142499a3f0ac31e764484c1c6bd6c6" title="make_ntor_onion_key\l_crosscert" alt="" coords="419,57,568,98"/>
</map>
</div>

</div>
</div>
<a id="a34a8bd7b192871bd1e5b778961ba2efb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34a8bd7b192871bd1e5b778961ba2efb">&#9670;&nbsp;</a></span>ed25519_seckey_read_from_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_seckey_read_from_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>seckey_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>tag_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read seckey unencrypted from <b>filename</b>, storing it into <b>seckey_out</b>. Set *<b>tag_out</b> to the tag it was marked with. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a34a8bd7b192871bd1e5b778961ba2efb_cgraph.png" border="0" usemap="#crypto__ed25519_8c_a34a8bd7b192871bd1e5b778961ba2efb_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a34a8bd7b192871bd1e5b778961ba2efb_cgraph" id="crypto__ed25519_8c_a34a8bd7b192871bd1e5b778961ba2efb_cgraph">
<area shape="rect" id="node2" href="crypto__format_8c.html#a40e1ed638568c15cac66b16cf427b4e7" title="crypto_read_tagged\l_contents_from_file" alt="" coords="205,49,341,90"/>
<area shape="rect" id="node3" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="407,5,495,32"/>
<area shape="rect" id="node4" href="util_8c.html#a28445ce92bb84e6413d5437428dae850" title="strcmpend" alt="" coords="409,56,492,83"/>
<area shape="rect" id="node5" href="util_8c.html#a7c5079074e649dc0369225eca3073f7d" title="tor_mem_is_zero" alt="" coords="389,107,512,133"/>
</map>
</div>

</div>
</div>
<a id="a91a3f7e13f15a365d83bcb418daaaf7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91a3f7e13f15a365d83bcb418daaaf7d">&#9670;&nbsp;</a></span>ed25519_seckey_write_to_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_seckey_write_to_file </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>seckey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Store seckey unencrypted to <b>filename</b>, marking it with <b>tag</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a91a3f7e13f15a365d83bcb418daaaf7d_cgraph.png" border="0" usemap="#crypto__ed25519_8c_a91a3f7e13f15a365d83bcb418daaaf7d_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a91a3f7e13f15a365d83bcb418daaaf7d_cgraph" id="crypto__ed25519_8c_a91a3f7e13f15a365d83bcb418daaaf7d_cgraph">
<area shape="rect" id="node2" href="crypto__format_8c.html#a58e217ce83721c40e22a70f6f9ca1544" title="crypto_write_tagged\l_contents_to_file" alt="" coords="208,49,347,90"/>
<area shape="rect" id="node3" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="422,5,509,32"/>
<area shape="rect" id="node5" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="415,56,515,83"/>
<area shape="rect" id="node6" href="util_8c.html#ae01530967d53afcfefa8227c98072e83" title="write_chunks_to_file" alt="" coords="395,107,536,133"/>
<area shape="rect" id="node4" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="584,5,679,32"/>
</map>
</div>

</div>
</div>
<a id="ae6166bdc946f83db639c67aa5f44bb35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6166bdc946f83db639c67aa5f44bb35">&#9670;&nbsp;</a></span>ed25519_secret_key_from_seed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_secret_key_from_seed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>seckey_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a 32-byte random seed in <b>seed</b>, expand it into an ed25519 secret key in <b>seckey_out</b>. Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="a49e4d1af4428ee01de5a0d0b409d0459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49e4d1af4428ee01de5a0d0b409d0459">&#9670;&nbsp;</a></span>ed25519_secret_key_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_secret_key_generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>seckey_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>extra_strong</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize a new ed25519 secret key in <b>seckey_out</b>. If <b>extra_strong</b>, take the RNG inputs directly from the operating system. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_cgraph.png" border="0" usemap="#crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_cgraph" id="crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#ae5356daa13494dbcca77324c6a85b9da" title="crypto_strongest_rand" alt="" coords="196,13,347,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_icgraph.png" border="0" usemap="#crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_icgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_icgraph" id="crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_icgraph">
<area shape="rect" id="node2" href="crypto__ed25519_8c.html#a53329d0f576211570b7481ad2a3cac04" title="ed25519_keypair_generate" alt="" coords="196,13,373,39"/>
</map>
</div>

</div>
</div>
<a id="ac524189e9fe43d0040e5be28bdf1c430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac524189e9fe43d0040e5be28bdf1c430">&#9670;&nbsp;</a></span>ed25519_set_impl_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ed25519_set_impl_params </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>use_donna</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Force the Ed25519 implementation to a given one, without sanity checking the output. Used for testing. </p>

</div>
</div>
<a id="a372c6a68ee684f2c73a2dfd89864bd44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a372c6a68ee684f2c73a2dfd89864bd44">&#9670;&nbsp;</a></span>ed25519_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_sign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *&#160;</td>
          <td class="paramname"><em>signature_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>keypair</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>signature_out</b> to a signature of the <b>len</b>-byte message <b>msg</b>, using the secret and public key in <b>keypair</b>.</p>
<p>Return 0 if we successfuly signed the message, otherwise return -1. </p>

</div>
</div>
<a id="a7d11e62a5ade103498362de1d41a9cdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d11e62a5ade103498362de1d41a9cdc">&#9670;&nbsp;</a></span>ed25519_sign_prefixed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_sign_prefixed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *&#160;</td>
          <td class="paramname"><em>signature_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>msg_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prefix_str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>keypair</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Like <a class="el" href="crypto__ed25519_8c.html#a372c6a68ee684f2c73a2dfd89864bd44">ed25519_sign()</a>, but also prefix <b>msg</b> with <b>prefix_str</b> before signing. <b>prefix_str</b> must be a NUL-terminated string. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
