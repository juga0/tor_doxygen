<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/common/crypto_ed25519.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_b7e1585941a202f53e5249c42015d573.html">common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">crypto_ed25519.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Wrapper code for an ed25519 implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;orconfig.h&quot;</code><br />
<code>#include &quot;crypto_curve25519.h&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__digest_8h_source.html">crypto_digest.h</a>&quot;</code><br />
<code>#include &quot;crypto_ed25519.h&quot;</code><br />
<code>#include &quot;crypto_format.h&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__rand_8h_source.html">crypto_rand.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__util_8h_source.html">crypto_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="torlog_8h_source.html">torlog.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util_8h_source.html">util.h</a>&quot;</code><br />
<code>#include &quot;util_format.h&quot;</code><br />
<code>#include &quot;ed25519/ref10/ed25519_ref10.h&quot;</code><br />
<code>#include &quot;ed25519/donna/ed25519_donna_tor.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for crypto_ed25519.c:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2crypto__ed25519_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2crypto__ed25519_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2crypto__ed25519_8c">
<area shape="rect" id="node2" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="565,885,643,912"/>
<area shape="rect" id="node3" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="891,266,1034,293"/>
<area shape="rect" id="node7" href="crypto__digest_8h.html" title="Headers for crypto_digest.c. " alt="" coords="798,355,909,382"/>
<area shape="rect" id="node10" href="util_8h.html" title="Headers for util.c. " alt="" coords="879,512,929,539"/>
<area shape="rect" id="node22" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="1060,184,1185,211"/>
<area shape="rect" id="node23" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1067,109,1181,136"/>
<area shape="rect" id="node24" href="crypto__rand_8h.html" title="Common functions for using (pseudo&#45;)random number generators. " alt="" coords="1464,437,1565,464"/>
<area shape="rect" id="node25" href="crypto__util_8h.html" title="Common functions for cryptographic routines. " alt="" coords="1515,184,1608,211"/>
<area shape="rect" id="node26" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="797,587,862,613"/>
<area shape="rect" id="node27" href="util__format_8h_source.html" title="util_format.h" alt="" coords="1217,736,1311,763"/>
<area shape="rect" id="node28" href="ed25519__ref10_8h_source.html" title="ed25519/ref10/ed25519\l_ref10.h" alt="" coords="1599,259,1756,300"/>
<area shape="rect" id="node29" href="ed25519__donna__tor_8h_source.html" title="ed25519/donna/ed25519\l_donna_tor.h" alt="" coords="1707,348,1869,389"/>
<area shape="rect" id="node4" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="381,811,480,837"/>
<area shape="rect" id="node5" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="1343,811,1406,837"/>
<area shape="rect" id="node20" href="crypto__openssl__mgt_8h_source.html" title="crypto_openssl_mgt.h" alt="" coords="829,437,979,464"/>
<area shape="rect" id="node9" href="container_8h_source.html" title="container.h" alt="" coords="718,437,805,464"/>
<area shape="rect" id="node19" href="siphash_8h_source.html" title="siphash.h" alt="" coords="246,512,325,539"/>
<area shape="rect" id="node11" href="compat_8h_source.html" title="compat.h" alt="" coords="631,661,707,688"/>
<area shape="rect" id="node16" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="1070,736,1141,763"/>
<area shape="rect" id="node18" href="util__bug_8h.html" title="Macros to manage assertions, fatal and non&#45;fatal. " alt="" coords="449,587,527,613"/>
<area shape="rect" id="node13" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="505,811,613,837"/>
<area shape="rect" id="node15" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="867,736,994,763"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structed25519__impl__t.html">ed25519_impl_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a49e4d1af4428ee01de5a0d0b409d0459"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a49e4d1af4428ee01de5a0d0b409d0459">ed25519_secret_key_generate</a> (<a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *seckey_out, int extra_strong)</td></tr>
<tr class="separator:a49e4d1af4428ee01de5a0d0b409d0459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6166bdc946f83db639c67aa5f44bb35"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#ae6166bdc946f83db639c67aa5f44bb35">ed25519_secret_key_from_seed</a> (<a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *seckey_out, const uint8_t *seed)</td></tr>
<tr class="separator:ae6166bdc946f83db639c67aa5f44bb35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a250f7c3af49aabe2d1173325ae0841f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a250f7c3af49aabe2d1173325ae0841f5">ed25519_public_key_generate</a> (<a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey_out, const <a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *seckey)</td></tr>
<tr class="separator:a250f7c3af49aabe2d1173325ae0841f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53329d0f576211570b7481ad2a3cac04"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a53329d0f576211570b7481ad2a3cac04">ed25519_keypair_generate</a> (<a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *keypair_out, int extra_strong)</td></tr>
<tr class="separator:a53329d0f576211570b7481ad2a3cac04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d56281a358363aa105b7032aebc46e4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a1d56281a358363aa105b7032aebc46e4">ed25519_public_key_is_zero</a> (const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey)</td></tr>
<tr class="separator:a1d56281a358363aa105b7032aebc46e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a372c6a68ee684f2c73a2dfd89864bd44"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a372c6a68ee684f2c73a2dfd89864bd44">ed25519_sign</a> (<a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *signature_out, const uint8_t *msg, size_t len, const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *keypair)</td></tr>
<tr class="separator:a372c6a68ee684f2c73a2dfd89864bd44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef90ca0de6825837dd8e741a0f3daf0b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#aef90ca0de6825837dd8e741a0f3daf0b">MOCK_IMPL</a> (int, ed25519_sign_prefixed,(<a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *signature_out, const uint8_t *msg, size_t msg_len, const char *prefix_str, const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *keypair))</td></tr>
<tr class="separator:aef90ca0de6825837dd8e741a0f3daf0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e36b3b43cdc50d24c3d77ed295988fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a1e36b3b43cdc50d24c3d77ed295988fa">MOCK_IMPL</a> (int, ed25519_checksig,(const <a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *signature, const uint8_t *msg, size_t len, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey))</td></tr>
<tr class="separator:a1e36b3b43cdc50d24c3d77ed295988fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a005195c17a15a9b7cc8cf3b82709800e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a005195c17a15a9b7cc8cf3b82709800e">ed25519_checksig_prefixed</a> (const <a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *signature, const uint8_t *msg, size_t msg_len, const char *prefix_str, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey)</td></tr>
<tr class="separator:a005195c17a15a9b7cc8cf3b82709800e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef0f167594e528cb46bf15f8d1a9f339"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#aef0f167594e528cb46bf15f8d1a9f339">MOCK_IMPL</a> (int, ed25519_checksig_batch,(int *okay_out, const <a class="el" href="structed25519__checkable__t.html">ed25519_checkable_t</a> *checkable, int n_checkable))</td></tr>
<tr class="separator:aef0f167594e528cb46bf15f8d1a9f339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb50b5bb9010dfe33e19a08f5cc362da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#abb50b5bb9010dfe33e19a08f5cc362da">ed25519_keypair_from_curve25519_keypair</a> (<a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *out, int *signbit_out, const <a class="el" href="structcurve25519__keypair__t.html">curve25519_keypair_t</a> *inp)</td></tr>
<tr class="separator:abb50b5bb9010dfe33e19a08f5cc362da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c15f72552477f36fca48340e53644e9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a8c15f72552477f36fca48340e53644e9">ed25519_public_key_from_curve25519_public_key</a> (<a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey, const <a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> *pubkey_in, int signbit)</td></tr>
<tr class="separator:a8c15f72552477f36fca48340e53644e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b704dfeb238e199f7d1cf5d6ff8b349"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a5b704dfeb238e199f7d1cf5d6ff8b349">ed25519_keypair_blind</a> (<a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *out, const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *inp, const uint8_t *param)</td></tr>
<tr class="separator:a5b704dfeb238e199f7d1cf5d6ff8b349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93deb0ce2adfc0236be5934191568e66"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a93deb0ce2adfc0236be5934191568e66">ed25519_public_blind</a> (<a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *out, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *inp, const uint8_t *param)</td></tr>
<tr class="separator:a93deb0ce2adfc0236be5934191568e66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91a3f7e13f15a365d83bcb418daaaf7d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a91a3f7e13f15a365d83bcb418daaaf7d">ed25519_seckey_write_to_file</a> (const <a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *seckey, const char *filename, const char *tag)</td></tr>
<tr class="separator:a91a3f7e13f15a365d83bcb418daaaf7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34a8bd7b192871bd1e5b778961ba2efb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a34a8bd7b192871bd1e5b778961ba2efb">ed25519_seckey_read_from_file</a> (<a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *seckey_out, char **tag_out, const char *filename)</td></tr>
<tr class="separator:a34a8bd7b192871bd1e5b778961ba2efb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7619807bfd3a082c5bba11d43f9f63ee"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a7619807bfd3a082c5bba11d43f9f63ee">ed25519_pubkey_write_to_file</a> (const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey, const char *filename, const char *tag)</td></tr>
<tr class="separator:a7619807bfd3a082c5bba11d43f9f63ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa33c6bb447b0042745d6d2938a12dda4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#aa33c6bb447b0042745d6d2938a12dda4">ed25519_pubkey_read_from_file</a> (<a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey_out, char **tag_out, const char *filename)</td></tr>
<tr class="separator:aa33c6bb447b0042745d6d2938a12dda4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3252ebaf6f62d86ba6cc8880d49a7bb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a3252ebaf6f62d86ba6cc8880d49a7bb6">ed25519_keypair_free_</a> (<a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *kp)</td></tr>
<tr class="separator:a3252ebaf6f62d86ba6cc8880d49a7bb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9396211603b40cf70b930b9ef726ed1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#af9396211603b40cf70b930b9ef726ed1">ed25519_pubkey_eq</a> (const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *key1, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *key2)</td></tr>
<tr class="separator:af9396211603b40cf70b930b9ef726ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cb678831fd4973f9b1cd7602961db91"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a0cb678831fd4973f9b1cd7602961db91">ed25519_pubkey_copy</a> (<a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *dest, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *src)</td></tr>
<tr class="separator:a0cb678831fd4973f9b1cd7602961db91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10237dc73d7e65d1175d15e98ed1a6ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a10237dc73d7e65d1175d15e98ed1a6ba">MOCK_IMPL</a> (STATIC int, ed25519_impl_spot_check,(void))</td></tr>
<tr class="separator:a10237dc73d7e65d1175d15e98ed1a6ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac524189e9fe43d0040e5be28bdf1c430"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#ac524189e9fe43d0040e5be28bdf1c430">ed25519_set_impl_params</a> (int use_donna)</td></tr>
<tr class="separator:ac524189e9fe43d0040e5be28bdf1c430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61ab2fd9af857351a18486b7a35572c4"><td class="memItemLeft" align="right" valign="top"><a id="a61ab2fd9af857351a18486b7a35572c4"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ed25519_init</b> (void)</td></tr>
<tr class="separator:a61ab2fd9af857351a18486b7a35572c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2642c8e2e2a057408be149542e7c750c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__ed25519_8c.html#a2642c8e2e2a057408be149542e7c750c">ed25519_validate_pubkey</a> (const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey)</td></tr>
<tr class="separator:a2642c8e2e2a057408be149542e7c750c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Wrapper code for an ed25519 implementation. </p>
<p>Ed25519 is a Schnorr signature on a Twisted Edwards curve, defined by Dan Bernstein. For more information, see <a href="https://ed25519.cr.yp.to/">https://ed25519.cr.yp.to/</a></p>
<p>This module wraps our choice of Ed25519 backend, and provides a few convenience functions for checking and generating signatures. It also provides Tor-specific tools for key blinding and for converting Ed25519 keys to and from the corresponding Curve25519 keys. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a005195c17a15a9b7cc8cf3b82709800e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a005195c17a15a9b7cc8cf3b82709800e">&#9670;&nbsp;</a></span>ed25519_checksig_prefixed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_checksig_prefixed </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>msg_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prefix_str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Like ed2519_checksig(), but also prefix <b>msg</b> with <b>prefix_str</b> before verifying signature. <b>prefix_str</b> must be a NUL-terminated string. </p>

</div>
</div>
<a id="a5b704dfeb238e199f7d1cf5d6ff8b349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b704dfeb238e199f7d1cf5d6ff8b349">&#9670;&nbsp;</a></span>ed25519_keypair_blind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_keypair_blind </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given an ed25519 keypair in <b>inp</b>, generate a corresponding ed25519 keypair in <b>out</b>, blinded by the corresponding 32-byte input in 'param'.</p>
<p>Tor uses key blinding for the "next-generation" hidden services design: service descriptors are encrypted with a key derived from the service's long-term public key, and then signed with (and stored at a position indexed by) a short-term key derived by blinding the long-term keys.</p>
<p>Return 0 if blinding was successful, else return -1. </p>

</div>
</div>
<a id="a3252ebaf6f62d86ba6cc8880d49a7bb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3252ebaf6f62d86ba6cc8880d49a7bb6">&#9670;&nbsp;</a></span>ed25519_keypair_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ed25519_keypair_free_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>kp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all storage held for <b>kp</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a3252ebaf6f62d86ba6cc8880d49a7bb6_cgraph.png" border="0" usemap="#crypto__ed25519_8c_a3252ebaf6f62d86ba6cc8880d49a7bb6_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a3252ebaf6f62d86ba6cc8880d49a7bb6_cgraph" id="crypto__ed25519_8c_a3252ebaf6f62d86ba6cc8880d49a7bb6_cgraph">
<area shape="rect" id="node2" href="crypto__util_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="209,5,288,32"/>
</map>
</div>

</div>
</div>
<a id="abb50b5bb9010dfe33e19a08f5cc362da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb50b5bb9010dfe33e19a08f5cc362da">&#9670;&nbsp;</a></span>ed25519_keypair_from_curve25519_keypair()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_keypair_from_curve25519_keypair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>signbit_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcurve25519__keypair__t.html">curve25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>inp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a curve25519 keypair in <b>inp</b>, generate a corresponding ed25519 keypair in <b>out</b>, and set <b>signbit_out</b> to the sign bit of the X coordinate of the ed25519 key.</p>
<p>NOTE THAT IT IS PROBABLY NOT SAFE TO USE THE GENERATED KEY FOR ANYTHING OUTSIDE OF WHAT'S PRESENTED IN PROPOSAL 228. In particular, it's probably not a great idea to use it to sign attacker-supplied anything. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_cgraph.png" border="0" usemap="#crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_cgraph" id="crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_cgraph">
<area shape="rect" id="node2" href="crypto__digest_8c.html#aff99a8b3d871957cbefb2d9bfa116d1f" title="crypto_digest512_new" alt="" coords="207,13,359,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_icgraph.png" border="0" usemap="#crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_icgraph" alt=""/></div>
<map name="crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_icgraph" id="crypto__ed25519_8c_abb50b5bb9010dfe33e19a08f5cc362da_icgraph">
<area shape="rect" id="node2" href="routerkeys_8c.html#ac1142499a3f0ac31e764484c1c6bd6c6" title="make_ntor_onion_key\l_crosscert" alt="" coords="207,5,356,47"/>
</map>
</div>

</div>
</div>
<a id="a53329d0f576211570b7481ad2a3cac04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53329d0f576211570b7481ad2a3cac04">&#9670;&nbsp;</a></span>ed25519_keypair_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_keypair_generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>keypair_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>extra_strong</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate a new ed25519 keypair in <b>keypair_out</b>. If <b>extra_strong</b> is set, try to mix some system entropy into the key generation process. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a53329d0f576211570b7481ad2a3cac04_cgraph.png" border="0" usemap="#crypto__ed25519_8c_a53329d0f576211570b7481ad2a3cac04_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a53329d0f576211570b7481ad2a3cac04_cgraph" id="crypto__ed25519_8c_a53329d0f576211570b7481ad2a3cac04_cgraph">
<area shape="rect" id="node2" href="crypto__ed25519_8c.html#a49e4d1af4428ee01de5a0d0b409d0459" title="ed25519_secret_key\l_generate" alt="" coords="231,5,373,47"/>
<area shape="rect" id="node4" href="crypto__ed25519_8c.html#a250f7c3af49aabe2d1173325ae0841f5" title="ed25519_public_key\l_generate" alt="" coords="232,71,372,112"/>
<area shape="rect" id="node3" href="crypto__rand_8c.html#ae5356daa13494dbcca77324c6a85b9da" title="crypto_strongest_rand" alt="" coords="421,13,572,39"/>
</map>
</div>

</div>
</div>
<a id="a0cb678831fd4973f9b1cd7602961db91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cb678831fd4973f9b1cd7602961db91">&#9670;&nbsp;</a></span>ed25519_pubkey_copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ed25519_pubkey_copy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>dest</b> to contain the same key as <b>src</b>. </p>

</div>
</div>
<a id="af9396211603b40cf70b930b9ef726ed1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9396211603b40cf70b930b9ef726ed1">&#9670;&nbsp;</a></span>ed25519_pubkey_eq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_pubkey_eq </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>key1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>key2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff <b>key1</b> and <b>key2</b> are the same public key. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_af9396211603b40cf70b930b9ef726ed1_cgraph.png" border="0" usemap="#crypto__ed25519_8c_af9396211603b40cf70b930b9ef726ed1_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_af9396211603b40cf70b930b9ef726ed1_cgraph" id="crypto__ed25519_8c_af9396211603b40cf70b930b9ef726ed1_cgraph">
<area shape="rect" id="node2" href="di__ops_8c.html#a473334ee93cca0aea10523321a444ea3" title="tor_memeq" alt="" coords="195,5,281,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_af9396211603b40cf70b930b9ef726ed1_icgraph.png" border="0" usemap="#crypto__ed25519_8c_af9396211603b40cf70b930b9ef726ed1_icgraph" alt=""/></div>
<map name="crypto__ed25519_8c_af9396211603b40cf70b930b9ef726ed1_icgraph" id="crypto__ed25519_8c_af9396211603b40cf70b930b9ef726ed1_icgraph">
<area shape="rect" id="node2" href="dirserv_8h.html#a2b981b610d4a3344b17a55300072ef66" title="dirserv_orconn_tls_done" alt="" coords="203,5,366,32"/>
<area shape="rect" id="node3" href="nodelist_8h.html#a9a536b832b4e1fab98d98efed737ffff" title="node_ed25519_id_matches" alt="" coords="195,56,375,83"/>
<area shape="rect" id="node4" href="routerkeys_8c.html#a32baa1ac0f83ced1415a21b99e3ba47a" title="router_ed25519_id_is_me" alt="" coords="199,107,370,133"/>
</map>
</div>

</div>
</div>
<a id="aa33c6bb447b0042745d6d2938a12dda4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa33c6bb447b0042745d6d2938a12dda4">&#9670;&nbsp;</a></span>ed25519_pubkey_read_from_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_pubkey_read_from_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>tag_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Store pubkey unencrypted to <b>filename</b>, marking it with <b>tag</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_aa33c6bb447b0042745d6d2938a12dda4_cgraph.png" border="0" usemap="#crypto__ed25519_8c_aa33c6bb447b0042745d6d2938a12dda4_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_aa33c6bb447b0042745d6d2938a12dda4_cgraph" id="crypto__ed25519_8c_aa33c6bb447b0042745d6d2938a12dda4_cgraph">
<area shape="rect" id="node2" href="crypto__format_8c.html#a40e1ed638568c15cac66b16cf427b4e7" title="crypto_read_tagged\l_contents_from_file" alt="" coords="205,49,341,90"/>
<area shape="rect" id="node3" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="407,5,495,32"/>
<area shape="rect" id="node4" href="util_8c.html#a28445ce92bb84e6413d5437428dae850" title="strcmpend" alt="" coords="409,56,492,83"/>
<area shape="rect" id="node5" href="util_8c.html#a7c5079074e649dc0369225eca3073f7d" title="tor_mem_is_zero" alt="" coords="389,107,512,133"/>
</map>
</div>

</div>
</div>
<a id="a7619807bfd3a082c5bba11d43f9f63ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7619807bfd3a082c5bba11d43f9f63ee">&#9670;&nbsp;</a></span>ed25519_pubkey_write_to_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_pubkey_write_to_file </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Store pubkey unencrypted to <b>filename</b>, marking it with <b>tag</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a7619807bfd3a082c5bba11d43f9f63ee_cgraph.png" border="0" usemap="#crypto__ed25519_8c_a7619807bfd3a082c5bba11d43f9f63ee_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a7619807bfd3a082c5bba11d43f9f63ee_cgraph" id="crypto__ed25519_8c_a7619807bfd3a082c5bba11d43f9f63ee_cgraph">
<area shape="rect" id="node2" href="crypto__format_8c.html#a58e217ce83721c40e22a70f6f9ca1544" title="crypto_write_tagged\l_contents_to_file" alt="" coords="208,49,347,90"/>
<area shape="rect" id="node3" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="422,5,509,32"/>
<area shape="rect" id="node5" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="415,56,515,83"/>
<area shape="rect" id="node6" href="util_8c.html#ae01530967d53afcfefa8227c98072e83" title="write_chunks_to_file" alt="" coords="395,107,536,133"/>
<area shape="rect" id="node4" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="584,5,679,32"/>
</map>
</div>

</div>
</div>
<a id="a93deb0ce2adfc0236be5934191568e66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93deb0ce2adfc0236be5934191568e66">&#9670;&nbsp;</a></span>ed25519_public_blind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_public_blind </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given an ed25519 public key in <b>inp</b>, generate a corresponding blinded public key in <b>out</b>, blinded with the 32-byte parameter in <b>param</b>. Return 0 on success, -1 on railure. </p>

</div>
</div>
<a id="a8c15f72552477f36fca48340e53644e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c15f72552477f36fca48340e53644e9">&#9670;&nbsp;</a></span>ed25519_public_key_from_curve25519_public_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_public_key_from_curve25519_public_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcurve25519__public__key__t.html">curve25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>signbit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a curve25519 public key and sign bit of X coordinate of the ed25519 public key, generate the corresponding ed25519 public key. </p>

</div>
</div>
<a id="a250f7c3af49aabe2d1173325ae0841f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a250f7c3af49aabe2d1173325ae0841f5">&#9670;&nbsp;</a></span>ed25519_public_key_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_public_key_generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>seckey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a secret key in <b>seckey</b>, expand it into an ed25519 public key. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a250f7c3af49aabe2d1173325ae0841f5_icgraph.png" border="0" usemap="#crypto__ed25519_8c_a250f7c3af49aabe2d1173325ae0841f5_icgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a250f7c3af49aabe2d1173325ae0841f5_icgraph" id="crypto__ed25519_8c_a250f7c3af49aabe2d1173325ae0841f5_icgraph">
<area shape="rect" id="node2" href="crypto__ed25519_8c.html#a53329d0f576211570b7481ad2a3cac04" title="ed25519_keypair_generate" alt="" coords="193,13,371,39"/>
</map>
</div>

</div>
</div>
<a id="a1d56281a358363aa105b7032aebc46e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d56281a358363aa105b7032aebc46e4">&#9670;&nbsp;</a></span>ed25519_public_key_is_zero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_public_key_is_zero </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff 'pubkey' is set to zero (eg to indicate that it is not set). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a1d56281a358363aa105b7032aebc46e4_cgraph.png" border="0" usemap="#crypto__ed25519_8c_a1d56281a358363aa105b7032aebc46e4_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a1d56281a358363aa105b7032aebc46e4_cgraph" id="crypto__ed25519_8c_a1d56281a358363aa105b7032aebc46e4_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a7c5079074e649dc0369225eca3073f7d" title="tor_mem_is_zero" alt="" coords="193,13,316,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a1d56281a358363aa105b7032aebc46e4_icgraph.png" border="0" usemap="#crypto__ed25519_8c_a1d56281a358363aa105b7032aebc46e4_icgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a1d56281a358363aa105b7032aebc46e4_icgraph" id="crypto__ed25519_8c_a1d56281a358363aa105b7032aebc46e4_icgraph">
<area shape="rect" id="node2" href="crypto__format_8c.html#a410a5ce7823282053a68132d17e82fe5" title="ed25519_fmt" alt="" coords="235,5,332,32"/>
<area shape="rect" id="node3" href="bridges_8h.html#a362a2f2ca9c3d9f5956010fa079e1a6d" title="learned_router_identity" alt="" coords="207,56,360,83"/>
<area shape="rect" id="node4" href="connection__or_8h.html#a25311bc6d11b48d5f281528453c53ab0" title="connection_or_client\l_learned_peer_id" alt="" coords="213,107,354,149"/>
<area shape="rect" id="node5" href="dirserv_8h.html#a2b981b610d4a3344b17a55300072ef66" title="dirserv_orconn_tls_done" alt="" coords="202,173,365,200"/>
<area shape="rect" id="node6" href="nodelist_8h.html#a9a536b832b4e1fab98d98efed737ffff" title="node_ed25519_id_matches" alt="" coords="193,224,373,251"/>
</map>
</div>

</div>
</div>
<a id="a34a8bd7b192871bd1e5b778961ba2efb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34a8bd7b192871bd1e5b778961ba2efb">&#9670;&nbsp;</a></span>ed25519_seckey_read_from_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_seckey_read_from_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>seckey_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>tag_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read seckey unencrypted from <b>filename</b>, storing it into <b>seckey_out</b>. Set *<b>tag_out</b> to the tag it was marked with. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a34a8bd7b192871bd1e5b778961ba2efb_cgraph.png" border="0" usemap="#crypto__ed25519_8c_a34a8bd7b192871bd1e5b778961ba2efb_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a34a8bd7b192871bd1e5b778961ba2efb_cgraph" id="crypto__ed25519_8c_a34a8bd7b192871bd1e5b778961ba2efb_cgraph">
<area shape="rect" id="node2" href="crypto__format_8c.html#a40e1ed638568c15cac66b16cf427b4e7" title="crypto_read_tagged\l_contents_from_file" alt="" coords="205,49,341,90"/>
<area shape="rect" id="node3" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="407,5,495,32"/>
<area shape="rect" id="node4" href="util_8c.html#a28445ce92bb84e6413d5437428dae850" title="strcmpend" alt="" coords="409,56,492,83"/>
<area shape="rect" id="node5" href="util_8c.html#a7c5079074e649dc0369225eca3073f7d" title="tor_mem_is_zero" alt="" coords="389,107,512,133"/>
</map>
</div>

</div>
</div>
<a id="a91a3f7e13f15a365d83bcb418daaaf7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91a3f7e13f15a365d83bcb418daaaf7d">&#9670;&nbsp;</a></span>ed25519_seckey_write_to_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_seckey_write_to_file </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>seckey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Store seckey unencrypted to <b>filename</b>, marking it with <b>tag</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a91a3f7e13f15a365d83bcb418daaaf7d_cgraph.png" border="0" usemap="#crypto__ed25519_8c_a91a3f7e13f15a365d83bcb418daaaf7d_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a91a3f7e13f15a365d83bcb418daaaf7d_cgraph" id="crypto__ed25519_8c_a91a3f7e13f15a365d83bcb418daaaf7d_cgraph">
<area shape="rect" id="node2" href="crypto__format_8c.html#a58e217ce83721c40e22a70f6f9ca1544" title="crypto_write_tagged\l_contents_to_file" alt="" coords="208,49,347,90"/>
<area shape="rect" id="node3" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="422,5,509,32"/>
<area shape="rect" id="node5" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="415,56,515,83"/>
<area shape="rect" id="node6" href="util_8c.html#ae01530967d53afcfefa8227c98072e83" title="write_chunks_to_file" alt="" coords="395,107,536,133"/>
<area shape="rect" id="node4" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="584,5,679,32"/>
</map>
</div>

</div>
</div>
<a id="ae6166bdc946f83db639c67aa5f44bb35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6166bdc946f83db639c67aa5f44bb35">&#9670;&nbsp;</a></span>ed25519_secret_key_from_seed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_secret_key_from_seed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>seckey_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a 32-byte random seed in <b>seed</b>, expand it into an ed25519 secret key in <b>seckey_out</b>. Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="a49e4d1af4428ee01de5a0d0b409d0459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49e4d1af4428ee01de5a0d0b409d0459">&#9670;&nbsp;</a></span>ed25519_secret_key_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_secret_key_generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__secret__key__t.html">ed25519_secret_key_t</a> *&#160;</td>
          <td class="paramname"><em>seckey_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>extra_strong</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize a new ed25519 secret key in <b>seckey_out</b>. If <b>extra_strong</b>, take the RNG inputs directly from the operating system. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_cgraph.png" border="0" usemap="#crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_cgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_cgraph" id="crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_cgraph">
<area shape="rect" id="node2" href="crypto__rand_8c.html#ae5356daa13494dbcca77324c6a85b9da" title="crypto_strongest_rand" alt="" coords="196,13,347,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_icgraph.png" border="0" usemap="#crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_icgraph" alt=""/></div>
<map name="crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_icgraph" id="crypto__ed25519_8c_a49e4d1af4428ee01de5a0d0b409d0459_icgraph">
<area shape="rect" id="node2" href="crypto__ed25519_8c.html#a53329d0f576211570b7481ad2a3cac04" title="ed25519_keypair_generate" alt="" coords="196,13,373,39"/>
</map>
</div>

</div>
</div>
<a id="ac524189e9fe43d0040e5be28bdf1c430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac524189e9fe43d0040e5be28bdf1c430">&#9670;&nbsp;</a></span>ed25519_set_impl_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ed25519_set_impl_params </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>use_donna</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Force the Ed25519 implementation to a given one, without sanity checking the output. Used for testing. </p>

</div>
</div>
<a id="a372c6a68ee684f2c73a2dfd89864bd44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a372c6a68ee684f2c73a2dfd89864bd44">&#9670;&nbsp;</a></span>ed25519_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_sign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *&#160;</td>
          <td class="paramname"><em>signature_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *&#160;</td>
          <td class="paramname"><em>keypair</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>signature_out</b> to a signature of the <b>len</b>-byte message <b>msg</b>, using the secret and public key in <b>keypair</b>.</p>
<p>Return 0 if we successfully signed the message, otherwise return -1. </p>

</div>
</div>
<a id="a2642c8e2e2a057408be149542e7c750c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2642c8e2e2a057408be149542e7c750c">&#9670;&nbsp;</a></span>ed25519_validate_pubkey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ed25519_validate_pubkey </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *&#160;</td>
          <td class="paramname"><em>pubkey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Validate <b>pubkey</b> to ensure that it has no torsion component. Return 0 if <b>pubkey</b> is valid, else return -1. </p>

</div>
</div>
<a id="aef90ca0de6825837dd8e741a0f3daf0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef90ca0de6825837dd8e741a0f3daf0b">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ed25519_sign_prefixed&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(<a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *signature_out, const uint8_t *msg, size_t msg_len, const char *prefix_str, const <a class="el" href="structed25519__keypair__t.html">ed25519_keypair_t</a> *keypair)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Like <a class="el" href="crypto__ed25519_8c.html#a372c6a68ee684f2c73a2dfd89864bd44">ed25519_sign()</a>, but also prefix <b>msg</b> with <b>prefix_str</b> before signing. <b>prefix_str</b> must be a NUL-terminated string. </p>

</div>
</div>
<a id="a1e36b3b43cdc50d24c3d77ed295988fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e36b3b43cdc50d24c3d77ed295988fa">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ed25519_checksig&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(const <a class="el" href="structed25519__signature__t.html">ed25519_signature_t</a> *signature, const uint8_t *msg, size_t len, const <a class="el" href="structed25519__public__key__t.html">ed25519_public_key_t</a> *pubkey)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether if <b>signature</b> is a valid signature for the <b>len</b>-byte message in <b>msg</b> made with the key <b>pubkey</b>.</p>
<p>Return 0 if the signature is valid; -1 if it isn't. </p>

</div>
</div>
<a id="aef0f167594e528cb46bf15f8d1a9f339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef0f167594e528cb46bf15f8d1a9f339">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ed25519_checksig_batch&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(int *okay_out, const <a class="el" href="structed25519__checkable__t.html">ed25519_checkable_t</a> *checkable, int n_checkable)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Validate every signature among those in <b>checkable</b>, which contains exactly <b>n_checkable</b> elements. If <b>okay_out</b> is non-NULL, set the i'th element of <b>okay_out</b> to 1 if the i'th element of <b>checkable</b> is valid, and to 0 otherwise. Return 0 if every signature was valid. Otherwise return -N, where N is the number of invalid signatures. </p>

</div>
</div>
<a id="a10237dc73d7e65d1175d15e98ed1a6ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10237dc73d7e65d1175d15e98ed1a6ba">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC&#160;</td>
          <td class="paramname"><em>int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ed25519_impl_spot_check&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(void)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether the given Ed25519 implementation seems to be working. If so, return 0; otherwise return -1. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
