<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/circuitstats.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">circuitstats.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="circuitstats_8c.html" title="Maintains and analyzes statistics about circuit built times, so we can tell how long we may need to w...">circuitstats.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h__dep__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2circuitstats_8hdep" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2circuitstats_8hdep" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2circuitstats_8hdep">
<area shape="rect" id="node2" href="channel_8c.html" title="OR/OP&#45;to&#45;OR channel abstraction layer. A channel&#39;s job is to transfer cells from Tor instance to Tor ..." alt="" coords="5,109,153,165"/>
<area shape="rect" id="node3" href="circpathbias_8c.html" title="Code to track success/failure rates of circuits built through different tor nodes, in an attempt to detect attacks where an attacker deliberately causes circuits to fail until the client choses a path they like. " alt="" coords="177,109,325,165"/>
<area shape="rect" id="node4" href="circuitbuild_8c.html" title="Implements the details of building circuits (by chosing paths, constructing/sending create/extend cel..." alt="" coords="349,109,497,165"/>
<area shape="rect" id="node5" href="circuitlist_8c.html" title="Manage global structures that list and index circuits, and look up circuits within them..." alt="" coords="521,109,669,165"/>
<area shape="rect" id="node6" href="circuitstats_8c.html" title="Maintains and analyzes statistics about circuit built times, so we can tell how long we may need to w..." alt="" coords="693,109,841,165"/>
<area shape="rect" id="node7" href="circuituse_8c.html" title="Launch the right sort of circuits and attach the right streams to them. " alt="" coords="865,109,1013,165"/>
<area shape="rect" id="node8" href="config_8c.html" title="Code to interpret the user&#39;s configuration of Tor. " alt="" coords="1037,109,1185,165"/>
<area shape="rect" id="node9" href="connection__or_8c.html" title="Functions to handle OR connections, TLS handshaking, and cells on the network. " alt="" coords="1210,109,1365,165"/>
<area shape="rect" id="node10" href="control_8c.html" title="Implementation for Tor&#39;s control&#45;socket interface. " alt="" coords="1389,109,1537,165"/>
<area shape="rect" id="node11" href="entrynodes_8c.html" title="Code to manage our fixed first nodes for various functions. " alt="" coords="1561,109,1709,165"/>
<area shape="rect" id="node12" href="networkstatus_8c.html" title="Functions and structures for handling networkstatus documents as a client or as a directory cache..." alt="" coords="1733,109,1889,165"/>
<area shape="rect" id="node13" href="routerlist_8c.html" title="Code to maintain and access the global list of routerinfos for known servers. " alt="" coords="1913,109,2061,165"/>
<area shape="rect" id="node14" href="routerparse_8c.html" title="Code to parse and validate router descriptors, consenus directories, and similar objects. " alt="" coords="2085,109,2233,165"/>
<area shape="rect" id="node15" href="statefile_8c.html" title="Handles parsing and encoding the persistent &#39;state&#39; file that carries miscellaneous persistent state ..." alt="" coords="2257,109,2405,165"/>
</map>
</div>
</div>
<p><a href="circuitstats_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a60132df70f749a68de14d2993d593787"><td class="memItemLeft" align="right" valign="top">const circuit_build_times_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a60132df70f749a68de14d2993d593787">get_circuit_build_times</a> (void)</td></tr>
<tr class="separator:a60132df70f749a68de14d2993d593787"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6607aa51a9503278d8f893f8092aabc"><td class="memItemLeft" align="right" valign="top">circuit_build_times_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#ab6607aa51a9503278d8f893f8092aabc">get_circuit_build_times_mutable</a> (void)</td></tr>
<tr class="separator:ab6607aa51a9503278d8f893f8092aabc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a612d7d345a4328b8dd4d1079fb0bc9b2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a612d7d345a4328b8dd4d1079fb0bc9b2">get_circuit_build_close_time_ms</a> (void)</td></tr>
<tr class="separator:a612d7d345a4328b8dd4d1079fb0bc9b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33097eebbc8865c466107e5588f357ec"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a33097eebbc8865c466107e5588f357ec">get_circuit_build_timeout_ms</a> (void)</td></tr>
<tr class="separator:a33097eebbc8865c466107e5588f357ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1b73e0bb66fa432389a7cc95a62bb21"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#ab1b73e0bb66fa432389a7cc95a62bb21">circuit_build_times_disabled</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:ab1b73e0bb66fa432389a7cc95a62bb21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a556d4f3e3d78886de05662aaf08f3c3f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a556d4f3e3d78886de05662aaf08f3c3f">circuit_build_times_disabled_</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options, int ignore_consensus)</td></tr>
<tr class="separator:a556d4f3e3d78886de05662aaf08f3c3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3e86bd1570419757d3e1cdc577395a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#aa3e86bd1570419757d3e1cdc577395a3">circuit_build_times_enough_to_compute</a> (const circuit_build_times_t *cbt)</td></tr>
<tr class="separator:aa3e86bd1570419757d3e1cdc577395a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cd11af3008cdeec3065dee7bed4cc88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a6cd11af3008cdeec3065dee7bed4cc88">circuit_build_times_update_state</a> (const circuit_build_times_t *cbt, <a class="el" href="structor__state__t.html">or_state_t</a> *state)</td></tr>
<tr class="separator:a6cd11af3008cdeec3065dee7bed4cc88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3698f5cf00759e40798b2dcb4097976c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a3698f5cf00759e40798b2dcb4097976c">circuit_build_times_parse_state</a> (circuit_build_times_t *cbt, <a class="el" href="structor__state__t.html">or_state_t</a> *state)</td></tr>
<tr class="separator:a3698f5cf00759e40798b2dcb4097976c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b7fc99dce125bfe7037769c7f300ed1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a5b7fc99dce125bfe7037769c7f300ed1">circuit_build_times_count_timeout</a> (circuit_build_times_t *cbt, int did_onehop)</td></tr>
<tr class="separator:a5b7fc99dce125bfe7037769c7f300ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae7a1d37f778a6e4e25443ec8a9b2c45"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#aae7a1d37f778a6e4e25443ec8a9b2c45">circuit_build_times_count_close</a> (circuit_build_times_t *cbt, int did_onehop, time_t start_time)</td></tr>
<tr class="separator:aae7a1d37f778a6e4e25443ec8a9b2c45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a321ec5d0efe5196955be8140397bba91"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a321ec5d0efe5196955be8140397bba91">circuit_build_times_set_timeout</a> (circuit_build_times_t *cbt)</td></tr>
<tr class="separator:a321ec5d0efe5196955be8140397bba91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a814d1a241f8835fa36625ee0a650733b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a814d1a241f8835fa36625ee0a650733b">circuit_build_times_add_time</a> (circuit_build_times_t *cbt, <a class="el" href="or_8h.html#a45411da7d117ffaaf83b8fe4d4274bb8">build_time_t</a> time)</td></tr>
<tr class="separator:a814d1a241f8835fa36625ee0a650733b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af926b84dc328f71fcccdaa4df5e418b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#af926b84dc328f71fcccdaa4df5e418b5">circuit_build_times_needs_circuits</a> (const circuit_build_times_t *cbt)</td></tr>
<tr class="separator:af926b84dc328f71fcccdaa4df5e418b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a306615a489277731398dbd19065f7b2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a306615a489277731398dbd19065f7b2b">circuit_build_times_handle_completed_hop</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:a306615a489277731398dbd19065f7b2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a078e35bc3a938238e3eac4eb29a076ce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a078e35bc3a938238e3eac4eb29a076ce">circuit_build_times_needs_circuits_now</a> (const circuit_build_times_t *cbt)</td></tr>
<tr class="separator:a078e35bc3a938238e3eac4eb29a076ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a783722d9622ae552e3f3d117163dd67a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a783722d9622ae552e3f3d117163dd67a">circuit_build_times_init</a> (circuit_build_times_t *cbt)</td></tr>
<tr class="separator:a783722d9622ae552e3f3d117163dd67a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12b65f2272f5751108d7eaa1554ab830"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a12b65f2272f5751108d7eaa1554ab830">circuit_build_times_free_timeouts</a> (circuit_build_times_t *cbt)</td></tr>
<tr class="separator:a12b65f2272f5751108d7eaa1554ab830"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbfb286d45e72331adbc9eea6f92a30a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#afbfb286d45e72331adbc9eea6f92a30a">circuit_build_times_new_consensus_params</a> (circuit_build_times_t *cbt, <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *ns)</td></tr>
<tr class="separator:afbfb286d45e72331adbc9eea6f92a30a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a685329d97770111282850e80b499d864"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a685329d97770111282850e80b499d864">circuit_build_times_timeout_rate</a> (const circuit_build_times_t *cbt)</td></tr>
<tr class="separator:a685329d97770111282850e80b499d864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af87293fa8cf6ca85a97c8d9202bda698"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#af87293fa8cf6ca85a97c8d9202bda698">circuit_build_times_close_rate</a> (const circuit_build_times_t *cbt)</td></tr>
<tr class="separator:af87293fa8cf6ca85a97c8d9202bda698"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedc5c23b75049ef442f574713c61bc7d"><td class="memItemLeft" align="right" valign="top"><a id="aedc5c23b75049ef442f574713c61bc7d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>circuit_build_times_update_last_circ</b> (circuit_build_times_t *cbt)</td></tr>
<tr class="separator:aedc5c23b75049ef442f574713c61bc7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73e9aaecc9e72307e2483feeaed4c448"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a73e9aaecc9e72307e2483feeaed4c448">circuit_build_times_mark_circ_as_measurement_only</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:a73e9aaecc9e72307e2483feeaed4c448"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b95a37e26723de09e38d46549c9fba0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a2b95a37e26723de09e38d46549c9fba0">circuit_build_times_network_is_live</a> (circuit_build_times_t *cbt)</td></tr>
<tr class="separator:a2b95a37e26723de09e38d46549c9fba0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c0ef1a1c2f4ee597394a8dc694e8e21"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a3c0ef1a1c2f4ee597394a8dc694e8e21">circuit_build_times_network_check_live</a> (const circuit_build_times_t *cbt)</td></tr>
<tr class="separator:a3c0ef1a1c2f4ee597394a8dc694e8e21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c61cd815e5afe00297676109450aa6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuitstats_8h.html#a9c61cd815e5afe00297676109450aa6d">circuit_build_times_network_circ_success</a> (circuit_build_times_t *cbt)</td></tr>
<tr class="separator:a9c61cd815e5afe00297676109450aa6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="circuitstats_8c.html" title="Maintains and analyzes statistics about circuit built times, so we can tell how long we may need to w...">circuitstats.c</a>. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a814d1a241f8835fa36625ee0a650733b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a814d1a241f8835fa36625ee0a650733b">&#9670;&nbsp;</a></span>circuit_build_times_add_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_build_times_add_time </td>
          <td>(</td>
          <td class="paramtype">circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a45411da7d117ffaaf83b8fe4d4274bb8">build_time_t</a>&#160;</td>
          <td class="paramname"><em>btime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a new build time value <b>time</b> to the set of build times. Time units are milliseconds.</p>
<p>circuit_build_times <b>cbt</b> is a circular array, so loop around when array is full. </p>

</div>
</div>
<a id="af87293fa8cf6ca85a97c8d9202bda698"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af87293fa8cf6ca85a97c8d9202bda698">&#9670;&nbsp;</a></span>circuit_build_times_close_rate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double circuit_build_times_close_rate </td>
          <td>(</td>
          <td class="paramtype">const circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Count the number of closed circuits in a set of cbt data. </p>

</div>
</div>
<a id="aae7a1d37f778a6e4e25443ec8a9b2c45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae7a1d37f778a6e4e25443ec8a9b2c45">&#9670;&nbsp;</a></span>circuit_build_times_count_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_build_times_count_close </td>
          <td>(</td>
          <td class="paramtype">circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>did_onehop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>start_time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Store a timeout as a synthetic value.</p>
<p>Returns true if the store was successful and we should possibly update our timeout estimate. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_aae7a1d37f778a6e4e25443ec8a9b2c45_cgraph.png" border="0" usemap="#circuitstats_8h_aae7a1d37f778a6e4e25443ec8a9b2c45_cgraph" alt=""/></div>
<map name="circuitstats_8h_aae7a1d37f778a6e4e25443ec8a9b2c45_cgraph" id="circuitstats_8h_aae7a1d37f778a6e4e25443ec8a9b2c45_cgraph">
<area shape="rect" id="node2" href="circuitstats_8c.html#ab1b73e0bb66fa432389a7cc95a62bb21" title="circuit_build_times\l_disabled" alt="" coords="184,5,315,47"/>
<area shape="rect" id="node3" href="circuitstats_8c.html#a556d4f3e3d78886de05662aaf08f3c3f" title="circuit_build_times\l_disabled_" alt="" coords="363,5,493,47"/>
</map>
</div>

</div>
</div>
<a id="a5b7fc99dce125bfe7037769c7f300ed1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b7fc99dce125bfe7037769c7f300ed1">&#9670;&nbsp;</a></span>circuit_build_times_count_timeout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_build_times_count_timeout </td>
          <td>(</td>
          <td class="paramtype">circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>did_onehop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update timeout counts to determine if we need to expire our build time history due to excessive timeouts.</p>
<p>We do not record any actual time values at this stage; we are only interested in recording the fact that a timeout happened. We record the time values via <a class="el" href="circuitstats_8c.html#aae7a1d37f778a6e4e25443ec8a9b2c45">circuit_build_times_count_close()</a> and <a class="el" href="circuitstats_8c.html#ade5765738bf2517d207fc123305b54e0">circuit_build_times_add_time()</a>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_a5b7fc99dce125bfe7037769c7f300ed1_cgraph.png" border="0" usemap="#circuitstats_8h_a5b7fc99dce125bfe7037769c7f300ed1_cgraph" alt=""/></div>
<map name="circuitstats_8h_a5b7fc99dce125bfe7037769c7f300ed1_cgraph" id="circuitstats_8h_a5b7fc99dce125bfe7037769c7f300ed1_cgraph">
<area shape="rect" id="node2" href="circuitstats_8c.html#ab1b73e0bb66fa432389a7cc95a62bb21" title="circuit_build_times\l_disabled" alt="" coords="184,5,315,47"/>
<area shape="rect" id="node3" href="circuitstats_8c.html#a556d4f3e3d78886de05662aaf08f3c3f" title="circuit_build_times\l_disabled_" alt="" coords="363,5,493,47"/>
</map>
</div>

</div>
</div>
<a id="ab1b73e0bb66fa432389a7cc95a62bb21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1b73e0bb66fa432389a7cc95a62bb21">&#9670;&nbsp;</a></span>circuit_build_times_disabled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_build_times_disabled </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function decides if CBT learning should be disabled. It returns true if one or more of the following conditions are met:</p>
<ol type="1">
<li>If the cbtdisabled consensus parameter is set.</li>
<li>If the torrc option LearnCircuitBuildTimeout is false.</li>
<li>If we are a directory authority</li>
<li>If we fail to write circuit build time history to our state file.</li>
<li>If we are compiled or configured in Tor2web mode</li>
<li>If we are configured in Single Onion mode </li>
</ol>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_ab1b73e0bb66fa432389a7cc95a62bb21_cgraph.png" border="0" usemap="#circuitstats_8h_ab1b73e0bb66fa432389a7cc95a62bb21_cgraph" alt=""/></div>
<map name="circuitstats_8h_ab1b73e0bb66fa432389a7cc95a62bb21_cgraph" id="circuitstats_8h_ab1b73e0bb66fa432389a7cc95a62bb21_cgraph">
<area shape="rect" id="node2" href="circuitstats_8c.html#a556d4f3e3d78886de05662aaf08f3c3f" title="circuit_build_times\l_disabled_" alt="" coords="184,5,315,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_ab1b73e0bb66fa432389a7cc95a62bb21_icgraph.png" border="0" usemap="#circuitstats_8h_ab1b73e0bb66fa432389a7cc95a62bb21_icgraph" alt=""/></div>
<map name="circuitstats_8h_ab1b73e0bb66fa432389a7cc95a62bb21_icgraph" id="circuitstats_8h_ab1b73e0bb66fa432389a7cc95a62bb21_icgraph">
<area shape="rect" id="node2" href="circuitstats_8h.html#afbfb286d45e72331adbc9eea6f92a30a" title="circuit_build_times\l_new_consensus_params" alt="" coords="184,5,357,47"/>
<area shape="rect" id="node3" href="circuitstats_8h.html#a783722d9622ae552e3f3d117163dd67a" title="circuit_build_times_init" alt="" coords="193,71,348,98"/>
<area shape="rect" id="node4" href="circuitstats_8h.html#a3698f5cf00759e40798b2dcb4097976c" title="circuit_build_times\l_parse_state" alt="" coords="405,89,536,131"/>
<area shape="rect" id="node5" href="circuitstats_8h.html#a306615a489277731398dbd19065f7b2b" title="circuit_build_times\l_handle_completed_hop" alt="" coords="189,173,352,215"/>
<area shape="rect" id="node6" href="circuitstats_8h.html#aae7a1d37f778a6e4e25443ec8a9b2c45" title="circuit_build_times\l_count_close" alt="" coords="205,239,336,280"/>
<area shape="rect" id="node7" href="circuitstats_8h.html#a5b7fc99dce125bfe7037769c7f300ed1" title="circuit_build_times\l_count_timeout" alt="" coords="205,304,336,345"/>
<area shape="rect" id="node8" href="circuitstats_8h.html#a321ec5d0efe5196955be8140397bba91" title="circuit_build_times\l_set_timeout" alt="" coords="205,369,336,411"/>
</map>
</div>

</div>
</div>
<a id="a556d4f3e3d78886de05662aaf08f3c3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a556d4f3e3d78886de05662aaf08f3c3f">&#9670;&nbsp;</a></span>circuit_build_times_disabled_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_build_times_disabled_ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ignore_consensus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As circuit_build_times_disabled, but take options as an argument. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_a556d4f3e3d78886de05662aaf08f3c3f_icgraph.png" border="0" usemap="#circuitstats_8h_a556d4f3e3d78886de05662aaf08f3c3f_icgraph" alt=""/></div>
<map name="circuitstats_8h_a556d4f3e3d78886de05662aaf08f3c3f_icgraph" id="circuitstats_8h_a556d4f3e3d78886de05662aaf08f3c3f_icgraph">
<area shape="rect" id="node2" href="circuitstats_8h.html#ab1b73e0bb66fa432389a7cc95a62bb21" title="circuit_build_times\l_disabled" alt="" coords="184,173,315,215"/>
<area shape="rect" id="node3" href="circuitstats_8h.html#afbfb286d45e72331adbc9eea6f92a30a" title="circuit_build_times\l_new_consensus_params" alt="" coords="363,5,536,47"/>
<area shape="rect" id="node4" href="circuitstats_8h.html#a783722d9622ae552e3f3d117163dd67a" title="circuit_build_times_init" alt="" coords="372,71,527,98"/>
<area shape="rect" id="node5" href="circuitstats_8h.html#a3698f5cf00759e40798b2dcb4097976c" title="circuit_build_times\l_parse_state" alt="" coords="584,89,715,131"/>
<area shape="rect" id="node6" href="circuitstats_8h.html#a306615a489277731398dbd19065f7b2b" title="circuit_build_times\l_handle_completed_hop" alt="" coords="368,173,531,215"/>
<area shape="rect" id="node7" href="circuitstats_8h.html#aae7a1d37f778a6e4e25443ec8a9b2c45" title="circuit_build_times\l_count_close" alt="" coords="384,239,515,280"/>
<area shape="rect" id="node8" href="circuitstats_8h.html#a5b7fc99dce125bfe7037769c7f300ed1" title="circuit_build_times\l_count_timeout" alt="" coords="384,304,515,345"/>
<area shape="rect" id="node9" href="circuitstats_8h.html#a321ec5d0efe5196955be8140397bba91" title="circuit_build_times\l_set_timeout" alt="" coords="384,369,515,411"/>
</map>
</div>

</div>
</div>
<a id="aa3e86bd1570419757d3e1cdc577395a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3e86bd1570419757d3e1cdc577395a3">&#9670;&nbsp;</a></span>circuit_build_times_enough_to_compute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_build_times_enough_to_compute </td>
          <td>(</td>
          <td class="paramtype">const circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff <b>cbt</b> has recorded enough build times that we want to start acting on the timeout it implies. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_aa3e86bd1570419757d3e1cdc577395a3_icgraph.png" border="0" usemap="#circuitstats_8h_aa3e86bd1570419757d3e1cdc577395a3_icgraph" alt=""/></div>
<map name="circuitstats_8h_aa3e86bd1570419757d3e1cdc577395a3_icgraph" id="circuitstats_8h_aa3e86bd1570419757d3e1cdc577395a3_icgraph">
<area shape="rect" id="node2" href="circuitstats_8h.html#af926b84dc328f71fcccdaa4df5e418b5" title="circuit_build_times\l_needs_circuits" alt="" coords="200,5,331,47"/>
<area shape="rect" id="node3" href="circuitstats_8h.html#a078e35bc3a938238e3eac4eb29a076ce" title="circuit_build_times\l_needs_circuits_now" alt="" coords="379,5,523,47"/>
</map>
</div>

</div>
</div>
<a id="a12b65f2272f5751108d7eaa1554ab830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12b65f2272f5751108d7eaa1554ab830">&#9670;&nbsp;</a></span>circuit_build_times_free_timeouts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_build_times_free_timeouts </td>
          <td>(</td>
          <td class="paramtype">circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free the saved timeouts, if the cbtdisabled consensus parameter got turned on or something. </p>

</div>
</div>
<a id="a306615a489277731398dbd19065f7b2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a306615a489277731398dbd19065f7b2b">&#9670;&nbsp;</a></span>circuit_build_times_handle_completed_hop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_build_times_handle_completed_hop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform the build time work that needs to be done when a circuit completes a hop.</p>
<p>This function decides if we should record a circuit's build time in our histogram data and other statistics, and if so, records it. It also will mark circuits that have already timed out as measurement-only circuits, so they can continue to build but not get used.</p>
<p>For this, we want to consider circuits that will eventually make it to the third hop. For circuits longer than 3 hops, we want to record their build time when they reach the third hop, but let them continue (and not count them later). For circuits that are exactly 3 hops, this will count them when they are completed. We do this so that CBT is always gathering statistics on circuits of the same length, regardless of their type. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_a306615a489277731398dbd19065f7b2b_cgraph.png" border="0" usemap="#circuitstats_8h_a306615a489277731398dbd19065f7b2b_cgraph" alt=""/></div>
<map name="circuitstats_8h_a306615a489277731398dbd19065f7b2b_cgraph" id="circuitstats_8h_a306615a489277731398dbd19065f7b2b_cgraph">
<area shape="rect" id="node2" href="circuitstats_8c.html#ab1b73e0bb66fa432389a7cc95a62bb21" title="circuit_build_times\l_disabled" alt="" coords="246,5,377,47"/>
<area shape="rect" id="node4" href="circuitbuild_8c.html#aa58d1c16591ccd8590c84255d7b3cc34" title="circuit_timeout_want\l_to_count_circ" alt="" coords="240,71,383,112"/>
<area shape="rect" id="node6" href="util_8c.html#aa86d039278659b0bcd070908fb5e5218" title="tv_mdiff" alt="" coords="277,137,346,163"/>
<area shape="rect" id="node7" href="circuitstats_8c.html#a33097eebbc8865c466107e5588f357ec" title="get_circuit_build_timeout_ms" alt="" coords="216,187,407,214"/>
<area shape="rect" id="node8" href="circuitlist_8c.html#a1f1254d702e18cb40b466c578e7187d3" title="circuit_any_opened\l_circuits_cached" alt="" coords="244,239,379,280"/>
<area shape="rect" id="node3" href="circuitstats_8c.html#a556d4f3e3d78886de05662aaf08f3c3f" title="circuit_build_times\l_disabled_" alt="" coords="487,5,617,47"/>
<area shape="rect" id="node5" href="circuitlist_8c.html#a946530ab71c12655f35d3206c16d49b5" title="circuit_get_cpath_opened_len" alt="" coords="455,78,649,105"/>
</map>
</div>

</div>
</div>
<a id="a783722d9622ae552e3f3d117163dd67a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a783722d9622ae552e3f3d117163dd67a">&#9670;&nbsp;</a></span>circuit_build_times_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_build_times_init </td>
          <td>(</td>
          <td class="paramtype">circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the buildtimes structure for first use.</p>
<p>Sets the initial timeout values based on either the config setting, the consensus param, or the default (CBT_DEFAULT_TIMEOUT_INITIAL_VALUE). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_a783722d9622ae552e3f3d117163dd67a_cgraph.png" border="0" usemap="#circuitstats_8h_a783722d9622ae552e3f3d117163dd67a_cgraph" alt=""/></div>
<map name="circuitstats_8h_a783722d9622ae552e3f3d117163dd67a_cgraph" id="circuitstats_8h_a783722d9622ae552e3f3d117163dd67a_cgraph">
<area shape="rect" id="node2" href="circuitstats_8c.html#ab1b73e0bb66fa432389a7cc95a62bb21" title="circuit_build_times\l_disabled" alt="" coords="208,5,339,47"/>
<area shape="rect" id="node3" href="circuitstats_8c.html#a556d4f3e3d78886de05662aaf08f3c3f" title="circuit_build_times\l_disabled_" alt="" coords="387,5,517,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_a783722d9622ae552e3f3d117163dd67a_icgraph.png" border="0" usemap="#circuitstats_8h_a783722d9622ae552e3f3d117163dd67a_icgraph" alt=""/></div>
<map name="circuitstats_8h_a783722d9622ae552e3f3d117163dd67a_icgraph" id="circuitstats_8h_a783722d9622ae552e3f3d117163dd67a_icgraph">
<area shape="rect" id="node2" href="circuitstats_8h.html#a3698f5cf00759e40798b2dcb4097976c" title="circuit_build_times\l_parse_state" alt="" coords="208,5,339,47"/>
</map>
</div>

</div>
</div>
<a id="a73e9aaecc9e72307e2483feeaed4c448"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73e9aaecc9e72307e2483feeaed4c448">&#9670;&nbsp;</a></span>circuit_build_times_mark_circ_as_measurement_only()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_build_times_mark_circ_as_measurement_only </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mark this circuit as timed out, but change its purpose so that it continues to build, allowing us to measure its full build time. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_a73e9aaecc9e72307e2483feeaed4c448_cgraph.png" border="0" usemap="#circuitstats_8h_a73e9aaecc9e72307e2483feeaed4c448_cgraph" alt=""/></div>
<map name="circuitstats_8h_a73e9aaecc9e72307e2483feeaed4c448_cgraph" id="circuitstats_8h_a73e9aaecc9e72307e2483feeaed4c448_cgraph">
<area shape="rect" id="node2" href="control_8c.html#a5fcccb8799c3633567989fd4560cf8a3" title="control_event_circuit\l_status" alt="" coords="277,5,420,47"/>
</map>
</div>

</div>
</div>
<a id="af926b84dc328f71fcccdaa4df5e418b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af926b84dc328f71fcccdaa4df5e418b5">&#9670;&nbsp;</a></span>circuit_build_times_needs_circuits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_build_times_needs_circuits </td>
          <td>(</td>
          <td class="paramtype">const circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns true if we need circuits to be built </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_af926b84dc328f71fcccdaa4df5e418b5_cgraph.png" border="0" usemap="#circuitstats_8h_af926b84dc328f71fcccdaa4df5e418b5_cgraph" alt=""/></div>
<map name="circuitstats_8h_af926b84dc328f71fcccdaa4df5e418b5_cgraph" id="circuitstats_8h_af926b84dc328f71fcccdaa4df5e418b5_cgraph">
<area shape="rect" id="node2" href="circuitstats_8c.html#aa3e86bd1570419757d3e1cdc577395a3" title="circuit_build_times\l_enough_to_compute" alt="" coords="184,5,331,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_af926b84dc328f71fcccdaa4df5e418b5_icgraph.png" border="0" usemap="#circuitstats_8h_af926b84dc328f71fcccdaa4df5e418b5_icgraph" alt=""/></div>
<map name="circuitstats_8h_af926b84dc328f71fcccdaa4df5e418b5_icgraph" id="circuitstats_8h_af926b84dc328f71fcccdaa4df5e418b5_icgraph">
<area shape="rect" id="node2" href="circuitstats_8h.html#a078e35bc3a938238e3eac4eb29a076ce" title="circuit_build_times\l_needs_circuits_now" alt="" coords="184,5,328,47"/>
</map>
</div>

</div>
</div>
<a id="a078e35bc3a938238e3eac4eb29a076ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a078e35bc3a938238e3eac4eb29a076ce">&#9670;&nbsp;</a></span>circuit_build_times_needs_circuits_now()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_build_times_needs_circuits_now </td>
          <td>(</td>
          <td class="paramtype">const circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns true if we should build a timeout test circuit right now. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_a078e35bc3a938238e3eac4eb29a076ce_cgraph.png" border="0" usemap="#circuitstats_8h_a078e35bc3a938238e3eac4eb29a076ce_cgraph" alt=""/></div>
<map name="circuitstats_8h_a078e35bc3a938238e3eac4eb29a076ce_cgraph" id="circuitstats_8h_a078e35bc3a938238e3eac4eb29a076ce_cgraph">
<area shape="rect" id="node2" href="circuitstats_8c.html#af926b84dc328f71fcccdaa4df5e418b5" title="circuit_build_times\l_needs_circuits" alt="" coords="197,5,328,47"/>
<area shape="rect" id="node4" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="216,71,309,98"/>
<area shape="rect" id="node3" href="circuitstats_8c.html#aa3e86bd1570419757d3e1cdc577395a3" title="circuit_build_times\l_enough_to_compute" alt="" coords="376,5,523,47"/>
</map>
</div>

</div>
</div>
<a id="a3c0ef1a1c2f4ee597394a8dc694e8e21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c0ef1a1c2f4ee597394a8dc694e8e21">&#9670;&nbsp;</a></span>circuit_build_times_network_check_live()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_build_times_network_check_live </td>
          <td>(</td>
          <td class="paramtype">const circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>When the network is not live, we do not record circuit build times.</p>
<p>The network is considered not live if there has been at least one circuit build that began and ended (had its close_ms measurement period expire) since we last received a cell.</p>
<p>Also has the side effect of rewinding the circuit time history in the case of recent liveness changes. </p>

</div>
</div>
<a id="a9c61cd815e5afe00297676109450aa6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c61cd815e5afe00297676109450aa6d">&#9670;&nbsp;</a></span>circuit_build_times_network_circ_success()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_build_times_network_circ_success </td>
          <td>(</td>
          <td class="paramtype">circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called to indicate that we "completed" a circuit. Because this circuit succeeded, it doesn't count as a timeout-after-the-first-hop.</p>
<p>(For the purposes of the cbt code, we consider a circuit "completed" if it has 3 hops, regardless of its final hop count. We do this because we're trying to answer the question, "how long should a circuit take to
reach the 3-hop count".)</p>
<p>This is used by <a class="el" href="circuitstats_8c.html#a4769116ba3c739de9deb558fb39470b7">circuit_build_times_network_check_changed()</a> to determine if we had too many recent timeouts and need to reset our learned timeout to something higher. </p>

</div>
</div>
<a id="a2b95a37e26723de09e38d46549c9fba0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b95a37e26723de09e38d46549c9fba0">&#9670;&nbsp;</a></span>circuit_build_times_network_is_live()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_build_times_network_is_live </td>
          <td>(</td>
          <td class="paramtype">circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called to indicate that the network showed some signs of liveness, i.e. we received a cell.</p>
<p>This is used by <a class="el" href="circuitstats_8c.html#a3c0ef1a1c2f4ee597394a8dc694e8e21">circuit_build_times_network_check_live()</a> to decide if we should record the circuit build timeout or not.</p>
<p>This function is called every time we receive a cell. Avoid syscalls, events, and other high-intensity work. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_a2b95a37e26723de09e38d46549c9fba0_cgraph.png" border="0" usemap="#circuitstats_8h_a2b95a37e26723de09e38d46549c9fba0_cgraph" alt=""/></div>
<map name="circuitstats_8h_a2b95a37e26723de09e38d46549c9fba0_cgraph" id="circuitstats_8h_a2b95a37e26723de09e38d46549c9fba0_cgraph">
<area shape="rect" id="node2" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="184,13,277,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_a2b95a37e26723de09e38d46549c9fba0_icgraph.png" border="0" usemap="#circuitstats_8h_a2b95a37e26723de09e38d46549c9fba0_icgraph" alt=""/></div>
<map name="circuitstats_8h_a2b95a37e26723de09e38d46549c9fba0_icgraph" id="circuitstats_8h_a2b95a37e26723de09e38d46549c9fba0_icgraph">
<area shape="rect" id="node2" href="channel_8c.html#a4bb9524073333e156da271ca623a772d" title="channel_do_open_actions" alt="" coords="184,13,356,39"/>
</map>
</div>

</div>
</div>
<a id="afbfb286d45e72331adbc9eea6f92a30a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbfb286d45e72331adbc9eea6f92a30a">&#9670;&nbsp;</a></span>circuit_build_times_new_consensus_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_build_times_new_consensus_params </td>
          <td>(</td>
          <td class="paramtype">circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is called when we get a consensus update.</p>
<p>It checks to see if we have changed any consensus parameters that require reallocation or discard of previous stats. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_afbfb286d45e72331adbc9eea6f92a30a_cgraph.png" border="0" usemap="#circuitstats_8h_afbfb286d45e72331adbc9eea6f92a30a_cgraph" alt=""/></div>
<map name="circuitstats_8h_afbfb286d45e72331adbc9eea6f92a30a_cgraph" id="circuitstats_8h_afbfb286d45e72331adbc9eea6f92a30a_cgraph">
<area shape="rect" id="node2" href="circuitstats_8c.html#ab1b73e0bb66fa432389a7cc95a62bb21" title="circuit_build_times\l_disabled" alt="" coords="227,5,357,47"/>
<area shape="rect" id="node3" href="circuitstats_8c.html#a556d4f3e3d78886de05662aaf08f3c3f" title="circuit_build_times\l_disabled_" alt="" coords="405,5,536,47"/>
</map>
</div>

</div>
</div>
<a id="a3698f5cf00759e40798b2dcb4097976c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3698f5cf00759e40798b2dcb4097976c">&#9670;&nbsp;</a></span>circuit_build_times_parse_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_build_times_parse_state </td>
          <td>(</td>
          <td class="paramtype">circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structor__state__t.html">or_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load histogram from <b>state</b>, shuffling the resulting array after we do so. Use this result to estimate parameters and calculate the timeout.</p>
<p>Return -1 on error. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_a3698f5cf00759e40798b2dcb4097976c_cgraph.png" border="0" usemap="#circuitstats_8h_a3698f5cf00759e40798b2dcb4097976c_cgraph" alt=""/></div>
<map name="circuitstats_8h_a3698f5cf00759e40798b2dcb4097976c_cgraph" id="circuitstats_8h_a3698f5cf00759e40798b2dcb4097976c_cgraph">
<area shape="rect" id="node2" href="circuitstats_8c.html#a783722d9622ae552e3f3d117163dd67a" title="circuit_build_times_init" alt="" coords="184,5,339,32"/>
<area shape="rect" id="node3" href="circuitstats_8c.html#ab1b73e0bb66fa432389a7cc95a62bb21" title="circuit_build_times\l_disabled" alt="" coords="387,23,517,65"/>
<area shape="rect" id="node4" href="circuitstats_8c.html#a556d4f3e3d78886de05662aaf08f3c3f" title="circuit_build_times\l_disabled_" alt="" coords="565,23,696,65"/>
</map>
</div>

</div>
</div>
<a id="a321ec5d0efe5196955be8140397bba91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a321ec5d0efe5196955be8140397bba91">&#9670;&nbsp;</a></span>circuit_build_times_set_timeout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_build_times_set_timeout </td>
          <td>(</td>
          <td class="paramtype">circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Exposed function to compute a new timeout. Dispatches events and also filters out extremely high timeout values. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_a321ec5d0efe5196955be8140397bba91_cgraph.png" border="0" usemap="#circuitstats_8h_a321ec5d0efe5196955be8140397bba91_cgraph" alt=""/></div>
<map name="circuitstats_8h_a321ec5d0efe5196955be8140397bba91_cgraph" id="circuitstats_8h_a321ec5d0efe5196955be8140397bba91_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a44cb339836df0bbfcf8416209976f6db" title="tor_lround" alt="" coords="210,5,289,32"/>
<area shape="rect" id="node3" href="circuitstats_8c.html#ab1b73e0bb66fa432389a7cc95a62bb21" title="circuit_build_times\l_disabled" alt="" coords="184,57,315,98"/>
<area shape="rect" id="node4" href="circuitstats_8c.html#a556d4f3e3d78886de05662aaf08f3c3f" title="circuit_build_times\l_disabled_" alt="" coords="363,57,493,98"/>
</map>
</div>

</div>
</div>
<a id="a685329d97770111282850e80b499d864"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a685329d97770111282850e80b499d864">&#9670;&nbsp;</a></span>circuit_build_times_timeout_rate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double circuit_build_times_timeout_rate </td>
          <td>(</td>
          <td class="paramtype">const circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Count the number of timeouts in a set of cbt data. </p>

</div>
</div>
<a id="a6cd11af3008cdeec3065dee7bed4cc88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cd11af3008cdeec3065dee7bed4cc88">&#9670;&nbsp;</a></span>circuit_build_times_update_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_build_times_update_state </td>
          <td>(</td>
          <td class="paramtype">const circuit_build_times_t *&#160;</td>
          <td class="paramname"><em>cbt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structor__state__t.html">or_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output a histogram of current circuit build times to the <a class="el" href="structor__state__t.html">or_state_t</a> state structure. </p>

</div>
</div>
<a id="a612d7d345a4328b8dd4d1079fb0bc9b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a612d7d345a4328b8dd4d1079fb0bc9b2">&#9670;&nbsp;</a></span>get_circuit_build_close_time_ms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_circuit_build_close_time_ms </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the time to wait before actually closing an under-construction, in milliseconds. </p>

</div>
</div>
<a id="a33097eebbc8865c466107e5588f357ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33097eebbc8865c466107e5588f357ec">&#9670;&nbsp;</a></span>get_circuit_build_timeout_ms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_circuit_build_timeout_ms </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the time to wait before giving up on an under-construction circuit, in milliseconds. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_a33097eebbc8865c466107e5588f357ec_icgraph.png" border="0" usemap="#circuitstats_8h_a33097eebbc8865c466107e5588f357ec_icgraph" alt=""/></div>
<map name="circuitstats_8h_a33097eebbc8865c466107e5588f357ec_icgraph" id="circuitstats_8h_a33097eebbc8865c466107e5588f357ec_icgraph">
<area shape="rect" id="node2" href="circuitstats_8h.html#a306615a489277731398dbd19065f7b2b" title="circuit_build_times\l_handle_completed_hop" alt="" coords="244,5,407,47"/>
</map>
</div>

</div>
</div>
<a id="a60132df70f749a68de14d2993d593787"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60132df70f749a68de14d2993d593787">&#9670;&nbsp;</a></span>get_circuit_build_times()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const circuit_build_times_t* get_circuit_build_times </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a pointer to the data structure describing our current circuit build time history and computations. </p>

</div>
</div>
<a id="ab6607aa51a9503278d8f893f8092aabc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6607aa51a9503278d8f893f8092aabc">&#9670;&nbsp;</a></span>get_circuit_build_times_mutable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">circuit_build_times_t* get_circuit_build_times_mutable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As get_circuit_build_times, but return a mutable pointer. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuitstats_8h_ab6607aa51a9503278d8f893f8092aabc_icgraph.png" border="0" usemap="#circuitstats_8h_ab6607aa51a9503278d8f893f8092aabc_icgraph" alt=""/></div>
<map name="circuitstats_8h_ab6607aa51a9503278d8f893f8092aabc_icgraph" id="circuitstats_8h_ab6607aa51a9503278d8f893f8092aabc_icgraph">
<area shape="rect" id="node2" href="channel_8c.html#a4bb9524073333e156da271ca623a772d" title="channel_do_open_actions" alt="" coords="208,13,380,39"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
