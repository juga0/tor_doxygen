<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/routerlist.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">routerlist.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="routerlist_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* Copyright (c) 2001-2004, Roger Dingledine.</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2004-2006, Roger Dingledine, Nick Mathewson.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (c) 2007-2016, The Tor Project, Inc. */</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* See LICENSE for licensing information */</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#ifndef TOR_ROUTERLIST_H</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#define TOR_ROUTERLIST_H</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;testsupport.h&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a40b0857598d14d49c8082667c70bc023">get_n_authorities</a>(<a class="code" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a> type);</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a88c116d81fb2aed5dde4a9c8590af12c">trusted_dirs_reload_certs</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * Pass one of these as source to trusted_dirs_load_certs_from_string()</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * to indicate whence string originates; this controls error handling</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * behavior such as marking downloads as failed.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#define TRUSTED_DIRS_CERTS_SRC_SELF 0</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#define TRUSTED_DIRS_CERTS_SRC_FROM_STORE 1</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#define TRUSTED_DIRS_CERTS_SRC_DL_BY_ID_DIGEST 2</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#define TRUSTED_DIRS_CERTS_SRC_DL_BY_ID_SK_DIGEST 3</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#define TRUSTED_DIRS_CERTS_SRC_FROM_VOTE 4</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a0a6e87e7775e3d61a3a0f2cb14f78ea1">trusted_dirs_load_certs_from_string</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *contents, <span class="keywordtype">int</span> source,</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                        <span class="keywordtype">int</span> flush, <span class="keyword">const</span> <span class="keywordtype">char</span> *source_dir);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#acb91993a221f80d7896395babb122f0a">trusted_dirs_flush_certs_to_disk</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<a class="code" href="structauthority__cert__t.html">authority_cert_t</a> *<a class="code" href="routerlist_8h.html#a339be9cf9f2920c65e6e938e3de8b3b8">authority_cert_get_newest_by_id</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *id_digest);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<a class="code" href="structauthority__cert__t.html">authority_cert_t</a> *<a class="code" href="routerlist_8h.html#ab24c5c3729a4bf122f277447df1c5e8c">authority_cert_get_by_sk_digest</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *sk_digest);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<a class="code" href="structauthority__cert__t.html">authority_cert_t</a> *<a class="code" href="routerlist_8h.html#a58983e59cd226450674e7a11edc59dad">authority_cert_get_by_digests</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *id_digest,</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                                                <span class="keyword">const</span> <span class="keywordtype">char</span> *sk_digest);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a4f963147c4e0b848b35c2bb5af493163">authority_cert_get_all</a>(<a class="code" href="structsmartlist__t.html">smartlist_t</a> *certs_out);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a0642e00994970234101190ca32fbf091">authority_cert_dl_failed</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *id_digest,</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span> *signing_key_digest, <span class="keywordtype">int</span> status);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a91f37bda7b9149b1da0f1abfff66ab23">authority_certs_fetch_missing</a>(<a class="code" href="structnetworkstatus__t.html">networkstatus_t</a> *status, time_t now,</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *dir_hint);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a86f14dd56cbe0cc04a9b096db95a4270">router_reload_router_list</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#af0674d915ac20d064542496c8a8c2c26">authority_cert_dl_looks_uncertain</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *id_digest);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">const</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *<a class="code" href="routerlist_8h.html#aa9b36f7b87463dc114065ea058660ac4">router_get_trusted_dir_servers</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">const</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *router_get_fallback_dir_servers(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a1414b47a61105dd75d01ba4966c511fc">authority_cert_is_blacklisted</a>(<span class="keyword">const</span> <a class="code" href="structauthority__cert__t.html">authority_cert_t</a> *cert);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">const</span> <a class="code" href="structrouterstatus__t.html">routerstatus_t</a> *<a class="code" href="routerlist_8h.html#ace83aa582c6836e9a172a8cafa1d4047">router_pick_directory_server</a>(<a class="code" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a> type,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                                   <span class="keywordtype">int</span> flags);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<a class="code" href="structdir__server__t.html">dir_server_t</a> *<a class="code" href="routerlist_8h.html#ae19d4c9a3cd78d4fbc5e926825704ba0">router_get_trusteddirserver_by_digest</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespaced.html">d</a>);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<a class="code" href="structdir__server__t.html">dir_server_t</a> *<a class="code" href="routerlist_8h.html#aaa2e70d04e8e04e2958f64f243e76987">router_get_fallback_dirserver_by_digest</a>(</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *digest);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#aa0f6ecb349cc9b484a19c1a0397dc1ed">router_digest_is_fallback_dir</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *digest);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;MOCK_DECL(<a class="code" href="structdir__server__t.html">dir_server_t</a> *, trusteddirserver_get_by_v3_auth_digest,</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;          (<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespaced.html">d</a>));</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">const</span> <a class="code" href="structrouterstatus__t.html">routerstatus_t</a> *<a class="code" href="routerlist_8h.html#ad96c8d565baf8a82010f5adfacb99060">router_pick_trusteddirserver</a>(<a class="code" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a> type,</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                                                   <span class="keywordtype">int</span> flags);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">const</span> <a class="code" href="structrouterstatus__t.html">routerstatus_t</a> *<a class="code" href="routerlist_8h.html#a58ed11d2f6808617760386221246b842">router_pick_fallback_dirserver</a>(<a class="code" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a> type,</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                                     <span class="keywordtype">int</span> flags);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordtype">int</span> router_skip_or_reachability(<span class="keyword">const</span> <a class="code" href="structor__options__t.html">or_options_t</a> *options, <span class="keywordtype">int</span> try_ip_pref);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keywordtype">int</span> router_get_my_share_of_directory_requests(<span class="keywordtype">double</span> *v3_share_out);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a4fab5ecf53641fa3ee384520aaa22e41">router_reset_status_download_failures</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a9b25dd842df15283a342bb77cf5935a8">routers_have_same_or_addrs</a>(<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *r1, <span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *r2);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#aba23320c5a1abde91478e430c7bd42bd">router_add_running_nodes_to_smartlist</a>(<a class="code" href="structsmartlist__t.html">smartlist_t</a> *sl, <span class="keywordtype">int</span> allow_invalid,</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                           <span class="keywordtype">int</span> need_uptime, <span class="keywordtype">int</span> need_capacity,</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                           <span class="keywordtype">int</span> need_guard, <span class="keywordtype">int</span> need_desc,</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                           <span class="keywordtype">int</span> pref_addr, <span class="keywordtype">int</span> direct_conn);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *<a class="code" href="routerlist_8h.html#afc5cd667e54af0c810a0930e70e27348">routerlist_find_my_routerinfo</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;uint32_t <a class="code" href="routerlist_8h.html#a529cee5c17927c3dd0bbab47b5530ced">router_get_advertised_bandwidth</a>(<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *router);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;uint32_t <a class="code" href="routerlist_8h.html#ad6fa9db0634a1b718251a999c4972b21">router_get_advertised_bandwidth_capped</a>(<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *router);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">const</span> <a class="code" href="structnode__t.html">node_t</a> *<a class="code" href="routerlist_8h.html#aaf1c16d2f07649504a2f0cb790312337">node_sl_choose_by_bandwidth</a>(<span class="keyword">const</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *sl,</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                          <a class="code" href="or_8h.html#afec7ed946efd497dc5d098510c5a2d87">bandwidth_weight_rule_t</a> rule);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keywordtype">double</span> <a class="code" href="routerlist_8h.html#a8c5a2d791ec14d51bceebd0201d884a5">frac_nodes_with_descriptors</a>(<span class="keyword">const</span> <a class="code" href="structsmartlist__t.html">smartlist_t</a> *sl,</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                   <a class="code" href="or_8h.html#afec7ed946efd497dc5d098510c5a2d87">bandwidth_weight_rule_t</a> rule);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">const</span> <a class="code" href="structnode__t.html">node_t</a> *<a class="code" href="routerlist_8h.html#a17969a33c59259ad90394d61997c2e94">router_choose_random_node</a>(<a class="code" href="structsmartlist__t.html">smartlist_t</a> *excludedsmartlist,</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                        <span class="keyword">struct</span> routerset_t *excludedset,</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                        <a class="code" href="or_8h.html#a274fd236a2f0fc116815f9077f5ca82c">router_crn_flags_t</a> flags);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a8b764a3362e4c3245d5e430925e380f1">router_is_named</a>(<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *router);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a6c38eadb28cf4532a7623c5aa1885cec">router_digest_is_trusted_dir_type</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *digest,</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                      <a class="code" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a> type);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#define router_digest_is_trusted_dir(d) \</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">  router_digest_is_trusted_dir_type((d), NO_DIRINFO)</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a0240e623457d6c4622dd3d9dad2a652f">router_addr_is_trusted_dir</a>(uint32_t addr);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a940b9f42b7b36f3fc3721aa2536d7cdf">hexdigest_to_digest</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *hexdigest, <span class="keywordtype">char</span> *digest);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *<a class="code" href="routerlist_8h.html#a9eb1861cedcb477a2e455b6c02eb56d8">router_get_by_id_digest</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *digest);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *<a class="code" href="routerlist_8h.html#a848eea1698b3361538f190f55f2cc0e6">router_get_mutable_by_digest</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *digest);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<a class="code" href="structsigned__descriptor__t.html">signed_descriptor_t</a> *<a class="code" href="routerlist_8h.html#aab0f360909c4cc3732e5f9541cf595bb">router_get_by_descriptor_digest</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *digest);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;MOCK_DECL(<a class="code" href="structsigned__descriptor__t.html">signed_descriptor_t</a> *,router_get_by_extrainfo_digest,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          (<span class="keyword">const</span> <span class="keywordtype">char</span> *digest));</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<a class="code" href="structsigned__descriptor__t.html">signed_descriptor_t</a> *<a class="code" href="routerlist_8h.html#ab49c0521b1d8a01f75abf4438992fd08">extrainfo_get_by_descriptor_digest</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *digest);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="routerlist_8h.html#af4d8bdd829c8eab4c9060c014fb59af8">signed_descriptor_get_body</a>(<span class="keyword">const</span> <a class="code" href="structsigned__descriptor__t.html">signed_descriptor_t</a> *desc);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="routerlist_8h.html#aa7aee947ee003a2d2367678bdbbb0aa9">signed_descriptor_get_annotations</a>(<span class="keyword">const</span> <a class="code" href="structsigned__descriptor__t.html">signed_descriptor_t</a> *desc);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<a class="code" href="structrouterlist__t.html">routerlist_t</a> *<a class="code" href="routerlist_8h.html#a9181bbed0ee6ff8088a7c53fc8c446f1">router_get_routerlist</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#af2db10502386ef035c89377d2968c7e0">routerinfo_free</a>(<a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *router);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a36bbf9bf41105f61c8f1f5b6ffc3b12b">extrainfo_free</a>(<a class="code" href="structextrainfo__t.html">extrainfo_t</a> *extrainfo);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#ab9228e04209739ed11f23f364b74bfde">routerlist_free</a>(<a class="code" href="structrouterlist__t.html">routerlist_t</a> *rl);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a5062bf36695d11df627a5d3cda2954fe">dump_routerlist_mem_usage</a>(<span class="keywordtype">int</span> severity);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a8c328828cd94c3bb84044c9003f8c78f">routerlist_remove</a>(<a class="code" href="structrouterlist__t.html">routerlist_t</a> *rl, <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *ri, <span class="keywordtype">int</span> make_old,</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                       time_t now);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a087a998f551e9fff456d9e4ce662668e">routerlist_free_all</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#ad5591c87fbad96a88fa4d0145431ef87">routerlist_reset_warnings</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;MOCK_DECL(<a class="code" href="structsmartlist__t.html">smartlist_t</a> *, list_authority_ids_with_downloads, (<span class="keywordtype">void</span>));</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;MOCK_DECL(<a class="code" href="structdownload__status__t.html">download_status_t</a> *, id_only_download_status_for_authority_id,</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          (<span class="keyword">const</span> <span class="keywordtype">char</span> *digest));</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;MOCK_DECL(<a class="code" href="structsmartlist__t.html">smartlist_t</a> *, list_sk_digests_for_authority_id,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          (<span class="keyword">const</span> <span class="keywordtype">char</span> *digest));</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;MOCK_DECL(<a class="code" href="structdownload__status__t.html">download_status_t</a> *, download_status_for_authority_id_and_sk,</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    (<span class="keyword">const</span> <span class="keywordtype">char</span> *id_digest, <span class="keyword">const</span> <span class="keywordtype">char</span> *sk_digest));</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> WRA_WAS_ADDED(<a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a> s);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> WRA_WAS_OUTDATED(<a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a> s);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> WRA_WAS_REJECTED(<a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a> s);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> WRA_NEVER_DOWNLOADABLE(<a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a> s);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;WRA_WAS_ADDED(<a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a> s) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">return</span> s == ROUTER_ADDED_SUCCESSFULLY || s == ROUTER_ADDED_NOTIFY_GENERATOR;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> WRA_WAS_OUTDATED(<a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a> s)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">return</span> (s == ROUTER_WAS_TOO_OLD ||</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          s == ROUTER_IS_ALREADY_KNOWN ||</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          s == ROUTER_NOT_IN_CONSENSUS ||</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          s == ROUTER_NOT_IN_CONSENSUS_OR_NETWORKSTATUS ||</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          s == ROUTER_CERTS_EXPIRED);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> WRA_WAS_REJECTED(<a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a> s)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">return</span> (s == ROUTER_AUTHDIR_REJECTS);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> WRA_NEVER_DOWNLOADABLE(<a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a> s)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">return</span> (s == ROUTER_AUTHDIR_REJECTS ||</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          s == ROUTER_BAD_EI ||</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          s == ROUTER_WAS_TOO_OLD ||</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          s == ROUTER_CERTS_EXPIRED);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a> <a class="code" href="routerlist_8h.html#ab1878aef0f1dd92c783d5477248b985d">router_add_to_routerlist</a>(<a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *router,</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">char</span> **msg,</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                            <span class="keywordtype">int</span> from_cache,</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                            <span class="keywordtype">int</span> from_fetch);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a> <a class="code" href="routerlist_8h.html#a91d657f054dd82fbaf519c02deb5ec51">router_add_extrainfo_to_routerlist</a>(</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                        <a class="code" href="structextrainfo__t.html">extrainfo_t</a> *ei, <span class="keyword">const</span> <span class="keywordtype">char</span> **msg,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                        <span class="keywordtype">int</span> from_cache, <span class="keywordtype">int</span> from_fetch);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#ad0e00a6f0df9aace49976da496902957">routerlist_descriptors_added</a>(<a class="code" href="structsmartlist__t.html">smartlist_t</a> *sl, <span class="keywordtype">int</span> from_cache);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#ad504742ed3340ecce532e798d3304c82">routerlist_remove_old_routers</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a7b194ad6a42e8fb2ef4f3aa1cf135830">router_load_single_router</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, uint8_t purpose, <span class="keywordtype">int</span> cache,</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span> **msg);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#ae08c5697c58be20a7bb11b34ca9aba5e">router_load_routers_from_string</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *eos,</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                     <a class="code" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a> saved_location,</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                     <a class="code" href="structsmartlist__t.html">smartlist_t</a> *requested_fingerprints,</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                     <span class="keywordtype">int</span> descriptor_digests,</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">char</span> *prepend_annotations);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a373b610cd5f3f54650e6e7d47ae70263">router_load_extrainfo_from_string</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *eos,</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                       <a class="code" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a> saved_location,</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                       <a class="code" href="structsmartlist__t.html">smartlist_t</a> *requested_fingerprints,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                       <span class="keywordtype">int</span> descriptor_digests);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a52db265aafa57b000917a06850363fcd">routerlist_retry_directory_downloads</a>(time_t now);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a1cb0d178232a933f8fea51a845f41265">router_exit_policy_rejects_all</a>(<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *router);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<a class="code" href="structdir__server__t.html">dir_server_t</a> *<a class="code" href="routerlist_8h.html#ab31a672081329b253fe2d46a506cc2f2">trusted_dir_server_new</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *nickname, <span class="keyword">const</span> <span class="keywordtype">char</span> *address,</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                       uint16_t dir_port, uint16_t or_port,</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                       <span class="keyword">const</span> <a class="code" href="structtor__addr__port__t.html">tor_addr_port_t</a> *addrport_ipv6,</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">char</span> *digest, <span class="keyword">const</span> <span class="keywordtype">char</span> *v3_auth_digest,</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                       <a class="code" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a> type, <span class="keywordtype">double</span> weight);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<a class="code" href="structdir__server__t.html">dir_server_t</a> *<a class="code" href="routerlist_8h.html#a0b3d74c73f42fb7ed7acc16a1cacfffa">fallback_dir_server_new</a>(<span class="keyword">const</span> <a class="code" href="structtor__addr__t.html">tor_addr_t</a> *addr,</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                      uint16_t dir_port, uint16_t or_port,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="structtor__addr__port__t.html">tor_addr_port_t</a> *addrport_ipv6,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *id_digest, <span class="keywordtype">double</span> weight);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a9bd4c9992a1cf27e95e2829ae40c7b79">dir_server_add</a>(<a class="code" href="structdir__server__t.html">dir_server_t</a> *ent);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a2bb77cd705f2c621023fff9a114c01bf">authority_cert_free</a>(<a class="code" href="structauthority__cert__t.html">authority_cert_t</a> *cert);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a6ffeae0d92b2c4eec18c14453732f726">clear_dir_servers</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a1a7cfda729e27cf26089db2112d21965">update_consensus_router_descriptor_downloads</a>(time_t now, <span class="keywordtype">int</span> is_vote,</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                                  <a class="code" href="structnetworkstatus__t.html">networkstatus_t</a> *consensus);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a8b67f737b9ea614297414b26eb3b784c">update_router_descriptor_downloads</a>(time_t now);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#afe7f2c6bcc3135272bc6aa66ec09cd76">update_all_descriptor_downloads</a>(time_t now);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#ab576efc7049ed4eca6fa56e9f0544844">update_extrainfo_downloads</a>(time_t now);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#adc3015689729ebc1c085666a99b80a10">router_reset_descriptor_download_failures</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#ac41971537948013e1684f04ae286affd">router_differences_are_cosmetic</a>(<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *r1,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *r2);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a3ed4f55736541adee60a83e8442d4d4f">routerinfo_incompatible_with_extrainfo</a>(<span class="keyword">const</span> <a class="code" href="structcrypto__pk__t.html">crypto_pk_t</a> *ri,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                           <a class="code" href="structextrainfo__t.html">extrainfo_t</a> *ei,</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                           <a class="code" href="structsigned__descriptor__t.html">signed_descriptor_t</a> *sd,</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">char</span> **msg);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordtype">int</span> routerinfo_has_curve25519_onion_key(<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *ri);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keywordtype">int</span> routerstatus_version_supports_extend2_cells(<span class="keyword">const</span> <a class="code" href="structrouterstatus__t.html">routerstatus_t</a> *rs,</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                                <span class="keywordtype">int</span> allow_unknown_versions);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a6bbb04e1dbdbbde5ad2089aac715d9cf">routerlist_assert_ok</a>(<span class="keyword">const</span> <a class="code" href="structrouterlist__t.html">routerlist_t</a> *rl);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="routerlist_8h.html#afd620fb5cbc29f6895ae016c0240d9a6">esc_router_info</a>(<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *router);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#aaf38df620524abf6789bd31196b07697">routers_sort_by_identity</a>(<a class="code" href="structsmartlist__t.html">smartlist_t</a> *routers);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a8989395a52cfb9cb553c9eebf44395eb">refresh_all_country_info</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a19e2aa4caae99a8eba67490a4d920794">list_pending_microdesc_downloads</a>(digest256map_t *result);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keywordtype">void</span> <a class="code" href="routerlist_8h.html#a33e8618001c42bd50575051362aaffa2">launch_descriptor_downloads</a>(<span class="keywordtype">int</span> purpose,</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                 <a class="code" href="structsmartlist__t.html">smartlist_t</a> *downloadable,</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="structrouterstatus__t.html">routerstatus_t</a> *source,</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                 time_t now);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#a523b43a59ea9b1e6b9a1c1be52f6d077">hex_digest_nickname_decode</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *hexdigest,</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                               <span class="keywordtype">char</span> *digest_out,</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                               <span class="keywordtype">char</span> *nickname_qualifier_out,</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                               <span class="keywordtype">char</span> *nickname_out);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keywordtype">int</span> <a class="code" href="routerlist_8h.html#afd0f7cc93c54df7858c6a6fd3f0eb443">hex_digest_nickname_matches</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *hexdigest,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">char</span> *identity_digest,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">char</span> *nickname, <span class="keywordtype">int</span> is_named);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">#ifdef ROUTERLIST_PRIVATE</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;STATIC <span class="keywordtype">int</span> <a class="code" href="routerlist_8c.html#a8b22797a2be55707af8334b747d51047">choose_array_element_by_weight</a>(<span class="keyword">const</span> uint64_t *entries,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                                          <span class="keywordtype">int</span> n_entries);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;STATIC <span class="keywordtype">void</span> <a class="code" href="routerlist_8c.html#aa17ec1d95171be8c87bb5dcc4ac341ba">scale_array_elements_to_u64</a>(uint64_t *entries_out,</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">double</span> *entries_in,</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                                        <span class="keywordtype">int</span> n_entries,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                        uint64_t *total_out);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;STATIC <span class="keyword">const</span> <a class="code" href="structrouterstatus__t.html">routerstatus_t</a> *<a class="code" href="routerlist_8c.html#ab3e64366c95e82de40cac88b7a39ae17">router_pick_directory_server_impl</a>(</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                           <a class="code" href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a> auth, <span class="keywordtype">int</span> flags,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                           <span class="keywordtype">int</span> *n_busy_out);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;MOCK_DECL(<span class="keywordtype">int</span>, router_descriptor_is_older_than, (<span class="keyword">const</span> <a class="code" href="structrouterinfo__t.html">routerinfo_t</a> *router,</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                                 <span class="keywordtype">int</span> seconds));</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;MOCK_DECL(STATIC <a class="code" href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a>, extrainfo_insert,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          (<a class="code" href="structrouterlist__t.html">routerlist_t</a> *rl, <a class="code" href="structextrainfo__t.html">extrainfo_t</a> *ei, <span class="keywordtype">int</span> warn_if_incompatible));</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;MOCK_DECL(STATIC <span class="keywordtype">void</span>, initiate_descriptor_downloads,</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          (<span class="keyword">const</span> <a class="code" href="structrouterstatus__t.html">routerstatus_t</a> *source, <span class="keywordtype">int</span> purpose, <a class="code" href="structsmartlist__t.html">smartlist_t</a> *digests,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;           <span class="keywordtype">int</span> lo, <span class="keywordtype">int</span> hi, <span class="keywordtype">int</span> pds_flags));</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;STATIC <span class="keywordtype">int</span> router_is_already_dir_fetching(<span class="keyword">const</span> <a class="code" href="structtor__addr__port__t.html">tor_addr_port_t</a> *ap,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                          <span class="keywordtype">int</span> serverdesc, <span class="keywordtype">int</span> microdesc);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="ttc" id="routerlist_8h_html_a1a7cfda729e27cf26089db2112d21965"><div class="ttname"><a href="routerlist_8h.html#a1a7cfda729e27cf26089db2112d21965">update_consensus_router_descriptor_downloads</a></div><div class="ttdeci">void update_consensus_router_descriptor_downloads(time_t now, int is_vote, networkstatus_t *consensus)</div><div class="ttdef"><b>Definition:</b> routerlist.c:5128</div></div>
<div class="ttc" id="routerlist_8h_html_a4f963147c4e0b848b35c2bb5af493163"><div class="ttname"><a href="routerlist_8h.html#a4f963147c4e0b848b35c2bb5af493163">authority_cert_get_all</a></div><div class="ttdeci">void authority_cert_get_all(smartlist_t *certs_out)</div><div class="ttdef"><b>Definition:</b> routerlist.c:810</div></div>
<div class="ttc" id="routerlist_8h_html_aa9b36f7b87463dc114065ea058660ac4"><div class="ttname"><a href="routerlist_8h.html#aa9b36f7b87463dc114065ea058660ac4">router_get_trusted_dir_servers</a></div><div class="ttdeci">const smartlist_t * router_get_trusted_dir_servers(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:1610</div></div>
<div class="ttc" id="routerlist_8h_html_a339be9cf9f2920c65e6e938e3de8b3b8"><div class="ttname"><a href="routerlist_8h.html#a339be9cf9f2920c65e6e938e3de8b3b8">authority_cert_get_newest_by_id</a></div><div class="ttdeci">authority_cert_t * authority_cert_get_newest_by_id(const char *id_digest)</div><div class="ttdef"><b>Definition:</b> routerlist.c:747</div></div>
<div class="ttc" id="routerlist_8h_html_a40b0857598d14d49c8082667c70bc023"><div class="ttname"><a href="routerlist_8h.html#a40b0857598d14d49c8082667c70bc023">get_n_authorities</a></div><div class="ttdeci">int get_n_authorities(dirinfo_type_t type)</div><div class="ttdef"><b>Definition:</b> routerlist.c:223</div></div>
<div class="ttc" id="routerlist_8h_html_a0b3d74c73f42fb7ed7acc16a1cacfffa"><div class="ttname"><a href="routerlist_8h.html#a0b3d74c73f42fb7ed7acc16a1cacfffa">fallback_dir_server_new</a></div><div class="ttdeci">dir_server_t * fallback_dir_server_new(const tor_addr_t *addr, uint16_t dir_port, uint16_t or_port, const tor_addr_port_t *addrport_ipv6, const char *id_digest, double weight)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4741</div></div>
<div class="ttc" id="routerlist_8c_html_aa17ec1d95171be8c87bb5dcc4ac341ba"><div class="ttname"><a href="routerlist_8c.html#aa17ec1d95171be8c87bb5dcc4ac341ba">scale_array_elements_to_u64</a></div><div class="ttdeci">STATIC void scale_array_elements_to_u64(uint64_t *entries_out, const double *entries_in, int n_entries, uint64_t *total_out)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2413</div></div>
<div class="ttc" id="structor__options__t_html"><div class="ttname"><a href="structor__options__t.html">or_options_t</a></div><div class="ttdef"><b>Definition:</b> or.h:3493</div></div>
<div class="ttc" id="or_8h_html_a7c96814e647f1b5b99e501ea5763842f"><div class="ttname"><a href="or_8h.html#a7c96814e647f1b5b99e501ea5763842f">was_router_added_t</a></div><div class="ttdeci">was_router_added_t</div><div class="ttdef"><b>Definition:</b> or.h:5326</div></div>
<div class="ttc" id="routerlist_8h_html_a523b43a59ea9b1e6b9a1c1be52f6d077"><div class="ttname"><a href="routerlist_8h.html#a523b43a59ea9b1e6b9a1c1be52f6d077">hex_digest_nickname_decode</a></div><div class="ttdeci">int hex_digest_nickname_decode(const char *hexdigest, char *digest_out, char *nickname_qualifier_out, char *nickname_out)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2922</div></div>
<div class="ttc" id="routerlist_8h_html_a91f37bda7b9149b1da0f1abfff66ab23"><div class="ttname"><a href="routerlist_8h.html#a91f37bda7b9149b1da0f1abfff66ab23">authority_certs_fetch_missing</a></div><div class="ttdeci">void authority_certs_fetch_missing(networkstatus_t *status, time_t now, const char *dir_hint)</div><div class="ttdef"><b>Definition:</b> routerlist.c:995</div></div>
<div class="ttc" id="routerlist_8h_html_a36bbf9bf41105f61c8f1f5b6ffc3b12b"><div class="ttname"><a href="routerlist_8h.html#a36bbf9bf41105f61c8f1f5b6ffc3b12b">extrainfo_free</a></div><div class="ttdeci">void extrainfo_free(extrainfo_t *extrainfo)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3229</div></div>
<div class="ttc" id="routerlist_8h_html_aa7aee947ee003a2d2367678bdbbb0aa9"><div class="ttname"><a href="routerlist_8h.html#aa7aee947ee003a2d2367678bdbbb0aa9">signed_descriptor_get_annotations</a></div><div class="ttdeci">const char * signed_descriptor_get_annotations(const signed_descriptor_t *desc)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3167</div></div>
<div class="ttc" id="routerlist_8h_html_ab9228e04209739ed11f23f364b74bfde"><div class="ttname"><a href="routerlist_8h.html#ab9228e04209739ed11f23f364b74bfde">routerlist_free</a></div><div class="ttdeci">void routerlist_free(routerlist_t *rl)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3304</div></div>
<div class="ttc" id="structnode__t_html"><div class="ttname"><a href="structnode__t.html">node_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2333</div></div>
<div class="ttc" id="routerlist_8h_html_a8989395a52cfb9cb553c9eebf44395eb"><div class="ttname"><a href="routerlist_8h.html#a8989395a52cfb9cb553c9eebf44395eb">refresh_all_country_info</a></div><div class="ttdeci">void refresh_all_country_info(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:5800</div></div>
<div class="ttc" id="routerlist_8h_html_a88c116d81fb2aed5dde4a9c8590af12c"><div class="ttname"><a href="routerlist_8h.html#a88c116d81fb2aed5dde4a9c8590af12c">trusted_dirs_reload_certs</a></div><div class="ttdeci">int trusted_dirs_reload_certs(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:469</div></div>
<div class="ttc" id="structtor__addr__t_html"><div class="ttname"><a href="structtor__addr__t.html">tor_addr_t</a></div><div class="ttdef"><b>Definition:</b> address.h:56</div></div>
<div class="ttc" id="routerlist_8h_html_aaf1c16d2f07649504a2f0cb790312337"><div class="ttname"><a href="routerlist_8h.html#aaf1c16d2f07649504a2f0cb790312337">node_sl_choose_by_bandwidth</a></div><div class="ttdeci">const node_t * node_sl_choose_by_bandwidth(const smartlist_t *sl, bandwidth_weight_rule_t rule)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2785</div></div>
<div class="ttc" id="routerlist_8h_html_aaa2e70d04e8e04e2958f64f243e76987"><div class="ttname"><a href="routerlist_8h.html#aaa2e70d04e8e04e2958f64f243e76987">router_get_fallback_dirserver_by_digest</a></div><div class="ttdeci">dir_server_t * router_get_fallback_dirserver_by_digest(const char *digest)</div><div class="ttdef"><b>Definition:</b> routerlist.c:1700</div></div>
<div class="ttc" id="routerlist_8c_html_ab3e64366c95e82de40cac88b7a39ae17"><div class="ttname"><a href="routerlist_8c.html#ab3e64366c95e82de40cac88b7a39ae17">router_pick_directory_server_impl</a></div><div class="ttdeci">STATIC const routerstatus_t * router_pick_directory_server_impl(dirinfo_type_t type, int flags, int *n_busy_out)</div><div class="ttdef"><b>Definition:</b> routerlist.c:1987</div></div>
<div class="ttc" id="routerlist_8h_html_a8b67f737b9ea614297414b26eb3b784c"><div class="ttname"><a href="routerlist_8h.html#a8b67f737b9ea614297414b26eb3b784c">update_router_descriptor_downloads</a></div><div class="ttdeci">void update_router_descriptor_downloads(time_t now)</div><div class="ttdef"><b>Definition:</b> routerlist.c:5287</div></div>
<div class="ttc" id="structsigned__descriptor__t_html"><div class="ttname"><a href="structsigned__descriptor__t.html">signed_descriptor_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2009</div></div>
<div class="ttc" id="routerlist_8h_html_a86f14dd56cbe0cc04a9b096db95a4270"><div class="ttname"><a href="routerlist_8h.html#a86f14dd56cbe0cc04a9b096db95a4270">router_reload_router_list</a></div><div class="ttdeci">int router_reload_router_list(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:1595</div></div>
<div class="ttc" id="routerlist_8h_html_ad6fa9db0634a1b718251a999c4972b21"><div class="ttname"><a href="routerlist_8h.html#ad6fa9db0634a1b718251a999c4972b21">router_get_advertised_bandwidth_capped</a></div><div class="ttdeci">uint32_t router_get_advertised_bandwidth_capped(const routerinfo_t *router)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2398</div></div>
<div class="ttc" id="routerlist_8h_html_a33e8618001c42bd50575051362aaffa2"><div class="ttname"><a href="routerlist_8h.html#a33e8618001c42bd50575051362aaffa2">launch_descriptor_downloads</a></div><div class="ttdeci">void launch_descriptor_downloads(int purpose, smartlist_t *downloadable, const routerstatus_t *source, time_t now)</div><div class="ttdef"><b>Definition:</b> routerlist.c:5031</div></div>
<div class="ttc" id="routerlist_8h_html_a58ed11d2f6808617760386221246b842"><div class="ttname"><a href="routerlist_8h.html#a58ed11d2f6808617760386221246b842">router_pick_fallback_dirserver</a></div><div class="ttdeci">const routerstatus_t * router_pick_fallback_dirserver(dirinfo_type_t type, int flags)</div><div class="ttdef"><b>Definition:</b> routerlist.c:1762</div></div>
<div class="ttc" id="routerlist_8h_html_a8b764a3362e4c3245d5e430925e380f1"><div class="ttname"><a href="routerlist_8h.html#a8b764a3362e4c3245d5e430925e380f1">router_is_named</a></div><div class="ttdeci">int router_is_named(const routerinfo_t *router)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2983</div></div>
<div class="ttc" id="structsmartlist__t_html"><div class="ttname"><a href="structsmartlist__t.html">smartlist_t</a></div><div class="ttdef"><b>Definition:</b> container.h:18</div></div>
<div class="ttc" id="routerlist_8h_html_a6c38eadb28cf4532a7623c5aa1885cec"><div class="ttname"><a href="routerlist_8h.html#a6c38eadb28cf4532a7623c5aa1885cec">router_digest_is_trusted_dir_type</a></div><div class="ttdeci">int router_digest_is_trusted_dir_type(const char *digest, dirinfo_type_t type)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2996</div></div>
<div class="ttc" id="or_8h_html_ae733ffc8e2cde85d0705d947f8f86ada"><div class="ttname"><a href="or_8h.html#ae733ffc8e2cde85d0705d947f8f86ada">dirinfo_type_t</a></div><div class="ttdeci">dirinfo_type_t</div><div class="ttdef"><b>Definition:</b> or.h:2692</div></div>
<div class="ttc" id="namespaced_html"><div class="ttname"><a href="namespaced.html">d</a></div><div class="ttdef"><b>Definition:</b> d.py:1</div></div>
<div class="ttc" id="routerlist_8h_html_a940b9f42b7b36f3fc3721aa2536d7cdf"><div class="ttname"><a href="routerlist_8h.html#a940b9f42b7b36f3fc3721aa2536d7cdf">hexdigest_to_digest</a></div><div class="ttdeci">int hexdigest_to_digest(const char *hexdigest, char *digest)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3028</div></div>
<div class="ttc" id="structnetworkstatus__t_html"><div class="ttname"><a href="structnetworkstatus__t.html">networkstatus_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2506</div></div>
<div class="ttc" id="routerlist_8h_html_af2db10502386ef035c89377d2968c7e0"><div class="ttname"><a href="routerlist_8h.html#af2db10502386ef035c89377d2968c7e0">routerinfo_free</a></div><div class="ttdeci">void routerinfo_free(routerinfo_t *router)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3199</div></div>
<div class="ttc" id="structextrainfo__t_html"><div class="ttname"><a href="structextrainfo__t.html">extrainfo_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2151</div></div>
<div class="ttc" id="routerlist_8h_html_a6bbb04e1dbdbbde5ad2089aac715d9cf"><div class="ttname"><a href="routerlist_8h.html#a6bbb04e1dbdbbde5ad2089aac715d9cf">routerlist_assert_ok</a></div><div class="ttdeci">void routerlist_assert_ok(const routerlist_t *rl)</div><div class="ttdef"><b>Definition:</b> routerlist.c:5671</div></div>
<div class="ttc" id="structtor__addr__port__t_html"><div class="ttname"><a href="structtor__addr__port__t.html">tor_addr_port_t</a></div><div class="ttdef"><b>Definition:</b> address.h:68</div></div>
<div class="ttc" id="or_8h_html_a010ba601a8385178d2aa25beb04b4d9c"><div class="ttname"><a href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a></div><div class="ttdeci">saved_location_t</div><div class="ttdef"><b>Definition:</b> or.h:1885</div></div>
<div class="ttc" id="routerlist_8h_html_a848eea1698b3361538f190f55f2cc0e6"><div class="ttname"><a href="routerlist_8h.html#a848eea1698b3361538f190f55f2cc0e6">router_get_mutable_by_digest</a></div><div class="ttdeci">routerinfo_t * router_get_mutable_by_digest(const char *digest)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3041</div></div>
<div class="ttc" id="routerlist_8h_html_a0642e00994970234101190ca32fbf091"><div class="ttname"><a href="routerlist_8h.html#a0642e00994970234101190ca32fbf091">authority_cert_dl_failed</a></div><div class="ttdeci">void authority_cert_dl_failed(const char *id_digest, const char *signing_key_digest, int status)</div><div class="ttdef"><b>Definition:</b> routerlist.c:827</div></div>
<div class="ttc" id="routerlist_8h_html_afc5cd667e54af0c810a0930e70e27348"><div class="ttname"><a href="routerlist_8h.html#afc5cd667e54af0c810a0930e70e27348">routerlist_find_my_routerinfo</a></div><div class="ttdeci">const routerinfo_t * routerlist_find_my_routerinfo(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2368</div></div>
<div class="ttc" id="routerlist_8h_html_a1cb0d178232a933f8fea51a845f41265"><div class="ttname"><a href="routerlist_8h.html#a1cb0d178232a933f8fea51a845f41265">router_exit_policy_rejects_all</a></div><div class="ttdeci">int router_exit_policy_rejects_all(const routerinfo_t *router)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4604</div></div>
<div class="ttc" id="routerlist_8h_html_a9eb1861cedcb477a2e455b6c02eb56d8"><div class="ttname"><a href="routerlist_8h.html#a9eb1861cedcb477a2e455b6c02eb56d8">router_get_by_id_digest</a></div><div class="ttdeci">const routerinfo_t * router_get_by_id_digest(const char *digest)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3055</div></div>
<div class="ttc" id="routerlist_8h_html_a0240e623457d6c4622dd3d9dad2a652f"><div class="ttname"><a href="routerlist_8h.html#a0240e623457d6c4622dd3d9dad2a652f">router_addr_is_trusted_dir</a></div><div class="ttdeci">int router_addr_is_trusted_dir(uint32_t addr)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3012</div></div>
<div class="ttc" id="routerlist_8h_html_a7b194ad6a42e8fb2ef4f3aa1cf135830"><div class="ttname"><a href="routerlist_8h.html#a7b194ad6a42e8fb2ef4f3aa1cf135830">router_load_single_router</a></div><div class="ttdeci">int router_load_single_router(const char *s, uint8_t purpose, int cache, const char **msg)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4321</div></div>
<div class="ttc" id="routerlist_8h_html_a19e2aa4caae99a8eba67490a4d920794"><div class="ttname"><a href="routerlist_8h.html#a19e2aa4caae99a8eba67490a4d920794">list_pending_microdesc_downloads</a></div><div class="ttdeci">void list_pending_microdesc_downloads(digest256map_t *result)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4875</div></div>
<div class="ttc" id="routerlist_8h_html_ae19d4c9a3cd78d4fbc5e926825704ba0"><div class="ttname"><a href="routerlist_8h.html#ae19d4c9a3cd78d4fbc5e926825704ba0">router_get_trusteddirserver_by_digest</a></div><div class="ttdeci">dir_server_t * router_get_trusteddirserver_by_digest(const char *d)</div><div class="ttdef"><b>Definition:</b> routerlist.c:1679</div></div>
<div class="ttc" id="routerlist_8h_html_ad5591c87fbad96a88fa4d0145431ef87"><div class="ttname"><a href="routerlist_8h.html#ad5591c87fbad96a88fa4d0145431ef87">routerlist_reset_warnings</a></div><div class="ttdeci">void routerlist_reset_warnings(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3811</div></div>
<div class="ttc" id="routerlist_8h_html_a1414b47a61105dd75d01ba4966c511fc"><div class="ttname"><a href="routerlist_8h.html#a1414b47a61105dd75d01ba4966c511fc">authority_cert_is_blacklisted</a></div><div class="ttdeci">int authority_cert_is_blacklisted(const authority_cert_t *cert)</div><div class="ttdef"><b>Definition:</b> routerlist.c:890</div></div>
<div class="ttc" id="routerlist_8h_html_a5062bf36695d11df627a5d3cda2954fe"><div class="ttname"><a href="routerlist_8h.html#a5062bf36695d11df627a5d3cda2954fe">dump_routerlist_mem_usage</a></div><div class="ttdeci">void dump_routerlist_mem_usage(int severity)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3338</div></div>
<div class="ttc" id="routerlist_8h_html_a8c5a2d791ec14d51bceebd0201d884a5"><div class="ttname"><a href="routerlist_8h.html#a8c5a2d791ec14d51bceebd0201d884a5">frac_nodes_with_descriptors</a></div><div class="ttdeci">double frac_nodes_with_descriptors(const smartlist_t *sl, bandwidth_weight_rule_t rule)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2752</div></div>
<div class="ttc" id="routerlist_8h_html_a17969a33c59259ad90394d61997c2e94"><div class="ttname"><a href="routerlist_8h.html#a17969a33c59259ad90394d61997c2e94">router_choose_random_node</a></div><div class="ttdeci">const node_t * router_choose_random_node(smartlist_t *excludedsmartlist, struct routerset_t *excludedset, router_crn_flags_t flags)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2814</div></div>
<div class="ttc" id="routerlist_8h_html_afd0f7cc93c54df7858c6a6fd3f0eb443"><div class="ttname"><a href="routerlist_8h.html#afd0f7cc93c54df7858c6a6fd3f0eb443">hex_digest_nickname_matches</a></div><div class="ttdeci">int hex_digest_nickname_matches(const char *hexdigest, const char *identity_digest, const char *nickname, int is_named)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2958</div></div>
<div class="ttc" id="structrouterlist__t_html"><div class="ttname"><a href="structrouterlist__t.html">routerlist_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2624</div></div>
<div class="ttc" id="structdir__server__t_html"><div class="ttname"><a href="structdir__server__t.html">dir_server_t</a></div><div class="ttdef"><b>Definition:</b> or.h:5226</div></div>
<div class="ttc" id="routerlist_8h_html_a373b610cd5f3f54650e6e7d47ae70263"><div class="ttname"><a href="routerlist_8h.html#a373b610cd5f3f54650e6e7d47ae70263">router_load_extrainfo_from_string</a></div><div class="ttdeci">void router_load_extrainfo_from_string(const char *s, const char *eos, saved_location_t saved_location, smartlist_t *requested_fingerprints, int descriptor_digests)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4487</div></div>
<div class="ttc" id="routerlist_8h_html_ad0e00a6f0df9aace49976da496902957"><div class="ttname"><a href="routerlist_8h.html#ad0e00a6f0df9aace49976da496902957">routerlist_descriptors_added</a></div><div class="ttdeci">void routerlist_descriptors_added(smartlist_t *sl, int from_cache)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4294</div></div>
<div class="ttc" id="routerlist_8h_html_a4fab5ecf53641fa3ee384520aaa22e41"><div class="ttname"><a href="routerlist_8h.html#a4fab5ecf53641fa3ee384520aaa22e41">router_reset_status_download_failures</a></div><div class="ttdeci">void router_reset_status_download_failures(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2300</div></div>
<div class="ttc" id="routerlist_8h_html_ad96c8d565baf8a82010f5adfacb99060"><div class="ttname"><a href="routerlist_8h.html#ad96c8d565baf8a82010f5adfacb99060">router_pick_trusteddirserver</a></div><div class="ttdeci">const routerstatus_t * router_pick_trusteddirserver(dirinfo_type_t type, int flags)</div><div class="ttdef"><b>Definition:</b> routerlist.c:1753</div></div>
<div class="ttc" id="routerlist_8h_html_a2bb77cd705f2c621023fff9a114c01bf"><div class="ttname"><a href="routerlist_8h.html#a2bb77cd705f2c621023fff9a114c01bf">authority_cert_free</a></div><div class="ttdeci">void authority_cert_free(authority_cert_t *cert)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4770</div></div>
<div class="ttc" id="routerlist_8h_html_ab1878aef0f1dd92c783d5477248b985d"><div class="ttname"><a href="routerlist_8h.html#ab1878aef0f1dd92c783d5477248b985d">router_add_to_routerlist</a></div><div class="ttdeci">was_router_added_t router_add_to_routerlist(routerinfo_t *router, const char **msg, int from_cache, int from_fetch)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3850</div></div>
<div class="ttc" id="routerlist_8h_html_a58983e59cd226450674e7a11edc59dad"><div class="ttname"><a href="routerlist_8h.html#a58983e59cd226450674e7a11edc59dad">authority_cert_get_by_digests</a></div><div class="ttdeci">authority_cert_t * authority_cert_get_by_digests(const char *id_digest, const char *sk_digest)</div><div class="ttdef"><b>Definition:</b> routerlist.c:794</div></div>
<div class="ttc" id="routerlist_8h_html_aaf38df620524abf6789bd31196b07697"><div class="ttname"><a href="routerlist_8h.html#aaf38df620524abf6789bd31196b07697">routers_sort_by_identity</a></div><div class="ttdeci">void routers_sort_by_identity(smartlist_t *routers)</div><div class="ttdef"><b>Definition:</b> routerlist.c:5791</div></div>
<div class="ttc" id="routerlist_8h_html_a9bd4c9992a1cf27e95e2829ae40c7b79"><div class="ttname"><a href="routerlist_8h.html#a9bd4c9992a1cf27e95e2829ae40c7b79">dir_server_add</a></div><div class="ttdeci">void dir_server_add(dir_server_t *ent)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4754</div></div>
<div class="ttc" id="structdownload__status__t_html"><div class="ttname"><a href="structdownload__status__t.html">download_status_t</a></div><div class="ttdef"><b>Definition:</b> or.h:1969</div></div>
<div class="ttc" id="routerlist_8h_html_ac41971537948013e1684f04ae286affd"><div class="ttname"><a href="routerlist_8h.html#ac41971537948013e1684f04ae286affd">router_differences_are_cosmetic</a></div><div class="ttdeci">int router_differences_are_cosmetic(const routerinfo_t *r1, const routerinfo_t *r2)</div><div class="ttdef"><b>Definition:</b> routerlist.c:5441</div></div>
<div class="ttc" id="routerlist_8h_html_ab31a672081329b253fe2d46a506cc2f2"><div class="ttname"><a href="routerlist_8h.html#ab31a672081329b253fe2d46a506cc2f2">trusted_dir_server_new</a></div><div class="ttdeci">dir_server_t * trusted_dir_server_new(const char *nickname, const char *address, uint16_t dir_port, uint16_t or_port, const tor_addr_port_t *addrport_ipv6, const char *digest, const char *v3_auth_digest, dirinfo_type_t type, double weight)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4696</div></div>
<div class="ttc" id="routerlist_8h_html_af0674d915ac20d064542496c8a8c2c26"><div class="ttname"><a href="routerlist_8h.html#af0674d915ac20d064542496c8a8c2c26">authority_cert_dl_looks_uncertain</a></div><div class="ttdeci">int authority_cert_dl_looks_uncertain(const char *id_digest)</div><div class="ttdef"><b>Definition:</b> routerlist.c:909</div></div>
<div class="ttc" id="routerlist_8h_html_a8c328828cd94c3bb84044c9003f8c78f"><div class="ttname"><a href="routerlist_8h.html#a8c328828cd94c3bb84044c9003f8c78f">routerlist_remove</a></div><div class="ttdeci">void routerlist_remove(routerlist_t *rl, routerinfo_t *ri, int make_old, time_t now)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3549</div></div>
<div class="ttc" id="routerlist_8h_html_aa0f6ecb349cc9b484a19c1a0397dc1ed"><div class="ttname"><a href="routerlist_8h.html#aa0f6ecb349cc9b484a19c1a0397dc1ed">router_digest_is_fallback_dir</a></div><div class="ttdeci">int router_digest_is_fallback_dir(const char *digest)</div><div class="ttdef"><b>Definition:</b> routerlist.c:1724</div></div>
<div class="ttc" id="or_8h_html_afec7ed946efd497dc5d098510c5a2d87"><div class="ttname"><a href="or_8h.html#afec7ed946efd497dc5d098510c5a2d87">bandwidth_weight_rule_t</a></div><div class="ttdeci">bandwidth_weight_rule_t</div><div class="ttdef"><b>Definition:</b> or.h:5303</div></div>
<div class="ttc" id="routerlist_8h_html_a9181bbed0ee6ff8088a7c53fc8c446f1"><div class="ttname"><a href="routerlist_8h.html#a9181bbed0ee6ff8088a7c53fc8c446f1">router_get_routerlist</a></div><div class="ttdeci">routerlist_t * router_get_routerlist(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3174</div></div>
<div class="ttc" id="routerlist_8h_html_a91d657f054dd82fbaf519c02deb5ec51"><div class="ttname"><a href="routerlist_8h.html#a91d657f054dd82fbaf519c02deb5ec51">router_add_extrainfo_to_routerlist</a></div><div class="ttdeci">was_router_added_t router_add_extrainfo_to_routerlist(extrainfo_t *ei, const char **msg, int from_cache, int from_fetch)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4026</div></div>
<div class="ttc" id="routerlist_8h_html_a3ed4f55736541adee60a83e8442d4d4f"><div class="ttname"><a href="routerlist_8h.html#a3ed4f55736541adee60a83e8442d4d4f">routerinfo_incompatible_with_extrainfo</a></div><div class="ttdeci">int routerinfo_incompatible_with_extrainfo(const crypto_pk_t *ri, extrainfo_t *ei, signed_descriptor_t *sd, const char **msg)</div><div class="ttdef"><b>Definition:</b> routerlist.c:5534</div></div>
<div class="ttc" id="routerlist_8h_html_ace83aa582c6836e9a172a8cafa1d4047"><div class="ttname"><a href="routerlist_8h.html#ace83aa582c6836e9a172a8cafa1d4047">router_pick_directory_server</a></div><div class="ttdeci">const routerstatus_t * router_pick_directory_server(dirinfo_type_t type, int flags)</div><div class="ttdef"><b>Definition:</b> routerlist.c:1644</div></div>
<div class="ttc" id="routerlist_8h_html_ae08c5697c58be20a7bb11b34ca9aba5e"><div class="ttname"><a href="routerlist_8h.html#ae08c5697c58be20a7bb11b34ca9aba5e">router_load_routers_from_string</a></div><div class="ttdeci">int router_load_routers_from_string(const char *s, const char *eos, saved_location_t saved_location, smartlist_t *requested_fingerprints, int descriptor_digests, const char *prepend_annotations)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4388</div></div>
<div class="ttc" id="structcrypto__pk__t_html"><div class="ttname"><a href="structcrypto__pk__t.html">crypto_pk_t</a></div><div class="ttdef"><b>Definition:</b> crypto.c:120</div></div>
<div class="ttc" id="routerlist_8h_html_aba23320c5a1abde91478e430c7bd42bd"><div class="ttname"><a href="routerlist_8h.html#aba23320c5a1abde91478e430c7bd42bd">router_add_running_nodes_to_smartlist</a></div><div class="ttdeci">void router_add_running_nodes_to_smartlist(smartlist_t *sl, int allow_invalid, int need_uptime, int need_capacity, int need_guard, int need_desc, int pref_addr, int direct_conn)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2330</div></div>
<div class="ttc" id="routerlist_8h_html_adc3015689729ebc1c085666a99b80a10"><div class="ttname"><a href="routerlist_8h.html#adc3015689729ebc1c085666a99b80a10">router_reset_descriptor_download_failures</a></div><div class="ttdeci">void router_reset_descriptor_download_failures(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:5411</div></div>
<div class="ttc" id="routerlist_8h_html_a6ffeae0d92b2c4eec18c14453732f726"><div class="ttname"><a href="routerlist_8h.html#a6ffeae0d92b2c4eec18c14453732f726">clear_dir_servers</a></div><div class="ttdeci">void clear_dir_servers(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4797</div></div>
<div class="ttc" id="routerlist_8h_html_afd620fb5cbc29f6895ae016c0240d9a6"><div class="ttname"><a href="routerlist_8h.html#afd620fb5cbc29f6895ae016c0240d9a6">esc_router_info</a></div><div class="ttdeci">const char * esc_router_info(const routerinfo_t *router)</div><div class="ttdef"><b>Definition:</b> routerlist.c:5759</div></div>
<div class="ttc" id="routerlist_8h_html_a9b25dd842df15283a342bb77cf5935a8"><div class="ttname"><a href="routerlist_8h.html#a9b25dd842df15283a342bb77cf5935a8">routers_have_same_or_addrs</a></div><div class="ttdeci">int routers_have_same_or_addrs(const routerinfo_t *r1, const routerinfo_t *r2)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2290</div></div>
<div class="ttc" id="routerlist_8h_html_af4d8bdd829c8eab4c9060c014fb59af8"><div class="ttname"><a href="routerlist_8h.html#af4d8bdd829c8eab4c9060c014fb59af8">signed_descriptor_get_body</a></div><div class="ttdeci">const char * signed_descriptor_get_body(const signed_descriptor_t *desc)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3159</div></div>
<div class="ttc" id="routerlist_8h_html_aab0f360909c4cc3732e5f9541cf595bb"><div class="ttname"><a href="routerlist_8h.html#aab0f360909c4cc3732e5f9541cf595bb">router_get_by_descriptor_digest</a></div><div class="ttdeci">signed_descriptor_t * router_get_by_descriptor_digest(const char *digest)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3063</div></div>
<div class="ttc" id="or_8h_html_a274fd236a2f0fc116815f9077f5ca82c"><div class="ttname"><a href="or_8h.html#a274fd236a2f0fc116815f9077f5ca82c">router_crn_flags_t</a></div><div class="ttdeci">router_crn_flags_t</div><div class="ttdef"><b>Definition:</b> or.h:5310</div></div>
<div class="ttc" id="routerlist_8c_html_a8b22797a2be55707af8334b747d51047"><div class="ttname"><a href="routerlist_8c.html#a8b22797a2be55707af8334b747d51047">choose_array_element_by_weight</a></div><div class="ttdeci">STATIC int choose_array_element_by_weight(const uint64_t *entries, int n_entries)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2442</div></div>
<div class="ttc" id="routerlist_8h_html_ad504742ed3340ecce532e798d3304c82"><div class="ttname"><a href="routerlist_8h.html#ad504742ed3340ecce532e798d3304c82">routerlist_remove_old_routers</a></div><div class="ttdeci">void routerlist_remove_old_routers(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4168</div></div>
<div class="ttc" id="routerlist_8h_html_a0a6e87e7775e3d61a3a0f2cb14f78ea1"><div class="ttname"><a href="routerlist_8h.html#a0a6e87e7775e3d61a3a0f2cb14f78ea1">trusted_dirs_load_certs_from_string</a></div><div class="ttdeci">int trusted_dirs_load_certs_from_string(const char *contents, int source, int flush, const char *source_dir)</div><div class="ttdef"><b>Definition:</b> routerlist.c:518</div></div>
<div class="ttc" id="structrouterstatus__t_html"><div class="ttname"><a href="structrouterstatus__t.html">routerstatus_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2169</div></div>
<div class="ttc" id="routerlist_8h_html_ab24c5c3729a4bf122f277447df1c5e8c"><div class="ttname"><a href="routerlist_8h.html#ab24c5c3729a4bf122f277447df1c5e8c">authority_cert_get_by_sk_digest</a></div><div class="ttdeci">authority_cert_t * authority_cert_get_by_sk_digest(const char *sk_digest)</div><div class="ttdef"><b>Definition:</b> routerlist.c:767</div></div>
<div class="ttc" id="routerlist_8h_html_ab576efc7049ed4eca6fa56e9f0544844"><div class="ttname"><a href="routerlist_8h.html#ab576efc7049ed4eca6fa56e9f0544844">update_extrainfo_downloads</a></div><div class="ttdeci">void update_extrainfo_downloads(time_t now)</div><div class="ttdef"><b>Definition:</b> routerlist.c:5301</div></div>
<div class="ttc" id="structauthority__cert__t_html"><div class="ttname"><a href="structauthority__cert__t.html">authority_cert_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2666</div></div>
<div class="ttc" id="routerlist_8h_html_a087a998f551e9fff456d9e4ce662668e"><div class="ttname"><a href="routerlist_8h.html#a087a998f551e9fff456d9e4ce662668e">routerlist_free_all</a></div><div class="ttdeci">void routerlist_free_all(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3789</div></div>
<div class="ttc" id="routerlist_8h_html_ab49c0521b1d8a01f75abf4438992fd08"><div class="ttname"><a href="routerlist_8h.html#ab49c0521b1d8a01f75abf4438992fd08">extrainfo_get_by_descriptor_digest</a></div><div class="ttdeci">signed_descriptor_t * extrainfo_get_by_descriptor_digest(const char *digest)</div><div class="ttdef"><b>Definition:</b> routerlist.c:3089</div></div>
<div class="ttc" id="routerlist_8h_html_a52db265aafa57b000917a06850363fcd"><div class="ttname"><a href="routerlist_8h.html#a52db265aafa57b000917a06850363fcd">routerlist_retry_directory_downloads</a></div><div class="ttdeci">void routerlist_retry_directory_downloads(time_t now)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4589</div></div>
<div class="ttc" id="routerlist_8h_html_a529cee5c17927c3dd0bbab47b5530ced"><div class="ttname"><a href="routerlist_8h.html#a529cee5c17927c3dd0bbab47b5530ced">router_get_advertised_bandwidth</a></div><div class="ttdeci">uint32_t router_get_advertised_bandwidth(const routerinfo_t *router)</div><div class="ttdef"><b>Definition:</b> routerlist.c:2384</div></div>
<div class="ttc" id="structrouterinfo__t_html"><div class="ttname"><a href="structrouterinfo__t.html">routerinfo_t</a></div><div class="ttdef"><b>Definition:</b> or.h:2060</div></div>
<div class="ttc" id="routerlist_8h_html_afe7f2c6bcc3135272bc6aa66ec09cd76"><div class="ttname"><a href="routerlist_8h.html#afe7f2c6bcc3135272bc6aa66ec09cd76">update_all_descriptor_downloads</a></div><div class="ttdeci">void update_all_descriptor_downloads(time_t now)</div><div class="ttdef"><b>Definition:</b> routerlist.c:4577</div></div>
<div class="ttc" id="routerlist_8h_html_acb91993a221f80d7896395babb122f0a"><div class="ttname"><a href="routerlist_8h.html#acb91993a221f80d7896395babb122f0a">trusted_dirs_flush_certs_to_disk</a></div><div class="ttdeci">void trusted_dirs_flush_certs_to_disk(void)</div><div class="ttdef"><b>Definition:</b> routerlist.c:645</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
