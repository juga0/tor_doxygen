<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/control.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">control.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation for Tor's control-socket interface.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;addressmap.h&quot;</code><br />
<code>#include &quot;<a class="el" href="bridges_8h_source.html">bridges.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buffers_8h_source.html">buffers.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="channel_8h_source.html">channel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="channeltls_8h_source.html">channeltls.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitbuild_8h_source.html">circuitbuild.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitlist_8h_source.html">circuitlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitstats_8h_source.html">circuitstats.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuituse_8h_source.html">circuituse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="command_8h_source.html">command.h</a>&quot;</code><br />
<code>#include &quot;compat_libevent.h&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;confparse.h&quot;</code><br />
<code>#include &quot;<a class="el" href="connection_8h_source.html">connection.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="connection__edge_8h_source.html">connection_edge.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="connection__or_8h_source.html">connection_or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="control_8h_source.html">control.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__rand_8h_source.html">crypto_rand.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__util_8h_source.html">crypto_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="directory_8h_source.html">directory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dirserv_8h_source.html">dirserv.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dnsserv_8h_source.html">dnsserv.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="entrynodes_8h_source.html">entrynodes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="geoip_8h_source.html">geoip.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hibernate_8h_source.html">hibernate.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hs__cache_8h_source.html">hs_cache.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hs__common_8h_source.html">hs_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hs__control_8h_source.html">hs_control.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="main_8h_source.html">main.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="microdesc_8h_source.html">microdesc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="networkstatus_8h_source.html">networkstatus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nodelist_8h_source.html">nodelist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="policies_8h_source.html">policies.h</a>&quot;</code><br />
<code>#include &quot;proto_control0.h&quot;</code><br />
<code>#include &quot;proto_http.h&quot;</code><br />
<code>#include &quot;<a class="el" href="reasons_8h_source.html">reasons.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendclient_8h_source.html">rendclient.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendcommon_8h_source.html">rendcommon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendservice_8h_source.html">rendservice.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rephist_8h_source.html">rephist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="router_8h_source.html">router.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerlist_8h_source.html">routerlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerparse_8h_source.html">routerparse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="shared__random__client_8h_source.html">shared_random_client.h</a>&quot;</code><br />
<code>#include &lt;pwd.h&gt;</code><br />
<code>#include &lt;sys/resource.h&gt;</code><br />
<code>#include &quot;crypto_s2k.h&quot;</code><br />
<code>#include &quot;<a class="el" href="procmon_8h_source.html">procmon.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for control.c:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2control_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2control_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2control_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="266,259,310,285"/>
<area shape="rect" id="node3" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="224,333,352,360"/>
<area shape="rect" id="node4" href="addressmap_8h_source.html" title="addressmap.h" alt="" coords="714,109,818,136"/>
<area shape="rect" id="node5" href="bridges_8h.html" title="Header file for circuitbuild.c. " alt="" coords="842,109,917,136"/>
<area shape="rect" id="node6" href="buffers_8h.html" title="Header file for buffers.c. " alt="" coords="995,184,1068,211"/>
<area shape="rect" id="node7" href="channel_8h.html" title="Header file for channel.c. " alt="" coords="248,184,327,211"/>
<area shape="rect" id="node8" href="channeltls_8h.html" title="Header file for channeltls.c. " alt="" coords="331,109,423,136"/>
<area shape="rect" id="node9" href="circuitbuild_8h.html" title="Header file for circuitbuild.c. " alt="" coords="1112,109,1207,136"/>
<area shape="rect" id="node10" href="circuitlist_8h.html" title="Header file for circuitlist.c. " alt="" coords="1232,109,1317,136"/>
<area shape="rect" id="node11" href="circuitstats_8h.html" title="Header file for circuitstats.c. " alt="" coords="1342,109,1439,136"/>
<area shape="rect" id="node12" href="circuituse_8h.html" title="Header file for circuituse.c. " alt="" coords="1463,109,1552,136"/>
<area shape="rect" id="node13" href="command_8h.html" title="Header file for command.c. " alt="" coords="165,109,256,136"/>
<area shape="rect" id="node14" href="config_8h.html" title="Header file for config.c. " alt="" coords="1576,109,1644,136"/>
<area shape="rect" id="node15" href="confparse_8h_source.html" title="confparse.h" alt="" coords="1669,109,1760,136"/>
<area shape="rect" id="node16" href="connection_8h.html" title="Header file for connection.c. " alt="" coords="941,109,1037,136"/>
<area shape="rect" id="node17" href="connection__edge_8h.html" title="Header file for connection_edge.c. " alt="" coords="1784,109,1914,136"/>
<area shape="rect" id="node18" href="connection__or_8h.html" title="Header file for connection_or.c. " alt="" coords="1938,109,2053,136"/>
<area shape="rect" id="node19" href="control_8h.html" title="Header file for control.c. " alt="" coords="2077,109,2149,136"/>
<area shape="rect" id="node20" href="crypto__rand_8h.html" title="Common functions for using (pseudo&#45;)random number generators. " alt="" coords="2173,109,2274,136"/>
<area shape="rect" id="node21" href="crypto__util_8h.html" title="Common functions for cryptographic routines. " alt="" coords="2298,109,2392,136"/>
<area shape="rect" id="node22" href="directory_8h.html" title="Header file for directory.c. " alt="" coords="2416,109,2498,136"/>
<area shape="rect" id="node23" href="dirserv_8h.html" title="Header file for dirserv.c. " alt="" coords="2522,109,2594,136"/>
<area shape="rect" id="node24" href="dnsserv_8h.html" title="Header file for dnsserv.c. " alt="" coords="2619,109,2698,136"/>
<area shape="rect" id="node25" href="entrynodes_8h.html" title="Header file for circuitbuild.c. " alt="" coords="2722,109,2819,136"/>
<area shape="rect" id="node26" href="geoip_8h.html" title="Header file for geoip.c. " alt="" coords="2844,109,2908,136"/>
<area shape="rect" id="node27" href="hibernate_8h.html" title="Header file for hibernate.c. " alt="" coords="2932,109,3019,136"/>
<area shape="rect" id="node28" href="hs__cache_8h.html" title="Header file for hs_cache.c. " alt="" coords="499,109,588,136"/>
<area shape="rect" id="node29" href="hs__common_8h.html" title="Header file containing common data for the whole HS subsytem. " alt="" coords="402,184,506,211"/>
<area shape="rect" id="node30" href="rendcommon_8h.html" title="Header file for rendcommon.c. " alt="" coords="531,184,639,211"/>
<area shape="rect" id="node31" href="hs__control_8h.html" title="Header file containing control port event related code. " alt="" coords="3044,109,3137,136"/>
<area shape="rect" id="node32" href="main_8h.html" title="Header file for main.c. " alt="" coords="3161,109,3222,136"/>
<area shape="rect" id="node33" href="microdesc_8h.html" title="Header file for microdesc.c. " alt="" coords="3246,109,3340,136"/>
<area shape="rect" id="node34" href="networkstatus_8h.html" title="Header file for networkstatus.c. " alt="" coords="3364,109,3478,136"/>
<area shape="rect" id="node35" href="nodelist_8h.html" title="Header file for nodelist.c. " alt="" coords="3503,109,3582,136"/>
<area shape="rect" id="node36" href="policies_8h.html" title="Header file for policies.c. " alt="" coords="3606,109,3684,136"/>
<area shape="rect" id="node37" href="proto__control0_8h_source.html" title="proto_control0.h" alt="" coords="3708,109,3822,136"/>
<area shape="rect" id="node38" href="proto__http_8h_source.html" title="proto_http.h" alt="" coords="3846,109,3937,136"/>
<area shape="rect" id="node39" href="reasons_8h.html" title="Header file for reasons.c. " alt="" coords="3962,109,4040,136"/>
<area shape="rect" id="node40" href="rendclient_8h.html" title="Header file for rendclient.c. " alt="" coords="4064,109,4154,136"/>
<area shape="rect" id="node41" href="rendservice_8h.html" title="Header file for rendservice.c. " alt="" coords="27,184,127,211"/>
<area shape="rect" id="node42" href="rephist_8h.html" title="Header file for rephist.c. " alt="" coords="4178,109,4250,136"/>
<area shape="rect" id="node43" href="router_8h.html" title="Header file for router.c. " alt="" coords="4274,109,4341,136"/>
<area shape="rect" id="node44" href="routerlist_8h.html" title="Header file for routerlist.c. " alt="" coords="4365,109,4448,136"/>
<area shape="rect" id="node45" href="routerparse_8h.html" title="Header file for routerparse.c. " alt="" coords="4472,109,4570,136"/>
<area shape="rect" id="node46" href="shared__random__client_8h.html" title="Header file for shared_random_client.c. " alt="" coords="4594,109,4754,136"/>
<area shape="rect" id="node49" href="crypto__s2k_8h_source.html" title="crypto_s2k.h" alt="" coords="4992,109,5090,136"/>
<area shape="rect" id="node50" href="procmon_8h.html" title="Headers for procmon.c. " alt="" coords="485,259,568,285"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structqueued__event__s.html">queued_event_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcontrol__event__t.html">control_event_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsignal__t.html">signal_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgetinfo__item__t.html">getinfo_item_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>cached_bw_event_s</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a529836cead9bc22eb0a1f51472034e80"><td class="memItemLeft" align="right" valign="top"><a id="a529836cead9bc22eb0a1f51472034e80"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CONTROL_PRIVATE</b></td></tr>
<tr class="separator:a529836cead9bc22eb0a1f51472034e80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a891794d9838a445210cb070c284656a5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a891794d9838a445210cb070c284656a5">STATE_IS_OPEN</a>(s)&#160;&#160;&#160;((s) == <a class="el" href="or_8h.html#a9360196a07cc959e0325943375af32d8">CONTROL_CONN_STATE_OPEN</a>)</td></tr>
<tr class="separator:a891794d9838a445210cb070c284656a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c6516221d89f0b2355a553950ee5829"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a1c6516221d89f0b2355a553950ee5829">EVENT_IS_INTERESTING</a>(e)&#160;&#160;&#160;(!! (global_event_mask &amp; EVENT_MASK_(e)))</td></tr>
<tr class="separator:a1c6516221d89f0b2355a553950ee5829"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff97f4aa113ab62b61d865d5d3c4724d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#aff97f4aa113ab62b61d865d5d3c4724d">ANY_EVENT_IS_INTERESTING</a>(e)&#160;&#160;&#160;(!! (global_event_mask &amp; (e)))</td></tr>
<tr class="separator:aff97f4aa113ab62b61d865d5d3c4724d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaab749d06c1a84ec27463752fb227ad5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#aaab749d06c1a84ec27463752fb227ad5">AUTHENTICATION_COOKIE_LEN</a>&#160;&#160;&#160;32</td></tr>
<tr class="separator:aaab749d06c1a84ec27463752fb227ad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc7f2031f34d922a94bd6dd9b2be5556"><td class="memItemLeft" align="right" valign="top"><a id="abc7f2031f34d922a94bd6dd9b2be5556"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SAFECOOKIE_SERVER_TO_CONTROLLER_CONSTANT</b>&#160;&#160;&#160;&quot;Tor safe cookie authentication server-to-controller hash&quot;</td></tr>
<tr class="separator:abc7f2031f34d922a94bd6dd9b2be5556"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75601561e3f474cb45c80e5d95d12344"><td class="memItemLeft" align="right" valign="top"><a id="a75601561e3f474cb45c80e5d95d12344"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SAFECOOKIE_CONTROLLER_TO_SERVER_CONSTANT</b>&#160;&#160;&#160;&quot;Tor safe cookie authentication controller-to-server hash&quot;</td></tr>
<tr class="separator:a75601561e3f474cb45c80e5d95d12344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4a0650c4340678d60419ed3a1bc543e"><td class="memItemLeft" align="right" valign="top"><a id="aa4a0650c4340678d60419ed3a1bc543e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SAFECOOKIE_SERVER_NONCE_LEN</b>&#160;&#160;&#160;<a class="el" href="crypto__digest_8h.html#a34e055abb21d9f47b5f3d821e4beb091">DIGEST256_LEN</a></td></tr>
<tr class="separator:aa4a0650c4340678d60419ed3a1bc543e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a213fb63ea766eb6ee39839947219f55b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a213fb63ea766eb6ee39839947219f55b">BOOTSTRAP_MSG_LEN</a>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:a213fb63ea766eb6ee39839947219f55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa2a20bd43abf70b852dc7885ae148ad"><td class="memItemLeft" align="right" valign="top"><a id="aaa2a20bd43abf70b852dc7885ae148ad"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NEWLY_ENABLED</b>(ev)&#160;&#160;&#160;(! (old_mask &amp; (ev)) &amp;&amp; (new_mask &amp; (ev)))</td></tr>
<tr class="separator:aaa2a20bd43abf70b852dc7885ae148ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfcc73ba8755bb83f87a2354aafe22fa"><td class="memItemLeft" align="right" valign="top"><a id="adfcc73ba8755bb83f87a2354aafe22fa"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>queued_event_free</b>(ev)&#160;&#160;&#160;FREE_AND_NULL(<a class="el" href="control_8c.html#a96479016ed9454057dacd4502232dc71">queued_event_t</a>, queued_event_free_, (ev))</td></tr>
<tr class="separator:adfcc73ba8755bb83f87a2354aafe22fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e648154620a303b70a3597d1bbc41ab"><td class="memItemLeft" align="right" valign="top"><a id="a5e648154620a303b70a3597d1bbc41ab"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ITEM</b>(name,  fn,  desc)&#160;&#160;&#160;{ name, getinfo_helper_##fn, desc, 0 }</td></tr>
<tr class="separator:a5e648154620a303b70a3597d1bbc41ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f64b0bf996e07dee017493138359200"><td class="memItemLeft" align="right" valign="top"><a id="a9f64b0bf996e07dee017493138359200"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PREFIX</b>(name,  fn,  desc)&#160;&#160;&#160;{ name, getinfo_helper_##fn, desc, 1 }</td></tr>
<tr class="separator:a9f64b0bf996e07dee017493138359200"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaf08894772761e05d6044826c057f3c"><td class="memItemLeft" align="right" valign="top"><a id="afaf08894772761e05d6044826c057f3c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DOC</b>(name,  desc)&#160;&#160;&#160;{ name, NULL, desc, 0 }</td></tr>
<tr class="separator:afaf08894772761e05d6044826c057f3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25d93fcb978c543a89f21db41685980b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a25d93fcb978c543a89f21db41685980b">MAX_COMMAND_LINE_LENGTH</a>&#160;&#160;&#160;(1024*1024)</td></tr>
<tr class="separator:a25d93fcb978c543a89f21db41685980b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d5ca9b790589951c37c8c1d3f11a8da"><td class="memItemLeft" align="right" valign="top"><a id="a7d5ca9b790589951c37c8c1d3f11a8da"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>N_BW_EVENTS_TO_CACHE</b>&#160;&#160;&#160;300</td></tr>
<tr class="separator:a7d5ca9b790589951c37c8c1d3f11a8da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb88f5b74df4a4f380b555e05bde8daf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>CONTROL_EVENT_STATUS_BODY</b>(event,  sev)</td></tr>
<tr class="separator:afb88f5b74df4a4f380b555e05bde8daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1b92674ea52c2c31377432d3114b95a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ac1b92674ea52c2c31377432d3114b95a">BOOTSTRAP_PROBLEM_THRESHOLD</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:ac1b92674ea52c2c31377432d3114b95a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9279b215d6781141e6ebe98551965e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ac9279b215d6781141e6ebe98551965e5">BOOTSTRAP_PCT_INCREMENT</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:ac9279b215d6781141e6ebe98551965e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a2dcff8985975867dd448ef5c4fbc1a64"><td class="memItemLeft" align="right" valign="top">typedef uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a2dcff8985975867dd448ef5c4fbc1a64">event_mask_t</a></td></tr>
<tr class="separator:a2dcff8985975867dd448ef5c4fbc1a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96479016ed9454057dacd4502232dc71"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structqueued__event__s.html">queued_event_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a96479016ed9454057dacd4502232dc71">queued_event_t</a></td></tr>
<tr class="separator:a96479016ed9454057dacd4502232dc71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7aea298a84afd1cb16a8032279bb155"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ad7aea298a84afd1cb16a8032279bb155">getinfo_helper_t</a>) (<a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *, const char *q, char **a, const char **error_out)</td></tr>
<tr class="separator:ad7aea298a84afd1cb16a8032279bb155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ca8540163b746f9fbec9e224213d665"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structgetinfo__item__t.html">getinfo_item_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a9ca8540163b746f9fbec9e224213d665">getinfo_item_t</a></td></tr>
<tr class="separator:a9ca8540163b746f9fbec9e224213d665"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ade569bf3dbd2110f2ac817428885f0b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ade569bf3dbd2110f2ac817428885f0b9">control_update_global_event_mask</a> (void)</td></tr>
<tr class="separator:ade569bf3dbd2110f2ac817428885f0b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f5ce05444faa77077480ce8327d878"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a91f5ce05444faa77077480ce8327d878">control_adjust_event_log_severity</a> (void)</td></tr>
<tr class="separator:a91f5ce05444faa77077480ce8327d878"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bba7fc2c25aada4416d77a64caa4219"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a7bba7fc2c25aada4416d77a64caa4219">control_event_is_interesting</a> (int event)</td></tr>
<tr class="separator:a7bba7fc2c25aada4416d77a64caa4219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa7eff3569fc8e5e5e27c1d6d9f02125"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#afa7eff3569fc8e5e5e27c1d6d9f02125">control_any_per_second_event_enabled</a> (void)</td></tr>
<tr class="separator:afa7eff3569fc8e5e5e27c1d6d9f02125"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1881d4083d31106d2108a1ac919ac4e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ae1881d4083d31106d2108a1ac919ac4e">control_per_second_events</a> (void)</td></tr>
<tr class="separator:ae1881d4083d31106d2108a1ac919ac4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2fafbf3893d3223323b28be3324b199"><td class="memItemLeft" align="right" valign="top">STATIC size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#af2fafbf3893d3223323b28be3324b199">write_escaped_data</a> (const char *data, size_t len, char **out)</td></tr>
<tr class="separator:af2fafbf3893d3223323b28be3324b199"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdb9c00c330d8c723c5e307c46aa7387"><td class="memItemLeft" align="right" valign="top">STATIC size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#abdb9c00c330d8c723c5e307c46aa7387">read_escaped_data</a> (const char *data, size_t len, char **out)</td></tr>
<tr class="separator:abdb9c00c330d8c723c5e307c46aa7387"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b5fbf9ddc3b167562660a53442f004f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a1b5fbf9ddc3b167562660a53442f004f">control_connection_add_local_fd</a> (tor_socket_t sock, unsigned flags)</td></tr>
<tr class="separator:a1b5fbf9ddc3b167562660a53442f004f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0381183e4e119ef80562083e5d6305fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a0381183e4e119ef80562083e5d6305fe">control_ports_write_to_file</a> (void)</td></tr>
<tr class="separator:a0381183e4e119ef80562083e5d6305fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a590753eb9db711112424117649f5cfa7"><td class="memItemLeft" align="right" valign="top"><a id="a590753eb9db711112424117649f5cfa7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>control_initialize_event_queue</b> (void)</td></tr>
<tr class="separator:a590753eb9db711112424117649f5cfa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbfd2697ea512e2df42fc31c8e1d208a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#afbfd2697ea512e2df42fc31c8e1d208a">MOCK_IMPL</a> (STATIC void, queue_control_event_string,(uint16_t event, char *msg))</td></tr>
<tr class="separator:afbfd2697ea512e2df42fc31c8e1d208a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8920daea607720e420120036eafa61f8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a8920daea607720e420120036eafa61f8">MOCK_IMPL</a> (STATIC void, send_control_event_string,(uint16_t event, const char *msg))</td></tr>
<tr class="separator:a8920daea607720e420120036eafa61f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab464eef1adbc6df3fcc09063dc6f9c3e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ab464eef1adbc6df3fcc09063dc6f9c3e">decode_hashed_passwords</a> (<a class="el" href="structconfig__line__t.html">config_line_t</a> *passwords)</td></tr>
<tr class="separator:ab464eef1adbc6df3fcc09063dc6f9c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa944da80f923edd033b270cb4b84cba"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#aaa944da80f923edd033b270cb4b84cba">getinfo_helper_current_time</a> (<a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *control_conn, const char *question, char **answer, const char **errmsg)</td></tr>
<tr class="separator:aaa944da80f923edd033b270cb4b84cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafbf616bddc3f380f8c682ed7550e3c4"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#aafbf616bddc3f380f8c682ed7550e3c4">getinfo_helper_dir</a> (<a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *control_conn, const char *question, char **answer, const char **errmsg)</td></tr>
<tr class="separator:aafbf616bddc3f380f8c682ed7550e3c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaee0cff899e0420de1d16379fffe98c8"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#aaee0cff899e0420de1d16379fffe98c8">getinfo_helper_downloads_networkstatus</a> (const char *flavor, <a class="el" href="structdownload__status__t.html">download_status_t</a> **dl_to_emit, const char **errmsg)</td></tr>
<tr class="separator:aaee0cff899e0420de1d16379fffe98c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb5aa2ca5fb7e5db504bf1d3ff1342c5"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#afb5aa2ca5fb7e5db504bf1d3ff1342c5">getinfo_helper_downloads_cert</a> (const char *fp_sk_req, <a class="el" href="structdownload__status__t.html">download_status_t</a> **dl_to_emit, <a class="el" href="structsmartlist__t.html">smartlist_t</a> **digest_list, const char **errmsg)</td></tr>
<tr class="separator:afb5aa2ca5fb7e5db504bf1d3ff1342c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a158cde22d2f4bffa9d62a032aa02308a"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a158cde22d2f4bffa9d62a032aa02308a">getinfo_helper_downloads_desc</a> (const char *desc_req, <a class="el" href="structdownload__status__t.html">download_status_t</a> **dl_to_emit, <a class="el" href="structsmartlist__t.html">smartlist_t</a> **digest_list, const char **errmsg)</td></tr>
<tr class="separator:a158cde22d2f4bffa9d62a032aa02308a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3d55d1ae306e3c81057ead47dcafb0d"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ad3d55d1ae306e3c81057ead47dcafb0d">getinfo_helper_downloads_bridge</a> (const char *bridge_req, <a class="el" href="structdownload__status__t.html">download_status_t</a> **dl_to_emit, <a class="el" href="structsmartlist__t.html">smartlist_t</a> **digest_list, const char **errmsg)</td></tr>
<tr class="separator:ad3d55d1ae306e3c81057ead47dcafb0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8464eca5a44ec95b58f55316cd5a4ceb"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a8464eca5a44ec95b58f55316cd5a4ceb">getinfo_helper_downloads</a> (<a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *control_conn, const char *question, char **answer, const char **errmsg)</td></tr>
<tr class="separator:a8464eca5a44ec95b58f55316cd5a4ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7b56ac7ede2a04d5c8311a5fbae88ab"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ad7b56ac7ede2a04d5c8311a5fbae88ab">getinfo_helper_onions</a> (<a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *control_conn, const char *question, char **answer, const char **errmsg)</td></tr>
<tr class="separator:ad7b56ac7ede2a04d5c8311a5fbae88ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a429edbc8e613a788ea2b42b9e5050f09"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a429edbc8e613a788ea2b42b9e5050f09">add_onion_helper_keyarg</a> (const char *arg, int discard_pk, const char **key_new_alg_out, char **key_new_blob_out, add_onion_secret_key_t *decoded_key, int *hs_version, char **err_msg_out)</td></tr>
<tr class="separator:a429edbc8e613a788ea2b42b9e5050f09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a193624b5e0d5d45a44a529b732d3e4f7"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="structrend__authorized__client__t.html">rend_authorized_client_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a193624b5e0d5d45a44a529b732d3e4f7">add_onion_helper_clientauth</a> (const char *arg, int *created, char **err_msg)</td></tr>
<tr class="separator:a193624b5e0d5d45a44a529b732d3e4f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7cb5d6cdb0f965dcd9a3e9529e2b4a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ad7cb5d6cdb0f965dcd9a3e9529e2b4a4">connection_control_finished_flushing</a> (<a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *conn)</td></tr>
<tr class="separator:ad7cb5d6cdb0f965dcd9a3e9529e2b4a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7281e40e36d30afc5723773720e28e81"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a7281e40e36d30afc5723773720e28e81">connection_control_reached_eof</a> (<a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *conn)</td></tr>
<tr class="separator:a7281e40e36d30afc5723773720e28e81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a966dc2b23c935600dc1f815fe8e88fda"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a966dc2b23c935600dc1f815fe8e88fda">connection_control_closed</a> (<a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *conn)</td></tr>
<tr class="separator:a966dc2b23c935600dc1f815fe8e88fda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af432f1e6e596c37d0320e46106243253"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#af432f1e6e596c37d0320e46106243253">connection_control_process_inbuf</a> (<a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *conn)</td></tr>
<tr class="separator:af432f1e6e596c37d0320e46106243253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fcccb8799c3633567989fd4560cf8a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a5fcccb8799c3633567989fd4560cf8a3">control_event_circuit_status</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ, <a class="el" href="or_8h.html#a7e9b3588f68b08a0b757d940aa8c4dc0">circuit_status_event_t</a> tp, int reason_code)</td></tr>
<tr class="separator:a5fcccb8799c3633567989fd4560cf8a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30466e8dfbb03b8af719e0cb78d7a63d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a30466e8dfbb03b8af719e0cb78d7a63d">control_event_circuit_purpose_changed</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ, int old_purpose)</td></tr>
<tr class="separator:a30466e8dfbb03b8af719e0cb78d7a63d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2db7010901d36e6b0c4ecd4651033c4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#aa2db7010901d36e6b0c4ecd4651033c4">control_event_circuit_cannibalized</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ, int old_purpose, const struct <a class="el" href="structtimeval.html">timeval</a> *old_tv_created)</td></tr>
<tr class="separator:aa2db7010901d36e6b0c4ecd4651033c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9acf2608d05458d1a9e8531619363080"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a9acf2608d05458d1a9e8531619363080">control_event_stream_status</a> (<a class="el" href="structentry__connection__t.html">entry_connection_t</a> *conn, <a class="el" href="or_8h.html#a678356e73d49a4c5cf2dc3133de8b49a">stream_status_event_t</a> tp, int reason_code)</td></tr>
<tr class="separator:a9acf2608d05458d1a9e8531619363080"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ec5a96f0e43d4719b7992819bb3f1ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a7ec5a96f0e43d4719b7992819bb3f1ac">control_event_or_conn_status</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, <a class="el" href="or_8h.html#a53c095ab81f2a8e2c459a95c35ab6ecc">or_conn_status_event_t</a> tp, int reason)</td></tr>
<tr class="separator:a7ec5a96f0e43d4719b7992819bb3f1ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1071613ea5671cd5cb638caf0d959395"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a1071613ea5671cd5cb638caf0d959395">control_event_stream_bandwidth</a> (<a class="el" href="structedge__connection__t.html">edge_connection_t</a> *edge_conn)</td></tr>
<tr class="separator:a1071613ea5671cd5cb638caf0d959395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a482ef6a449be80739f6d8b094c104c07"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a482ef6a449be80739f6d8b094c104c07">control_event_stream_bandwidth_used</a> (void)</td></tr>
<tr class="separator:a482ef6a449be80739f6d8b094c104c07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c809b65a1d31d745dfb608d872e82a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a82c809b65a1d31d745dfb608d872e82a">control_event_circ_bandwidth_used</a> (void)</td></tr>
<tr class="separator:a82c809b65a1d31d745dfb608d872e82a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32ebecaaed0f7fc36982c27237c24c6a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a32ebecaaed0f7fc36982c27237c24c6a">control_event_conn_bandwidth</a> (<a class="el" href="structconnection__t.html">connection_t</a> *conn)</td></tr>
<tr class="separator:a32ebecaaed0f7fc36982c27237c24c6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91a42d462b534b08ce9a0addc567613b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a91a42d462b534b08ce9a0addc567613b">control_event_conn_bandwidth_used</a> (void)</td></tr>
<tr class="separator:a91a42d462b534b08ce9a0addc567613b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45b32d8cedf52b7ef8b0174d47a4cc37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a45b32d8cedf52b7ef8b0174d47a4cc37">sum_up_cell_stats_by_command</a> (<a class="el" href="structcircuit__t.html">circuit_t</a> *circ, cell_stats_t *cell_stats)</td></tr>
<tr class="separator:a45b32d8cedf52b7ef8b0174d47a4cc37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e609f8cc909bbbf05c04094ade553ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a8e609f8cc909bbbf05c04094ade553ac">append_cell_stats_by_command</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *event_parts, const char *key, const uint64_t *include_if_non_zero, const uint64_t *number_to_include)</td></tr>
<tr class="separator:a8e609f8cc909bbbf05c04094ade553ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21f67f80a4baa5a7432a916937e38d45"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a21f67f80a4baa5a7432a916937e38d45">format_cell_stats</a> (char **event_string, <a class="el" href="structcircuit__t.html">circuit_t</a> *circ, cell_stats_t *cell_stats)</td></tr>
<tr class="separator:a21f67f80a4baa5a7432a916937e38d45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34ccad9d6430df1ed10abf18fda46891"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a34ccad9d6430df1ed10abf18fda46891">control_event_circuit_cell_stats</a> (void)</td></tr>
<tr class="separator:a34ccad9d6430df1ed10abf18fda46891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a282f3c5c767e9a652b4519e5c19016aa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a282f3c5c767e9a652b4519e5c19016aa">control_event_bandwidth_used</a> (uint32_t n_read, uint32_t n_written)</td></tr>
<tr class="separator:a282f3c5c767e9a652b4519e5c19016aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57fedb007398cca6edebf8635f35f210"><td class="memItemLeft" align="right" valign="top"><a id="a57fedb007398cca6edebf8635f35f210"></a>
STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><b>get_bw_samples</b> (void)</td></tr>
<tr class="separator:a57fedb007398cca6edebf8635f35f210"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cf18ec51013b4b0b8b104ef4509ca61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a3cf18ec51013b4b0b8b104ef4509ca61">disable_control_logging</a> (void)</td></tr>
<tr class="separator:a3cf18ec51013b4b0b8b104ef4509ca61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8336a8705fe16b16bc29aa26defeb567"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a8336a8705fe16b16bc29aa26defeb567">enable_control_logging</a> (void)</td></tr>
<tr class="separator:a8336a8705fe16b16bc29aa26defeb567"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e2cfc4aa0b38b8043b3e4aa467e0745"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a2e2cfc4aa0b38b8043b3e4aa467e0745">control_event_logmsg</a> (int severity, uint32_t domain, const char *msg)</td></tr>
<tr class="separator:a2e2cfc4aa0b38b8043b3e4aa467e0745"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade2557c81242d73d93750e0c68218a7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ade2557c81242d73d93750e0c68218a7c">control_event_logmsg_pending</a> (void)</td></tr>
<tr class="separator:ade2557c81242d73d93750e0c68218a7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1c562cb6f09c13a49ec73cc1b72c7f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ac1c562cb6f09c13a49ec73cc1b72c7f8">control_event_descriptors_changed</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *routers)</td></tr>
<tr class="separator:ac1c562cb6f09c13a49ec73cc1b72c7f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf333c7b412035374239a43e99c4f588"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#abf333c7b412035374239a43e99c4f588">control_event_address_mapped</a> (const char *from, const char *to, time_t expires, const char *error, const int cached)</td></tr>
<tr class="separator:abf333c7b412035374239a43e99c4f588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88dfbfe80b8462d7ca8e438a40e6d30f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a88dfbfe80b8462d7ca8e438a40e6d30f">control_event_network_liveness_update</a> (int liveness)</td></tr>
<tr class="separator:a88dfbfe80b8462d7ca8e438a40e6d30f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7331ec4f1191128906b7dcb447dad328"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a7331ec4f1191128906b7dcb447dad328">control_event_networkstatus_changed</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *statuses)</td></tr>
<tr class="separator:a7331ec4f1191128906b7dcb447dad328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2cce566f007535370cda5c829181ede"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ac2cce566f007535370cda5c829181ede">control_event_newconsensus</a> (const <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *consensus)</td></tr>
<tr class="separator:ac2cce566f007535370cda5c829181ede"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a2b503ef04599f6c944ecb4a71aefc5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a3a2b503ef04599f6c944ecb4a71aefc5">control_event_buildtimeout_set</a> (<a class="el" href="or_8h.html#ae591eb108092443fa060afdaf00a17ef">buildtimeout_set_event_t</a> type, const char *args)</td></tr>
<tr class="separator:a3a2b503ef04599f6c944ecb4a71aefc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a3b05ceb558dee6cac62cb7f389f19b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a3a3b05ceb558dee6cac62cb7f389f19b">control_event_signal</a> (uintptr_t signal_num)</td></tr>
<tr class="separator:a3a3b05ceb558dee6cac62cb7f389f19b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9be374155fbeb8f7102071f7ddf6facb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a9be374155fbeb8f7102071f7ddf6facb">control_event_networkstatus_changed_single</a> (const <a class="el" href="structrouterstatus__t.html">routerstatus_t</a> *rs)</td></tr>
<tr class="separator:a9be374155fbeb8f7102071f7ddf6facb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0648f9ac41df9391146becf8d7f7f650"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a0648f9ac41df9391146becf8d7f7f650">control_event_my_descriptor_changed</a> (void)</td></tr>
<tr class="separator:a0648f9ac41df9391146becf8d7f7f650"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bd4001ec6bb62a01e1d6d6c3f3bf44a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a1bd4001ec6bb62a01e1d6d6c3f3bf44a">control_event_general_status</a> (int severity, const char *format,...)</td></tr>
<tr class="separator:a1bd4001ec6bb62a01e1d6d6c3f3bf44a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7118f2fef9379a00b4969283e6c0b8f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a7118f2fef9379a00b4969283e6c0b8f8">control_event_general_error</a> (const char *format,...)</td></tr>
<tr class="separator:a7118f2fef9379a00b4969283e6c0b8f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92de51ab68d72df3bf43754758ba5c00"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a92de51ab68d72df3bf43754758ba5c00">control_event_client_status</a> (int severity, const char *format,...)</td></tr>
<tr class="separator:a92de51ab68d72df3bf43754758ba5c00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d916b3ab4cc1ff8d72e4b9fc0ea1274"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a7d916b3ab4cc1ff8d72e4b9fc0ea1274">control_event_client_error</a> (const char *format,...)</td></tr>
<tr class="separator:a7d916b3ab4cc1ff8d72e4b9fc0ea1274"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a744e1e120d455e1662fdbb4704a1be20"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a744e1e120d455e1662fdbb4704a1be20">control_event_server_status</a> (int severity, const char *format,...)</td></tr>
<tr class="separator:a744e1e120d455e1662fdbb4704a1be20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0edfc547e3467665efb1a4fe346b45a0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a0edfc547e3467665efb1a4fe346b45a0">control_event_server_error</a> (const char *format,...)</td></tr>
<tr class="separator:a0edfc547e3467665efb1a4fe346b45a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bcae87af9362ae1e34ba942a5ac124e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a4bcae87af9362ae1e34ba942a5ac124e">control_event_guard</a> (const char *nickname, const char *digest, const char *status)</td></tr>
<tr class="separator:a4bcae87af9362ae1e34ba942a5ac124e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad442667356d1ccf0fc9c42aefde5c16b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ad442667356d1ccf0fc9c42aefde5c16b">control_event_conf_changed</a> (const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *elements)</td></tr>
<tr class="separator:ad442667356d1ccf0fc9c42aefde5c16b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9443fc62bda985f770ac05fe96fcd4f4"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a9443fc62bda985f770ac05fe96fcd4f4">get_controller_cookie_file_name</a> (void)</td></tr>
<tr class="separator:a9443fc62bda985f770ac05fe96fcd4f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d22e77c8b8208e7023c74899086da58"><td class="memItemLeft" align="right" valign="top"><a id="a2d22e77c8b8208e7023c74899086da58"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>init_control_cookie_authentication</b> (int enabled)</td></tr>
<tr class="separator:a2d22e77c8b8208e7023c74899086da58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1f8aa865448a4f8c34719f2b1ea67d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#ad1f8aa865448a4f8c34719f2b1ea67d2">monitor_owning_controller_process</a> (const char *process_spec)</td></tr>
<tr class="separator:ad1f8aa865448a4f8c34719f2b1ea67d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedcfacb9f04291c724b3a7cd1cac4d39"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#aedcfacb9f04291c724b3a7cd1cac4d39">control_event_bootstrap</a> (<a class="el" href="or_8h.html#aca5cc90a3504ceeacfbdca51d6e4f46d">bootstrap_status_t</a> status, int progress)</td></tr>
<tr class="separator:aedcfacb9f04291c724b3a7cd1cac4d39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a909cd7f141f9111cda009bd1960d7e08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a909cd7f141f9111cda009bd1960d7e08">control_event_bootstrap_problem</a> (const char *warn, const char *reason, const <a class="el" href="structconnection__t.html">connection_t</a> *conn, int dowarn)</td></tr>
<tr class="separator:a909cd7f141f9111cda009bd1960d7e08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12cf925561cc1fc7aab3dc2b383a3071"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a12cf925561cc1fc7aab3dc2b383a3071">MOCK_IMPL</a> (void, control_event_bootstrap_prob_or,(const char *warn, int reason, <a class="el" href="structor__connection__t.html">or_connection_t</a> *or_conn))</td></tr>
<tr class="separator:a12cf925561cc1fc7aab3dc2b383a3071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a268c6940e7eb06fe81447d3f1a423b81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a268c6940e7eb06fe81447d3f1a423b81">control_event_clients_seen</a> (const char *controller_str)</td></tr>
<tr class="separator:a268c6940e7eb06fe81447d3f1a423b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d693451765fc0a044d1bc40ce0a0809"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a8d693451765fc0a044d1bc40ce0a0809">control_event_transport_launched</a> (const char *mode, const char *transport_name, <a class="el" href="structtor__addr__t.html">tor_addr_t</a> *addr, uint16_t port)</td></tr>
<tr class="separator:a8d693451765fc0a044d1bc40ce0a0809"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f5b8b8ca50d94db752f91e1d59034b8"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a9f5b8b8ca50d94db752f91e1d59034b8">rend_auth_type_to_string</a> (<a class="el" href="or_8h.html#aafc6920f8a16e10f46703e7819795c74">rend_auth_type_t</a> auth_type)</td></tr>
<tr class="separator:a9f5b8b8ca50d94db752f91e1d59034b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a000c7faf94744c2b3a6f1753b513e5ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a000c7faf94744c2b3a6f1753b513e5ae">MOCK_IMPL</a> (const char *, node_describe_longname_by_id,(const char *id_digest))</td></tr>
<tr class="separator:a000c7faf94744c2b3a6f1753b513e5ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b9d57f7220ee44755362058ffa97892"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a3b9d57f7220ee44755362058ffa97892">control_event_hs_descriptor_requested</a> (const char *onion_address, <a class="el" href="or_8h.html#aafc6920f8a16e10f46703e7819795c74">rend_auth_type_t</a> auth_type, const char *id_digest, const char *desc_id, const char *hsdir_index)</td></tr>
<tr class="separator:a3b9d57f7220ee44755362058ffa97892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add53b1a6396162e3bb9eab66a6afebdc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#add53b1a6396162e3bb9eab66a6afebdc">control_event_hs_descriptor_created</a> (const char *onion_address, const char *desc_id, int replica)</td></tr>
<tr class="separator:add53b1a6396162e3bb9eab66a6afebdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6195a5446c44a761339449df87237887"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a6195a5446c44a761339449df87237887">control_event_hs_descriptor_upload</a> (const char *onion_address, const char *id_digest, const char *desc_id, const char *hsdir_index)</td></tr>
<tr class="separator:a6195a5446c44a761339449df87237887"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a689805429adc3369580c97c9e8b9bdd7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a689805429adc3369580c97c9e8b9bdd7">control_event_hs_descriptor_upload_end</a> (const char *action, const char *onion_address, const char *id_digest, const char *reason)</td></tr>
<tr class="separator:a689805429adc3369580c97c9e8b9bdd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45ebad4c4804dd1e80cd580233af062a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a45ebad4c4804dd1e80cd580233af062a">control_event_hsv2_descriptor_received</a> (const char *onion_address, const <a class="el" href="structrend__data__t.html">rend_data_t</a> *rend_data, const char *hsdir_id_digest)</td></tr>
<tr class="separator:a45ebad4c4804dd1e80cd580233af062a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae93051e46f7c876546586fe7e454f91e"><td class="memItemLeft" align="right" valign="top"><a id="ae93051e46f7c876546586fe7e454f91e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>control_event_hsv3_descriptor_received</b> (const char *onion_address, const char *desc_id, const char *hsdir_id_digest)</td></tr>
<tr class="separator:ae93051e46f7c876546586fe7e454f91e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6668148651c111619b3cbe75c39d75d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a6668148651c111619b3cbe75c39d75d6">control_event_hs_descriptor_uploaded</a> (const char *id_digest, const char *onion_address)</td></tr>
<tr class="separator:a6668148651c111619b3cbe75c39d75d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7407c201dd8249d580be5eeb048a74f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a7407c201dd8249d580be5eeb048a74f6">control_event_hsv2_descriptor_failed</a> (const <a class="el" href="structrend__data__t.html">rend_data_t</a> *rend_data, const char *hsdir_id_digest, const char *reason)</td></tr>
<tr class="separator:a7407c201dd8249d580be5eeb048a74f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8420c8c951d738c5f549820689ae4ac8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a8420c8c951d738c5f549820689ae4ac8">control_event_hsv3_descriptor_failed</a> (const char *onion_address, const char *desc_id, const char *hsdir_id_digest, const char *reason)</td></tr>
<tr class="separator:a8420c8c951d738c5f549820689ae4ac8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fc2b6b7637cc858a77a37f96129edf4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a2fc2b6b7637cc858a77a37f96129edf4">control_event_hs_descriptor_content</a> (const char *onion_address, const char *desc_id, const char *hsdir_id_digest, const char *content)</td></tr>
<tr class="separator:a2fc2b6b7637cc858a77a37f96129edf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dbd4bf59a3490e0272203314f56a66c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a3dbd4bf59a3490e0272203314f56a66c">control_event_hs_descriptor_upload_failed</a> (const char *id_digest, const char *onion_address, const char *reason)</td></tr>
<tr class="separator:a3dbd4bf59a3490e0272203314f56a66c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cdf2d5778284e11b466e62b92c7bdbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8c.html#a5cdf2d5778284e11b466e62b92c7bdbf">control_free_all</a> (void)</td></tr>
<tr class="separator:a5cdf2d5778284e11b466e62b92c7bdbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation for Tor's control-socket interface. </p>
<p>A "controller" is an external program that monitors and controls a Tor instance via a text-based protocol. It connects to Tor via a connection to a local socket.</p>
<p>The protocol is line-driven. The controller sends commands terminated by a CRLF. Tor sends lines that are either <em>replies</em> to what the controller has said, or <em>events</em> that Tor sends to the controller asynchronously based on occurrences in the Tor network model.</p>
<p>See the control-spec.txt file in the torspec.git repository for full details on protocol.</p>
<p>This module generally has two kinds of entry points: those based on having received a command on a controller socket, which are handled in <a class="el" href="control_8c.html#af432f1e6e596c37d0320e46106243253">connection_control_process_inbuf()</a>, and dispatched to individual functions with names like control_handle_COMMANDNAME(); and those based on events that occur elsewhere in Tor, which are handled by functions with names like control_event_EVENTTYPE().</p>
<p>Controller events are not sent immediately; rather, they are inserted into the queued_control_events array, and flushed later from flush_queued_events_cb(). Doing this simplifies our callgraph greatly, by limiting the number of places in Tor that can call back into the network stack. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aff97f4aa113ab62b61d865d5d3c4724d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff97f4aa113ab62b61d865d5d3c4724d">&#9670;&nbsp;</a></span>ANY_EVENT_IS_INTERESTING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ANY_EVENT_IS_INTERESTING</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">e</td><td>)</td>
          <td>&#160;&#160;&#160;(!! (global_event_mask &amp; (e)))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro: true if any event from the bitfield 'e' is interesting. </p>

</div>
</div>
<a id="aaab749d06c1a84ec27463752fb227ad5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaab749d06c1a84ec27463752fb227ad5">&#9670;&nbsp;</a></span>AUTHENTICATION_COOKIE_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AUTHENTICATION_COOKIE_LEN&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If we're using cookie-type authentication, how long should our cookies be? </p>

</div>
</div>
<a id="a213fb63ea766eb6ee39839947219f55b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a213fb63ea766eb6ee39839947219f55b">&#9670;&nbsp;</a></span>BOOTSTRAP_MSG_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOOTSTRAP_MSG_LEN&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A sufficiently large size to record the last bootstrap phase string. </p>

</div>
</div>
<a id="ac9279b215d6781141e6ebe98551965e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9279b215d6781141e6ebe98551965e5">&#9670;&nbsp;</a></span>BOOTSTRAP_PCT_INCREMENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOOTSTRAP_PCT_INCREMENT&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>When our bootstrapping progress level changes, but our bootstrapping status has not advanced, we only log at NOTICE when we have made at least this much progress. </p>

</div>
</div>
<a id="ac1b92674ea52c2c31377432d3114b95a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1b92674ea52c2c31377432d3114b95a">&#9670;&nbsp;</a></span>BOOTSTRAP_PROBLEM_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOOTSTRAP_PROBLEM_THRESHOLD&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We only tell the controller once we've hit a threshold of problems for the current phase. </p>

</div>
</div>
<a id="afb88f5b74df4a4f380b555e05bde8daf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb88f5b74df4a4f380b555e05bde8daf">&#9670;&nbsp;</a></span>CONTROL_EVENT_STATUS_BODY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_EVENT_STATUS_BODY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">event, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">sev&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordtype">int</span> r;                                                        \</div><div class="line">  do {                                                          \</div><div class="line">    va_list ap;                                                 \</div><div class="line">    if (!<a class="code" href="control_8c.html#a1c6516221d89f0b2355a553950ee5829">EVENT_IS_INTERESTING</a>(event))                           \</div><div class="line">      return 0;                                                 \</div><div class="line">                                                                \</div><div class="line">    va_start(ap, format);                                       \</div><div class="line">    r = control_event_status((event), (sev), format, ap);       \</div><div class="line">    va_end(ap);                                                 \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div><div class="ttc" id="control_8c_html_a1c6516221d89f0b2355a553950ee5829"><div class="ttname"><a href="control_8c.html#a1c6516221d89f0b2355a553950ee5829">EVENT_IS_INTERESTING</a></div><div class="ttdeci">#define EVENT_IS_INTERESTING(e)</div><div class="ttdef"><b>Definition:</b> control.c:113</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c6516221d89f0b2355a553950ee5829"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c6516221d89f0b2355a553950ee5829">&#9670;&nbsp;</a></span>EVENT_IS_INTERESTING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVENT_IS_INTERESTING</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">e</td><td>)</td>
          <td>&#160;&#160;&#160;(!! (global_event_mask &amp; EVENT_MASK_(e)))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro: true if any control connection is interested in events of type <b>e</b>. </p>

</div>
</div>
<a id="a25d93fcb978c543a89f21db41685980b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25d93fcb978c543a89f21db41685980b">&#9670;&nbsp;</a></span>MAX_COMMAND_LINE_LENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_COMMAND_LINE_LENGTH&#160;&#160;&#160;(1024*1024)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Do not accept any control command of more than 1MB in length. Anything that needs to be anywhere near this long probably means that one of our interfaces is broken. </p>

</div>
</div>
<a id="a891794d9838a445210cb070c284656a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a891794d9838a445210cb070c284656a5">&#9670;&nbsp;</a></span>STATE_IS_OPEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_IS_OPEN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s</td><td>)</td>
          <td>&#160;&#160;&#160;((s) == <a class="el" href="or_8h.html#a9360196a07cc959e0325943375af32d8">CONTROL_CONN_STATE_OPEN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Yield true iff <b>s</b> is the state of a <a class="el" href="structcontrol__connection__t.html">control_connection_t</a> that has finished authentication and is accepting commands. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a2dcff8985975867dd448ef5c4fbc1a64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dcff8985975867dd448ef5c4fbc1a64">&#9670;&nbsp;</a></span>event_mask_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint64_t <a class="el" href="control_8c.html#a2dcff8985975867dd448ef5c4fbc1a64">event_mask_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bitfield: The bit 1&lt;&lt;e is set if <b>any</b> open control connection is interested in events of type <b>e</b>. We use this so that we can decide to skip generating event messages that nobody has interest in without having to walk over the global connection list to find out. </p>

</div>
</div>
<a id="ad7aea298a84afd1cb16a8032279bb155"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7aea298a84afd1cb16a8032279bb155">&#9670;&nbsp;</a></span>getinfo_helper_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* getinfo_helper_t) (<a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *, const char *q, char **a, const char **error_out)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Callback function for GETINFO: on a given control connection, try to answer the question <b>q</b> and store the newly-allocated answer in *<b>a</b>. If an internal error occurs, return -1 and optionally set *<b>error_out</b> to point to an error message to be delivered to the controller. On success, <em>or if the key is not recognized</em>, return 0. Do not set <b>a</b> if the key is not recognized but you may set <b>error_out</b> to improve the error message. </p>

</div>
</div>
<a id="a9ca8540163b746f9fbec9e224213d665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ca8540163b746f9fbec9e224213d665">&#9670;&nbsp;</a></span>getinfo_item_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structgetinfo__item__t.html">getinfo_item_t</a>  <a class="el" href="structgetinfo__item__t.html">getinfo_item_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A single item for the GETINFO question-to-answer-function table. </p>

</div>
</div>
<a id="a96479016ed9454057dacd4502232dc71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96479016ed9454057dacd4502232dc71">&#9670;&nbsp;</a></span>queued_event_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structqueued__event__s.html">queued_event_s</a>  <a class="el" href="control_8c.html#a96479016ed9454057dacd4502232dc71">queued_event_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Represents an event that's queued to be sent to one or more controllers. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a193624b5e0d5d45a44a529b732d3e4f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a193624b5e0d5d45a44a529b732d3e4f7">&#9670;&nbsp;</a></span>add_onion_helper_clientauth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="structrend__authorized__client__t.html">rend_authorized_client_t</a>* add_onion_helper_clientauth </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>created</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>err_msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function to handle parsing a ClientAuth argument to the ADD_ONION command. Return a new <a class="el" href="structrend__authorized__client__t.html">rend_authorized_client_t</a>, or NULL and an optional control protocol error message on failure. The caller is responsible for freeing the returned auth_client and err_msg.</p>
<p>If 'created' is specified, it will be set to 1 when a new cookie has been generated. </p>

</div>
</div>
<a id="a429edbc8e613a788ea2b42b9e5050f09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a429edbc8e613a788ea2b42b9e5050f09">&#9670;&nbsp;</a></span>add_onion_helper_keyarg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int add_onion_helper_keyarg </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>discard_pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>key_new_alg_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>key_new_blob_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">add_onion_secret_key_t *&#160;</td>
          <td class="paramname"><em>decoded_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>hs_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>err_msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function to handle parsing the KeyType:KeyBlob argument to the ADD_ONION command. Return a new <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> and if a new key was generated and the private key not discarded, the algorithm and serialized private key, or NULL and an optional control protocol error message on failure. The caller is responsible for freeing the returned key_new_blob and err_msg.</p>
<p>Note: The error messages returned are deliberately vague to avoid echoing key material. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a429edbc8e613a788ea2b42b9e5050f09_cgraph.png" border="0" usemap="#control_8c_a429edbc8e613a788ea2b42b9e5050f09_cgraph" alt=""/></div>
<map name="control_8c_a429edbc8e613a788ea2b42b9e5050f09_cgraph" id="control_8c_a429edbc8e613a788ea2b42b9e5050f09_cgraph">
<area shape="rect" id="node2" href="container_8c.html#a1d75cac5583c66900c032ba972ffabc8" title="smartlist_split_string" alt="" coords="223,5,365,32"/>
</map>
</div>

</div>
</div>
<a id="a8e609f8cc909bbbf05c04094ade553ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e609f8cc909bbbf05c04094ade553ac">&#9670;&nbsp;</a></span>append_cell_stats_by_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void append_cell_stats_by_command </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>event_parts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t *&#160;</td>
          <td class="paramname"><em>include_if_non_zero</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t *&#160;</td>
          <td class="paramname"><em>number_to_include</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: append a cell statistics string to <code>event_parts</code>, prefixed with <code>key</code>=. Statistics consist of comma-separated key:value pairs with lower-case command strings as keys and cell numbers or total waiting times as values. A key:value pair is included if the entry in <code>include_if_non_zero</code> is not zero, but with the (possibly zero) entry from <code>number_to_include</code>. Both arrays are expected to have a length of CELL_COMMAND_MAX_ + 1. If no entry in <code>include_if_non_zero</code> is positive, no string will be added to <code>event_parts</code>. </p>

</div>
</div>
<a id="a966dc2b23c935600dc1f815fe8e88fda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a966dc2b23c935600dc1f815fe8e88fda">&#9670;&nbsp;</a></span>connection_control_closed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void connection_control_closed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when <b>conn</b> is being freed. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a966dc2b23c935600dc1f815fe8e88fda_cgraph.png" border="0" usemap="#control_8c_a966dc2b23c935600dc1f815fe8e88fda_cgraph" alt=""/></div>
<map name="control_8c_a966dc2b23c935600dc1f815fe8e88fda_cgraph" id="control_8c_a966dc2b23c935600dc1f815fe8e88fda_cgraph">
<area shape="rect" id="node2" href="control_8c.html#ade569bf3dbd2110f2ac817428885f0b9" title="control_update_global\l_event_mask" alt="" coords="203,5,351,47"/>
<area shape="rect" id="node3" href="rendcommon_8c.html#a07d97b83844365f0949fd9998269a5a9" title="rend_valid_v2_service_id" alt="" coords="419,97,587,123"/>
<area shape="rect" id="node4" href="rendservice_8c.html#a9adfef842de9b8aec233a9046b9faeb2" title="rend_service_del_ephemeral" alt="" coords="184,122,371,149"/>
</map>
</div>

</div>
</div>
<a id="ad7cb5d6cdb0f965dcd9a3e9529e2b4a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7cb5d6cdb0f965dcd9a3e9529e2b4a4">&#9670;&nbsp;</a></span>connection_control_finished_flushing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_control_finished_flushing </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when <b>conn</b> has no more bytes left on its outbuf. </p>

</div>
</div>
<a id="af432f1e6e596c37d0320e46106243253"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af432f1e6e596c37d0320e46106243253">&#9670;&nbsp;</a></span>connection_control_process_inbuf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_control_process_inbuf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when data has arrived on a v1 control connection: Try to fetch commands from conn-&gt;inbuf, and execute them. </p>

</div>
</div>
<a id="a7281e40e36d30afc5723773720e28e81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7281e40e36d30afc5723773720e28e81">&#9670;&nbsp;</a></span>connection_control_reached_eof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_control_reached_eof </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when <b>conn</b> has gotten its socket closed. </p>

</div>
</div>
<a id="a91f5ce05444faa77077480ce8327d878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91f5ce05444faa77077480ce8327d878">&#9670;&nbsp;</a></span>control_adjust_event_log_severity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_adjust_event_log_severity </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adjust the log severities that result in control_event_logmsg being called to match the severity of log messages that any controllers are interested in. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a91f5ce05444faa77077480ce8327d878_cgraph.png" border="0" usemap="#control_8c_a91f5ce05444faa77077480ce8327d878_cgraph" alt=""/></div>
<map name="control_8c_a91f5ce05444faa77077480ce8327d878_cgraph" id="control_8c_a91f5ce05444faa77077480ce8327d878_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a26c45902f415353a9ab42857c58f4580" title="change_callback_log\l_severity" alt="" coords="196,23,339,65"/>
<area shape="rect" id="node3" href="log_8c.html#a5e0951aa88718546b90e38018b66c9f7" title="set_log_severity_config" alt="" coords="387,5,545,32"/>
<area shape="rect" id="node4" href="log_8c.html#a62f4e494ccdddfdd631addbc64507976" title="get_min_log_level" alt="" coords="403,56,529,83"/>
</map>
</div>

</div>
</div>
<a id="afa7eff3569fc8e5e5e27c1d6d9f02125"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa7eff3569fc8e5e5e27c1d6d9f02125">&#9670;&nbsp;</a></span>control_any_per_second_event_enabled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_any_per_second_event_enabled </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true if any event that needs to fire once a second is enabled. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_afa7eff3569fc8e5e5e27c1d6d9f02125_icgraph.png" border="0" usemap="#control_8c_afa7eff3569fc8e5e5e27c1d6d9f02125_icgraph" alt=""/></div>
<map name="control_8c_afa7eff3569fc8e5e5e27c1d6d9f02125_icgraph" id="control_8c_afa7eff3569fc8e5e5e27c1d6d9f02125_icgraph">
<area shape="rect" id="node2" href="control_8h.html#ae1881d4083d31106d2108a1ac919ac4e" title="control_per_second\l_events" alt="" coords="216,5,351,47"/>
</map>
</div>

</div>
</div>
<a id="a1b5fbf9ddc3b167562660a53442f004f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b5fbf9ddc3b167562660a53442f004f">&#9670;&nbsp;</a></span>control_connection_add_local_fd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_connection_add_local_fd </td>
          <td>(</td>
          <td class="paramtype">tor_socket_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create and add a new controller connection on <b>sock</b>. If <b>CC_LOCAL_FD_IS_OWNER</b> is set in <b>flags</b>, this Tor process should exit when the connection closes. If <b>CC_LOCAL_FD_IS_AUTHENTICATED</b> is set, then the connection does not need to authenticate. </p>

</div>
</div>
<a id="abf333c7b412035374239a43e99c4f588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf333c7b412035374239a43e99c4f588">&#9670;&nbsp;</a></span>control_event_address_mapped()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_address_mapped </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>expires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>cached</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when an address mapping on <b>from</b> from changes to <b>to</b>. <b>expires</b> values less than 3 are special; see <a class="el" href="connection__edge_8c.html" title="Handle edge streams. ">connection_edge.c</a>. If <b>error</b> is non-NULL, it is an error code describing the failure mode of the mapping. </p>

</div>
</div>
<a id="a282f3c5c767e9a652b4519e5c19016aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a282f3c5c767e9a652b4519e5c19016aa">&#9670;&nbsp;</a></span>control_event_bandwidth_used()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_bandwidth_used </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>n_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>n_written</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A second or more has elapsed: tell any interested control connections how much bandwidth we used. </p>

</div>
</div>
<a id="aedcfacb9f04291c724b3a7cd1cac4d39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedcfacb9f04291c724b3a7cd1cac4d39">&#9670;&nbsp;</a></span>control_event_bootstrap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_bootstrap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="or_8h.html#aca5cc90a3504ceeacfbdca51d6e4f46d">bootstrap_status_t</a>&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>progress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when Tor has made progress at bootstrapping its directory information and initial circuits.</p>
<p><b>status</b> is the new status, that is, what task we will be doing next. <b>progress</b> is zero if we just started this task, else it represents progress on the task.</p>
<p>Return true if we logged a message at level NOTICE, and false otherwise. </p>

</div>
</div>
<a id="a909cd7f141f9111cda009bd1960d7e08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a909cd7f141f9111cda009bd1960d7e08">&#9670;&nbsp;</a></span>control_event_bootstrap_problem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_bootstrap_problem </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>warn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>reason</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structconnection__t.html">connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dowarn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when Tor has failed to make bootstrapping progress in a way that indicates a problem. <b>warn</b> gives a human-readable hint as to why, and <b>reason</b> provides a controller-facing short tag. <b>conn</b> is the connection that caused this problem and can be NULL if a connection cannot be easily identified. </p>

</div>
</div>
<a id="a3a2b503ef04599f6c944ecb4a71aefc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a2b503ef04599f6c944ecb4a71aefc5">&#9670;&nbsp;</a></span>control_event_buildtimeout_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_buildtimeout_set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="or_8h.html#ae591eb108092443fa060afdaf00a17ef">buildtimeout_set_event_t</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we compute a new circuitbuildtimeout </p>

</div>
</div>
<a id="a82c809b65a1d31d745dfb608d872e82a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82c809b65a1d31d745dfb608d872e82a">&#9670;&nbsp;</a></span>control_event_circ_bandwidth_used()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_circ_bandwidth_used </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A second or more has elapsed: tell any interested control connections how much bandwidth origin circuits have used. </p>

</div>
</div>
<a id="aa2db7010901d36e6b0c4ecd4651033c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2db7010901d36e6b0c4ecd4651033c4">&#9670;&nbsp;</a></span>control_event_circuit_cannibalized()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_circuit_cannibalized </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>old_purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structtimeval.html">timeval</a> *&#160;</td>
          <td class="paramname"><em>old_tv_created</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><b>circ</b> has changed its purpose from <b>old_purpose</b>, and its created-time from <b>old_tv_created</b>: tell any interested controllers. </p>

</div>
</div>
<a id="a34ccad9d6430df1ed10abf18fda46891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34ccad9d6430df1ed10abf18fda46891">&#9670;&nbsp;</a></span>control_event_circuit_cell_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_circuit_cell_stats </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A second or more has elapsed: tell any interested control connection how many cells have been processed for a given circuit. </p>

</div>
</div>
<a id="a30466e8dfbb03b8af719e0cb78d7a63d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30466e8dfbb03b8af719e0cb78d7a63d">&#9670;&nbsp;</a></span>control_event_circuit_purpose_changed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_circuit_purpose_changed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>old_purpose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><b>circ</b> has changed its purpose from <b>old_purpose</b>: tell any interested controllers. </p>

</div>
</div>
<a id="a5fcccb8799c3633567989fd4560cf8a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fcccb8799c3633567989fd4560cf8a3">&#9670;&nbsp;</a></span>control_event_circuit_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_circuit_status </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a7e9b3588f68b08a0b757d940aa8c4dc0">circuit_status_event_t</a>&#160;</td>
          <td class="paramname"><em>tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reason_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Something major has happened to circuit <b>circ</b>: tell any interested control connections. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a5fcccb8799c3633567989fd4560cf8a3_icgraph.png" border="0" usemap="#control_8c_a5fcccb8799c3633567989fd4560cf8a3_icgraph" alt=""/></div>
<map name="control_8c_a5fcccb8799c3633567989fd4560cf8a3_icgraph" id="control_8c_a5fcccb8799c3633567989fd4560cf8a3_icgraph">
<area shape="rect" id="node2" href="circuitstats_8h.html#a73e9aaecc9e72307e2483feeaed4c448" title="circuit_build_times\l_mark_circ_as_measurement_only" alt="" coords="196,5,420,47"/>
<area shape="rect" id="node3" href="circuituse_8h.html#a78a23775279a45daabbdc354310a9e1f" title="circuit_has_opened" alt="" coords="241,71,375,98"/>
</map>
</div>

</div>
</div>
<a id="a7d916b3ab4cc1ff8d72e4b9fc0ea1274"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d916b3ab4cc1ff8d72e4b9fc0ea1274">&#9670;&nbsp;</a></span>control_event_client_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_client_error </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Format and send an EVENT_STATUS_CLIENT LOG_ERR event, and flush it to the controller(s) immediately. </p>

</div>
</div>
<a id="a92de51ab68d72df3bf43754758ba5c00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92de51ab68d72df3bf43754758ba5c00">&#9670;&nbsp;</a></span>control_event_client_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_client_status </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Format and send an EVENT_STATUS_CLIENT event whose main text is obtained by formatting the arguments using the printf-style <b>format</b>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a92de51ab68d72df3bf43754758ba5c00_icgraph.png" border="0" usemap="#control_8c_a92de51ab68d72df3bf43754758ba5c00_icgraph" alt=""/></div>
<map name="control_8c_a92de51ab68d72df3bf43754758ba5c00_icgraph" id="control_8c_a92de51ab68d72df3bf43754758ba5c00_icgraph">
<area shape="rect" id="node2" href="circuitbuild_8h.html#ad0daecc03b3062716a6845b8a522d3da" title="circuit_note_clock\l_jumped" alt="" coords="192,5,319,47"/>
</map>
</div>

</div>
</div>
<a id="a268c6940e7eb06fe81447d3f1a423b81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a268c6940e7eb06fe81447d3f1a423b81">&#9670;&nbsp;</a></span>control_event_clients_seen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_clients_seen </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>controller_str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We just generated a new summary of which countries we've seen clients from recently. Send a copy to the controller in case it wants to display it for the user. </p>

</div>
</div>
<a id="ad442667356d1ccf0fc9c42aefde5c16b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad442667356d1ccf0fc9c42aefde5c16b">&#9670;&nbsp;</a></span>control_event_conf_changed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_conf_changed </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>elements</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when a configuration option changes. This is generally triggered by SETCONF requests and RELOAD/SIGHUP signals. The <b>elements</b> is a <a class="el" href="structsmartlist__t.html">smartlist_t</a> containing (key, value, ...) pairs in sequence. <b>value</b> can be NULL. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_ad442667356d1ccf0fc9c42aefde5c16b_cgraph.png" border="0" usemap="#control_8c_ad442667356d1ccf0fc9c42aefde5c16b_cgraph" alt=""/></div>
<map name="control_8c_ad442667356d1ccf0fc9c42aefde5c16b_cgraph" id="control_8c_ad442667356d1ccf0fc9c42aefde5c16b_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a68cb44a66a7446022122c93590b6d179" title="smartlist_add_asprintf" alt="" coords="185,31,336,57"/>
<area shape="rect" id="node6" href="container_8c.html#ab865391a8cac688c51809c33dad0bfe2" title="smartlist_join_strings" alt="" coords="188,81,333,108"/>
<area shape="rect" id="node3" href="util_8c.html#a4fee2abf83af3a8b8a18b245daf4083b" title="smartlist_add_vasprintf" alt="" coords="384,31,541,57"/>
<area shape="rect" id="node4" href="compat_8c.html#a5ef7a08e8b543c0d61f9ef1081d4c1ea" title="tor_vasprintf" alt="" coords="592,5,687,32"/>
<area shape="rect" id="node5" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="589,56,689,83"/>
<area shape="rect" id="node7" href="container_8c.html#aac69a4c0d462859a1a13a6eb35ab3c0a" title="smartlist_join_strings2" alt="" coords="387,81,539,108"/>
</map>
</div>

</div>
</div>
<a id="a32ebecaaed0f7fc36982c27237c24c6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32ebecaaed0f7fc36982c27237c24c6a">&#9670;&nbsp;</a></span>control_event_conn_bandwidth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_conn_bandwidth </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structconnection__t.html">connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Print out CONN_BW event for a single OR/DIR/EXIT <b>conn</b> and reset bandwidth counters. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a32ebecaaed0f7fc36982c27237c24c6a_icgraph.png" border="0" usemap="#control_8c_a32ebecaaed0f7fc36982c27237c24c6a_icgraph" alt=""/></div>
<map name="control_8c_a32ebecaaed0f7fc36982c27237c24c6a_icgraph" id="control_8c_a32ebecaaed0f7fc36982c27237c24c6a_icgraph">
<area shape="rect" id="node2" href="control_8h.html#a91a42d462b534b08ce9a0addc567613b" title="control_event_conn\l_bandwidth_used" alt="" coords="188,5,323,47"/>
</map>
</div>

</div>
</div>
<a id="a91a42d462b534b08ce9a0addc567613b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91a42d462b534b08ce9a0addc567613b">&#9670;&nbsp;</a></span>control_event_conn_bandwidth_used()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_conn_bandwidth_used </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A second or more has elapsed: tell any interested control connections how much bandwidth connections have used. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a91a42d462b534b08ce9a0addc567613b_cgraph.png" border="0" usemap="#control_8c_a91a42d462b534b08ce9a0addc567613b_cgraph" alt=""/></div>
<map name="control_8c_a91a42d462b534b08ce9a0addc567613b_cgraph" id="control_8c_a91a42d462b534b08ce9a0addc567613b_cgraph">
<area shape="rect" id="node2" href="control_8c.html#a32ebecaaed0f7fc36982c27237c24c6a" title="control_event_conn\l_bandwidth" alt="" coords="188,5,323,47"/>
</map>
</div>

</div>
</div>
<a id="ac1c562cb6f09c13a49ec73cc1b72c7f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1c562cb6f09c13a49ec73cc1b72c7f8">&#9670;&nbsp;</a></span>control_event_descriptors_changed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_descriptors_changed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>routers</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called whenever we receive new router descriptors: tell any interested control connections. <b>routers</b> is a list of <a class="el" href="structrouterinfo__t.html">routerinfo_t</a>'s. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_ac1c562cb6f09c13a49ec73cc1b72c7f8_icgraph.png" border="0" usemap="#control_8c_ac1c562cb6f09c13a49ec73cc1b72c7f8_icgraph" alt=""/></div>
<map name="control_8c_ac1c562cb6f09c13a49ec73cc1b72c7f8_icgraph" id="control_8c_ac1c562cb6f09c13a49ec73cc1b72c7f8_icgraph">
<area shape="rect" id="node2" href="routerlist_8h.html#ad0e00a6f0df9aace49976da496902957" title="routerlist_descriptors\l_added" alt="" coords="224,5,367,47"/>
</map>
</div>

</div>
</div>
<a id="a7118f2fef9379a00b4969283e6c0b8f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7118f2fef9379a00b4969283e6c0b8f8">&#9670;&nbsp;</a></span>control_event_general_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_general_error </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Format and send an EVENT_STATUS_GENERAL LOG_ERR event, and flush it to the controller(s) immediately. </p>

</div>
</div>
<a id="a1bd4001ec6bb62a01e1d6d6c3f3bf44a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bd4001ec6bb62a01e1d6d6c3f3bf44a">&#9670;&nbsp;</a></span>control_event_general_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_general_status </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Format and send an EVENT_STATUS_GENERAL event whose main text is obtained by formatting the arguments using the printf-style <b>format</b>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a1bd4001ec6bb62a01e1d6d6c3f3bf44a_icgraph.png" border="0" usemap="#control_8c_a1bd4001ec6bb62a01e1d6d6c3f3bf44a_icgraph" alt=""/></div>
<map name="control_8c_a1bd4001ec6bb62a01e1d6d6c3f3bf44a_icgraph" id="control_8c_a1bd4001ec6bb62a01e1d6d6c3f3bf44a_icgraph">
<area shape="rect" id="node2" href="circuitbuild_8h.html#ad0daecc03b3062716a6845b8a522d3da" title="circuit_note_clock\l_jumped" alt="" coords="203,5,329,47"/>
</map>
</div>

</div>
</div>
<a id="a4bcae87af9362ae1e34ba942a5ac124e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bcae87af9362ae1e34ba942a5ac124e">&#9670;&nbsp;</a></span>control_event_guard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_guard </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>nickname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when the status of an entry guard with the given <b>nickname</b> and identity <b>digest</b> has changed to <b>status</b>: tells any controllers that care. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a4bcae87af9362ae1e34ba942a5ac124e_cgraph.png" border="0" usemap="#control_8c_a4bcae87af9362ae1e34ba942a5ac124e_cgraph" alt=""/></div>
<map name="control_8c_a4bcae87af9362ae1e34ba942a5ac124e_cgraph" id="control_8c_a4bcae87af9362ae1e34ba942a5ac124e_cgraph">
<area shape="rect" id="node2" href="util__format_8c.html#a8b8940b2ef607928eb3dca4850567ea5" title="base16_encode" alt="" coords="443,5,557,32"/>
<area shape="rect" id="node3" href="nodelist_8c.html#ae942465b949bf8cc1006ddd3e9c61221" title="node_get_verbose_nickname" alt="" coords="192,56,383,83"/>
<area shape="rect" id="node5" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="244,107,331,133"/>
<area shape="rect" id="node4" href="nodelist_8c.html#a6d458e5290092933bd5c1aae33b2654f" title="node_get_nickname" alt="" coords="431,56,569,83"/>
<area shape="rect" id="node6" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="453,107,547,133"/>
</map>
</div>

</div>
</div>
<a id="a2fc2b6b7637cc858a77a37f96129edf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fc2b6b7637cc858a77a37f96129edf4">&#9670;&nbsp;</a></span>control_event_hs_descriptor_content()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_hs_descriptor_content </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>onion_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hsdir_id_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>content</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send HS_DESC_CONTENT event after completion of a successful fetch from hs directory. If <b>hsdir_id_digest</b> is NULL, it is replaced by "UNKNOWN". If <b>content</b> is NULL, it is replaced by an empty string. The <b>onion_address</b> or <b>desc_id</b> set to NULL will no trigger the control event. </p>

</div>
</div>
<a id="add53b1a6396162e3bb9eab66a6afebdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add53b1a6396162e3bb9eab66a6afebdc">&#9670;&nbsp;</a></span>control_event_hs_descriptor_created()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_hs_descriptor_created </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>onion_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>replica</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>send HS_DESC CREATED event when a local service generates a descriptor.</p>
<p><b>onion_address</b> is service address. <b>desc_id</b> is the descriptor ID. <b>replica</b> is the the descriptor replica number. If it is negative, it is ignored. </p>

</div>
</div>
<a id="a3b9d57f7220ee44755362058ffa97892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b9d57f7220ee44755362058ffa97892">&#9670;&nbsp;</a></span>control_event_hs_descriptor_requested()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_hs_descriptor_requested </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>onion_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#aafc6920f8a16e10f46703e7819795c74">rend_auth_type_t</a>&#160;</td>
          <td class="paramname"><em>auth_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hsdir_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>send HS_DESC requested event.</p>
<p><b>rend_query</b> is used to fetch requested onion address and auth type. <b>hs_dir</b> is the description of contacting hs directory. <b>desc_id_base32</b> is the ID of requested hs descriptor. <b>hsdir_index</b> is the HSDir fetch index value for v3, an hex string. </p>

</div>
</div>
<a id="a6195a5446c44a761339449df87237887"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6195a5446c44a761339449df87237887">&#9670;&nbsp;</a></span>control_event_hs_descriptor_upload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_hs_descriptor_upload </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>onion_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hsdir_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>send HS_DESC upload event.</p>
<p><b>onion_address</b> is service address. <b>hs_dir</b> is the description of contacting hs directory. <b>desc_id</b> is the ID of requested hs descriptor. </p>

</div>
</div>
<a id="a689805429adc3369580c97c9e8b9bdd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a689805429adc3369580c97c9e8b9bdd7">&#9670;&nbsp;</a></span>control_event_hs_descriptor_upload_end()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_hs_descriptor_upload_end </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>onion_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>send HS_DESC event after got response from hs directory.</p>
<p>NOTE: this is an internal function used by following functions: control_event_hs_descriptor_uploaded control_event_hs_descriptor_upload_failed</p>
<p>So do not call this function directly. </p>

</div>
</div>
<a id="a3dbd4bf59a3490e0272203314f56a66c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dbd4bf59a3490e0272203314f56a66c">&#9670;&nbsp;</a></span>control_event_hs_descriptor_upload_failed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_hs_descriptor_upload_failed </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>onion_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send HS_DESC event to inform controller upload of hidden service descriptor identified by <b>id_digest</b> failed. If <b>reason</b> is not NULL, add it to REASON= field. </p>

</div>
</div>
<a id="a6668148651c111619b3cbe75c39d75d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6668148651c111619b3cbe75c39d75d6">&#9670;&nbsp;</a></span>control_event_hs_descriptor_uploaded()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_hs_descriptor_uploaded </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>onion_address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>send HS_DESC UPLOADED event</p>
<p>called when we successfully uploaded a hidden service descriptor. </p>

</div>
</div>
<a id="a7407c201dd8249d580be5eeb048a74f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7407c201dd8249d580be5eeb048a74f6">&#9670;&nbsp;</a></span>control_event_hsv2_descriptor_failed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_hsv2_descriptor_failed </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structrend__data__t.html">rend_data_t</a> *&#160;</td>
          <td class="paramname"><em>rend_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hsdir_id_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send HS_DESC event to inform controller that query <b>rend_data</b> failed to retrieve hidden service descriptor from directory identified by <b>id_digest</b>. If NULL, "UNKNOWN" is used. If <b>reason</b> is not NULL, add it to REASON= field. </p>

</div>
</div>
<a id="a45ebad4c4804dd1e80cd580233af062a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45ebad4c4804dd1e80cd580233af062a">&#9670;&nbsp;</a></span>control_event_hsv2_descriptor_received()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_hsv2_descriptor_received </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>onion_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structrend__data__t.html">rend_data_t</a> *&#160;</td>
          <td class="paramname"><em>rend_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hsdir_id_digest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>send HS_DESC RECEIVED event</p>
<p>called when we successfully received a hidden service descriptor. </p>

</div>
</div>
<a id="a8420c8c951d738c5f549820689ae4ac8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8420c8c951d738c5f549820689ae4ac8">&#9670;&nbsp;</a></span>control_event_hsv3_descriptor_failed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_hsv3_descriptor_failed </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>onion_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hsdir_id_digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send HS_DESC event to inform controller that the query to <b>onion_address</b> failed to retrieve hidden service descriptor <b>desc_id</b> from directory identified by <b>hsdir_id_digest</b>. If NULL, "UNKNOWN" is used. If <b>reason</b> is not NULL, add it to REASON= field. </p>

</div>
</div>
<a id="a7bba7fc2c25aada4416d77a64caa4219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bba7fc2c25aada4416d77a64caa4219">&#9670;&nbsp;</a></span>control_event_is_interesting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_is_interesting </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff the event with code <b>c</b> is being sent to any current control connection. This is useful if the amount of work needed to prepare to call the appropriate control_event_...() function is high. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a7bba7fc2c25aada4416d77a64caa4219_icgraph.png" border="0" usemap="#control_8c_a7bba7fc2c25aada4416d77a64caa4219_icgraph" alt=""/></div>
<map name="control_8c_a7bba7fc2c25aada4416d77a64caa4219_icgraph" id="control_8c_a7bba7fc2c25aada4416d77a64caa4219_icgraph">
<area shape="rect" id="node2" href="control_8h.html#ac2cce566f007535370cda5c829181ede" title="control_event_newconsensus" alt="" coords="237,5,432,32"/>
<area shape="rect" id="node3" href="control_8h.html#ad6e3451a891012be7336b7b5a24a8465" title="control_event_signal" alt="" coords="264,56,405,83"/>
</map>
</div>

</div>
</div>
<a id="a2e2cfc4aa0b38b8043b3e4aa467e0745"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e2cfc4aa0b38b8043b3e4aa467e0745">&#9670;&nbsp;</a></span>control_event_logmsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_logmsg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We got a log message: tell any interested control connections. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a2e2cfc4aa0b38b8043b3e4aa467e0745_cgraph.png" border="0" usemap="#control_8c_a2e2cfc4aa0b38b8043b3e4aa467e0745_cgraph" alt=""/></div>
<map name="control_8c_a2e2cfc4aa0b38b8043b3e4aa467e0745_cgraph" id="control_8c_a2e2cfc4aa0b38b8043b3e4aa467e0745_cgraph">
<area shape="rect" id="node2" href="compat__threads_8c.html#a92e0c20ce48368802f8fcab7eaa6c669" title="in_main_thread" alt="" coords="203,5,313,32"/>
</map>
</div>

</div>
</div>
<a id="ade2557c81242d73d93750e0c68218a7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade2557c81242d73d93750e0c68218a7c">&#9670;&nbsp;</a></span>control_event_logmsg_pending()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_logmsg_pending </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Logging callback: called when there is a queued pending log callback. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_ade2557c81242d73d93750e0c68218a7c_cgraph.png" border="0" usemap="#control_8c_ade2557c81242d73d93750e0c68218a7c_cgraph" alt=""/></div>
<map name="control_8c_ade2557c81242d73d93750e0c68218a7c_cgraph" id="control_8c_ade2557c81242d73d93750e0c68218a7c_cgraph">
<area shape="rect" id="node2" href="compat__threads_8c.html#a92e0c20ce48368802f8fcab7eaa6c669" title="in_main_thread" alt="" coords="231,5,341,32"/>
<area shape="rect" id="node3" href="compat__libevent_8c.html#af815b0dd39abfb6b6ddbf5266175b479" title="mainloop_event_activate" alt="" coords="203,56,369,83"/>
</map>
</div>

</div>
</div>
<a id="a0648f9ac41df9391146becf8d7f7f650"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0648f9ac41df9391146becf8d7f7f650">&#9670;&nbsp;</a></span>control_event_my_descriptor_changed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_my_descriptor_changed </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Our own router descriptor has changed; tell any controllers that care. </p>

</div>
</div>
<a id="a88dfbfe80b8462d7ca8e438a40e6d30f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88dfbfe80b8462d7ca8e438a40e6d30f">&#9670;&nbsp;</a></span>control_event_network_liveness_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_network_liveness_update </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>liveness</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The network liveness has changed; this is called from <a class="el" href="circuitstats_8c.html" title="Maintains and analyzes statistics about circuit built times, so we can tell how long we may need to w...">circuitstats.c</a> whenever we receive a cell, or when timeout expires and we assume the network is down. </p>

</div>
</div>
<a id="a7331ec4f1191128906b7dcb447dad328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7331ec4f1191128906b7dcb447dad328">&#9670;&nbsp;</a></span>control_event_networkstatus_changed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_networkstatus_changed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>statuses</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when the routerstatus_ts <b>statuses</b> have changed: sends an NS event to any controller that cares. </p>

</div>
</div>
<a id="a9be374155fbeb8f7102071f7ddf6facb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9be374155fbeb8f7102071f7ddf6facb">&#9670;&nbsp;</a></span>control_event_networkstatus_changed_single()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_networkstatus_changed_single </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structrouterstatus__t.html">routerstatus_t</a> *&#160;</td>
          <td class="paramname"><em>rs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when a single local_routerstatus_t has changed: Sends an NS event to any controller that cares. </p>

</div>
</div>
<a id="ac2cce566f007535370cda5c829181ede"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2cce566f007535370cda5c829181ede">&#9670;&nbsp;</a></span>control_event_newconsensus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_newconsensus </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>consensus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we get a new consensus networkstatus. Sends a NEWCONSENSUS event consisting of an NS-style line for each relay in the consensus. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_ac2cce566f007535370cda5c829181ede_cgraph.png" border="0" usemap="#control_8c_ac2cce566f007535370cda5c829181ede_cgraph" alt=""/></div>
<map name="control_8c_ac2cce566f007535370cda5c829181ede_cgraph" id="control_8c_ac2cce566f007535370cda5c829181ede_cgraph">
<area shape="rect" id="node2" href="control_8c.html#a7bba7fc2c25aada4416d77a64caa4219" title="control_event_is_interesting" alt="" coords="248,5,432,32"/>
</map>
</div>

</div>
</div>
<a id="a7ec5a96f0e43d4719b7992819bb3f1ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ec5a96f0e43d4719b7992819bb3f1ac">&#9670;&nbsp;</a></span>control_event_or_conn_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_or_conn_status </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a53c095ab81f2a8e2c459a95c35ab6ecc">or_conn_status_event_t</a>&#160;</td>
          <td class="paramname"><em>tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when the status of an OR connection <b>conn</b> changes: tell any interested control connections. <b>tp</b> is the new status for the connection. If <b>conn</b> has just closed or failed, then <b>reason</b> may be the reason why. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a7ec5a96f0e43d4719b7992819bb3f1ac_icgraph.png" border="0" usemap="#control_8c_a7ec5a96f0e43d4719b7992819bb3f1ac_icgraph" alt=""/></div>
<map name="control_8c_a7ec5a96f0e43d4719b7992819bb3f1ac_icgraph" id="control_8c_a7ec5a96f0e43d4719b7992819bb3f1ac_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#a6a75b0592cc90f11549ed8899454a1f0" title="connection_or_connect\l_failed" alt="" coords="207,5,363,47"/>
<area shape="rect" id="node3" href="connection__or_8h.html#a1782f56c8e2a13ef3db44eed29c83d28" title="connection_or_notify\l_error" alt="" coords="411,5,553,47"/>
</map>
</div>

</div>
</div>
<a id="a0edfc547e3467665efb1a4fe346b45a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0edfc547e3467665efb1a4fe346b45a0">&#9670;&nbsp;</a></span>control_event_server_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_server_error </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Format and send an EVENT_STATUS_SERVER LOG_ERR event, and flush it to the controller(s) immediately. </p>

</div>
</div>
<a id="a744e1e120d455e1662fdbb4704a1be20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a744e1e120d455e1662fdbb4704a1be20">&#9670;&nbsp;</a></span>control_event_server_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_server_status </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Format and send an EVENT_STATUS_SERVER event whose main text is obtained by formatting the arguments using the printf-style <b>format</b>. </p>

</div>
</div>
<a id="a3a3b05ceb558dee6cac62cb7f389f19b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a3b05ceb558dee6cac62cb7f389f19b">&#9670;&nbsp;</a></span>control_event_signal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_signal </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>signal_num</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when a signal has been processed from signal_callback </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a3a3b05ceb558dee6cac62cb7f389f19b_cgraph.png" border="0" usemap="#control_8c_a3a3b05ceb558dee6cac62cb7f389f19b_cgraph" alt=""/></div>
<map name="control_8c_a3a3b05ceb558dee6cac62cb7f389f19b_cgraph" id="control_8c_a3a3b05ceb558dee6cac62cb7f389f19b_cgraph">
<area shape="rect" id="node2" href="control_8c.html#a7bba7fc2c25aada4416d77a64caa4219" title="control_event_is_interesting" alt="" coords="195,5,379,32"/>
</map>
</div>

</div>
</div>
<a id="a1071613ea5671cd5cb638caf0d959395"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1071613ea5671cd5cb638caf0d959395">&#9670;&nbsp;</a></span>control_event_stream_bandwidth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_stream_bandwidth </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structedge__connection__t.html">edge_connection_t</a> *&#160;</td>
          <td class="paramname"><em>edge_conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Print out STREAM_BW event for a single conn </p>

</div>
</div>
<a id="a482ef6a449be80739f6d8b094c104c07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a482ef6a449be80739f6d8b094c104c07">&#9670;&nbsp;</a></span>control_event_stream_bandwidth_used()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_stream_bandwidth_used </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A second or more has elapsed: tell any interested control connections how much bandwidth streams have used. </p>

</div>
</div>
<a id="a9acf2608d05458d1a9e8531619363080"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9acf2608d05458d1a9e8531619363080">&#9670;&nbsp;</a></span>control_event_stream_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int control_event_stream_status </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structentry__connection__t.html">entry_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a678356e73d49a4c5cf2dc3133de8b49a">stream_status_event_t</a>&#160;</td>
          <td class="paramname"><em>tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reason_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Something has happened to the stream associated with AP connection <b>conn</b>: tell any interested control connections. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a9acf2608d05458d1a9e8531619363080_icgraph.png" border="0" usemap="#control_8c_a9acf2608d05458d1a9e8531619363080_icgraph" alt=""/></div>
<map name="control_8c_a9acf2608d05458d1a9e8531619363080_icgraph" id="control_8c_a9acf2608d05458d1a9e8531619363080_icgraph">
<area shape="rect" id="node2" href="connection__edge_8h.html#a44bc7714d6e53e1ce4eaa07344fc8ba5" title="connection_ap_detach\l_retriable" alt="" coords="200,5,352,47"/>
</map>
</div>

</div>
</div>
<a id="a8d693451765fc0a044d1bc40ce0a0809"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d693451765fc0a044d1bc40ce0a0809">&#9670;&nbsp;</a></span>control_event_transport_launched()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_event_transport_launched </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>transport_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtor__addr__t.html">tor_addr_t</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A new pluggable transport called <b>transport_name</b> was launched on <b>addr</b>:<b>port</b>. <b>mode</b> is either "server" or "client" depending on the mode of the pluggable transport. "650" SP "TRANSPORT_LAUNCHED" SP Mode SP Name SP Address SP Port </p>

</div>
</div>
<a id="a5cdf2d5778284e11b466e62b92c7bdbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cdf2d5778284e11b466e62b92c7bdbf">&#9670;&nbsp;</a></span>control_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free any leftover allocated memory of the <a class="el" href="control_8c.html" title="Implementation for Tor&#39;s control-socket interface. ">control.c</a> subsystem. </p>

</div>
</div>
<a id="ae1881d4083d31106d2108a1ac919ac4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1881d4083d31106d2108a1ac919ac4e">&#9670;&nbsp;</a></span>control_per_second_events()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_per_second_events </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Run all the controller events (if any) that are scheduled to trigger once per second. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_ae1881d4083d31106d2108a1ac919ac4e_cgraph.png" border="0" usemap="#control_8c_ae1881d4083d31106d2108a1ac919ac4e_cgraph" alt=""/></div>
<map name="control_8c_ae1881d4083d31106d2108a1ac919ac4e_cgraph" id="control_8c_ae1881d4083d31106d2108a1ac919ac4e_cgraph">
<area shape="rect" id="node2" href="control_8c.html#afa7eff3569fc8e5e5e27c1d6d9f02125" title="control_any_per_second\l_event_enabled" alt="" coords="188,5,351,47"/>
</map>
</div>

</div>
</div>
<a id="a0381183e4e119ef80562083e5d6305fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0381183e4e119ef80562083e5d6305fe">&#9670;&nbsp;</a></span>control_ports_write_to_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_ports_write_to_file </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write all of the open control ports to ControlPortWriteToFile </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a0381183e4e119ef80562083e5d6305fe_cgraph.png" border="0" usemap="#control_8c_a0381183e4e119ef80562083e5d6305fe_cgraph" alt=""/></div>
<map name="control_8c_a0381183e4e119ef80562083e5d6305fe_cgraph" id="control_8c_a0381183e4e119ef80562083e5d6305fe_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a68cb44a66a7446022122c93590b6d179" title="smartlist_add_asprintf" alt="" coords="185,31,336,57"/>
<area shape="rect" id="node6" href="container_8c.html#ab865391a8cac688c51809c33dad0bfe2" title="smartlist_join_strings" alt="" coords="188,81,333,108"/>
<area shape="rect" id="node3" href="util_8c.html#a4fee2abf83af3a8b8a18b245daf4083b" title="smartlist_add_vasprintf" alt="" coords="384,31,541,57"/>
<area shape="rect" id="node4" href="compat_8c.html#a5ef7a08e8b543c0d61f9ef1081d4c1ea" title="tor_vasprintf" alt="" coords="592,5,687,32"/>
<area shape="rect" id="node5" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="589,56,689,83"/>
<area shape="rect" id="node7" href="container_8c.html#aac69a4c0d462859a1a13a6eb35ab3c0a" title="smartlist_join_strings2" alt="" coords="387,81,539,108"/>
</map>
</div>

</div>
</div>
<a id="ade569bf3dbd2110f2ac817428885f0b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade569bf3dbd2110f2ac817428885f0b9">&#9670;&nbsp;</a></span>control_update_global_event_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_update_global_event_mask </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>global_event_mask*</b> to the bitwise OR of each live control connection's event_mask field. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_ade569bf3dbd2110f2ac817428885f0b9_icgraph.png" border="0" usemap="#control_8c_ade569bf3dbd2110f2ac817428885f0b9_icgraph" alt=""/></div>
<map name="control_8c_ade569bf3dbd2110f2ac817428885f0b9_icgraph" id="control_8c_ade569bf3dbd2110f2ac817428885f0b9_icgraph">
<area shape="rect" id="node2" href="control_8h.html#a966dc2b23c935600dc1f815fe8e88fda" title="connection_control\l_closed" alt="" coords="201,5,332,47"/>
</map>
</div>

</div>
</div>
<a id="ab464eef1adbc6df3fcc09063dc6f9c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab464eef1adbc6df3fcc09063dc6f9c3e">&#9670;&nbsp;</a></span>decode_hashed_passwords()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsmartlist__t.html">smartlist_t</a>* decode_hashed_passwords </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structconfig__line__t.html">config_line_t</a> *&#160;</td>
          <td class="paramname"><em>passwords</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decode the hashed, base64'd passwords stored in <b>passwords</b>. Return a smartlist of acceptable passwords (unterminated strings of length S2K_RFC2440_SPECIFIER_LEN+DIGEST_LEN) on success, or NULL on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_ab464eef1adbc6df3fcc09063dc6f9c3e_cgraph.png" border="0" usemap="#control_8c_ab464eef1adbc6df3fcc09063dc6f9c3e_cgraph" alt=""/></div>
<map name="control_8c_ab464eef1adbc6df3fcc09063dc6f9c3e_cgraph" id="control_8c_ab464eef1adbc6df3fcc09063dc6f9c3e_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="249,5,337,32"/>
<area shape="rect" id="node3" href="util__format_8c.html#a6942053f58dd619a86734e55a42d7266" title="base16_decode" alt="" coords="236,56,349,83"/>
<area shape="rect" id="node4" href="util__format_8c.html#a21c1486a0e17c055aed65a12ec364350" title="base64_decode" alt="" coords="236,107,349,133"/>
<area shape="rect" id="node5" href="container_8c.html#accf59a8b7d39a4286ff99653b6878006" title="smartlist_add" alt="" coords="243,157,343,184"/>
</map>
</div>

</div>
</div>
<a id="a3cf18ec51013b4b0b8b104ef4509ca61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cf18ec51013b4b0b8b104ef4509ca61">&#9670;&nbsp;</a></span>disable_control_logging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void disable_control_logging </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we are sending a log message to the controllers: suspend sending further log messages to the controllers until we're done. Used by CONN_LOG_PROTECT. </p>

</div>
</div>
<a id="a8336a8705fe16b16bc29aa26defeb567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8336a8705fe16b16bc29aa26defeb567">&#9670;&nbsp;</a></span>enable_control_logging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void enable_control_logging </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We're done sending a log message to the controllers: re-enable controller logging. Used by CONN_LOG_PROTECT. </p>

</div>
</div>
<a id="a21f67f80a4baa5a7432a916937e38d45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21f67f80a4baa5a7432a916937e38d45">&#9670;&nbsp;</a></span>format_cell_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void format_cell_stats </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>event_string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcircuit__t.html">circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cell_stats_t *&#160;</td>
          <td class="paramname"><em>cell_stats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: format <b>cell_stats</b> for <b>circ</b> for inclusion in a CELL_STATS event and write result string to <b>event_string</b>. </p>

</div>
</div>
<a id="a9443fc62bda985f770ac05fe96fcd4f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9443fc62bda985f770ac05fe96fcd4f4">&#9670;&nbsp;</a></span>get_controller_cookie_file_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* get_controller_cookie_file_name </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: Return a newly allocated string containing a path to the file where we store our authentication cookie. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a9443fc62bda985f770ac05fe96fcd4f4_icgraph.png" border="0" usemap="#control_8c_a9443fc62bda985f770ac05fe96fcd4f4_icgraph" alt=""/></div>
<map name="control_8c_a9443fc62bda985f770ac05fe96fcd4f4_icgraph" id="control_8c_a9443fc62bda985f770ac05fe96fcd4f4_icgraph">
<area shape="rect" id="node2" href="main_8h.html#a4d28e76dd898a85ba3459928e3659954" title="tor_cleanup" alt="" coords="199,13,288,39"/>
</map>
</div>

</div>
</div>
<a id="aaa944da80f923edd033b270cb4b84cba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa944da80f923edd033b270cb4b84cba">&#9670;&nbsp;</a></span>getinfo_helper_current_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int getinfo_helper_current_time </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *&#160;</td>
          <td class="paramname"><em>control_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>question</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>answer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>errmsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Implementation helper for GETINFO: answers requests for information about the current time in both local and UTF forms. </p>

</div>
</div>
<a id="aafbf616bddc3f380f8c682ed7550e3c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafbf616bddc3f380f8c682ed7550e3c4">&#9670;&nbsp;</a></span>getinfo_helper_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int getinfo_helper_dir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *&#160;</td>
          <td class="paramname"><em>control_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>question</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>answer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>errmsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Implementation helper for GETINFO: knows the answers for questions about directory information. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_aafbf616bddc3f380f8c682ed7550e3c4_cgraph.png" border="0" usemap="#control_8c_aafbf616bddc3f380f8c682ed7550e3c4_cgraph" alt=""/></div>
<map name="control_8c_aafbf616bddc3f380f8c682ed7550e3c4_cgraph" id="control_8c_aafbf616bddc3f380f8c682ed7550e3c4_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="225,5,313,32"/>
<area shape="rect" id="node3" href="nodelist_8c.html#ab876cec61e163d3246f27357c98d0687" title="node_get_by_hex_id" alt="" coords="199,56,340,83"/>
<area shape="rect" id="node6" href="routerlist_8c.html#af4d8bdd829c8eab4c9060c014fb59af8" title="signed_descriptor_get_body" alt="" coords="177,107,361,133"/>
<area shape="rect" id="node4" href="routerlist_8c.html#a589e19badbee6e0257d94d03dcc40ba7" title="hex_digest_nickname\l_decode" alt="" coords="409,49,557,90"/>
<area shape="rect" id="node5" href="util__format_8c.html#a6942053f58dd619a86734e55a42d7266" title="base16_decode" alt="" coords="605,56,719,83"/>
</map>
</div>

</div>
</div>
<a id="a8464eca5a44ec95b58f55316cd5a4ceb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8464eca5a44ec95b58f55316cd5a4ceb">&#9670;&nbsp;</a></span>getinfo_helper_downloads()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int getinfo_helper_downloads </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *&#160;</td>
          <td class="paramname"><em>control_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>question</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>answer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>errmsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Implementation helper for GETINFO: knows the answers for questions about download status information. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a8464eca5a44ec95b58f55316cd5a4ceb_cgraph.png" border="0" usemap="#control_8c_a8464eca5a44ec95b58f55316cd5a4ceb_cgraph" alt=""/></div>
<map name="control_8c_a8464eca5a44ec95b58f55316cd5a4ceb_cgraph" id="control_8c_a8464eca5a44ec95b58f55316cd5a4ceb_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="493,42,581,68"/>
<area shape="rect" id="node3" href="control_8c.html#aaee0cff899e0420de1d16379fffe98c8" title="getinfo_helper_downloads\l_networkstatus" alt="" coords="243,34,415,76"/>
<area shape="rect" id="node4" href="control_8c.html#afb5aa2ca5fb7e5db504bf1d3ff1342c5" title="getinfo_helper_downloads_cert" alt="" coords="228,100,429,127"/>
<area shape="rect" id="node6" href="control_8c.html#a158cde22d2f4bffa9d62a032aa02308a" title="getinfo_helper_downloads_desc" alt="" coords="225,151,432,178"/>
<area shape="rect" id="node7" href="control_8c.html#ad3d55d1ae306e3c81057ead47dcafb0d" title="getinfo_helper_downloads\l_bridge" alt="" coords="243,202,415,244"/>
<area shape="rect" id="node5" href="util__format_8c.html#a6942053f58dd619a86734e55a42d7266" title="base16_decode" alt="" coords="480,151,593,178"/>
</map>
</div>

</div>
</div>
<a id="ad3d55d1ae306e3c81057ead47dcafb0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3d55d1ae306e3c81057ead47dcafb0d">&#9670;&nbsp;</a></span>getinfo_helper_downloads_bridge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void getinfo_helper_downloads_bridge </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>bridge_req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdownload__status__t.html">download_status_t</a> **&#160;</td>
          <td class="paramname"><em>dl_to_emit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> **&#160;</td>
          <td class="paramname"><em>digest_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>errmsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle the bridge download cases for <a class="el" href="control_8c.html#a8464eca5a44ec95b58f55316cd5a4ceb">getinfo_helper_downloads()</a> </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_ad3d55d1ae306e3c81057ead47dcafb0d_cgraph.png" border="0" usemap="#control_8c_ad3d55d1ae306e3c81057ead47dcafb0d_cgraph" alt=""/></div>
<map name="control_8c_ad3d55d1ae306e3c81057ead47dcafb0d_cgraph" id="control_8c_ad3d55d1ae306e3c81057ead47dcafb0d_cgraph">
<area shape="rect" id="node2" href="util__format_8c.html#a6942053f58dd619a86734e55a42d7266" title="base16_decode" alt="" coords="225,13,339,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_ad3d55d1ae306e3c81057ead47dcafb0d_icgraph.png" border="0" usemap="#control_8c_ad3d55d1ae306e3c81057ead47dcafb0d_icgraph" alt=""/></div>
<map name="control_8c_ad3d55d1ae306e3c81057ead47dcafb0d_icgraph" id="control_8c_ad3d55d1ae306e3c81057ead47dcafb0d_icgraph">
<area shape="rect" id="node2" href="control_8c.html#a8464eca5a44ec95b58f55316cd5a4ceb" title="getinfo_helper_downloads" alt="" coords="225,13,397,39"/>
</map>
</div>

</div>
</div>
<a id="afb5aa2ca5fb7e5db504bf1d3ff1342c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb5aa2ca5fb7e5db504bf1d3ff1342c5">&#9670;&nbsp;</a></span>getinfo_helper_downloads_cert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void getinfo_helper_downloads_cert </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fp_sk_req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdownload__status__t.html">download_status_t</a> **&#160;</td>
          <td class="paramname"><em>dl_to_emit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> **&#160;</td>
          <td class="paramname"><em>digest_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>errmsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle the cert download cases for <a class="el" href="control_8c.html#a8464eca5a44ec95b58f55316cd5a4ceb">getinfo_helper_downloads()</a> </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_afb5aa2ca5fb7e5db504bf1d3ff1342c5_cgraph.png" border="0" usemap="#control_8c_afb5aa2ca5fb7e5db504bf1d3ff1342c5_cgraph" alt=""/></div>
<map name="control_8c_afb5aa2ca5fb7e5db504bf1d3ff1342c5_cgraph" id="control_8c_afb5aa2ca5fb7e5db504bf1d3ff1342c5_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="267,5,355,32"/>
<area shape="rect" id="node3" href="util__format_8c.html#a6942053f58dd619a86734e55a42d7266" title="base16_decode" alt="" coords="255,56,368,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_afb5aa2ca5fb7e5db504bf1d3ff1342c5_icgraph.png" border="0" usemap="#control_8c_afb5aa2ca5fb7e5db504bf1d3ff1342c5_icgraph" alt=""/></div>
<map name="control_8c_afb5aa2ca5fb7e5db504bf1d3ff1342c5_icgraph" id="control_8c_afb5aa2ca5fb7e5db504bf1d3ff1342c5_icgraph">
<area shape="rect" id="node2" href="control_8c.html#a8464eca5a44ec95b58f55316cd5a4ceb" title="getinfo_helper_downloads" alt="" coords="255,5,427,32"/>
</map>
</div>

</div>
</div>
<a id="a158cde22d2f4bffa9d62a032aa02308a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a158cde22d2f4bffa9d62a032aa02308a">&#9670;&nbsp;</a></span>getinfo_helper_downloads_desc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void getinfo_helper_downloads_desc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc_req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdownload__status__t.html">download_status_t</a> **&#160;</td>
          <td class="paramname"><em>dl_to_emit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> **&#160;</td>
          <td class="paramname"><em>digest_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>errmsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle the routerdesc download cases for <a class="el" href="control_8c.html#a8464eca5a44ec95b58f55316cd5a4ceb">getinfo_helper_downloads()</a> </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a158cde22d2f4bffa9d62a032aa02308a_cgraph.png" border="0" usemap="#control_8c_a158cde22d2f4bffa9d62a032aa02308a_cgraph" alt=""/></div>
<map name="control_8c_a158cde22d2f4bffa9d62a032aa02308a_cgraph" id="control_8c_a158cde22d2f4bffa9d62a032aa02308a_cgraph">
<area shape="rect" id="node2" href="util__format_8c.html#a6942053f58dd619a86734e55a42d7266" title="base16_decode" alt="" coords="260,5,373,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a158cde22d2f4bffa9d62a032aa02308a_icgraph.png" border="0" usemap="#control_8c_a158cde22d2f4bffa9d62a032aa02308a_icgraph" alt=""/></div>
<map name="control_8c_a158cde22d2f4bffa9d62a032aa02308a_icgraph" id="control_8c_a158cde22d2f4bffa9d62a032aa02308a_icgraph">
<area shape="rect" id="node2" href="control_8c.html#a8464eca5a44ec95b58f55316cd5a4ceb" title="getinfo_helper_downloads" alt="" coords="260,5,432,32"/>
</map>
</div>

</div>
</div>
<a id="aaee0cff899e0420de1d16379fffe98c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaee0cff899e0420de1d16379fffe98c8">&#9670;&nbsp;</a></span>getinfo_helper_downloads_networkstatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void getinfo_helper_downloads_networkstatus </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>flavor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdownload__status__t.html">download_status_t</a> **&#160;</td>
          <td class="paramname"><em>dl_to_emit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>errmsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle the consensus download cases for <a class="el" href="control_8c.html#a8464eca5a44ec95b58f55316cd5a4ceb">getinfo_helper_downloads()</a> </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_aaee0cff899e0420de1d16379fffe98c8_icgraph.png" border="0" usemap="#control_8c_aaee0cff899e0420de1d16379fffe98c8_icgraph" alt=""/></div>
<map name="control_8c_aaee0cff899e0420de1d16379fffe98c8_icgraph" id="control_8c_aaee0cff899e0420de1d16379fffe98c8_icgraph">
<area shape="rect" id="node2" href="control_8c.html#a8464eca5a44ec95b58f55316cd5a4ceb" title="getinfo_helper_downloads" alt="" coords="225,13,397,39"/>
</map>
</div>

</div>
</div>
<a id="ad7b56ac7ede2a04d5c8311a5fbae88ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7b56ac7ede2a04d5c8311a5fbae88ab">&#9670;&nbsp;</a></span>getinfo_helper_onions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int getinfo_helper_onions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcontrol__connection__t.html">control_connection_t</a> *&#160;</td>
          <td class="paramname"><em>control_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>question</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>answer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>errmsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Implementation helper for GETINFO: knows how to enumerate hidden services created via the control port. </p>

</div>
</div>
<a id="afbfd2697ea512e2df42fc31c8e1d208a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbfd2697ea512e2df42fc31c8e1d208a">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC&#160;</td>
          <td class="paramname"><em>void</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">queue_control_event_string&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(uint16_t event, char *msg)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: inserts an event on the list of events queued to be sent to one or more controllers, and schedules the events to be flushed if needed.</p>
<p>This function takes ownership of <b>msg</b>, and may free it.</p>
<p>We queue these events rather than send them immediately in order to break the dependency in our callgraph from code that generates events for the controller, and the network layer at large. Otherwise, nearly every interesting part of Tor would potentially call every other interesting part of Tor. </p>

</div>
</div>
<a id="a8920daea607720e420120036eafa61f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8920daea607720e420120036eafa61f8">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">STATIC&#160;</td>
          <td class="paramname"><em>void</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">send_control_event_string&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(uint16_t event, const char *msg)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send an event to all v1 controllers that are listening for code <b>event</b>. The event's body is given by <b>msg</b>.</p>
<p>The EXTENDED_FORMAT and NONEXTENDED_FORMAT flags behave similarly with respect to the EXTENDED_EVENTS feature. </p>

</div>
</div>
<a id="a12cf925561cc1fc7aab3dc2b383a3071"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12cf925561cc1fc7aab3dc2b383a3071">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">control_event_bootstrap_prob_or&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(const char *warn, int reason, <a class="el" href="structor__connection__t.html">or_connection_t</a> *or_conn)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when Tor has failed to make bootstrapping progress in a way that indicates a problem. <b>warn</b> gives a hint as to why, and <b>reason</b> provides an "or_conn_end_reason" tag. <b>or_conn</b> is the connection that caused this problem. </p>

</div>
</div>
<a id="a000c7faf94744c2b3a6f1753b513e5ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a000c7faf94744c2b3a6f1753b513e5ae">&#9670;&nbsp;</a></span>MOCK_IMPL() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MOCK_IMPL </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">node_describe_longname_by_id&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">(const char *id_digest)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a longname the node whose identity is <b>id_digest</b>. If node_get_by_id() returns NULL, base 16 encoding of <b>id_digest</b> is returned instead.</p>
<p>This function is not thread-safe. Each call to this function invalidates previous values returned by this function. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="control_8c_a000c7faf94744c2b3a6f1753b513e5ae_cgraph.png" border="0" usemap="#control_8c_a000c7faf94744c2b3a6f1753b513e5ae_cgraph" alt=""/></div>
<map name="control_8c_a000c7faf94744c2b3a6f1753b513e5ae_cgraph" id="control_8c_a000c7faf94744c2b3a6f1753b513e5ae_cgraph">
<area shape="rect" id="node2" href="nodelist_8c.html#a111b3704de6d40d874d64dbced6bb9ae" title="node_get_verbose_nickname\l_by_id" alt="" coords="153,23,344,65"/>
<area shape="rect" id="node3" href="util__format_8c.html#a8b8940b2ef607928eb3dca4850567ea5" title="base16_encode" alt="" coords="643,5,757,32"/>
<area shape="rect" id="node4" href="nodelist_8c.html#ae942465b949bf8cc1006ddd3e9c61221" title="node_get_verbose_nickname" alt="" coords="392,56,583,83"/>
<area shape="rect" id="node5" href="nodelist_8c.html#a6d458e5290092933bd5c1aae33b2654f" title="node_get_nickname" alt="" coords="631,56,769,83"/>
</map>
</div>

</div>
</div>
<a id="ad1f8aa865448a4f8c34719f2b1ea67d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1f8aa865448a4f8c34719f2b1ea67d2">&#9670;&nbsp;</a></span>monitor_owning_controller_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void monitor_owning_controller_process </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>process_spec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>process_spec</b> as Tor's owning controller process. Exit on failure. </p>

</div>
</div>
<a id="abdb9c00c330d8c723c5e307c46aa7387"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdb9c00c330d8c723c5e307c46aa7387">&#9670;&nbsp;</a></span>read_escaped_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC size_t read_escaped_data </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a <b>len</b>-character string in <b>data</b>, made of lines terminated by CRLF, allocate a new string in *<b>out</b>, and copy the contents of <b>data</b> into *<b>out</b>, removing any period that appears at the start of a line, and replacing all CRLF sequences with LF. Return the number of bytes in *<b>out</b>. </p>

</div>
</div>
<a id="a9f5b8b8ca50d94db752f91e1d59034b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f5b8b8ca50d94db752f91e1d59034b8">&#9670;&nbsp;</a></span>rend_auth_type_to_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* rend_auth_type_to_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="or_8h.html#aafc6920f8a16e10f46703e7819795c74">rend_auth_type_t</a>&#160;</td>
          <td class="paramname"><em>auth_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert rendezvous auth type to string for HS_DESC control events </p>

</div>
</div>
<a id="a45b32d8cedf52b7ef8b0174d47a4cc37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45b32d8cedf52b7ef8b0174d47a4cc37">&#9670;&nbsp;</a></span>sum_up_cell_stats_by_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sum_up_cell_stats_by_command </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcircuit__t.html">circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cell_stats_t *&#160;</td>
          <td class="paramname"><em>cell_stats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: iterate over cell statistics of <b>circ</b> and sum up added cells, removed cells, and waiting times by cell command and direction. Store results in <b>cell_stats</b>. Free cell statistics of the circuit afterwards. </p>

</div>
</div>
<a id="af2fafbf3893d3223323b28be3324b199"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2fafbf3893d3223323b28be3324b199">&#9670;&nbsp;</a></span>write_escaped_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC size_t write_escaped_data </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a <b>len</b>-character string in <b>data</b>, made of lines terminated by CRLF, allocate a new string in *<b>out</b>, and copy the contents of <b>data</b> into *<b>out</b>, adding a period before any period that appears at the start of a line, and adding a period-CRLF line at the end. Replace all LF characters sequences with CRLF. Return the number of bytes in *<b>out</b>. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
