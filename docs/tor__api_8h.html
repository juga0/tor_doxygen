<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/tor_api.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tor_api.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Public C API for the Tor network service.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="tor__api_8h__dep__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2tor__api_8hdep" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2tor__api_8hdep" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2tor__api_8hdep">
<area shape="rect" id="node2" href="main_8c.html" title="Toplevel module. Handles signals, multiplexes between connections, implements main loop..." alt="" coords="5,109,153,165"/>
<area shape="rect" id="node3" href="tor__api_8c.html" title="/home/user/_my/code\l/bwauth&#45;related/tor\l/src/or/tor_api.c" alt="" coords="177,109,325,165"/>
<area shape="rect" id="node4" href="tor__runner_8c.html" title="Experimental module to emulate tor_run_main() API with fork+exec. " alt="" coords="350,109,499,165"/>
</map>
</div>
</div>
<p><a href="tor__api_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a08fd3b8f009aa988cf6133dfc0783caf"><td class="memItemLeft" align="right" valign="top"><a id="a08fd3b8f009aa988cf6133dfc0783caf"></a>
typedef struct <a class="el" href="structtor__main__configuration__t.html">tor_main_configuration_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>tor_main_configuration_t</b></td></tr>
<tr class="separator:a08fd3b8f009aa988cf6133dfc0783caf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a492d3b04d7d987e557b360baa222f32c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtor__main__configuration__t.html">tor_main_configuration_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tor__api_8h.html#a492d3b04d7d987e557b360baa222f32c">tor_main_configuration_new</a> (void)</td></tr>
<tr class="separator:a492d3b04d7d987e557b360baa222f32c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e4d16991254ff6ede69bc5050796130"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tor__api_8h.html#a4e4d16991254ff6ede69bc5050796130">tor_main_configuration_set_command_line</a> (<a class="el" href="structtor__main__configuration__t.html">tor_main_configuration_t</a> *cfg, int argc, char *argv[])</td></tr>
<tr class="separator:a4e4d16991254ff6ede69bc5050796130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad869650abfa67785a584da17fe79201"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tor__api_8h.html#aad869650abfa67785a584da17fe79201">tor_main_configuration_free</a> (<a class="el" href="structtor__main__configuration__t.html">tor_main_configuration_t</a> *cfg)</td></tr>
<tr class="separator:aad869650abfa67785a584da17fe79201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03a6419d2872fb481d95c23a7283cebf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tor__api_8h.html#a03a6419d2872fb481d95c23a7283cebf">tor_run_main</a> (const <a class="el" href="structtor__main__configuration__t.html">tor_main_configuration_t</a> *)</td></tr>
<tr class="separator:a03a6419d2872fb481d95c23a7283cebf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8065629c5ebc53aa63929d456662526a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tor__api_8h.html#a8065629c5ebc53aa63929d456662526a">tor_main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a8065629c5ebc53aa63929d456662526a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Public C API for the Tor network service. </p>
<p>This interface is intended for use by programs that need to link Tor as a library, and launch it in a separate thread. If you have the ability to run Tor as a separate executable, you should probably do that instead of embedding it as a library.</p>
<p>To use this API, first construct a <a class="el" href="structtor__main__configuration__t.html">tor_main_configuration_t</a> object using <a class="el" href="tor__api_8h.html#a492d3b04d7d987e557b360baa222f32c">tor_main_configuration_new()</a>. Then, you use one or more other function calls (such as <a class="el" href="tor__api_8h.html#a4e4d16991254ff6ede69bc5050796130">tor_main_configuration_set_command_line()</a> to configure how Tor should be run. Finally, you pass the configuration object to <a class="el" href="tor__api_8h.html#a03a6419d2872fb481d95c23a7283cebf">tor_run_main()</a>.</p>
<p>At this point, <a class="el" href="tor__api_8h.html#a03a6419d2872fb481d95c23a7283cebf">tor_run_main()</a> will block its thread to run a Tor daemon; when the Tor daemon exits, it will return. See notes on bugs and limitations below.</p>
<p>There is no other public C API to Tor: calling any C Tor function not documented in this file is not guaranteed to be stable. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a8065629c5ebc53aa63929d456662526a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8065629c5ebc53aa63929d456662526a">&#9670;&nbsp;</a></span>tor_main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Run the tor process, as if from the command line.</p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000001">Deprecated:</a></b></dt><dd>Using this function from outside Tor is deprecated; you should use <a class="el" href="tor__api_8h.html#a03a6419d2872fb481d95c23a7283cebf">tor_run_main()</a> instead.</dd></dl>
<p>BUGS: This function has all the same bugs as <a class="el" href="tor__api_8h.html#a03a6419d2872fb481d95c23a7283cebf">tor_run_main()</a>.</p>
<p>LIMITATIONS: This function has all the limitations of <a class="el" href="tor__api_8h.html#a03a6419d2872fb481d95c23a7283cebf">tor_run_main()</a>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tor__api_8h_a8065629c5ebc53aa63929d456662526a_icgraph.png" border="0" usemap="#tor__api_8h_a8065629c5ebc53aa63929d456662526a_icgraph" alt=""/></div>
<map name="tor__api_8h_a8065629c5ebc53aa63929d456662526a_icgraph" id="tor__api_8h_a8065629c5ebc53aa63929d456662526a_icgraph">
<area shape="rect" id="node2" href="tor__main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="125,5,176,32"/>
<area shape="rect" id="node3" href="test_8h.html#a334e47899bf2c19bf8a5ce0f226ab399" title="get_fname_rnd" alt="" coords="224,5,332,32"/>
</map>
</div>

</div>
</div>
<a id="aad869650abfa67785a584da17fe79201"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad869650abfa67785a584da17fe79201">&#9670;&nbsp;</a></span>tor_main_configuration_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_main_configuration_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtor__main__configuration__t.html">tor_main_configuration_t</a> *&#160;</td>
          <td class="paramname"><em>cfg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all storage held in <b>cfg</b>.</p>
<p>Once you have passed a <a class="el" href="structtor__main__configuration__t.html">tor_main_configuration_t</a> to <a class="el" href="tor__api_8h.html#a03a6419d2872fb481d95c23a7283cebf">tor_run_main()</a>, you must not free it until <a class="el" href="tor__api_8h.html#a03a6419d2872fb481d95c23a7283cebf">tor_run_main()</a> has finished. </p>

</div>
</div>
<a id="a492d3b04d7d987e557b360baa222f32c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a492d3b04d7d987e557b360baa222f32c">&#9670;&nbsp;</a></span>tor_main_configuration_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtor__main__configuration__t.html">tor_main_configuration_t</a>* tor_main_configuration_new </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create and return a new tor_main_configuration(). </p>

</div>
</div>
<a id="a4e4d16991254ff6ede69bc5050796130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e4d16991254ff6ede69bc5050796130">&#9670;&nbsp;</a></span>tor_main_configuration_set_command_line()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_main_configuration_set_command_line </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtor__main__configuration__t.html">tor_main_configuration_t</a> *&#160;</td>
          <td class="paramname"><em>cfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the command-line arguments in <b>cfg</b>.</p>
<p>The <b>argc</b> and <b>argv</b> values here are as for <a class="el" href="tor__main_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>. The contents of the argv pointer must remain unchanged until <a class="el" href="tor__api_8h.html#a03a6419d2872fb481d95c23a7283cebf">tor_run_main()</a> has finished and you call <a class="el" href="tor__api_8h.html#aad869650abfa67785a584da17fe79201">tor_main_configuration_free()</a>.</p>
<p>Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="a03a6419d2872fb481d95c23a7283cebf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03a6419d2872fb481d95c23a7283cebf">&#9670;&nbsp;</a></span>tor_run_main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_run_main </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtor__main__configuration__t.html">tor_main_configuration_t</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Run the tor process, as if from the command line.</p>
<p>The command line arguments from <a class="el" href="tor__api_8h.html#a4e4d16991254ff6ede69bc5050796130">tor_main_configuration_set_command_line()</a> are taken as if they had been passed to <a class="el" href="tor__main_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<p>This function will not return until Tor is done running. It returns zero on success, and nonzero on failure.</p>
<p>If you want to control when Tor exits, make sure to configure a control socket. The OwningControllerFD option may be helpful there.</p>
<p>BUG 23847: Sometimes, if you call tor_main a second time (after it has returned), Tor may crash or behave strangely. We have fixed all issues of this type that we could find, but more may remain.</p>
<p>LIMITATION: You cannot run more than one instance of Tor in the same process at the same time. Concurrent calls will cause undefined behavior. We do not currently have plans to change this.</p>
<p>LIMITATION: While we will try to fix any problems found here, you should be aware that Tor was originally written to run as its own process, and that the functionality of this file was added later. If you find any bugs or strange behavior, please report them, and we'll try to straighten them out. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tor__api_8h_a03a6419d2872fb481d95c23a7283cebf_cgraph.png" border="0" usemap="#tor__api_8h_a03a6419d2872fb481d95c23a7283cebf_cgraph" alt=""/></div>
<map name="tor__api_8h_a03a6419d2872fb481d95c23a7283cebf_cgraph" id="tor__api_8h_a03a6419d2872fb481d95c23a7283cebf_cgraph">
<area shape="rect" id="node2" href="backtrace_8c.html#a6d08b912f24793f23f1ab1dfbc7c423e" title="configure_backtrace\l_handler" alt="" coords="153,41,292,82"/>
<area shape="rect" id="node3" href="config_8c.html#a3113591cdd3555bd354860a3a0802222" title="get_version" alt="" coords="384,5,473,32"/>
<area shape="rect" id="node7" href="config_8c.html#a9badc2e4e664120fd99bbd63cd4af3c6" title="init_protocol_warning\l_severity_level" alt="" coords="151,251,295,293"/>
<area shape="rect" id="node10" href="util_8c.html#a866d4c80bbdc37a0279c2bd02f4b2bde" title="update_approx_time" alt="" coords="153,368,292,395"/>
<area shape="rect" id="node11" href="compat__pthreads_8c.html#ad7af2665dcebaab14be9e040eef67de0" title="tor_threads_init" alt="" coords="167,419,278,445"/>
<area shape="rect" id="node12" href="compress_8c.html#aa70790c077be4c170f9a6ee17baf93e3" title="tor_compress_init" alt="" coords="160,317,285,344"/>
<area shape="rect" id="node16" href="log_8c.html#a0bc134e471615f694edc26aef8bf961f" title="init_logging" alt="" coords="179,469,266,496"/>
<area shape="rect" id="node18" href="compat__time_8c.html#ac3081103a772136f197e2eda085ff26d" title="monotime_init" alt="" coords="171,520,274,547"/>
<area shape="rect" id="node19" href="main_8c.html#a5c761b9de5289922e4f75826f766355f" title="tor_init" alt="" coords="192,157,253,184"/>
<area shape="rect" id="node4" href="compat_8c.html#ade97970c1d8a691241adac739c4f9b12" title="tor_asprintf" alt="" coords="795,5,881,32"/>
<area shape="rect" id="node6" href="config_8c.html#a229118cbc4221ec841824b17f7c82b06" title="get_short_version" alt="" coords="567,31,693,57"/>
<area shape="rect" id="node5" href="compat_8c.html#a5ef7a08e8b543c0d61f9ef1081d4c1ea" title="tor_vasprintf" alt="" coords="979,5,1073,32"/>
<area shape="rect" id="node8" href="compat__threads_8c.html#a28fc1a1e6d143b15ab62ddfa810a7ffd" title="atomic_counter_init" alt="" coords="563,360,697,387"/>
<area shape="rect" id="node9" href="compat__pthreads_8c.html#a900a1a27db8f1815a4db66e98e67bac0" title="tor_mutex_init_nonrecursive" alt="" coords="745,360,931,387"/>
<area shape="rect" id="node13" href="compress__zlib_8c.html#a256ccf247e5c5cc84f2063f3a23f1eb5" title="tor_zlib_init" alt="" coords="385,360,473,387"/>
<area shape="rect" id="node14" href="compress__lzma_8c.html#aa959a50329a95dc76efe6d112b52e21d" title="tor_lzma_init" alt="" coords="381,411,477,437"/>
<area shape="rect" id="node15" href="compress__zstd_8c.html#a70bc7321f0ab96e8ac23ede28063dc22" title="tor_zstd_init" alt="" coords="382,461,475,488"/>
<area shape="rect" id="node17" href="compat__pthreads_8c.html#accea24c75779968942013afa3ae1c051" title="tor_mutex_init" alt="" coords="377,512,481,539"/>
<area shape="rect" id="node20" href="main_8c.html#add1f47335c5e96d25eb95c6308b3ea1e" title="init_connection_lists" alt="" coords="359,56,499,83"/>
<area shape="rect" id="node21" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="385,107,472,133"/>
<area shape="rect" id="node23" href="log_8c.html#a665d03a179fc9e07ac04fd65dccb6d47" title="log_set_application_name" alt="" coords="343,157,515,184"/>
<area shape="rect" id="node24" href="crypto_8c.html#a6bde73f49ce0082ba60bf6fa8abee655" title="crypto_early_init" alt="" coords="370,208,487,235"/>
<area shape="rect" id="node22" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="583,107,677,133"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
