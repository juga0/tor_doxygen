<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/channeltls.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">channeltls.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="channeltls_8c.html" title="A concrete subclass of channel_t using or_connection_t to transfer cells between Tor instances...">channeltls.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="channel_8h_source.html">channel.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for channeltls.h:</div>
<div class="dyncontent">
<div class="center"><img src="channeltls_8h__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2channeltls_8h" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2channeltls_8h" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2channeltls_8h">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="1447,259,1491,285"/>
<area shape="rect" id="node34" href="channel_8h.html" title="Header file for channel.c. " alt="" coords="1482,109,1561,136"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="366,856,445,883"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="902,781,965,808"/>
<area shape="rect" id="node5" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="955,557,1024,584"/>
<area shape="rect" id="node13" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1721,557,1834,584"/>
<area shape="rect" id="node14" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="1419,632,1544,659"/>
<area shape="rect" id="node15" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="1369,707,1511,733"/>
<area shape="rect" id="node16" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="1130,483,1193,509"/>
<area shape="rect" id="node19" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1419,557,1485,584"/>
<area shape="rect" id="node20" href="container_8h_source.html" title="container.h" alt="" coords="617,408,703,435"/>
<area shape="rect" id="node26" href="torgzip_8h.html" title="Headers for torgzip.h. " alt="" coords="1249,333,1321,360"/>
<area shape="rect" id="node27" href="address_8h.html" title="Headers for address.h. " alt="" coords="497,333,575,360"/>
<area shape="rect" id="node28" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="1960,707,2088,733"/>
<area shape="rect" id="node30" href="ht_8h_source.html" title="ht.h" alt="" coords="1447,333,1491,360"/>
<area shape="rect" id="node31" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="1515,333,1618,360"/>
<area shape="rect" id="node32" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="1643,333,1733,360"/>
<area shape="rect" id="node33" href="util__format_8h_source.html" title="util_format.h" alt="" coords="1638,707,1733,733"/>
<area shape="rect" id="node7" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="1391,781,1489,808"/>
<area shape="rect" id="node8" href="compat_8h_source.html" title="compat.h" alt="" coords="666,632,742,659"/>
<area shape="rect" id="node10" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="145,781,253,808"/>
<area shape="rect" id="node12" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="726,707,853,733"/>
<area shape="rect" id="node17" href="compat__openssl_8h.html" title="compatability definitions for working with different openssl forks " alt="" coords="1109,557,1237,584"/>
<area shape="rect" id="node21" href="util_8h.html" title="Headers for util.c. " alt="" coords="589,483,640,509"/>
<area shape="rect" id="node25" href="siphash_8h_source.html" title="siphash.h" alt="" coords="665,483,743,509"/>
<area shape="rect" id="node22" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="195,707,266,733"/>
<area shape="rect" id="node24" href="util__bug_8h.html" title="util_bug.h" alt="" coords="574,557,653,584"/>
<area shape="rect" id="node35" href="circuitmux_8h.html" title="Header file for circuitmux.c. " alt="" coords="1532,184,1625,211"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="channeltls_8h__dep__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2channeltls_8hdep" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2channeltls_8hdep" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2channeltls_8hdep">
<area shape="rect" id="node2" href="channel_8c.html" title="OR/OP&#45;to&#45;OR channel abstraction layer. A channel&#39;s job is to transfer cells from Tor instance to Tor ..." alt="" coords="5,109,153,165"/>
<area shape="rect" id="node3" href="channeltls_8c.html" title="A concrete subclass of channel_t using or_connection_t to transfer cells between Tor instances..." alt="" coords="177,109,325,165"/>
<area shape="rect" id="node4" href="connection_8c.html" title="General high&#45;level functions to handle reading and writing on connections. " alt="" coords="349,109,497,165"/>
<area shape="rect" id="node5" href="connection__or_8c.html" title="Functions to handle OR connections, TLS handshaking, and cells on the network. " alt="" coords="522,109,677,165"/>
<area shape="rect" id="node6" href="control_8c.html" title="Implementation for Tor&#39;s control&#45;socket interface. " alt="" coords="701,109,849,165"/>
<area shape="rect" id="node7" href="dirserv_8c.html" title="Directory server core implementation. Manages directory contents and generates directories. " alt="" coords="873,109,1021,165"/>
<area shape="rect" id="node8" href="hibernate_8c.html" title="Functions to close listeners, stop allowing new circuits, etc in preparation for closing down or goin..." alt="" coords="1045,109,1193,165"/>
<area shape="rect" id="node9" href="main_8c.html" title="Toplevel module. Handles signals, multiplexes between connections, implements main loop..." alt="" coords="1217,109,1365,165"/>
</map>
</div>
</div>
<p><a href="channeltls_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae6b409a66b42b94c409b0c5c658b50ae"><td class="memItemLeft" align="right" valign="top"><a id="ae6b409a66b42b94c409b0c5c658b50ae"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BASE_CHAN_TO_TLS</b>(c)&#160;&#160;&#160;(<a class="el" href="channeltls_8h.html#a98d15ef1110249b6f094f0ac5d09b07a">channel_tls_from_base</a>((c)))</td></tr>
<tr class="separator:ae6b409a66b42b94c409b0c5c658b50ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b47963069de41fbdc5279a1a9b3c2dc"><td class="memItemLeft" align="right" valign="top"><a id="a7b47963069de41fbdc5279a1a9b3c2dc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TLS_CHAN_TO_BASE</b>(c)&#160;&#160;&#160;(<a class="el" href="channeltls_8h.html#a103e1b5acee3f7892a537d0c6f143752">channel_tls_to_base</a>((c)))</td></tr>
<tr class="separator:a7b47963069de41fbdc5279a1a9b3c2dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f876980e2934f0fdba6be50a5e73d13"><td class="memItemLeft" align="right" valign="top"><a id="a4f876980e2934f0fdba6be50a5e73d13"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TLS_CHAN_MAGIC</b>&#160;&#160;&#160;0x8a192427U</td></tr>
<tr class="separator:a4f876980e2934f0fdba6be50a5e73d13"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7a89e235963df96d4b8df41e90dd9447"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structchannel__s.html">channel_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a7a89e235963df96d4b8df41e90dd9447">channel_tls_connect</a> (const <a class="el" href="structtor__addr__t.html">tor_addr_t</a> *addr, uint16_t port, const char *id_digest)</td></tr>
<tr class="separator:a7a89e235963df96d4b8df41e90dd9447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fbe32c536a922af8a1aa588a239055b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structchannel__listener__s.html">channel_listener_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a3fbe32c536a922af8a1aa588a239055b">channel_tls_get_listener</a> (void)</td></tr>
<tr class="separator:a3fbe32c536a922af8a1aa588a239055b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e1f9831dfe17a5cebcc49982597d2d5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structchannel__listener__s.html">channel_listener_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a8e1f9831dfe17a5cebcc49982597d2d5">channel_tls_start_listener</a> (void)</td></tr>
<tr class="separator:a8e1f9831dfe17a5cebcc49982597d2d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af227caf294fbde3eeffa7588e1dd2a69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structchannel__s.html">channel_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#af227caf294fbde3eeffa7588e1dd2a69">channel_tls_handle_incoming</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *orconn)</td></tr>
<tr class="separator:af227caf294fbde3eeffa7588e1dd2a69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a103e1b5acee3f7892a537d0c6f143752"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structchannel__s.html">channel_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a103e1b5acee3f7892a537d0c6f143752">channel_tls_to_base</a> (channel_tls_t *tlschan)</td></tr>
<tr class="separator:a103e1b5acee3f7892a537d0c6f143752"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98d15ef1110249b6f094f0ac5d09b07a"><td class="memItemLeft" align="right" valign="top">channel_tls_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a98d15ef1110249b6f094f0ac5d09b07a">channel_tls_from_base</a> (<a class="el" href="structchannel__s.html">channel_t</a> *chan)</td></tr>
<tr class="separator:a98d15ef1110249b6f094f0ac5d09b07a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46807c7ed6daa9844d23ddfdd9972a08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a46807c7ed6daa9844d23ddfdd9972a08">channel_tls_handle_cell</a> (<a class="el" href="structcell__t.html">cell_t</a> *cell, <a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a46807c7ed6daa9844d23ddfdd9972a08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3e2f5d8c32d94cde8adcbfb97d5e832"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#ab3e2f5d8c32d94cde8adcbfb97d5e832">channel_tls_handle_state_change_on_orconn</a> (channel_tls_t *chan, <a class="el" href="structor__connection__t.html">or_connection_t</a> *conn, uint8_t old_state, uint8_t state)</td></tr>
<tr class="separator:ab3e2f5d8c32d94cde8adcbfb97d5e832"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06640a04357389ebf3741cd095d7fc3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a06640a04357389ebf3741cd095d7fc3c">channel_tls_handle_var_cell</a> (<a class="el" href="structvar__cell__t.html">var_cell_t</a> *var_cell, <a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a06640a04357389ebf3741cd095d7fc3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bd8b0e020ac1810b246264ed9d09bbe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a8bd8b0e020ac1810b246264ed9d09bbe">channel_tls_update_marks</a> (<a class="el" href="structor__connection__t.html">or_connection_t</a> *conn)</td></tr>
<tr class="separator:a8bd8b0e020ac1810b246264ed9d09bbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02c3940e159ed3f423d8d3cb0e5d40eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a02c3940e159ed3f423d8d3cb0e5d40eb">channel_tls_free_all</a> (void)</td></tr>
<tr class="separator:a02c3940e159ed3f423d8d3cb0e5d40eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8d307a4fc3db127f8d7753c2eae4ce40"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a8d307a4fc3db127f8d7753c2eae4ce40">stats_n_authorize_cells_processed</a></td></tr>
<tr class="separator:a8d307a4fc3db127f8d7753c2eae4ce40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92c5b23ac6778475f992a73cfbb9f189"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a92c5b23ac6778475f992a73cfbb9f189">stats_n_authenticate_cells_processed</a></td></tr>
<tr class="separator:a92c5b23ac6778475f992a73cfbb9f189"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d4ddb19bc933f6fce31ac27bc63d4c1"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a8d4ddb19bc933f6fce31ac27bc63d4c1">stats_n_versions_cells_processed</a></td></tr>
<tr class="separator:a8d4ddb19bc933f6fce31ac27bc63d4c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7481930669fadca09c2e4dba9c439cc"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#af7481930669fadca09c2e4dba9c439cc">stats_n_netinfo_cells_processed</a></td></tr>
<tr class="separator:af7481930669fadca09c2e4dba9c439cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1252e193d9b8628528ea5df3e4be411"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#ac1252e193d9b8628528ea5df3e4be411">stats_n_vpadding_cells_processed</a></td></tr>
<tr class="separator:ac1252e193d9b8628528ea5df3e4be411"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e11d00906b173608220b880b8e8a08d"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a6e11d00906b173608220b880b8e8a08d">stats_n_certs_cells_processed</a></td></tr>
<tr class="separator:a6e11d00906b173608220b880b8e8a08d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80ee86983d286b4e23837b3a06af5c97"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="channeltls_8h.html#a80ee86983d286b4e23837b3a06af5c97">stats_n_auth_challenge_cells_processed</a></td></tr>
<tr class="separator:a80ee86983d286b4e23837b3a06af5c97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="channeltls_8c.html" title="A concrete subclass of channel_t using or_connection_t to transfer cells between Tor instances...">channeltls.c</a>. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a7a89e235963df96d4b8df41e90dd9447"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a89e235963df96d4b8df41e90dd9447">&#9670;&nbsp;</a></span>channel_tls_connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structchannel__s.html">channel_t</a>* channel_tls_connect </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtor__addr__t.html">tor_addr_t</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id_digest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Start a new TLS channel</p>
<p>Launch a new OR connection to <b>addr</b>:<b>port</b> and expect to handshake with an OR with identity digest <b>id_digest</b>, and wrap it in a channel_tls_t. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="channeltls_8h_a7a89e235963df96d4b8df41e90dd9447_icgraph.png" border="0" usemap="#channeltls_8h_a7a89e235963df96d4b8df41e90dd9447_icgraph" alt=""/></div>
<map name="channeltls_8h_a7a89e235963df96d4b8df41e90dd9447_icgraph" id="channeltls_8h_a7a89e235963df96d4b8df41e90dd9447_icgraph">
<area shape="rect" id="node2" href="channel_8h.html#a13b8cc7d1d3dbbdca20c863c3cb35273" title="channel_connect" alt="" coords="195,5,315,32"/>
</map>
</div>

</div>
</div>
<a id="a02c3940e159ed3f423d8d3cb0e5d40eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02c3940e159ed3f423d8d3cb0e5d40eb">&#9670;&nbsp;</a></span>channel_tls_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void channel_tls_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free everything on shutdown</p>
<p>Not much to do here, since <a class="el" href="channel_8c.html#adb2d84e3ecc8f662ed2072a2104d0b6b">channel_free_all()</a> takes care of a lot, but let's get rid of the listener. </p>

</div>
</div>
<a id="a98d15ef1110249b6f094f0ac5d09b07a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98d15ef1110249b6f094f0ac5d09b07a">&#9670;&nbsp;</a></span>channel_tls_from_base()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">channel_tls_t* channel_tls_from_base </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structchannel__s.html">channel_t</a> *&#160;</td>
          <td class="paramname"><em>chan</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cast a channel_t to a channel_tls_t, with appropriate type-checking asserts. </p>

</div>
</div>
<a id="a3fbe32c536a922af8a1aa588a239055b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fbe32c536a922af8a1aa588a239055b">&#9670;&nbsp;</a></span>channel_tls_get_listener()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structchannel__listener__s.html">channel_listener_t</a>* channel_tls_get_listener </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the current channel_tls_t listener</p>
<p>Returns the current channel listener for incoming TLS connections, or NULL if none has been established </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="channeltls_8h_a3fbe32c536a922af8a1aa588a239055b_icgraph.png" border="0" usemap="#channeltls_8h_a3fbe32c536a922af8a1aa588a239055b_icgraph" alt=""/></div>
<map name="channeltls_8h_a3fbe32c536a922af8a1aa588a239055b_icgraph" id="channeltls_8h_a3fbe32c536a922af8a1aa588a239055b_icgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a4b039b5bbe0c7cd361769189ce4d2238" title="MOCK_IMPL" alt="" coords="216,5,316,32"/>
</map>
</div>

</div>
</div>
<a id="a46807c7ed6daa9844d23ddfdd9972a08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46807c7ed6daa9844d23ddfdd9972a08">&#9670;&nbsp;</a></span>channel_tls_handle_cell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void channel_tls_handle_cell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcell__t.html">cell_t</a> *&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle an incoming cell on a channel_tls_t</p>
<p>This is called from <a class="el" href="connection__or_8c.html" title="Functions to handle OR connections, TLS handshaking, and cells on the network. ">connection_or.c</a> to handle an arriving cell; it checks for cell types specific to the handshake for this transport protocol and handles them, and queues all other cells to the channel_t layer, which eventually will hand them off to <a class="el" href="command_8c.html" title="Functions for processing incoming cells. ">command.c</a>.</p>
<p>The channel layer itself decides whether the cell should be queued or can be handed off immediately to the upper-layer code. It is responsible for copying in the case that it queues; we merely pass pointers through which we get from connection_or_process_cells_from_inbuf(). </p>

</div>
</div>
<a id="af227caf294fbde3eeffa7588e1dd2a69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af227caf294fbde3eeffa7588e1dd2a69">&#9670;&nbsp;</a></span>channel_tls_handle_incoming()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structchannel__s.html">channel_t</a>* channel_tls_handle_incoming </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>orconn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new channel around an incoming <a class="el" href="structor__connection__t.html">or_connection_t</a> </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="channeltls_8h_af227caf294fbde3eeffa7588e1dd2a69_icgraph.png" border="0" usemap="#channeltls_8h_af227caf294fbde3eeffa7588e1dd2a69_icgraph" alt=""/></div>
<map name="channeltls_8h_af227caf294fbde3eeffa7588e1dd2a69_icgraph" id="channeltls_8h_af227caf294fbde3eeffa7588e1dd2a69_icgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a4b039b5bbe0c7cd361769189ce4d2238" title="MOCK_IMPL" alt="" coords="187,13,287,39"/>
</map>
</div>

</div>
</div>
<a id="ab3e2f5d8c32d94cde8adcbfb97d5e832"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3e2f5d8c32d94cde8adcbfb97d5e832">&#9670;&nbsp;</a></span>channel_tls_handle_state_change_on_orconn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void channel_tls_handle_state_change_on_orconn </td>
          <td>(</td>
          <td class="paramtype">channel_tls_t *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>old_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle an orconn state change</p>
<p>This function will be called by <a class="el" href="connection__or_8c.html" title="Functions to handle OR connections, TLS handshaking, and cells on the network. ">connection_or.c</a> when the <a class="el" href="structor__connection__t.html">or_connection_t</a> associated with this channel_tls_t changes state. </p>

</div>
</div>
<a id="a06640a04357389ebf3741cd095d7fc3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06640a04357389ebf3741cd095d7fc3c">&#9670;&nbsp;</a></span>channel_tls_handle_var_cell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void channel_tls_handle_var_cell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvar__cell__t.html">var_cell_t</a> *&#160;</td>
          <td class="paramname"><em>var_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle an incoming variable-length cell on a channel_tls_t</p>
<p>Process a <b>var_cell</b> that was just received on <b>conn</b>. Keep internal statistics about how many of each cell we've processed so far this second, and the total number of microseconds it took to process each type of cell. All the var_cell commands are handshake- related and live below the channel_t layer, so no variable-length cells ever get delivered in the current implementation, but I've left the mechanism in place for future use.</p>
<p>If we were handing them off to the upper layer, the channel_t queueing code would be responsible for memory management, and we'd just be passing pointers through from connection_or_process_cells_from_inbuf(). That caller always frees them after this function returns, so this function should never free var_cell. </p>

</div>
</div>
<a id="a8e1f9831dfe17a5cebcc49982597d2d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e1f9831dfe17a5cebcc49982597d2d5">&#9670;&nbsp;</a></span>channel_tls_start_listener()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structchannel__listener__s.html">channel_listener_t</a>* channel_tls_start_listener </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Start a channel_tls_t listener if necessary</p>
<p>Return the current channel_tls_t listener, or start one if we haven't yet, and return that. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="channeltls_8h_a8e1f9831dfe17a5cebcc49982597d2d5_icgraph.png" border="0" usemap="#channeltls_8h_a8e1f9831dfe17a5cebcc49982597d2d5_icgraph" alt=""/></div>
<map name="channeltls_8h_a8e1f9831dfe17a5cebcc49982597d2d5_icgraph" id="channeltls_8h_a8e1f9831dfe17a5cebcc49982597d2d5_icgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a4b039b5bbe0c7cd361769189ce4d2238" title="MOCK_IMPL" alt="" coords="224,5,324,32"/>
</map>
</div>

</div>
</div>
<a id="a103e1b5acee3f7892a537d0c6f143752"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a103e1b5acee3f7892a537d0c6f143752">&#9670;&nbsp;</a></span>channel_tls_to_base()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structchannel__s.html">channel_t</a>* channel_tls_to_base </td>
          <td>(</td>
          <td class="paramtype">channel_tls_t *&#160;</td>
          <td class="paramname"><em>tlschan</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cast a channel_tls_t to a channel_t. </p>

</div>
</div>
<a id="a8bd8b0e020ac1810b246264ed9d09bbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bd8b0e020ac1810b246264ed9d09bbe">&#9670;&nbsp;</a></span>channel_tls_update_marks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void channel_tls_update_marks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structor__connection__t.html">or_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update channel marks after <a class="el" href="connection__or_8c.html" title="Functions to handle OR connections, TLS handshaking, and cells on the network. ">connection_or.c</a> has changed an address</p>
<p>This is called from <a class="el" href="connection__or_8c.html#a81f0c0f45bf6e7d920db1c1603f448f9">connection_or_init_conn_from_address()</a> after the connection's _base.addr or real_addr fields have potentially been changed so we can recalculate the local mark. Notably, this happens when incoming connections are reverse-proxied and we only learn the real address of the remote router by looking it up in the consensus after we finish the handshake and know an authenticated identity digest. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a80ee86983d286b4e23837b3a06af5c97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80ee86983d286b4e23837b3a06af5c97">&#9670;&nbsp;</a></span>stats_n_auth_challenge_cells_processed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t stats_n_auth_challenge_cells_processed</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many CELL_AUTH_CHALLENGE cells have we received, ever? </p>

</div>
</div>
<a id="a92c5b23ac6778475f992a73cfbb9f189"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92c5b23ac6778475f992a73cfbb9f189">&#9670;&nbsp;</a></span>stats_n_authenticate_cells_processed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t stats_n_authenticate_cells_processed</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many CELL_AUTHENTICATE cells have we received, ever? </p>

</div>
</div>
<a id="a8d307a4fc3db127f8d7753c2eae4ce40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d307a4fc3db127f8d7753c2eae4ce40">&#9670;&nbsp;</a></span>stats_n_authorize_cells_processed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t stats_n_authorize_cells_processed</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many CELL_AUTHORIZE cells have we received, ever? </p>

</div>
</div>
<a id="a6e11d00906b173608220b880b8e8a08d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e11d00906b173608220b880b8e8a08d">&#9670;&nbsp;</a></span>stats_n_certs_cells_processed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t stats_n_certs_cells_processed</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many CELL_CERTS cells have we received, ever? </p>

</div>
</div>
<a id="af7481930669fadca09c2e4dba9c439cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7481930669fadca09c2e4dba9c439cc">&#9670;&nbsp;</a></span>stats_n_netinfo_cells_processed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t stats_n_netinfo_cells_processed</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many CELL_NETINFO cells have we received, ever? </p>

</div>
</div>
<a id="a8d4ddb19bc933f6fce31ac27bc63d4c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d4ddb19bc933f6fce31ac27bc63d4c1">&#9670;&nbsp;</a></span>stats_n_versions_cells_processed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t stats_n_versions_cells_processed</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many CELL_VERSIONS cells have we received, ever? </p>

</div>
</div>
<a id="ac1252e193d9b8628528ea5df3e4be411"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1252e193d9b8628528ea5df3e4be411">&#9670;&nbsp;</a></span>stats_n_vpadding_cells_processed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t stats_n_vpadding_cells_processed</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many CELL_VPADDING cells have we received, ever? </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
