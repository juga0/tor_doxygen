<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/routerparse.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">routerparse.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="routerparse_8c.html" title="Code to parse and validate router descriptors, consenus directories, and similar objects. ">routerparse.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h__dep__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2routerparse_8hdep" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2routerparse_8hdep" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2routerparse_8hdep">
<area shape="rect" id="node2" href="circuitbuild_8c.html" title="Implements the details of building circuits (by chosing paths, constructing/sending create/extend cel..." alt="" coords="5,109,153,165"/>
<area shape="rect" id="node3" href="connection_8c.html" title="General high&#45;level functions to handle reading and writing on connections. " alt="" coords="177,109,325,165"/>
<area shape="rect" id="node4" href="consdiff_8c.html" title="Consensus diff implementation, including both the generation and the application of diffs in a minima..." alt="" coords="349,109,497,165"/>
<area shape="rect" id="node5" href="control_8c.html" title="Implementation for Tor&#39;s control&#45;socket interface. " alt="" coords="521,109,669,165"/>
<area shape="rect" id="node6" href="dirvote_8c.html" title="Functions to compute directory consensus, and schedule voting. " alt="" coords="693,109,849,165"/>
<area shape="rect" id="node7" href="directory_8c.html" title="Code to send and fetch information from directory authorities and caches via HTTP. " alt="" coords="873,109,1021,165"/>
<area shape="rect" id="node8" href="dirserv_8c.html" title="Directory server core implementation. Manages directory contents and generates directories. " alt="" coords="1045,109,1193,165"/>
<area shape="rect" id="node9" href="entrynodes_8c.html" title="Code to manage our fixed first nodes for various functions. " alt="" coords="1217,109,1365,165"/>
<area shape="rect" id="node10" href="main_8c.html" title="Toplevel module. Handles signals, multiplexes between connections, implements main loop..." alt="" coords="1389,109,1537,165"/>
<area shape="rect" id="node11" href="microdesc_8c.html" title="Implements microdescriptors â€“ an abbreviated description of less&#45;frequently&#45;changing router informat..." alt="" coords="1561,109,1709,165"/>
<area shape="rect" id="node12" href="networkstatus_8c.html" title="Functions and structures for handling networkstatus documents as a client or as a directory cache..." alt="" coords="1733,109,1889,165"/>
<area shape="rect" id="node13" href="nodelist_8c.html" title="Structures and functions for tracking what we know about the routers on the Tor network, and correlating information from networkstatus, routerinfo, and microdescs. " alt="" coords="1913,109,2061,165"/>
<area shape="rect" id="node14" href="policies_8c.html" title="Code to parse and use address policies and exit policies. " alt="" coords="2085,109,2233,165"/>
<area shape="rect" id="node15" href="protover_8c.html" title="Versioning information for different pieces of the Tor protocol. " alt="" coords="2257,109,2405,165"/>
<area shape="rect" id="node16" href="relay_8c.html" title="Handle relay cell encryption/decryption, plus packaging and receiving from circuits, plus queuing on circuits. " alt="" coords="2429,109,2577,165"/>
<area shape="rect" id="node17" href="rendcache_8c.html" title="Hidden service descriptor cache. " alt="" coords="2601,109,2749,165"/>
<area shape="rect" id="node18" href="rendcommon_8c.html" title="Rendezvous implementation: shared code between introducers, services, clients, and rendezvous points..." alt="" coords="2774,109,2923,165"/>
<area shape="rect" id="node19" href="rendservice_8c.html" title="The hidden&#45;service side of rendezvous functionality. " alt="" coords="2948,109,3096,165"/>
<area shape="rect" id="node20" href="router_8c.html" title="Miscellaneous relay functionality, including RSA key maintenance, generating and uploading server des..." alt="" coords="3120,109,3268,165"/>
<area shape="rect" id="node21" href="routerlist_8c.html" title="Code to maintain and access the global list of routerinfos for known servers. " alt="" coords="3292,109,3440,165"/>
<area shape="rect" id="node22" href="routerparse_8c.html" title="Code to parse and validate router descriptors, consenus directories, and similar objects. " alt="" coords="3464,109,3612,165"/>
<area shape="rect" id="node23" href="routerset_8c.html" title="Functions and structures to handle set&#45;type selection of routers by name, ID, address, etc. " alt="" coords="3636,109,3784,165"/>
<area shape="rect" id="node24" href="test__dir__common_8h_source.html" title="/home/user/_my/code\l/bwauth&#45;related/tor\l/src/test/test_dir_common.h" alt="" coords="3808,109,3993,165"/>
<area shape="rect" id="node25" href="test__hs__service_8c.html" title="Test hidden service functionality. " alt="" coords="4017,109,4195,165"/>
</map>
</div>
</div>
<p><a href="routerparse_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a549e0a2570e80ea4a0cc974d479640ca"><td class="memItemLeft" align="right" valign="top"><a id="a549e0a2570e80ea4a0cc974d479640ca"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DIROBJ_MAX_SIG_LEN</b>&#160;&#160;&#160;256</td></tr>
<tr class="separator:a549e0a2570e80ea4a0cc974d479640ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a326ef3df575c728bfdabfec62850e08e"><td class="memItemLeft" align="right" valign="top"><a id="a326ef3df575c728bfdabfec62850e08e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ED_DESC_SIGNATURE_PREFIX</b>&#160;&#160;&#160;&quot;Tor router descriptor signature v1&quot;</td></tr>
<tr class="separator:a326ef3df575c728bfdabfec62850e08e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88a39471f268a31b09e1677d5e57506a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a88a39471f268a31b09e1677d5e57506a">router_get_router_hash</a> (const char *s, size_t s_len, char *digest)</td></tr>
<tr class="separator:a88a39471f268a31b09e1677d5e57506a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9c94e2b40578dbed4b4e38a5ebe2c65"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#ae9c94e2b40578dbed4b4e38a5ebe2c65">router_get_dir_hash</a> (const char *s, char *digest)</td></tr>
<tr class="separator:ae9c94e2b40578dbed4b4e38a5ebe2c65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6105fa03c7a751d474a380de5016360b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a6105fa03c7a751d474a380de5016360b">router_get_networkstatus_v3_hashes</a> (const char *s, <a class="el" href="structcommon__digests__t.html">common_digests_t</a> *digests)</td></tr>
<tr class="separator:a6105fa03c7a751d474a380de5016360b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae7e91b9970f52f892b255d99a2358fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#aae7e91b9970f52f892b255d99a2358fd">router_get_networkstatus_v3_signed_boundaries</a> (const char *s, const char **start_out, const char **end_out)</td></tr>
<tr class="separator:aae7e91b9970f52f892b255d99a2358fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd89ff48acdb8ef399f773e42a8398d8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#afd89ff48acdb8ef399f773e42a8398d8">router_get_networkstatus_v3_sha3_as_signed</a> (uint8_t *digest_out, const char *s)</td></tr>
<tr class="separator:afd89ff48acdb8ef399f773e42a8398d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38ef1e01c3b561811bc4bd4f0777eb3e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a38ef1e01c3b561811bc4bd4f0777eb3e">router_get_extrainfo_hash</a> (const char *s, size_t s_len, char *digest)</td></tr>
<tr class="separator:a38ef1e01c3b561811bc4bd4f0777eb3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada91c927ebf9cb2a3b92b285198f172a"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#ada91c927ebf9cb2a3b92b285198f172a">router_get_dirobj_signature</a> (const char *digest, size_t digest_len, const <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *private_key)</td></tr>
<tr class="separator:ada91c927ebf9cb2a3b92b285198f172a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a594cb966cbb2893822d931ffe955b53d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a594cb966cbb2893822d931ffe955b53d">router_append_dirobj_signature</a> (char *buf, size_t buf_len, const char *digest, size_t digest_len, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *private_key)</td></tr>
<tr class="separator:a594cb966cbb2893822d931ffe955b53d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac757269bfea899db05e0778fd18c4d5a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#ac757269bfea899db05e0778fd18c4d5a">router_parse_list_from_string</a> (const char **s, const char *eos, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *dest, <a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a> saved_location, int is_extrainfo, int allow_annotations, const char *prepend_annotations, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *invalid_digests_out)</td></tr>
<tr class="separator:ac757269bfea899db05e0778fd18c4d5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ed67129e89fe64d2f329a1e94063f48"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrouterinfo__t.html">routerinfo_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a6ed67129e89fe64d2f329a1e94063f48">router_parse_entry_from_string</a> (const char *s, const char *end, int cache_copy, int allow_annotations, const char *prepend_annotations, int *can_dl_again_out)</td></tr>
<tr class="separator:a6ed67129e89fe64d2f329a1e94063f48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c7183356964eccb2338e4ce2c80eb36"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structextrainfo__t.html">extrainfo_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a5c7183356964eccb2338e4ce2c80eb36">extrainfo_parse_entry_from_string</a> (const char *s, const char *end, int cache_copy, struct digest_ri_map_t *routermap, int *can_dl_again_out)</td></tr>
<tr class="separator:a5c7183356964eccb2338e4ce2c80eb36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18bc4a5d0d311bdd5f6d36b304f72748"><td class="memItemLeft" align="right" valign="top"><a id="a18bc4a5d0d311bdd5f6d36b304f72748"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MOCK_DECL</b> (<a class="el" href="structaddr__policy__t.html">addr_policy_t</a> *, router_parse_addr_policy_item_from_string,(const char *s, int assume_action, int *malformed_list))</td></tr>
<tr class="separator:a18bc4a5d0d311bdd5f6d36b304f72748"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef22cc5550ef14cb0cf8fd3bca4dbd69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="or_8h.html#a00fd54618330b1d6b76e7571d84d90ce">version_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#aef22cc5550ef14cb0cf8fd3bca4dbd69">tor_version_is_obsolete</a> (const char *myversion, const char *versionlist)</td></tr>
<tr class="separator:aef22cc5550ef14cb0cf8fd3bca4dbd69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47c9a3cf5868b2133b4e5a582ca69aa6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a47c9a3cf5868b2133b4e5a582ca69aa6">tor_version_parse_platform</a> (const char *platform, <a class="el" href="structtor__version__t.html">tor_version_t</a> *version_out, int strict)</td></tr>
<tr class="separator:a47c9a3cf5868b2133b4e5a582ca69aa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34e1f6d4f6429bcf1d565f54a1dfcd5c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a34e1f6d4f6429bcf1d565f54a1dfcd5c">tor_version_as_new_as</a> (const char *platform, const char *cutoff)</td></tr>
<tr class="separator:a34e1f6d4f6429bcf1d565f54a1dfcd5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace4c11b51ca67a4f140ed41ae3d47b6d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#ace4c11b51ca67a4f140ed41ae3d47b6d">tor_version_parse</a> (const char *s, <a class="el" href="structtor__version__t.html">tor_version_t</a> *out)</td></tr>
<tr class="separator:ace4c11b51ca67a4f140ed41ae3d47b6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86ae08e44b4d585ae18040e96e98a92c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a86ae08e44b4d585ae18040e96e98a92c">tor_version_compare</a> (<a class="el" href="structtor__version__t.html">tor_version_t</a> *a, <a class="el" href="structtor__version__t.html">tor_version_t</a> *b)</td></tr>
<tr class="separator:a86ae08e44b4d585ae18040e96e98a92c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed569b83c27fc31ecf6c7aa2af2751d7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#aed569b83c27fc31ecf6c7aa2af2751d7">tor_version_same_series</a> (<a class="el" href="structtor__version__t.html">tor_version_t</a> *a, <a class="el" href="structtor__version__t.html">tor_version_t</a> *b)</td></tr>
<tr class="separator:aed569b83c27fc31ecf6c7aa2af2751d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e5734db3a8dd85fb0d16c180d64a4cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a8e5734db3a8dd85fb0d16c180d64a4cd">sort_version_list</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *lst, int remove_duplicates)</td></tr>
<tr class="separator:a8e5734db3a8dd85fb0d16c180d64a4cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a806988fd94a476db99e043aae0bc4fab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a806988fd94a476db99e043aae0bc4fab">assert_addr_policy_ok</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *t)</td></tr>
<tr class="separator:a806988fd94a476db99e043aae0bc4fab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae652ccb5411f5cb5eae101cd26ac4d6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#ae652ccb5411f5cb5eae101cd26ac4d6b">dump_distinct_digest_count</a> (int severity)</td></tr>
<tr class="separator:ae652ccb5411f5cb5eae101cd26ac4d6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9d5e58f345dc2f0f63a9ca03d025d1f"><td class="memItemLeft" align="right" valign="top"><a id="ab9d5e58f345dc2f0f63a9ca03d025d1f"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>compare_vote_routerstatus_entries</b> (const void **_a, const void **_b)</td></tr>
<tr class="separator:ab9d5e58f345dc2f0f63a9ca03d025d1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadb249c6c48887d46e7fc9d396f26c21"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#aadb249c6c48887d46e7fc9d396f26c21">networkstatus_verify_bw_weights</a> (<a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *ns, int)</td></tr>
<tr class="separator:aadb249c6c48887d46e7fc9d396f26c21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65f051065986f87c9969726c07d761be"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a65f051065986f87c9969726c07d761be">networkstatus_parse_vote_from_string</a> (const char *s, const char **eos_out, <a class="el" href="or_8h.html#a4cc3535cd1c60e55a79683e1b3ae8814">networkstatus_type_t</a> ns_type)</td></tr>
<tr class="separator:a65f051065986f87c9969726c07d761be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37b894a8c8b42685b0f542ea86dc42ff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structns__detached__signatures__t.html">ns_detached_signatures_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a37b894a8c8b42685b0f542ea86dc42ff">networkstatus_parse_detached_signatures</a> (const char *s, const char *eos)</td></tr>
<tr class="separator:a37b894a8c8b42685b0f542ea86dc42ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfc52ced95cf906593bbdab812e1cd8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#abfc52ced95cf906593bbdab812e1cd8e">microdescs_parse_from_string</a> (const char *s, const char *eos, int allow_annotations, <a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a> where, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *invalid_digests_out)</td></tr>
<tr class="separator:abfc52ced95cf906593bbdab812e1cd8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e030201d6bc0307036313ed138a0b63"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structauthority__cert__t.html">authority_cert_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a6e030201d6bc0307036313ed138a0b63">authority_cert_parse_from_string</a> (const char *s, const char **end_of_string)</td></tr>
<tr class="separator:a6e030201d6bc0307036313ed138a0b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2faba4db0eeeb6f97d9ba56983390b37"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a2faba4db0eeeb6f97d9ba56983390b37">rend_parse_v2_service_descriptor</a> (<a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> **parsed_out, char *desc_id_out, char **intro_points_encrypted_out, size_t *intro_points_encrypted_size_out, size_t *encoded_size_out, const char **next_out, const char *desc, int as_hsdir)</td></tr>
<tr class="separator:a2faba4db0eeeb6f97d9ba56983390b37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ece24495c2fa4a93440cc849e6a0702"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a7ece24495c2fa4a93440cc849e6a0702">rend_decrypt_introduction_points</a> (char **ipos_decrypted, size_t *ipos_decrypted_size, const char *descriptor_cookie, const char *ipos_encrypted, size_t ipos_encrypted_size)</td></tr>
<tr class="separator:a7ece24495c2fa4a93440cc849e6a0702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23b22c9a5a626774e68f0c7678221028"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#a23b22c9a5a626774e68f0c7678221028">rend_parse_introduction_points</a> (<a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> *parsed, const char *intro_points_encoded, size_t intro_points_encoded_size)</td></tr>
<tr class="separator:a23b22c9a5a626774e68f0c7678221028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9f19ced712ed538c086276fa472851d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#af9f19ced712ed538c086276fa472851d">rend_parse_client_keys</a> (strmap_t *parsed_clients, const char *str)</td></tr>
<tr class="separator:af9f19ced712ed538c086276fa472851d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ca055512bee2e709f53a889cd2dd84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#ab4ca055512bee2e709f53a889cd2dd84">routerparse_init</a> (void)</td></tr>
<tr class="separator:ab4ca055512bee2e709f53a889cd2dd84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa960633d43eaf0a653b3d45d9e7e5f92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routerparse_8h.html#aa960633d43eaf0a653b3d45d9e7e5f92">routerparse_free_all</a> (void)</td></tr>
<tr class="separator:aa960633d43eaf0a653b3d45d9e7e5f92"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="routerparse_8c.html" title="Code to parse and validate router descriptors, consenus directories, and similar objects. ">routerparse.c</a>. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a806988fd94a476db99e043aae0bc4fab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a806988fd94a476db99e043aae0bc4fab">&#9670;&nbsp;</a></span>assert_addr_policy_ok()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void assert_addr_policy_ok </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>lst</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log and exit if <b>t</b> is malformed </p>

</div>
</div>
<a id="a6e030201d6bc0307036313ed138a0b63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e030201d6bc0307036313ed138a0b63">&#9670;&nbsp;</a></span>authority_cert_parse_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structauthority__cert__t.html">authority_cert_t</a>* authority_cert_parse_from_string </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>end_of_string</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a key certificate from <b>s</b>; point <b>end-of-string</b> to the first character after the certificate. </p>
<p>Reject any certificate at least this big; it is probably an overflow, an attack, a bug, or some other nonsense. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_a6e030201d6bc0307036313ed138a0b63_cgraph.png" border="0" usemap="#routerparse_8h_a6e030201d6bc0307036313ed138a0b63_cgraph" alt=""/></div>
<map name="routerparse_8h_a6e030201d6bc0307036313ed138a0b63_cgraph" id="routerparse_8h_a6e030201d6bc0307036313ed138a0b63_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a69faf166aa0aa9164d2134419c81ba1b" title="eat_whitespace" alt="" coords="193,13,307,39"/>
</map>
</div>

</div>
</div>
<a id="ae652ccb5411f5cb5eae101cd26ac4d6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae652ccb5411f5cb5eae101cd26ac4d6b">&#9670;&nbsp;</a></span>dump_distinct_digest_count()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dump_distinct_digest_count </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log the total count of the number of distinct router digests we've ever verified. When compared to the number of times we've verified routerdesc signatures <em>in toto</em>, this will tell us if we're doing too much multiple-verification. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_ae652ccb5411f5cb5eae101cd26ac4d6b_cgraph.png" border="0" usemap="#routerparse_8h_ae652ccb5411f5cb5eae101cd26ac4d6b_cgraph" alt=""/></div>
<map name="routerparse_8h_ae652ccb5411f5cb5eae101cd26ac4d6b_cgraph" id="routerparse_8h_ae652ccb5411f5cb5eae101cd26ac4d6b_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="199,13,260,39"/>
</map>
</div>

</div>
</div>
<a id="a5c7183356964eccb2338e4ce2c80eb36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c7183356964eccb2338e4ce2c80eb36">&#9670;&nbsp;</a></span>extrainfo_parse_entry_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structextrainfo__t.html">extrainfo_t</a>* extrainfo_parse_entry_from_string </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cache_copy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct digest_ri_map_t *&#160;</td>
          <td class="paramname"><em>routermap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>can_dl_again_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a single extrainfo entry from the string <b>s</b>, ending at <b>end</b>. (If <b>end</b> is NULL, parse up to the end of <b>s</b>.) If <b>cache_copy</b> is true, make a copy of the extra-info document in the cache_info fields of the result. If <b>routermap</b> is provided, use it as a map from router identity to <a class="el" href="structrouterinfo__t.html">routerinfo_t</a> when looking up signing keys.</p>
<p>If <b>can_dl_again_out</b> is provided, set *<b>can_dl_again_out</b> to 1 if it's okay to try to download an extrainfo with this same digest again, and 0 if it isn't. (It might not be okay to download it again if part of the part covered by the digest is invalid.) </p>

</div>
</div>
<a id="abfc52ced95cf906593bbdab812e1cd8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfc52ced95cf906593bbdab812e1cd8e">&#9670;&nbsp;</a></span>microdescs_parse_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsmartlist__t.html">smartlist_t</a>* microdescs_parse_from_string </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>eos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allow_annotations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a>&#160;</td>
          <td class="paramname"><em>where</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>invalid_digests_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse as many microdescriptors as are found from the string starting at <b>s</b> and ending at <b>eos</b>. If allow_annotations is set, read any annotations we recognize and ignore ones we don't.</p>
<p>If <b>saved_location</b> isn't SAVED_IN_CACHE, make a local copy of each descriptor in the body field of each <a class="el" href="structmicrodesc__t.html">microdesc_t</a>.</p>
<p>Return all newly parsed microdescriptors in a newly allocated <a class="el" href="structsmartlist__t.html">smartlist_t</a>. If <b>invalid_disgests_out</b> is provided, add a SHA256 microdesc digest to it for every microdesc that we found to be badly formed. (This may cause duplicates) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_abfc52ced95cf906593bbdab812e1cd8e_icgraph.png" border="0" usemap="#routerparse_8h_abfc52ced95cf906593bbdab812e1cd8e_icgraph" alt=""/></div>
<map name="routerparse_8h_abfc52ced95cf906593bbdab812e1cd8e_icgraph" id="routerparse_8h_abfc52ced95cf906593bbdab812e1cd8e_icgraph">
<area shape="rect" id="node2" href="dirvote_8c.html#a059168318a87de5f77438cbcefdb73ed" title="dirvote_create_microdescriptor" alt="" coords="215,5,415,32"/>
<area shape="rect" id="node3" href="microdesc_8h.html#a8c94ac08f79487c605faf8e543fc3057" title="microdescs_add_to_cache" alt="" coords="226,56,403,83"/>
<area shape="rect" id="node4" href="microdesc_8h.html#a7955c20e8710e1f0b377d61eaba416b1" title="microdesc_cache_reload" alt="" coords="463,56,629,83"/>
</map>
</div>

</div>
</div>
<a id="a37b894a8c8b42685b0f542ea86dc42ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37b894a8c8b42685b0f542ea86dc42ff">&#9670;&nbsp;</a></span>networkstatus_parse_detached_signatures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structns__detached__signatures__t.html">ns_detached_signatures_t</a>* networkstatus_parse_detached_signatures </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>eos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a detached v3 networkstatus signature document between <b>s</b> and <b>eos</b> and return the result. Return -1 on failure. </p>

</div>
</div>
<a id="a65f051065986f87c9969726c07d761be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65f051065986f87c9969726c07d761be">&#9670;&nbsp;</a></span>networkstatus_parse_vote_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a>* networkstatus_parse_vote_from_string </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>eos_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a4cc3535cd1c60e55a79683e1b3ae8814">networkstatus_type_t</a>&#160;</td>
          <td class="paramname"><em>ns_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a v3 networkstatus vote, opinion, or consensus (depending on ns_type), from <b>s</b>, and return the result. Return NULL on failure. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_a65f051065986f87c9969726c07d761be_icgraph.png" border="0" usemap="#routerparse_8h_a65f051065986f87c9969726c07d761be_icgraph" alt=""/></div>
<map name="routerparse_8h_a65f051065986f87c9969726c07d761be_icgraph" id="routerparse_8h_a65f051065986f87c9969726c07d761be_icgraph">
<area shape="rect" id="node2" href="dirvote_8c.html#ae4e7e393e4261047243c1c3f339886e4" title="dirvote_add_vote" alt="" coords="196,13,317,39"/>
</map>
</div>

</div>
</div>
<a id="aadb249c6c48887d46e7fc9d396f26c21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadb249c6c48887d46e7fc9d396f26c21">&#9670;&nbsp;</a></span>networkstatus_verify_bw_weights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int networkstatus_verify_bw_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnetworkstatus__t.html">networkstatus_t</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>consensus_method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verify the bandwidth weights of a network status document </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_aadb249c6c48887d46e7fc9d396f26c21_cgraph.png" border="0" usemap="#routerparse_8h_aadb249c6c48887d46e7fc9d396f26c21_cgraph" alt=""/></div>
<map name="routerparse_8h_aadb249c6c48887d46e7fc9d396f26c21_cgraph" id="routerparse_8h_aadb249c6c48887d46e7fc9d396f26c21_cgraph">
<area shape="rect" id="node2" href="networkstatus_8c.html#afda0b094982877af4c11b127167acb9e" title="networkstatus_get_weight\l_scale_param" alt="" coords="397,5,572,47"/>
<area shape="rect" id="node3" href="networkstatus_8c.html#a77165f72d7e9e6e99fce27ee87a063a9" title="networkstatus_get_bw\l_weight" alt="" coords="196,35,349,76"/>
</map>
</div>

</div>
</div>
<a id="a7ece24495c2fa4a93440cc849e6a0702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ece24495c2fa4a93440cc849e6a0702">&#9670;&nbsp;</a></span>rend_decrypt_introduction_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_decrypt_introduction_points </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>ipos_decrypted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>ipos_decrypted_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>descriptor_cookie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ipos_encrypted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ipos_encrypted_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt the encrypted introduction points in <b>ipos_encrypted</b> of length <b>ipos_encrypted_size</b> using <b>descriptor_cookie</b> and write the result to a newly allocated string that is pointed to by <b>ipos_decrypted</b> and its length to <b>ipos_decrypted_size</b>. Return 0 if decryption was successful and -1 otherwise. </p>

</div>
</div>
<a id="af9f19ced712ed538c086276fa472851d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9f19ced712ed538c086276fa472851d">&#9670;&nbsp;</a></span>rend_parse_client_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_parse_client_keys </td>
          <td>(</td>
          <td class="paramtype">strmap_t *&#160;</td>
          <td class="paramname"><em>parsed_clients</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ckstr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the content of a client_key file in <b>ckstr</b> and add <a class="el" href="structrend__authorized__client__t.html">rend_authorized_client_t</a>'s for each parsed client to <b>parsed_clients</b>. Return the number of parsed clients as result or -1 for failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_af9f19ced712ed538c086276fa472851d_cgraph.png" border="0" usemap="#routerparse_8h_af9f19ced712ed538c086276fa472851d_cgraph" alt=""/></div>
<map name="routerparse_8h_af9f19ced712ed538c086276fa472851d_cgraph" id="routerparse_8h_af9f19ced712ed538c086276fa472851d_cgraph">
<area shape="rect" id="node2" href="memarea_8c.html#a9bc481c5060ff6280cfb1e5eaaa915f4" title="memarea_new" alt="" coords="215,5,322,32"/>
<area shape="rect" id="node3" href="util_8c.html#a69faf166aa0aa9164d2134419c81ba1b" title="eat_whitespace" alt="" coords="212,56,325,83"/>
<area shape="rect" id="node4" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="225,107,313,133"/>
<area shape="rect" id="node5" href="parsecommon_8c.html#a0a897ae41319f84342483abb652dd6dd" title="token_clear" alt="" coords="224,157,313,184"/>
<area shape="rect" id="node6" href="container_8c.html#ad24500d61ff1dbb6c845a8a70f6d2f14" title="smartlist_clear" alt="" coords="215,208,322,235"/>
<area shape="rect" id="node7" href="memarea_8c.html#a98079351167b7e4a7e189045d8534dc8" title="memarea_clear" alt="" coords="213,259,324,285"/>
<area shape="rect" id="node8" href="parsecommon_8c.html#af5a0f0fc39c7237d4d86a4288f31e19b" title="tokenize_string" alt="" coords="213,309,324,336"/>
</map>
</div>

</div>
</div>
<a id="a23b22c9a5a626774e68f0c7678221028"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23b22c9a5a626774e68f0c7678221028">&#9670;&nbsp;</a></span>rend_parse_introduction_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_parse_introduction_points </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> *&#160;</td>
          <td class="paramname"><em>parsed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>intro_points_encoded</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>intro_points_encoded_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the encoded introduction points in <b>intro_points_encoded</b> of length <b>intro_points_encoded_size</b> and write the result to the descriptor in <b>parsed</b>; return the number of successfully parsed introduction points or -1 in case of a failure. </p>
<p>Function may only be invoked once. </p>

</div>
</div>
<a id="a2faba4db0eeeb6f97d9ba56983390b37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2faba4db0eeeb6f97d9ba56983390b37">&#9670;&nbsp;</a></span>rend_parse_v2_service_descriptor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_parse_v2_service_descriptor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> **&#160;</td>
          <td class="paramname"><em>parsed_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>desc_id_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>intro_points_encrypted_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>intro_points_encrypted_size_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>encoded_size_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>next_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>as_hsdir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse and validate the ASCII-encoded v2 descriptor in <b>desc</b>, write the parsed descriptor to the newly allocated *<b>parsed_out</b>, the binary descriptor ID of length DIGEST_LEN to <b>desc_id_out</b>, the encrypted introduction points to the newly allocated *<b>intro_points_encrypted_out</b>, their encrypted size to *<b>intro_points_encrypted_size_out</b>, the size of the encoded descriptor to *<b>encoded_size_out</b>, and a pointer to the possibly next descriptor to *<b>next_out</b>; return 0 for success (including validation) and -1 for failure.</p>
<p>If <b>as_hsdir</b> is 1, we're parsing this as an HSDir, and we should be strict about time formats. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_a2faba4db0eeeb6f97d9ba56983390b37_icgraph.png" border="0" usemap="#routerparse_8h_a2faba4db0eeeb6f97d9ba56983390b37_icgraph" alt=""/></div>
<map name="routerparse_8h_a2faba4db0eeeb6f97d9ba56983390b37_icgraph" id="routerparse_8h_a2faba4db0eeeb6f97d9ba56983390b37_icgraph">
<area shape="rect" id="node2" href="rendcache_8h.html#a0029729f71187fd666fb549197645b7e" title="rend_cache_store_v2\l_desc_as_dir" alt="" coords="224,5,371,47"/>
<area shape="rect" id="node3" href="rendcommon_8c.html#a8fd972a1eacaa6e1208f2d02a51ba824" title="rend_desc_v2_is_parsable" alt="" coords="209,71,385,98"/>
</map>
</div>

</div>
</div>
<a id="a594cb966cbb2893822d931ffe955b53d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a594cb966cbb2893822d931ffe955b53d">&#9670;&nbsp;</a></span>router_append_dirobj_signature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_append_dirobj_signature </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buf_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>digest_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>private_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: used to generate signatures for routers, directories and network-status objects. Given a digest in <b>digest</b> and a secret <b>private_key</b>, generate a PKCS1-padded signature, BASE64-encode it, surround it with --&mdash;BEGIN/END--&mdash; pairs, and write it to the <b>buf_len</b>-byte buffer at <b>buf</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_a594cb966cbb2893822d931ffe955b53d_cgraph.png" border="0" usemap="#routerparse_8h_a594cb966cbb2893822d931ffe955b53d_cgraph" alt=""/></div>
<map name="routerparse_8h_a594cb966cbb2893822d931ffe955b53d_cgraph" id="routerparse_8h_a594cb966cbb2893822d931ffe955b53d_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#ada91c927ebf9cb2a3b92b285198f172a" title="router_get_dirobj_signature" alt="" coords="196,13,375,39"/>
<area shape="rect" id="node3" href="crypto__rsa_8c.html#a47b1080a7a68f04e0e745168075c235f" title="crypto_pk_keysize" alt="" coords="423,13,553,39"/>
</map>
</div>

</div>
</div>
<a id="ae9c94e2b40578dbed4b4e38a5ebe2c65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9c94e2b40578dbed4b4e38a5ebe2c65">&#9670;&nbsp;</a></span>router_get_dir_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_get_dir_hash </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>digest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>digest</b> to the SHA-1 digest of the hash of the directory in <b>s</b>. Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="ada91c927ebf9cb2a3b92b285198f172a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada91c927ebf9cb2a3b92b285198f172a">&#9670;&nbsp;</a></span>router_get_dirobj_signature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* router_get_dirobj_signature </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>digest_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>private_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: used to generate signatures for routers, directories and network-status objects. Given a <b>digest_len</b>-byte digest in <b>digest</b> and a secret <b>private_key</b>, generate an PKCS1-padded signature, BASE64-encode it, surround it with --&mdash;BEGIN/END--&mdash; pairs, and return the new signature on success or NULL on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_ada91c927ebf9cb2a3b92b285198f172a_cgraph.png" border="0" usemap="#routerparse_8h_ada91c927ebf9cb2a3b92b285198f172a_cgraph" alt=""/></div>
<map name="routerparse_8h_ada91c927ebf9cb2a3b92b285198f172a_cgraph" id="routerparse_8h_ada91c927ebf9cb2a3b92b285198f172a_cgraph">
<area shape="rect" id="node2" href="crypto__rsa_8c.html#a47b1080a7a68f04e0e745168075c235f" title="crypto_pk_keysize" alt="" coords="232,5,363,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_ada91c927ebf9cb2a3b92b285198f172a_icgraph.png" border="0" usemap="#routerparse_8h_ada91c927ebf9cb2a3b92b285198f172a_icgraph" alt=""/></div>
<map name="routerparse_8h_ada91c927ebf9cb2a3b92b285198f172a_icgraph" id="routerparse_8h_ada91c927ebf9cb2a3b92b285198f172a_icgraph">
<area shape="rect" id="node2" href="routerparse_8h.html#a594cb966cbb2893822d931ffe955b53d" title="router_append_dirobj\l_signature" alt="" coords="232,5,375,47"/>
</map>
</div>

</div>
</div>
<a id="a38ef1e01c3b561811bc4bd4f0777eb3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38ef1e01c3b561811bc4bd4f0777eb3e">&#9670;&nbsp;</a></span>router_get_extrainfo_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_get_extrainfo_hash </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>s_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>digest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>digest</b> to the SHA-1 digest of the hash of the <b>s_len</b>-byte extrainfo string at <b>s</b>. Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="a6105fa03c7a751d474a380de5016360b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6105fa03c7a751d474a380de5016360b">&#9670;&nbsp;</a></span>router_get_networkstatus_v3_hashes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_get_networkstatus_v3_hashes </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcommon__digests__t.html">common_digests_t</a> *&#160;</td>
          <td class="paramname"><em>digests</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>digests</b> to all the digests of the consensus document in <b>s</b> </p>

</div>
</div>
<a id="afd89ff48acdb8ef399f773e42a8398d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd89ff48acdb8ef399f773e42a8398d8">&#9670;&nbsp;</a></span>router_get_networkstatus_v3_sha3_as_signed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_get_networkstatus_v3_sha3_as_signed </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>digest_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>digest_out</b> to the SHA3-256 digest of the signed portion of the networkstatus vote in <b>s</b> &ndash; or of the entirety of <b>s</b> if no signed portion can be identified. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_afd89ff48acdb8ef399f773e42a8398d8_cgraph.png" border="0" usemap="#routerparse_8h_afd89ff48acdb8ef399f773e42a8398d8_cgraph" alt=""/></div>
<map name="routerparse_8h_afd89ff48acdb8ef399f773e42a8398d8_cgraph" id="routerparse_8h_afd89ff48acdb8ef399f773e42a8398d8_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#aae7e91b9970f52f892b255d99a2358fd" title="router_get_networkstatus\l_v3_signed_boundaries" alt="" coords="223,5,392,47"/>
<area shape="rect" id="node3" href="crypto__digest_8c.html#a42ff4ac7df6e3158f3a1a32d75081c32" title="crypto_digest256" alt="" coords="247,71,368,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_afd89ff48acdb8ef399f773e42a8398d8_icgraph.png" border="0" usemap="#routerparse_8h_afd89ff48acdb8ef399f773e42a8398d8_icgraph" alt=""/></div>
<map name="routerparse_8h_afd89ff48acdb8ef399f773e42a8398d8_icgraph" id="routerparse_8h_afd89ff48acdb8ef399f773e42a8398d8_icgraph">
<area shape="rect" id="node2" href="consdiff_8c.html#af0b81e4502db10522c1051647963be2f" title="MOCK_IMPL" alt="" coords="223,13,323,39"/>
</map>
</div>

</div>
</div>
<a id="aae7e91b9970f52f892b255d99a2358fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae7e91b9970f52f892b255d99a2358fd">&#9670;&nbsp;</a></span>router_get_networkstatus_v3_signed_boundaries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_get_networkstatus_v3_signed_boundaries </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>start_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>end_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Try to find the start and end of the signed portion of a networkstatus document in <b>s</b>. On success, set <b>start_out</b> to the first character of the document, and <b>end_out</b> to a position one after the final character of the signed document, and return 0. On failure, return -1. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_aae7e91b9970f52f892b255d99a2358fd_icgraph.png" border="0" usemap="#routerparse_8h_aae7e91b9970f52f892b255d99a2358fd_icgraph" alt=""/></div>
<map name="routerparse_8h_aae7e91b9970f52f892b255d99a2358fd_icgraph" id="routerparse_8h_aae7e91b9970f52f892b255d99a2358fd_icgraph">
<area shape="rect" id="node2" href="routerparse_8h.html#afd89ff48acdb8ef399f773e42a8398d8" title="router_get_networkstatus\l_v3_sha3_as_signed" alt="" coords="223,5,392,47"/>
<area shape="rect" id="node3" href="consdiff_8c.html#af0b81e4502db10522c1051647963be2f" title="MOCK_IMPL" alt="" coords="440,13,540,39"/>
</map>
</div>

</div>
</div>
<a id="a88a39471f268a31b09e1677d5e57506a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88a39471f268a31b09e1677d5e57506a">&#9670;&nbsp;</a></span>router_get_router_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_get_router_hash </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>s_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>digest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>digest</b> to the SHA-1 digest of the hash of the first router in <b>s</b>. Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="a6ed67129e89fe64d2f329a1e94063f48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ed67129e89fe64d2f329a1e94063f48">&#9670;&nbsp;</a></span>router_parse_entry_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrouterinfo__t.html">routerinfo_t</a>* router_parse_entry_from_string </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cache_copy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allow_annotations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prepend_annotations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>can_dl_again_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function: reads a single router entry from *<b>s</b> ... *<b>end</b>. Mallocs a new router and returns it if all goes well, else returns NULL. If <b>cache_copy</b> is true, duplicate the contents of s through end into the signed_descriptor_body of the resulting <a class="el" href="structrouterinfo__t.html">routerinfo_t</a>.</p>
<p>If <b>end</b> is NULL, <b>s</b> must be properly NUL-terminated.</p>
<p>If <b>allow_annotations</b>, it's okay to encounter annotations in <b>s</b> before the router; if it's false, reject the router if it's annotated. If <b>prepend_annotations</b> is set, it should contain some annotations: append them to the front of the router before parsing it, and keep them around when caching the router.</p>
<p>Only one of allow_annotations and prepend_annotations may be set.</p>
<p>If <b>can_dl_again_out</b> is provided, set *<b>can_dl_again_out</b> to 1 if it's okay to try to download a descriptor with this same digest again, and 0 if it isn't. (It might not be okay to download it again if part of the part covered by the digest is invalid.) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_a6ed67129e89fe64d2f329a1e94063f48_cgraph.png" border="0" usemap="#routerparse_8h_a6ed67129e89fe64d2f329a1e94063f48_cgraph" alt=""/></div>
<map name="routerparse_8h_a6ed67129e89fe64d2f329a1e94063f48_cgraph" id="routerparse_8h_a6ed67129e89fe64d2f329a1e94063f48_cgraph">
<area shape="rect" id="node2" href="memarea_8c.html#a9bc481c5060ff6280cfb1e5eaaa915f4" title="memarea_new" alt="" coords="186,5,293,32"/>
<area shape="rect" id="node3" href="parsecommon_8c.html#af5a0f0fc39c7237d4d86a4288f31e19b" title="tokenize_string" alt="" coords="184,56,295,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_a6ed67129e89fe64d2f329a1e94063f48_icgraph.png" border="0" usemap="#routerparse_8h_a6ed67129e89fe64d2f329a1e94063f48_icgraph" alt=""/></div>
<map name="routerparse_8h_a6ed67129e89fe64d2f329a1e94063f48_icgraph" id="routerparse_8h_a6ed67129e89fe64d2f329a1e94063f48_icgraph">
<area shape="rect" id="node2" href="routerlist_8h.html#a7b194ad6a42e8fb2ef4f3aa1cf135830" title="router_load_single\l_router" alt="" coords="184,5,311,47"/>
</map>
</div>

</div>
</div>
<a id="ac757269bfea899db05e0778fd18c4d5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac757269bfea899db05e0778fd18c4d5a">&#9670;&nbsp;</a></span>router_parse_list_from_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int router_parse_list_from_string </td>
          <td>(</td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>eos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#a010ba601a8385178d2aa25beb04b4d9c">saved_location_t</a>&#160;</td>
          <td class="paramname"><em>saved_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>want_extrainfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allow_annotations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prepend_annotations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>invalid_digests_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a string *<b>s</b> containing a concatenated sequence of router descriptors (or extra-info documents if <b>is_extrainfo</b> is set), parses them and stores the result in <b>dest</b>. All routers are marked running and valid. Advances *s to a point immediately following the last router entry. Ignore any trailing router entries that are not complete.</p>
<p>If <b>saved_location</b> isn't SAVED_IN_CACHE, make a local copy of each descriptor in the signed_descriptor_body field of each <a class="el" href="structrouterinfo__t.html">routerinfo_t</a>. If it isn't SAVED_NOWHERE, remember the offset of each descriptor.</p>
<p>Returns 0 on success and -1 on failure. Adds a digest to <b>invalid_digests_out</b> for every entry that was unparseable or invalid. (This may cause duplicate entries.) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_ac757269bfea899db05e0778fd18c4d5a_icgraph.png" border="0" usemap="#routerparse_8h_ac757269bfea899db05e0778fd18c4d5a_icgraph" alt=""/></div>
<map name="routerparse_8h_ac757269bfea899db05e0778fd18c4d5a_icgraph" id="routerparse_8h_ac757269bfea899db05e0778fd18c4d5a_icgraph">
<area shape="rect" id="node2" href="routerlist_8h.html#ae08c5697c58be20a7bb11b34ca9aba5e" title="router_load_routers\l_from_string" alt="" coords="209,5,342,47"/>
<area shape="rect" id="node3" href="routerlist_8h.html#a373b610cd5f3f54650e6e7d47ae70263" title="router_load_extrainfo\l_from_string" alt="" coords="204,71,347,112"/>
</map>
</div>

</div>
</div>
<a id="aa960633d43eaf0a653b3d45d9e7e5f92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa960633d43eaf0a653b3d45d9e7e5f92">&#9670;&nbsp;</a></span>routerparse_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void routerparse_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clean up all data structures used by <a class="el" href="routerparse_8c.html" title="Code to parse and validate router descriptors, consenus directories, and similar objects. ">routerparse.c</a> at exit </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_aa960633d43eaf0a653b3d45d9e7e5f92_cgraph.png" border="0" usemap="#routerparse_8h_aa960633d43eaf0a653b3d45d9e7e5f92_cgraph" alt=""/></div>
<map name="routerparse_8h_aa960633d43eaf0a653b3d45d9e7e5f92_cgraph" id="routerparse_8h_aa960633d43eaf0a653b3d45d9e7e5f92_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#a87185b16e92ff1ca520cd5293c20531d" title="dump_desc_fifo_cleanup" alt="" coords="189,5,356,32"/>
</map>
</div>

</div>
</div>
<a id="ab4ca055512bee2e709f53a889cd2dd84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4ca055512bee2e709f53a889cd2dd84">&#9670;&nbsp;</a></span>routerparse_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void routerparse_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called on startup; right now we just handle scanning the unparseable descriptor dumps, but hang anything else we might need to do in the future here as well. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_ab4ca055512bee2e709f53a889cd2dd84_cgraph.png" border="0" usemap="#routerparse_8h_ab4ca055512bee2e709f53a889cd2dd84_cgraph" alt=""/></div>
<map name="routerparse_8h_ab4ca055512bee2e709f53a889cd2dd84_cgraph" id="routerparse_8h_ab4ca055512bee2e709f53a889cd2dd84_cgraph">
<area shape="rect" id="node2" href="sandbox_8c.html#accea9203c614b0ca61ae5f3da44e0f56" title="sandbox_is_active" alt="" coords="164,5,295,32"/>
</map>
</div>

</div>
</div>
<a id="a8e5734db3a8dd85fb0d16c180d64a4cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e5734db3a8dd85fb0d16c180d64a4cd">&#9670;&nbsp;</a></span>sort_version_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sort_version_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>versions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>remove_duplicates</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sort a list of string-representations of versions in ascending order. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_a8e5734db3a8dd85fb0d16c180d64a4cd_cgraph.png" border="0" usemap="#routerparse_8h_a8e5734db3a8dd85fb0d16c180d64a4cd_cgraph" alt=""/></div>
<map name="routerparse_8h_a8e5734db3a8dd85fb0d16c180d64a4cd_cgraph" id="routerparse_8h_a8e5734db3a8dd85fb0d16c180d64a4cd_cgraph">
<area shape="rect" id="node2" href="container_8c.html#adeb0528c65b62117acb2b8f6e2b0e910" title="smartlist_sort" alt="" coords="171,5,272,32"/>
</map>
</div>

</div>
</div>
<a id="a34e1f6d4f6429bcf1d565f54a1dfcd5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34e1f6d4f6429bcf1d565f54a1dfcd5c">&#9670;&nbsp;</a></span>tor_version_as_new_as()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_version_as_new_as </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>platform</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cutoff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the Tor version of the platform string <b>platform</b>, and compare it to the version in <b>cutoff</b>. Return 1 if the router is at least as new as the cutoff, else return 0. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_a34e1f6d4f6429bcf1d565f54a1dfcd5c_cgraph.png" border="0" usemap="#routerparse_8h_a34e1f6d4f6429bcf1d565f54a1dfcd5c_cgraph" alt=""/></div>
<map name="routerparse_8h_a34e1f6d4f6429bcf1d565f54a1dfcd5c_cgraph" id="routerparse_8h_a34e1f6d4f6429bcf1d565f54a1dfcd5c_cgraph">
<area shape="rect" id="node2" href="routerparse_8c.html#ace4c11b51ca67a4f140ed41ae3d47b6d" title="tor_version_parse" alt="" coords="212,5,337,32"/>
<area shape="rect" id="node3" href="util_8c.html#a1d095be5cec365a93ac90501390f70fa" title="strcasecmpstart" alt="" coords="385,5,501,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_a34e1f6d4f6429bcf1d565f54a1dfcd5c_icgraph.png" border="0" usemap="#routerparse_8h_a34e1f6d4f6429bcf1d565f54a1dfcd5c_icgraph" alt=""/></div>
<map name="routerparse_8h_a34e1f6d4f6429bcf1d565f54a1dfcd5c_icgraph" id="routerparse_8h_a34e1f6d4f6429bcf1d565f54a1dfcd5c_icgraph">
<area shape="rect" id="node2" href="protover_8h.html#a14cfeb2deba8e3104fc9ca36778312d9" title="C_RUST_COUPLED: src/rust/protover/protover.rs compute_for_old_tor " alt="" coords="212,5,360,47"/>
</map>
</div>

</div>
</div>
<a id="a86ae08e44b4d585ae18040e96e98a92c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86ae08e44b4d585ae18040e96e98a92c">&#9670;&nbsp;</a></span>tor_version_compare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_version_compare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtor__version__t.html">tor_version_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtor__version__t.html">tor_version_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compare two tor versions; Return &lt;0 if a &lt; b; 0 if a ==b, &gt;0 if a &gt; b. </p>

</div>
</div>
<a id="aef22cc5550ef14cb0cf8fd3bca4dbd69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef22cc5550ef14cb0cf8fd3bca4dbd69">&#9670;&nbsp;</a></span>tor_version_is_obsolete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="or_8h.html#a00fd54618330b1d6b76e7571d84d90ce">version_status_t</a> tor_version_is_obsolete </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>myversion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>versionlist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return VS_RECOMMENDED if <b>myversion</b> is contained in <b>versionlist</b>. Else, return VS_EMPTY if versionlist has no entries. Else, return VS_OLD if every member of <b>versionlist</b> is newer than <b>myversion</b>. Else, return VS_NEW_IN_SERIES if there is at least one member of <b>versionlist</b> in the same series (major.minor.micro) as <b>myversion</b>, but no such member is newer than <b>myversion.</b>. Else, return VS_NEW if every member of <b>versionlist</b> is older than <b>myversion</b>. Else, return VS_UNRECOMMENDED.</p>
<p>(versionlist is a comma-separated list of version strings, optionally prefixed with "Tor". Versions that can't be parsed are ignored.) </p>

</div>
</div>
<a id="ace4c11b51ca67a4f140ed41ae3d47b6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace4c11b51ca67a4f140ed41ae3d47b6d">&#9670;&nbsp;</a></span>tor_version_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_version_parse </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtor__version__t.html">tor_version_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a tor version from <b>s</b>, and store the result in <b>out</b>. Return 0 on success, -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_ace4c11b51ca67a4f140ed41ae3d47b6d_cgraph.png" border="0" usemap="#routerparse_8h_ace4c11b51ca67a4f140ed41ae3d47b6d_cgraph" alt=""/></div>
<map name="routerparse_8h_ace4c11b51ca67a4f140ed41ae3d47b6d_cgraph" id="routerparse_8h_ace4c11b51ca67a4f140ed41ae3d47b6d_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a1d095be5cec365a93ac90501390f70fa" title="strcasecmpstart" alt="" coords="179,5,295,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_ace4c11b51ca67a4f140ed41ae3d47b6d_icgraph.png" border="0" usemap="#routerparse_8h_ace4c11b51ca67a4f140ed41ae3d47b6d_icgraph" alt=""/></div>
<map name="routerparse_8h_ace4c11b51ca67a4f140ed41ae3d47b6d_icgraph" id="routerparse_8h_ace4c11b51ca67a4f140ed41ae3d47b6d_icgraph">
<area shape="rect" id="node2" href="routerparse_8h.html#a47c9a3cf5868b2133b4e5a582ca69aa6" title="tor_version_parse_platform" alt="" coords="179,5,357,32"/>
<area shape="rect" id="node3" href="routerparse_8h.html#a34e1f6d4f6429bcf1d565f54a1dfcd5c" title="tor_version_as_new_as" alt="" coords="189,56,347,83"/>
<area shape="rect" id="node4" href="protover_8h.html#a14cfeb2deba8e3104fc9ca36778312d9" title="C_RUST_COUPLED: src/rust/protover/protover.rs compute_for_old_tor " alt="" coords="405,49,553,90"/>
</map>
</div>

</div>
</div>
<a id="a47c9a3cf5868b2133b4e5a582ca69aa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47c9a3cf5868b2133b4e5a582ca69aa6">&#9670;&nbsp;</a></span>tor_version_parse_platform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_version_parse_platform </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>platform</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtor__version__t.html">tor_version_t</a> *&#160;</td>
          <td class="paramname"><em>router_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>strict</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extract a Tor version from a <b>platform</b> line from a router descriptor, and place the result in <b>router_version</b>.</p>
<p>Return 1 on success, -1 on parsing failure, and 0 if the platform line does not indicate some version of Tor.</p>
<p>If <b>strict</b> is non-zero, finding any weird version components (like negative numbers) counts as a parsing failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="routerparse_8h_a47c9a3cf5868b2133b4e5a582ca69aa6_cgraph.png" border="0" usemap="#routerparse_8h_a47c9a3cf5868b2133b4e5a582ca69aa6_cgraph" alt=""/></div>
<map name="routerparse_8h_a47c9a3cf5868b2133b4e5a582ca69aa6_cgraph" id="routerparse_8h_a47c9a3cf5868b2133b4e5a582ca69aa6_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a245aaefd9d8715af06ce0f7b7355fd0d" title="strcmpstart" alt="" coords="251,5,339,32"/>
<area shape="rect" id="node3" href="util_8c.html#a69faf166aa0aa9164d2134419c81ba1b" title="eat_whitespace" alt="" coords="238,56,351,83"/>
<area shape="rect" id="node4" href="util_8c.html#a34984f08eb3eef95438b8e65226dff8e" title="find_whitespace" alt="" coords="237,107,353,133"/>
<area shape="rect" id="node5" href="routerparse_8c.html#ace4c11b51ca67a4f140ed41ae3d47b6d" title="tor_version_parse" alt="" coords="232,157,357,184"/>
<area shape="rect" id="node6" href="util_8c.html#a1d095be5cec365a93ac90501390f70fa" title="strcasecmpstart" alt="" coords="405,157,521,184"/>
</map>
</div>

</div>
</div>
<a id="aed569b83c27fc31ecf6c7aa2af2751d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed569b83c27fc31ecf6c7aa2af2751d7">&#9670;&nbsp;</a></span>tor_version_same_series()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_version_same_series </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtor__version__t.html">tor_version_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtor__version__t.html">tor_version_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff versions <b>a</b> and <b>b</b> belong to the same series. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
