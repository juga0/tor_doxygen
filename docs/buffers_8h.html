<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/common/buffers.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_b7e1585941a202f53e5249c42015d573.html">common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">buffers.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="buffers_8c.html" title="Implements a generic buffer interface. ">buffers.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;compat.h&quot;</code><br />
<code>#include &quot;<a class="el" href="torint_8h_source.html">torint.h</a>&quot;</code><br />
<code>#include &quot;testsupport.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for buffers.h:</div>
<div class="dyncontent">
<div class="center"><img src="buffers_8h__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2buffers_8h" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2buffers_8h" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2buffers_8h">
<area shape="rect" id="node2" href="compat_8h_source.html" title="compat.h" alt="" coords="240,109,316,136"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="83,259,145,285"/>
<area shape="rect" id="node6" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="525,259,623,285"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="309,333,388,360"/>
<area shape="rect" id="node8" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="341,259,449,285"/>
<area shape="rect" id="node11" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="401,184,528,211"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="buffers_8h__dep__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2buffers_8hdep" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2buffers_8hdep" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2buffers_8hdep">
<area shape="rect" id="node2" href="buffers_8c.html" title="Implements a generic buffer interface. " alt="" coords="1791,117,1944,173"/>
<area shape="rect" id="node3" href="connection_8h.html" title="Header file for connection.c. " alt="" coords="2273,117,2421,173"/>
<area shape="rect" id="node11" href="connection_8c.html" title="General high&#45;level functions to handle reading and writing on connections. " alt="" coords="5,228,153,284"/>
<area shape="rect" id="node12" href="connection__edge_8c.html" title="Handle edge streams. " alt="" coords="177,228,349,284"/>
<area shape="rect" id="node13" href="connection__or_8c.html" title="Functions to handle OR connections, TLS handshaking, and cells on the network. " alt="" coords="374,228,529,284"/>
<area shape="rect" id="node14" href="control_8c.html" title="Implementation for Tor&#39;s control&#45;socket interface. " alt="" coords="553,228,701,284"/>
<area shape="rect" id="node15" href="directory_8c.html" title="Code to send and fetch information from directory authorities and caches via HTTP. " alt="" coords="725,228,873,284"/>
<area shape="rect" id="node16" href="dirserv_8c.html" title="Directory server core implementation. Manages directory contents and generates directories. " alt="" coords="897,228,1045,284"/>
<area shape="rect" id="node24" href="main_8c.html" title="Toplevel module. Handles signals, multiplexes between connections, implements main loop..." alt="" coords="4732,228,4880,284"/>
<area shape="rect" id="node26" href="relay_8c.html" title="Handle relay cell encryption/decryption, plus packaging and receiving from circuits, plus queuing on circuits. " alt="" coords="4904,228,5052,284"/>
<area shape="rect" id="node31" href="test__helpers_8c.html" title="Some helper functions to avoid code duplication in unit tests. " alt="" coords="5076,228,5232,284"/>
<area shape="rect" id="node34" href="geoip_8c.html" title="Functions related to maintaining an IP&#45;to&#45;country database; to summarizing client connections by coun..." alt="" coords="2599,117,2747,173"/>
<area shape="rect" id="node35" href="scheduler_8c.html" title="Channel scheduling system: decides which channels should send and receive when. " alt="" coords="2771,117,2919,173"/>
<area shape="rect" id="node36" href="test__proto__http_8c.html" title="Tests for our HTTP protocol parser code. " alt="" coords="2943,109,3091,180"/>
<area shape="rect" id="node37" href="test__proto__misc_8c.html" title="Test our smaller buffer&#45;based protocol functions. " alt="" coords="3115,109,3263,180"/>
<area shape="rect" id="node4" href="bridges_8c.html" title="Code to manage bridges and bridge selection. " alt="" coords="3700,228,3848,284"/>
<area shape="rect" id="node5" href="channeltls_8c.html" title="A concrete subclass of channel_t using or_connection_t to transfer cells between Tor instances..." alt="" coords="3872,228,4020,284"/>
<area shape="rect" id="node6" href="circuitbuild_8c.html" title="Implements the details of building circuits (by chosing paths, constructing/sending create/extend cel..." alt="" coords="4044,228,4192,284"/>
<area shape="rect" id="node7" href="circuitlist_8c.html" title="Manage global structures that list and index circuits, and look up circuits within them..." alt="" coords="4216,228,4364,284"/>
<area shape="rect" id="node8" href="circuituse_8c.html" title="Launch the right sort of circuits and attach the right streams to them. " alt="" coords="4388,228,4536,284"/>
<area shape="rect" id="node9" href="command_8c.html" title="Functions for processing incoming cells. " alt="" coords="4560,228,4708,284"/>
<area shape="rect" id="node10" href="config_8c.html" title="Code to interpret the user&#39;s configuration of Tor. " alt="" coords="1069,228,1217,284"/>
<area shape="rect" id="node17" href="dns_8c.html" title="Implements a local cache for DNS results for Tor servers. This is implemented as a wrapper around Ada..." alt="" coords="1241,228,1389,284"/>
<area shape="rect" id="node18" href="dnsserv_8c.html" title="Implements client&#45;side DNS proxy server code. " alt="" coords="1413,228,1561,284"/>
<area shape="rect" id="node19" href="entrynodes_8c.html" title="Code to manage our fixed first nodes for various functions. " alt="" coords="1585,228,1733,284"/>
<area shape="rect" id="node20" href="ext__orport_8c.html" title="Code implementing the Extended ORPort. " alt="" coords="1757,228,1905,284"/>
<area shape="rect" id="node21" href="hibernate_8c.html" title="Functions to close listeners, stop allowing new circuits, etc in preparation for closing down or goin..." alt="" coords="1929,228,2077,284"/>
<area shape="rect" id="node22" href="hs__client_8c.html" title="Implement next generation hidden service client functionality. " alt="" coords="2101,228,2249,284"/>
<area shape="rect" id="node23" href="hs__service_8c.html" title="Implement next generation hidden service functionality. " alt="" coords="2273,228,2421,284"/>
<area shape="rect" id="node25" href="networkstatus_8c.html" title="Functions and structures for handling networkstatus documents as a client or as a directory cache..." alt="" coords="2445,228,2601,284"/>
<area shape="rect" id="node27" href="rendclient_8c.html" title="Client code to access location&#45;hidden services. " alt="" coords="2625,228,2773,284"/>
<area shape="rect" id="node28" href="router_8c.html" title="Miscellaneous relay functionality, including RSA key maintenance, generating and uploading server des..." alt="" coords="2797,228,2945,284"/>
<area shape="rect" id="node29" href="routerlist_8c.html" title="Code to maintain and access the global list of routerinfos for known servers. " alt="" coords="2969,228,3117,284"/>
<area shape="rect" id="node30" href="statefile_8c.html" title="Handles parsing and encoding the persistent &#39;state&#39; file that carries miscellaneous persistent state ..." alt="" coords="3141,228,3289,284"/>
<area shape="rect" id="node32" href="test__hs__cache_8c.html" title="Test hidden service caches. " alt="" coords="3314,228,3485,284"/>
<area shape="rect" id="node33" href="test__hs__client_8c.html" title="Test prop224 HS client functionality. " alt="" coords="3509,228,3676,284"/>
</map>
</div>
</div>
<p><a href="buffers_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:abbefb067ade64cae00145d4e9e5f148c"><td class="memItemLeft" align="right" valign="top"><a id="abbefb067ade64cae00145d4e9e5f148c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>buf_free</b>(b)&#160;&#160;&#160;FREE_AND_NULL(buf_t, <a class="el" href="buffers_8h.html#ac4a84ddb637f879c6e24ef77a229b731">buf_free_</a>, (b))</td></tr>
<tr class="separator:abbefb067ade64cae00145d4e9e5f148c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eca3fac75b41512270216af01806bc2"><td class="memItemLeft" align="right" valign="top"><a id="a8eca3fac75b41512270216af01806bc2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PEEK_BUF_STARTSWITH_MAX</b>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a8eca3fac75b41512270216af01806bc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a64812dda38d4edbffab5eaa701bb3f4e"><td class="memItemLeft" align="right" valign="top"><a id="a64812dda38d4edbffab5eaa701bb3f4e"></a>
typedef struct buf_t&#160;</td><td class="memItemRight" valign="bottom"><b>buf_t</b></td></tr>
<tr class="separator:a64812dda38d4edbffab5eaa701bb3f4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2792d274b6e45707b54d36697b575cd5"><td class="memItemLeft" align="right" valign="top">buf_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a2792d274b6e45707b54d36697b575cd5">buf_new</a> (void)</td></tr>
<tr class="separator:a2792d274b6e45707b54d36697b575cd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25596a2194d00f8015a2a454ad0deede"><td class="memItemLeft" align="right" valign="top">buf_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a25596a2194d00f8015a2a454ad0deede">buf_new_with_capacity</a> (size_t size)</td></tr>
<tr class="separator:a25596a2194d00f8015a2a454ad0deede"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ccdeb5d1807ead1cf47df6fdd78267f"><td class="memItemLeft" align="right" valign="top"><a id="a0ccdeb5d1807ead1cf47df6fdd78267f"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>buf_get_default_chunk_size</b> (const buf_t *buf)</td></tr>
<tr class="separator:a0ccdeb5d1807ead1cf47df6fdd78267f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4a84ddb637f879c6e24ef77a229b731"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#ac4a84ddb637f879c6e24ef77a229b731">buf_free_</a> (buf_t *buf)</td></tr>
<tr class="separator:ac4a84ddb637f879c6e24ef77a229b731"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d5f6af679f4b6ead9ba2aca03941931"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a1d5f6af679f4b6ead9ba2aca03941931">buf_clear</a> (buf_t *buf)</td></tr>
<tr class="separator:a1d5f6af679f4b6ead9ba2aca03941931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a698473a00b89755b994e4f9b83817e98"><td class="memItemLeft" align="right" valign="top">buf_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a698473a00b89755b994e4f9b83817e98">buf_copy</a> (const buf_t *buf)</td></tr>
<tr class="separator:a698473a00b89755b994e4f9b83817e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abec7016d94d6a9481baae254319676db"><td class="memItemLeft" align="right" valign="top"><a id="abec7016d94d6a9481baae254319676db"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MOCK_DECL</b> (size_t, buf_datalen,(const buf_t *buf))</td></tr>
<tr class="separator:abec7016d94d6a9481baae254319676db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a364f8af28dc3b92ec93bf5c433a44209"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a364f8af28dc3b92ec93bf5c433a44209">buf_allocation</a> (const buf_t *buf)</td></tr>
<tr class="separator:a364f8af28dc3b92ec93bf5c433a44209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8042b5333db20f4e1198817d96ba0be"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#aa8042b5333db20f4e1198817d96ba0be">buf_slack</a> (const buf_t *buf)</td></tr>
<tr class="separator:aa8042b5333db20f4e1198817d96ba0be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69be7777203d7b3f1626f62dea75cc61"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a69be7777203d7b3f1626f62dea75cc61">buf_get_oldest_chunk_timestamp</a> (const buf_t *buf, uint32_t now)</td></tr>
<tr class="separator:a69be7777203d7b3f1626f62dea75cc61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed3d5a6dbe1161f151d342e4f32f29c"><td class="memItemLeft" align="right" valign="top"><a id="aeed3d5a6dbe1161f151d342e4f32f29c"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>buf_get_total_allocation</b> (void)</td></tr>
<tr class="separator:aeed3d5a6dbe1161f151d342e4f32f29c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af302612b5c872f922c101cbeef706969"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#af302612b5c872f922c101cbeef706969">buf_read_from_socket</a> (buf_t *buf, tor_socket_t s, size_t at_most, int *reached_eof, int *socket_error)</td></tr>
<tr class="separator:af302612b5c872f922c101cbeef706969"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f32546eb41f11cddf6ce32335c2705a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a0f32546eb41f11cddf6ce32335c2705a">buf_flush_to_socket</a> (buf_t *buf, tor_socket_t s, size_t sz, size_t *buf_flushlen)</td></tr>
<tr class="separator:a0f32546eb41f11cddf6ce32335c2705a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2771e1c14c464b10533a079f40a59a8d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a2771e1c14c464b10533a079f40a59a8d">buf_add</a> (buf_t *buf, const char *string, size_t string_len)</td></tr>
<tr class="separator:a2771e1c14c464b10533a079f40a59a8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac81f33eaee90f281dd2e983edb5d8a76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#ac81f33eaee90f281dd2e983edb5d8a76">buf_add_string</a> (buf_t *buf, const char *string)</td></tr>
<tr class="separator:ac81f33eaee90f281dd2e983edb5d8a76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca2f04a704608eac41173d508d1574b7"><td class="memItemLeft" align="right" valign="top"><a id="aca2f04a704608eac41173d508d1574b7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>buf_add_printf</b> (buf_t *buf, const char *format,...) CHECK_PRINTF(2</td></tr>
<tr class="separator:aca2f04a704608eac41173d508d1574b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95716ffa18df94a0410ad2616ec7cf6a"><td class="memItemLeft" align="right" valign="top"><a id="a95716ffa18df94a0410ad2616ec7cf6a"></a>
void void&#160;</td><td class="memItemRight" valign="bottom"><b>buf_add_vprintf</b> (buf_t *buf, const char *format, va_list args) CHECK_PRINTF(2</td></tr>
<tr class="separator:a95716ffa18df94a0410ad2616ec7cf6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7f2c6985fb46e56498bb3d79a0982af"><td class="memItemLeft" align="right" valign="top">void void int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#aa7f2c6985fb46e56498bb3d79a0982af">buf_add_compress</a> (buf_t *buf, struct <a class="el" href="structtor__compress__state__t.html">tor_compress_state_t</a> *state, const char *data, size_t data_len, int done)</td></tr>
<tr class="separator:aa7f2c6985fb46e56498bb3d79a0982af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac37c46ae32a03e102b2d96ead9720b78"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#ac37c46ae32a03e102b2d96ead9720b78">buf_move_to_buf</a> (buf_t *buf_out, buf_t *buf_in, size_t *buf_flushlen)</td></tr>
<tr class="separator:ac37c46ae32a03e102b2d96ead9720b78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad564d96c1341295bc78e91a63487b380"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#ad564d96c1341295bc78e91a63487b380">buf_move_all</a> (buf_t *buf_out, buf_t *buf_in)</td></tr>
<tr class="separator:ad564d96c1341295bc78e91a63487b380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab57eb196436a751b01d16d36800d024f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#ab57eb196436a751b01d16d36800d024f">buf_peek</a> (const buf_t *buf, char *string, size_t string_len)</td></tr>
<tr class="separator:ab57eb196436a751b01d16d36800d024f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35f5b3ecde022dbe0d090d05a124c161"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a35f5b3ecde022dbe0d090d05a124c161">buf_drain</a> (buf_t *buf, size_t n)</td></tr>
<tr class="separator:a35f5b3ecde022dbe0d090d05a124c161"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee885c0513a4508ae43799128f2ef740"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#aee885c0513a4508ae43799128f2ef740">buf_get_bytes</a> (buf_t *buf, char *string, size_t string_len)</td></tr>
<tr class="separator:aee885c0513a4508ae43799128f2ef740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eae1b7d95fe3452ed0a7015c8928d06"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a8eae1b7d95fe3452ed0a7015c8928d06">buf_get_line</a> (buf_t *buf, char *data_out, size_t *data_len)</td></tr>
<tr class="separator:a8eae1b7d95fe3452ed0a7015c8928d06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71277fd087ceacf0a3895d986cffd8c9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a71277fd087ceacf0a3895d986cffd8c9">buf_peek_startswith</a> (const buf_t *buf, const char *cmd)</td></tr>
<tr class="separator:a71277fd087ceacf0a3895d986cffd8c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad27eb7c3c9dcc484cbd276fbfb2a0791"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#ad27eb7c3c9dcc484cbd276fbfb2a0791">buf_set_to_copy</a> (buf_t **output, const buf_t *input)</td></tr>
<tr class="separator:ad27eb7c3c9dcc484cbd276fbfb2a0791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73c287855239cd653ece9a64f5e37628"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a73c287855239cd653ece9a64f5e37628">buf_assert_ok</a> (buf_t *buf)</td></tr>
<tr class="separator:a73c287855239cd653ece9a64f5e37628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a521faf31db632ada50138286eeb8aef3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#a521faf31db632ada50138286eeb8aef3">buf_find_string_offset</a> (const buf_t *buf, const char *s, size_t n)</td></tr>
<tr class="separator:a521faf31db632ada50138286eeb8aef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc9b19740e96a976653effe8f2db21ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#afc9b19740e96a976653effe8f2db21ff">buf_pullup</a> (buf_t *buf, size_t bytes, const char **head_out, size_t *len_out)</td></tr>
<tr class="separator:afc9b19740e96a976653effe8f2db21ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5b7a576cef119053df2184f76e4000f"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffers_8h.html#af5b7a576cef119053df2184f76e4000f">buf_extract</a> (buf_t *buf, size_t *sz_out)</td></tr>
<tr class="separator:af5b7a576cef119053df2184f76e4000f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="buffers_8c.html" title="Implements a generic buffer interface. ">buffers.c</a>. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a2771e1c14c464b10533a079f40a59a8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2771e1c14c464b10533a079f40a59a8d">&#9670;&nbsp;</a></span>buf_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int buf_add </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>string_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Append <b>string_len</b> bytes from <b>string</b> to the end of <b>buf</b>.</p>
<p>Return the new length of the buffer on success, -1 on failure. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="buffers_8h_a2771e1c14c464b10533a079f40a59a8d_icgraph.png" border="0" usemap="#buffers_8h_a2771e1c14c464b10533a079f40a59a8d_icgraph" alt=""/></div>
<map name="buffers_8h_a2771e1c14c464b10533a079f40a59a8d_icgraph" id="buffers_8h_a2771e1c14c464b10533a079f40a59a8d_icgraph">
<area shape="rect" id="node2" href="buffers_8h.html#ac81f33eaee90f281dd2e983edb5d8a76" title="buf_add_string" alt="" coords="123,5,230,32"/>
<area shape="rect" id="node3" href="buffers_8c.html#aa957514fdc2f68cccc3ec62ecb9448ef" title="buf_add_vprintf" alt="" coords="121,56,232,83"/>
<area shape="rect" id="node4" href="buffers_8c.html#a05f864bf1a0d082230f7869e4f5b51c7" title="buf_add_printf" alt="" coords="280,56,384,83"/>
</map>
</div>

</div>
</div>
<a id="aa7f2c6985fb46e56498bb3d79a0982af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7f2c6985fb46e56498bb3d79a0982af">&#9670;&nbsp;</a></span>buf_add_compress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void void int buf_add_compress </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtor__compress__state__t.html">tor_compress_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>done</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compress or uncompress the <b>data_len</b> bytes in <b>data</b> using the compression state <b>state</b>, appending the result to <b>buf</b>. If <b>done</b> is true, flush the data in the state and finish the compression/uncompression. Return -1 on failure, 0 on success. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="buffers_8h_aa7f2c6985fb46e56498bb3d79a0982af_cgraph.png" border="0" usemap="#buffers_8h_aa7f2c6985fb46e56498bb3d79a0982af_cgraph" alt=""/></div>
<map name="buffers_8h_aa7f2c6985fb46e56498bb3d79a0982af_cgraph" id="buffers_8h_aa7f2c6985fb46e56498bb3d79a0982af_cgraph">
<area shape="rect" id="node2" href="buffers_8c.html#a200c41fd4c9428ee25c7426d2341cfa4" title="buf_add_chunk_with\l_capacity" alt="" coords="192,5,333,47"/>
<area shape="rect" id="node3" href="compress_8c.html#a17aeea51b529bfd80931a7fc554adb25" title="tor_compress_process" alt="" coords="185,71,340,98"/>
</map>
</div>

</div>
</div>
<a id="ac81f33eaee90f281dd2e983edb5d8a76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac81f33eaee90f281dd2e983edb5d8a76">&#9670;&nbsp;</a></span>buf_add_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buf_add_string </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>string</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a nul-terminated <b>string</b> to <b>buf</b>, not including the terminating NUL. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="buffers_8h_ac81f33eaee90f281dd2e983edb5d8a76_cgraph.png" border="0" usemap="#buffers_8h_ac81f33eaee90f281dd2e983edb5d8a76_cgraph" alt=""/></div>
<map name="buffers_8h_ac81f33eaee90f281dd2e983edb5d8a76_cgraph" id="buffers_8h_ac81f33eaee90f281dd2e983edb5d8a76_cgraph">
<area shape="rect" id="node2" href="buffers_8c.html#a2771e1c14c464b10533a079f40a59a8d" title="buf_add" alt="" coords="160,5,228,32"/>
</map>
</div>

</div>
</div>
<a id="a364f8af28dc3b92ec93bf5c433a44209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a364f8af28dc3b92ec93bf5c433a44209">&#9670;&nbsp;</a></span>buf_allocation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t buf_allocation </td>
          <td>(</td>
          <td class="paramtype">const buf_t *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the total length of all chunks used in <b>buf</b>. </p>

</div>
</div>
<a id="a73c287855239cd653ece9a64f5e37628"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73c287855239cd653ece9a64f5e37628">&#9670;&nbsp;</a></span>buf_assert_ok()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buf_assert_ok </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log an error and exit if <b>buf</b> is corrupted. </p>

</div>
</div>
<a id="a1d5f6af679f4b6ead9ba2aca03941931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d5f6af679f4b6ead9ba2aca03941931">&#9670;&nbsp;</a></span>buf_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buf_clear </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove all data from <b>buf</b>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="buffers_8h_a1d5f6af679f4b6ead9ba2aca03941931_icgraph.png" border="0" usemap="#buffers_8h_a1d5f6af679f4b6ead9ba2aca03941931_icgraph" alt=""/></div>
<map name="buffers_8h_a1d5f6af679f4b6ead9ba2aca03941931_icgraph" id="buffers_8h_a1d5f6af679f4b6ead9ba2aca03941931_icgraph">
<area shape="rect" id="node2" href="buffers_8h.html#ac4a84ddb637f879c6e24ef77a229b731" title="buf_free_" alt="" coords="128,5,204,32"/>
</map>
</div>

</div>
</div>
<a id="a698473a00b89755b994e4f9b83817e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a698473a00b89755b994e4f9b83817e98">&#9670;&nbsp;</a></span>buf_copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">buf_t* buf_copy </td>
          <td>(</td>
          <td class="paramtype">const buf_t *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a new copy of <b>buf</b> </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="buffers_8h_a698473a00b89755b994e4f9b83817e98_cgraph.png" border="0" usemap="#buffers_8h_a698473a00b89755b994e4f9b83817e98_cgraph" alt=""/></div>
<map name="buffers_8h_a698473a00b89755b994e4f9b83817e98_cgraph" id="buffers_8h_a698473a00b89755b994e4f9b83817e98_cgraph">
<area shape="rect" id="node2" href="buffers_8c.html#a2792d274b6e45707b54d36697b575cd5" title="buf_new" alt="" coords="128,5,199,32"/>
</map>
</div>

</div>
</div>
<a id="a35f5b3ecde022dbe0d090d05a124c161"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35f5b3ecde022dbe0d090d05a124c161">&#9670;&nbsp;</a></span>buf_drain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buf_drain </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove the first <b>n</b> bytes from buf. </p>

</div>
</div>
<a id="af5b7a576cef119053df2184f76e4000f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5b7a576cef119053df2184f76e4000f">&#9670;&nbsp;</a></span>buf_extract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* buf_extract </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>sz_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a heap-allocated string containing the contents of <b>buf</b>, plus a NUL byte. If <b>sz_out</b> is provided, set *<b>sz_out</b> to the length of the returned string, not including the terminating NUL. </p>

</div>
</div>
<a id="a521faf31db632ada50138286eeb8aef3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a521faf31db632ada50138286eeb8aef3">&#9670;&nbsp;</a></span>buf_find_string_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int buf_find_string_offset </td>
          <td>(</td>
          <td class="paramtype">const buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the first position in <b>buf</b> at which the <b>n</b>-character string <b>s</b> occurs, or -1 if it does not occur. </p>

</div>
</div>
<a id="a0f32546eb41f11cddf6ce32335c2705a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f32546eb41f11cddf6ce32335c2705a">&#9670;&nbsp;</a></span>buf_flush_to_socket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int buf_flush_to_socket </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_socket_t&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>buf_flushlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write data from <b>buf</b> to the socket <b>s</b>. Write at most <b>sz</b> bytes, decrement *<b>buf_flushlen</b> by the number of bytes actually written, and remove the written bytes from the buffer. Return the number of bytes written on success, -1 on failure. Return 0 if write() would block. </p>

</div>
</div>
<a id="ac4a84ddb637f879c6e24ef77a229b731"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4a84ddb637f879c6e24ef77a229b731">&#9670;&nbsp;</a></span>buf_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buf_free_ </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release storage held by <b>buf</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="buffers_8h_ac4a84ddb637f879c6e24ef77a229b731_cgraph.png" border="0" usemap="#buffers_8h_ac4a84ddb637f879c6e24ef77a229b731_cgraph" alt=""/></div>
<map name="buffers_8h_ac4a84ddb637f879c6e24ef77a229b731_cgraph" id="buffers_8h_ac4a84ddb637f879c6e24ef77a229b731_cgraph">
<area shape="rect" id="node2" href="buffers_8c.html#a1d5f6af679f4b6ead9ba2aca03941931" title="buf_clear" alt="" coords="129,5,204,32"/>
</map>
</div>

</div>
</div>
<a id="aee885c0513a4508ae43799128f2ef740"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee885c0513a4508ae43799128f2ef740">&#9670;&nbsp;</a></span>buf_get_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int buf_get_bytes </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>string_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove <b>string_len</b> bytes from the front of <b>buf</b>, and store them into <b>string</b>. Return the new buffer size. <b>string_len</b> must be &lt;= the number of bytes on the buffer. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="buffers_8h_aee885c0513a4508ae43799128f2ef740_icgraph.png" border="0" usemap="#buffers_8h_aee885c0513a4508ae43799128f2ef740_icgraph" alt=""/></div>
<map name="buffers_8h_aee885c0513a4508ae43799128f2ef740_icgraph" id="buffers_8h_aee885c0513a4508ae43799128f2ef740_icgraph">
<area shape="rect" id="node2" href="connection_8h.html#a09e89d0a59c7f3a016ce0835ee5bbbbe" title="connection_buf_get\l_bytes" alt="" coords="157,5,292,47"/>
</map>
</div>

</div>
</div>
<a id="a8eae1b7d95fe3452ed0a7015c8928d06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eae1b7d95fe3452ed0a7015c8928d06">&#9670;&nbsp;</a></span>buf_get_line()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int buf_get_line </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>data_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Try to read a single LF-terminated line from <b>buf</b>, and write it (including the LF), NUL-terminated, into the *<b>data_len</b> byte buffer at <b>data_out</b>. Set *<b>data_len</b> to the number of bytes in the line, not counting the terminating NUL. Return 1 if we read a whole line, return 0 if we don't have a whole line yet, and return -1 if the line length exceeds *<b>data_len</b>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="buffers_8h_a8eae1b7d95fe3452ed0a7015c8928d06_icgraph.png" border="0" usemap="#buffers_8h_a8eae1b7d95fe3452ed0a7015c8928d06_icgraph" alt=""/></div>
<map name="buffers_8h_a8eae1b7d95fe3452ed0a7015c8928d06_icgraph" id="buffers_8h_a8eae1b7d95fe3452ed0a7015c8928d06_icgraph">
<area shape="rect" id="node2" href="connection_8h.html#a214ac732b498552723a03c07aad66ffc" title="connection_buf_get_line" alt="" coords="145,5,308,32"/>
</map>
</div>

</div>
</div>
<a id="a69be7777203d7b3f1626f62dea75cc61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69be7777203d7b3f1626f62dea75cc61">&#9670;&nbsp;</a></span>buf_get_oldest_chunk_timestamp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t buf_get_oldest_chunk_timestamp </td>
          <td>(</td>
          <td class="paramtype">const buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>now</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the age of the oldest chunk in the buffer <b>buf</b>, in timestamp units. Requires the current monotonic timestamp as its input <b>now</b>. </p>

</div>
</div>
<a id="ad564d96c1341295bc78e91a63487b380"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad564d96c1341295bc78e91a63487b380">&#9670;&nbsp;</a></span>buf_move_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buf_move_all </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Moves all data from <b>buf_in</b> to <b>buf_out</b>, without copying. </p>

</div>
</div>
<a id="ac37c46ae32a03e102b2d96ead9720b78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac37c46ae32a03e102b2d96ead9720b78">&#9670;&nbsp;</a></span>buf_move_to_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int buf_move_to_buf </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>buf_flushlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Move up to *<b>buf_flushlen</b> bytes from <b>buf_in</b> to <b>buf_out</b>, and modify *<b>buf_flushlen</b> appropriately. Return the number of bytes actually copied. </p>

</div>
</div>
<a id="a2792d274b6e45707b54d36697b575cd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2792d274b6e45707b54d36697b575cd5">&#9670;&nbsp;</a></span>buf_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">buf_t* buf_new </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate and return a new buffer with default capacity. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="buffers_8h_a2792d274b6e45707b54d36697b575cd5_icgraph.png" border="0" usemap="#buffers_8h_a2792d274b6e45707b54d36697b575cd5_icgraph" alt=""/></div>
<map name="buffers_8h_a2792d274b6e45707b54d36697b575cd5_icgraph" id="buffers_8h_a2792d274b6e45707b54d36697b575cd5_icgraph">
<area shape="rect" id="node2" href="buffers_8h.html#a25596a2194d00f8015a2a454ad0deede" title="buf_new_with_capacity" alt="" coords="124,5,283,32"/>
<area shape="rect" id="node3" href="buffers_8h.html#a698473a00b89755b994e4f9b83817e98" title="buf_copy" alt="" coords="166,56,241,83"/>
</map>
</div>

</div>
</div>
<a id="a25596a2194d00f8015a2a454ad0deede"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25596a2194d00f8015a2a454ad0deede">&#9670;&nbsp;</a></span>buf_new_with_capacity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">buf_t* buf_new_with_capacity </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create and return a new buf with default chunk capacity <b>size</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="buffers_8h_a25596a2194d00f8015a2a454ad0deede_cgraph.png" border="0" usemap="#buffers_8h_a25596a2194d00f8015a2a454ad0deede_cgraph" alt=""/></div>
<map name="buffers_8h_a25596a2194d00f8015a2a454ad0deede_cgraph" id="buffers_8h_a25596a2194d00f8015a2a454ad0deede_cgraph">
<area shape="rect" id="node2" href="buffers_8c.html#a2792d274b6e45707b54d36697b575cd5" title="buf_new" alt="" coords="262,5,333,32"/>
<area shape="rect" id="node3" href="buffers_8c.html#ac9f6eb1228245bca00d9a3fbbe0fe755" title="buf_preferred_chunk_size" alt="" coords="212,56,383,83"/>
</map>
</div>

</div>
</div>
<a id="ab57eb196436a751b01d16d36800d024f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab57eb196436a751b01d16d36800d024f">&#9670;&nbsp;</a></span>buf_peek()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buf_peek </td>
          <td>(</td>
          <td class="paramtype">const buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>string_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: copy the first <b>string_len</b> bytes from <b>buf</b> onto <b>string</b>. </p>

</div>
</div>
<a id="a71277fd087ceacf0a3895d986cffd8c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71277fd087ceacf0a3895d986cffd8c9">&#9670;&nbsp;</a></span>buf_peek_startswith()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int buf_peek_startswith </td>
          <td>(</td>
          <td class="paramtype">const buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cmd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return 1 iff <b>buf</b> starts with <b>cmd</b>. <b>cmd</b> must be a null terminated string, of no more than PEEK_BUF_STARTSWITH_MAX bytes. </p>

</div>
</div>
<a id="afc9b19740e96a976653effe8f2db21ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc9b19740e96a976653effe8f2db21ff">&#9670;&nbsp;</a></span>buf_pullup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buf_pullup </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>head_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>len_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Collapse data from the first N chunks from <b>buf</b> into buf-&gt;head, growing it as necessary, until buf-&gt;head has the first <b>bytes</b> bytes of data from the buffer, or until buf-&gt;head has all the data in <b>buf</b>.</p>
<p>Set *<b>head_out</b> to point to the first byte of available data, and *<b>len_out</b> to the number of bytes of data available at *<b>head_out</b>. Note that *<b>len_out</b> may be more or less than <b>bytes</b>, depending on the number of bytes available. </p>

</div>
</div>
<a id="af302612b5c872f922c101cbeef706969"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af302612b5c872f922c101cbeef706969">&#9670;&nbsp;</a></span>buf_read_from_socket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int buf_read_from_socket </td>
          <td>(</td>
          <td class="paramtype">buf_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_socket_t&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>at_most</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>reached_eof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>socket_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read from socket <b>s</b>, writing onto end of <b>buf</b>. Read at most <b>at_most</b> bytes, growing the buffer as necessary. If recv() returns 0 (because of EOF), set *<b>reached_eof</b> to 1 and return 0. Return -1 on error; else return the number of bytes read. </p>

</div>
</div>
<a id="ad27eb7c3c9dcc484cbd276fbfb2a0791"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad27eb7c3c9dcc484cbd276fbfb2a0791">&#9670;&nbsp;</a></span>buf_set_to_copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int buf_set_to_copy </td>
          <td>(</td>
          <td class="paramtype">buf_t **&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const buf_t *&#160;</td>
          <td class="paramname"><em>input</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set *<b>output</b> to contain a copy of the data in *<b>input</b> </p>

</div>
</div>
<a id="aa8042b5333db20f4e1198817d96ba0be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8042b5333db20f4e1198817d96ba0be">&#9670;&nbsp;</a></span>buf_slack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t buf_slack </td>
          <td>(</td>
          <td class="paramtype">const buf_t *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of bytes that can be added to <b>buf</b> without performing any additional allocation. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
