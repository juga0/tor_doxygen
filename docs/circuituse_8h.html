<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/circuituse.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">circuituse.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="circuituse_8c.html" title="Launch the right sort of circuits and attach streams to them. ">circuituse.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h__dep__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2circuituse_8hdep" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2circuituse_8hdep" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2circuituse_8hdep">
<area shape="rect" id="node2" href="addressmap_8c.html" title="The addressmap module manages the processes by which we rewrite addresses in client requess..." alt="" coords="5,109,153,165"/>
<area shape="rect" id="node3" href="circpathbias_8c.html" title="Code to track success/failure rates of circuits built through different tor nodes, in an attempt to detect attacks where an attacker deliberately causes circuits to fail until the client choses a path they like. " alt="" coords="177,109,325,165"/>
<area shape="rect" id="node4" href="circuitbuild_8c.html" title="Implements the details of building circuits (by chosing paths, constructing/sending create/extend cel..." alt="" coords="349,109,497,165"/>
<area shape="rect" id="node5" href="circuitlist_8c.html" title="Manage the global circuit list, and looking up circuits within it. " alt="" coords="521,109,669,165"/>
<area shape="rect" id="node6" href="circuituse_8c.html" title="Launch the right sort of circuits and attach streams to them. " alt="" coords="693,109,841,165"/>
<area shape="rect" id="node7" href="connection_8c.html" title="General high&#45;level functions to handle reading and writing on connections. " alt="" coords="865,109,1013,165"/>
<area shape="rect" id="node8" href="connection__edge_8c.html" title="Handle edge streams. " alt="" coords="1037,109,1209,165"/>
<area shape="rect" id="node9" href="control_8c.html" title="Implementation for Tor&#39;s control&#45;socket interface. " alt="" coords="1233,109,1381,165"/>
<area shape="rect" id="node10" href="dns_8c.html" title="Implements a local cache for DNS results for Tor servers. This is implemented as a wrapper around Ada..." alt="" coords="1405,109,1553,165"/>
<area shape="rect" id="node11" href="main_8c.html" title="Toplevel module. Handles signals, multiplexes between connections, implements main loop..." alt="" coords="1577,109,1725,165"/>
<area shape="rect" id="node12" href="relay_8c.html" title="Handle relay cell encryption/decryption, plus packaging and receiving from circuits, plus queuing on circuits. " alt="" coords="1749,109,1897,165"/>
<area shape="rect" id="node13" href="rendclient_8c.html" title="Client code to access location&#45;hidden services. " alt="" coords="1921,109,2069,165"/>
<area shape="rect" id="node14" href="rendmid_8c.html" title="Implement introductions points and rendezvous points. " alt="" coords="2093,109,2241,165"/>
<area shape="rect" id="node15" href="rendservice_8c.html" title="The hidden&#45;service side of rendezvous functionality. " alt="" coords="2265,109,2413,165"/>
<area shape="rect" id="node16" href="rephist_8c.html" title="Basic history and performance&#45;tracking functionality. " alt="" coords="2437,109,2585,165"/>
<area shape="rect" id="node17" href="router_8c.html" title="Miscellaneous relay functionality, including RSA key maintenance, generating and uploading server des..." alt="" coords="2609,109,2757,165"/>
<area shape="rect" id="node18" href="status_8c.html" title="Collect status information and log heartbeat messages. " alt="" coords="2781,109,2929,165"/>
</map>
</div>
</div>
<p><a href="circuituse_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a883f4d0010de416beabf5a3e2efd2bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a883f4d0010de416beabf5a3e2efd2bc5">CIRCLAUNCH_ONEHOP_TUNNEL</a>&#160;&#160;&#160;(1&lt;&lt;0)</td></tr>
<tr class="separator:a883f4d0010de416beabf5a3e2efd2bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb862887487985df30585ee38147c5da"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#acb862887487985df30585ee38147c5da">CIRCLAUNCH_NEED_UPTIME</a>&#160;&#160;&#160;(1&lt;&lt;1)</td></tr>
<tr class="separator:acb862887487985df30585ee38147c5da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77d2e94963198a037df3050e5e1bb5a9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a77d2e94963198a037df3050e5e1bb5a9">CIRCLAUNCH_NEED_CAPACITY</a>&#160;&#160;&#160;(1&lt;&lt;2)</td></tr>
<tr class="separator:a77d2e94963198a037df3050e5e1bb5a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4ac61839c8a0d41c77f90628a131cf5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#aa4ac61839c8a0d41c77f90628a131cf5">CIRCLAUNCH_IS_INTERNAL</a>&#160;&#160;&#160;(1&lt;&lt;3)</td></tr>
<tr class="separator:aa4ac61839c8a0d41c77f90628a131cf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a857005b7512302feee182107aed11121"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a857005b7512302feee182107aed11121">circuit_expire_building</a> (void)</td></tr>
<tr class="separator:a857005b7512302feee182107aed11121"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0941a9dc5da7825f107d1d4bf028063"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#ac0941a9dc5da7825f107d1d4bf028063">circuit_remove_handled_ports</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *needed_ports)</td></tr>
<tr class="separator:ac0941a9dc5da7825f107d1d4bf028063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9c9e6111de126ec1c3ca4dd17f4091c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#aa9c9e6111de126ec1c3ca4dd17f4091c">circuit_stream_is_being_handled</a> (<a class="el" href="structentry__connection__t.html">entry_connection_t</a> *conn, uint16_t port, int min)</td></tr>
<tr class="separator:aa9c9e6111de126ec1c3ca4dd17f4091c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31768fdff079617503ff37e96181c8d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a31768fdff079617503ff37e96181c8d4">circuit_log_ancient_one_hop_circuits</a> (int age)</td></tr>
<tr class="separator:a31768fdff079617503ff37e96181c8d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a882afdac4876448ae1b5eda08db9a66f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a882afdac4876448ae1b5eda08db9a66f">circuit_build_needed_circs</a> (time_t now)</td></tr>
<tr class="separator:a882afdac4876448ae1b5eda08db9a66f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5474432e0dd7549eb766af37bebb37ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a5474432e0dd7549eb766af37bebb37ed">circuit_expire_old_circs_as_needed</a> (time_t now)</td></tr>
<tr class="separator:a5474432e0dd7549eb766af37bebb37ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1159f471577ebff888f0133714903fb2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a1159f471577ebff888f0133714903fb2">circuit_detach_stream</a> (<a class="el" href="structcircuit__t.html">circuit_t</a> *circ, <a class="el" href="structedge__connection__t.html">edge_connection_t</a> *conn)</td></tr>
<tr class="separator:a1159f471577ebff888f0133714903fb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10961db035e74aaaf4791c7606873ce6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a10961db035e74aaaf4791c7606873ce6">circuit_expire_old_circuits_serverside</a> (time_t now)</td></tr>
<tr class="separator:a10961db035e74aaaf4791c7606873ce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62c92926e67f1674290aff0d08bac948"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a62c92926e67f1674290aff0d08bac948">reset_bandwidth_test</a> (void)</td></tr>
<tr class="separator:a62c92926e67f1674290aff0d08bac948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6c1a2c715351d85ef6747ca1a4db958"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#ac6c1a2c715351d85ef6747ca1a4db958">circuit_enough_testing_circs</a> (void)</td></tr>
<tr class="separator:ac6c1a2c715351d85ef6747ca1a4db958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78a23775279a45daabbdc354310a9e1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a78a23775279a45daabbdc354310a9e1f">circuit_has_opened</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:a78a23775279a45daabbdc354310a9e1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4abb529971723bed7226e327b8326c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#af4abb529971723bed7226e327b8326c3">circuit_try_attaching_streams</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:af4abb529971723bed7226e327b8326c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd87fd29ee842fc8518b17c9f7cb9ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a0bd87fd29ee842fc8518b17c9f7cb9ac">circuit_build_failed</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:a0bd87fd29ee842fc8518b17c9f7cb9ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ed466f41f7080d1c94d2394e55901ff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a5ed466f41f7080d1c94d2394e55901ff">circuit_launch_by_extend_info</a> (uint8_t purpose, <a class="el" href="structextend__info__t.html">extend_info_t</a> *info, int flags)</td></tr>
<tr class="separator:a5ed466f41f7080d1c94d2394e55901ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18a1d7e9015582c550d0d3eb7710efc9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a18a1d7e9015582c550d0d3eb7710efc9">circuit_launch</a> (uint8_t purpose, int flags)</td></tr>
<tr class="separator:a18a1d7e9015582c550d0d3eb7710efc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f03827edb583ab1e727def243a42be1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a8f03827edb583ab1e727def243a42be1">circuit_reset_failure_count</a> (int <a class="el" href="structtimeout.html">timeout</a>)</td></tr>
<tr class="separator:a8f03827edb583ab1e727def243a42be1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa95a48009b429befccf14ebce9d13a97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#aa95a48009b429befccf14ebce9d13a97">connection_ap_handshake_attach_chosen_circuit</a> (<a class="el" href="structentry__connection__t.html">entry_connection_t</a> *conn, <a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ, <a class="el" href="structcrypt__path__t.html">crypt_path_t</a> *cpath)</td></tr>
<tr class="separator:aa95a48009b429befccf14ebce9d13a97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d5c81bf7d6238331123b1e8753597f1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a8d5c81bf7d6238331123b1e8753597f1">connection_ap_handshake_attach_circuit</a> (<a class="el" href="structentry__connection__t.html">entry_connection_t</a> *conn)</td></tr>
<tr class="separator:a8d5c81bf7d6238331123b1e8753597f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a407966b13bb02eb365910ea9f07e08be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a407966b13bb02eb365910ea9f07e08be">circuit_change_purpose</a> (<a class="el" href="structcircuit__t.html">circuit_t</a> *circ, uint8_t new_purpose)</td></tr>
<tr class="separator:a407966b13bb02eb365910ea9f07e08be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6552c3467492a702a37f75ffd9a7676b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#a6552c3467492a702a37f75ffd9a7676b">hostname_in_track_host_exits</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options, const char *address)</td></tr>
<tr class="separator:a6552c3467492a702a37f75ffd9a7676b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf36645f7a473ad622918668f2f5ba33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="circuituse_8h.html#adf36645f7a473ad622918668f2f5ba33">mark_circuit_unusable_for_new_conns</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:adf36645f7a473ad622918668f2f5ba33"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="circuituse_8c.html" title="Launch the right sort of circuits and attach streams to them. ">circuituse.c</a>. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aa4ac61839c8a0d41c77f90628a131cf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4ac61839c8a0d41c77f90628a131cf5">&#9670;&nbsp;</a></span>CIRCLAUNCH_IS_INTERNAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CIRCLAUNCH_IS_INTERNAL&#160;&#160;&#160;(1&lt;&lt;3)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag to set when the last hop of a circuit doesn't need to be an exit node. </p>

</div>
</div>
<a id="a77d2e94963198a037df3050e5e1bb5a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77d2e94963198a037df3050e5e1bb5a9">&#9670;&nbsp;</a></span>CIRCLAUNCH_NEED_CAPACITY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CIRCLAUNCH_NEED_CAPACITY&#160;&#160;&#160;(1&lt;&lt;2)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag to set when a circuit needs to be built of high-capacity nodes </p>

</div>
</div>
<a id="acb862887487985df30585ee38147c5da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb862887487985df30585ee38147c5da">&#9670;&nbsp;</a></span>CIRCLAUNCH_NEED_UPTIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CIRCLAUNCH_NEED_UPTIME&#160;&#160;&#160;(1&lt;&lt;1)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag to set when a circuit needs to be built of high-uptime nodes </p>

</div>
</div>
<a id="a883f4d0010de416beabf5a3e2efd2bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a883f4d0010de416beabf5a3e2efd2bc5">&#9670;&nbsp;</a></span>CIRCLAUNCH_ONEHOP_TUNNEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CIRCLAUNCH_ONEHOP_TUNNEL&#160;&#160;&#160;(1&lt;&lt;0)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag to set when a circuit should have only a single hop. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0bd87fd29ee842fc8518b17c9f7cb9ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bd87fd29ee842fc8518b17c9f7cb9ac">&#9670;&nbsp;</a></span>circuit_build_failed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_build_failed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called whenever a circuit could not be successfully built. </p>

</div>
</div>
<a id="a882afdac4876448ae1b5eda08db9a66f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a882afdac4876448ae1b5eda08db9a66f">&#9670;&nbsp;</a></span>circuit_build_needed_circs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_build_needed_circs </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is called once a second, if router_have_min_dir_info() is true. Its job is to make sure all services we offer have enough circuits available. Some services just want enough circuits for current tasks, whereas others want a minimum set of idle circuits hanging around. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_a882afdac4876448ae1b5eda08db9a66f_cgraph.png" border="0" usemap="#circuituse_8h_a882afdac4876448ae1b5eda08db9a66f_cgraph" alt=""/></div>
<map name="circuituse_8h_a882afdac4876448ae1b5eda08db9a66f_cgraph" id="circuituse_8h_a882afdac4876448ae1b5eda08db9a66f_cgraph">
<area shape="rect" id="node2" href="nodelist_8c.html#a95765599d022a89bdb2a851e1ad2ec21" title="router_have_consensus_path" alt="" coords="193,13,385,39"/>
</map>
</div>

</div>
</div>
<a id="a407966b13bb02eb365910ea9f07e08be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a407966b13bb02eb365910ea9f07e08be">&#9670;&nbsp;</a></span>circuit_change_purpose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_change_purpose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcircuit__t.html">circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>new_purpose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Change <b>circ</b>'s purpose to <b>new_purpose</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_a407966b13bb02eb365910ea9f07e08be_cgraph.png" border="0" usemap="#circuituse_8h_a407966b13bb02eb365910ea9f07e08be_cgraph" alt=""/></div>
<map name="circuituse_8h_a407966b13bb02eb365910ea9f07e08be_cgraph" id="circuituse_8h_a407966b13bb02eb365910ea9f07e08be_cgraph">
<area shape="rect" id="node2" href="circuitlist_8c.html#a6c79060856f98208dbdbf81c4f5ed336" title="circuit_purpose_to\l_string" alt="" coords="212,5,340,47"/>
<area shape="rect" id="node3" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="388,13,475,39"/>
<area shape="rect" id="node4" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="523,13,617,39"/>
</map>
</div>

</div>
</div>
<a id="a1159f471577ebff888f0133714903fb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1159f471577ebff888f0133714903fb2">&#9670;&nbsp;</a></span>circuit_detach_stream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_detach_stream </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcircuit__t.html">circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structedge__connection__t.html">edge_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If the stream <b>conn</b> is a member of any of the linked lists of <b>circ</b>, then remove it from the list. </p>

</div>
</div>
<a id="ac6c1a2c715351d85ef6747ca1a4db958"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6c1a2c715351d85ef6747ca1a4db958">&#9670;&nbsp;</a></span>circuit_enough_testing_circs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_enough_testing_circs </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return 1 if we've already exercised our bandwidth, or if we have fewer than NUM_PARALLEL_TESTING_CIRCS testing circuits established or on the way. Else return 0. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_ac6c1a2c715351d85ef6747ca1a4db958_icgraph.png" border="0" usemap="#circuituse_8h_ac6c1a2c715351d85ef6747ca1a4db958_icgraph" alt=""/></div>
<map name="circuituse_8h_ac6c1a2c715351d85ef6747ca1a4db958_icgraph" id="circuituse_8h_ac6c1a2c715351d85ef6747ca1a4db958_icgraph">
<area shape="rect" id="node2" href="rephist_8h.html#a890009e83c2e90292a435526b8111727" title="rep_hist_circbuilding\l_dormant" alt="" coords="205,27,345,68"/>
<area shape="rect" id="node3" href="dirserv_8h.html#a2c5edbbd6883a33af3d72bfead4033db" title="directory_too_idle\l_to_fetch_descriptors" alt="" coords="393,27,540,68"/>
<area shape="rect" id="node4" href="main_8h.html#ac64189cc036980dc5785f76d85db9fa6" title="directory_info_has\l_arrived" alt="" coords="1245,5,1373,47"/>
<area shape="rect" id="node5" href="microdesc_8h.html#aad7f413d899b72e58bed8efc0162d8bd" title="update_microdesc_downloads" alt="" coords="807,34,1004,61"/>
<area shape="rect" id="node7" href="routerlist_8h.html#a1a7cfda729e27cf26089db2112d21965" title="update_consensus_router\l_descriptor_downloads" alt="" coords="588,85,759,127"/>
<area shape="rect" id="node6" href="routerlist_8h.html#afe7f2c6bcc3135272bc6aa66ec09cd76" title="update_all_descriptor\l_downloads" alt="" coords="1052,35,1197,76"/>
<area shape="rect" id="node8" href="routerlist_8h.html#a8b67f737b9ea614297414b26eb3b784c" title="update_router_descriptor\l_downloads" alt="" coords="823,85,988,127"/>
</map>
</div>

</div>
</div>
<a id="a857005b7512302feee182107aed11121"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a857005b7512302feee182107aed11121">&#9670;&nbsp;</a></span>circuit_expire_building()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_expire_building </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Close all circuits that start at us, aren't open, and were born at least CircuitBuildTimeout seconds ago. </p>
<p>Because circuit build timeout is calculated only based on 3 hop general purpose circuit construction, we need to scale the timeout to make it properly apply to longer circuits, and circuits of certain usage types. The following diagram illustrates how we derive the scaling below. In short, we calculate the number of times our telescoping-based circuit construction causes cells to traverse each link for the circuit purpose types in question, and then assume each link is equivalent.</p>
<p>OP &ndash;a&ndash;&gt; A &ndash;b&ndash;&gt; B &ndash;c&ndash;&gt; C OP &ndash;a&ndash;&gt; A &ndash;b&ndash;&gt; B &ndash;c&ndash;&gt; C &ndash;d&ndash;&gt; D</p>
<p>Let h = a = b = c = d</p>
<p>Three hops (general_cutoff) RTTs = 3a + 2b + c RTTs = 6h Cannibalized: RTTs = a+b+c+d RTTs = 4h Four hops: RTTs = 4a + 3b + 2c + d RTTs = 10h Client INTRODUCE1+ACK: // XXX: correct? RTTs = 5a + 4b + 3c + 2d RTTs = 14h Server intro: RTTs = 4a + 3b + 2c RTTs = 9h</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_a857005b7512302feee182107aed11121_cgraph.png" border="0" usemap="#circuituse_8h_a857005b7512302feee182107aed11121_cgraph" alt=""/></div>
<map name="circuituse_8h_a857005b7512302feee182107aed11121_cgraph" id="circuituse_8h_a857005b7512302feee182107aed11121_cgraph">
<area shape="rect" id="node2" href="compat__time_8c.html#a44ef505a26821a6ac00802efbdda9531" title="tor_gettimeofday" alt="" coords="204,5,323,32"/>
</map>
</div>

</div>
</div>
<a id="a5474432e0dd7549eb766af37bebb37ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5474432e0dd7549eb766af37bebb37ed">&#9670;&nbsp;</a></span>circuit_expire_old_circs_as_needed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_expire_old_circs_as_needed </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called once a second either directly or from <a class="el" href="circuituse_8c.html#a882afdac4876448ae1b5eda08db9a66f">circuit_build_needed_circs()</a>. As appropriate (once per NewCircuitPeriod) resets failure counts and expires old circuits. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_a5474432e0dd7549eb766af37bebb37ed_cgraph.png" border="0" usemap="#circuituse_8h_a5474432e0dd7549eb766af37bebb37ed_cgraph" alt=""/></div>
<map name="circuituse_8h_a5474432e0dd7549eb766af37bebb37ed_cgraph" id="circuituse_8h_a5474432e0dd7549eb766af37bebb37ed_cgraph">
<area shape="rect" id="node2" href="circuituse_8c.html#a8f03827edb583ab1e727def243a42be1" title="circuit_reset_failure\l_count" alt="" coords="180,5,315,47"/>
<area shape="rect" id="node3" href="router_8c.html#aaa263ba55448946fedc8475b3d9b34b8" title="proxy_mode" alt="" coords="201,71,294,98"/>
<area shape="rect" id="node4" href="addressmap_8c.html#a72c5cdc19a414853d92897aefdc95b66" title="addressmap_clean" alt="" coords="182,122,313,149"/>
<area shape="rect" id="node5" href="addressmap_8c.html#a578c622b1ec403e3029606d35a80b261" title="addressmap_get_mappings" alt="" coords="363,122,544,149"/>
</map>
</div>

</div>
</div>
<a id="a10961db035e74aaaf4791c7606873ce6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10961db035e74aaaf4791c7606873ce6">&#9670;&nbsp;</a></span>circuit_expire_old_circuits_serverside()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_expire_old_circuits_serverside </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find each non-origin circuit that has been unused for too long, has no streams on it, used a create_fast, and ends here: mark it for close. </p>

</div>
</div>
<a id="a78a23775279a45daabbdc354310a9e1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78a23775279a45daabbdc354310a9e1f">&#9670;&nbsp;</a></span>circuit_has_opened()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_has_opened </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The circuit <b>circ</b> has just become open. Take the next step: for rendezvous circuits, we pass circ to the appropriate function in rendclient or rendservice. For general circuits, we call connection_ap_attach_pending, which looks for pending streams that could use circ. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_a78a23775279a45daabbdc354310a9e1f_cgraph.png" border="0" usemap="#circuituse_8h_a78a23775279a45daabbdc354310a9e1f_cgraph" alt=""/></div>
<map name="circuituse_8h_a78a23775279a45daabbdc354310a9e1f_cgraph" id="circuituse_8h_a78a23775279a45daabbdc354310a9e1f_cgraph">
<area shape="rect" id="node2" href="control_8c.html#a5fcccb8799c3633567989fd4560cf8a3" title="control_event_circuit\l_status" alt="" coords="188,5,331,47"/>
</map>
</div>

</div>
</div>
<a id="a18a1d7e9015582c550d0d3eb7710efc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18a1d7e9015582c550d0d3eb7710efc9">&#9670;&nbsp;</a></span>circuit_launch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a>* circuit_launch </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Launch a new circuit; see <a class="el" href="circuituse_8c.html#aca38c91870b66d7a0e495f2cd775e403">circuit_launch_by_extend_info()</a> for details on arguments. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_a18a1d7e9015582c550d0d3eb7710efc9_cgraph.png" border="0" usemap="#circuituse_8h_a18a1d7e9015582c550d0d3eb7710efc9_cgraph" alt=""/></div>
<map name="circuituse_8h_a18a1d7e9015582c550d0d3eb7710efc9_cgraph" id="circuituse_8h_a18a1d7e9015582c550d0d3eb7710efc9_cgraph">
<area shape="rect" id="node2" href="circuituse_8c.html#aca38c91870b66d7a0e495f2cd775e403" title="circuit_launch_by_extend_info" alt="" coords="156,5,353,32"/>
</map>
</div>

</div>
</div>
<a id="a5ed466f41f7080d1c94d2394e55901ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ed466f41f7080d1c94d2394e55901ff">&#9670;&nbsp;</a></span>circuit_launch_by_extend_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a>* circuit_launch_by_extend_info </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>purpose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structextend__info__t.html">extend_info_t</a> *&#160;</td>
          <td class="paramname"><em>extend_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Launch a new circuit with purpose <b>purpose</b> and exit node <b>extend_info</b> (or NULL to select a random exit node). If flags contains CIRCLAUNCH_NEED_UPTIME, choose among routers with high uptime. If CIRCLAUNCH_NEED_CAPACITY is set, choose among routers with high bandwidth. If CIRCLAUNCH_IS_INTERNAL is true, the last hop need not be an exit node. If CIRCLAUNCH_ONEHOP_TUNNEL is set, the circuit will have only one hop. Return the newly allocated circuit on success, or NULL on failure. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_a5ed466f41f7080d1c94d2394e55901ff_icgraph.png" border="0" usemap="#circuituse_8h_a5ed466f41f7080d1c94d2394e55901ff_icgraph" alt=""/></div>
<map name="circuituse_8h_a5ed466f41f7080d1c94d2394e55901ff_icgraph" id="circuituse_8h_a5ed466f41f7080d1c94d2394e55901ff_icgraph">
<area shape="rect" id="node2" href="circuituse_8h.html#a18a1d7e9015582c550d0d3eb7710efc9" title="circuit_launch" alt="" coords="251,5,353,32"/>
</map>
</div>

</div>
</div>
<a id="a31768fdff079617503ff37e96181c8d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31768fdff079617503ff37e96181c8d4">&#9670;&nbsp;</a></span>circuit_log_ancient_one_hop_circuits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_log_ancient_one_hop_circuits </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>age</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As a diagnostic for bug 8387, log information about how many one-hop circuits we have around that have been there for at least <b>age</b> seconds. Log a few of them. Ignores Single Onion Service intro and Tor2web redezvous circuits, they are expected to be long-term one-hop circuits. </p>

</div>
</div>
<a id="ac0941a9dc5da7825f107d1d4bf028063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0941a9dc5da7825f107d1d4bf028063">&#9670;&nbsp;</a></span>circuit_remove_handled_ports()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_remove_handled_ports </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>needed_ports</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove any elements in <b>needed_ports</b> that are handled by an open or in-progress circuit. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_ac0941a9dc5da7825f107d1d4bf028063_cgraph.png" border="0" usemap="#circuituse_8h_ac0941a9dc5da7825f107d1d4bf028063_cgraph" alt=""/></div>
<map name="circuituse_8h_ac0941a9dc5da7825f107d1d4bf028063_cgraph" id="circuituse_8h_ac0941a9dc5da7825f107d1d4bf028063_cgraph">
<area shape="rect" id="node2" href="circuituse_8c.html#aa9c9e6111de126ec1c3ca4dd17f4091c" title="circuit_stream_is_being\l_handled" alt="" coords="212,27,371,69"/>
<area shape="rect" id="node7" href="container_8c.html#ae56cc8eb3ee68132c63168b2485037cb" title="smartlist_del" alt="" coords="243,93,339,120"/>
<area shape="rect" id="node3" href="container_8c.html#a9060e1f019093c294f1a076b6f0226da" title="smartlist_contains\l_int_as_string" alt="" coords="419,27,547,69"/>
<area shape="rect" id="node4" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="615,5,702,32"/>
<area shape="rect" id="node6" href="container_8c.html#ac33bb0aa376a138f6ca81d6e8ea25e60" title="smartlist_contains\l_string" alt="" coords="595,57,723,98"/>
<area shape="rect" id="node5" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="771,5,865,32"/>
</map>
</div>

</div>
</div>
<a id="a8f03827edb583ab1e727def243a42be1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f03827edb583ab1e727def243a42be1">&#9670;&nbsp;</a></span>circuit_reset_failure_count()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_reset_failure_count </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reset the failure count for opening general circuits. This means we will try MAX_CIRCUIT_FAILURES times more (if necessary) before stopping again. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_a8f03827edb583ab1e727def243a42be1_icgraph.png" border="0" usemap="#circuituse_8h_a8f03827edb583ab1e727def243a42be1_icgraph" alt=""/></div>
<map name="circuituse_8h_a8f03827edb583ab1e727def243a42be1_icgraph" id="circuituse_8h_a8f03827edb583ab1e727def243a42be1_icgraph">
<area shape="rect" id="node2" href="circuituse_8h.html#a5474432e0dd7549eb766af37bebb37ed" title="circuit_expire_old\l_circs_as_needed" alt="" coords="188,5,315,47"/>
</map>
</div>

</div>
</div>
<a id="aa9c9e6111de126ec1c3ca4dd17f4091c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9c9e6111de126ec1c3ca4dd17f4091c">&#9670;&nbsp;</a></span>circuit_stream_is_being_handled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circuit_stream_is_being_handled </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structentry__connection__t.html">entry_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>min</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return 1 if at least <b>min</b> general-purpose non-internal circuits will have an acceptable exit node for exit stream <b>conn</b> if it is defined, else for "*:port". Else return 0. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_aa9c9e6111de126ec1c3ca4dd17f4091c_cgraph.png" border="0" usemap="#circuituse_8h_aa9c9e6111de126ec1c3ca4dd17f4091c_cgraph" alt=""/></div>
<map name="circuituse_8h_aa9c9e6111de126ec1c3ca4dd17f4091c_cgraph" id="circuituse_8h_aa9c9e6111de126ec1c3ca4dd17f4091c_cgraph">
<area shape="rect" id="node2" href="container_8c.html#a9060e1f019093c294f1a076b6f0226da" title="smartlist_contains\l_int_as_string" alt="" coords="212,27,340,69"/>
<area shape="rect" id="node3" href="compat_8c.html#af032ac661214ae28b4f205781a515290" title="tor_snprintf" alt="" coords="409,5,495,32"/>
<area shape="rect" id="node5" href="container_8c.html#ac33bb0aa376a138f6ca81d6e8ea25e60" title="smartlist_contains\l_string" alt="" coords="388,57,516,98"/>
<area shape="rect" id="node4" href="compat_8c.html#a1df7873b16ae8936d25dfedb706f4ea6" title="tor_vsnprintf" alt="" coords="564,5,659,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_aa9c9e6111de126ec1c3ca4dd17f4091c_icgraph.png" border="0" usemap="#circuituse_8h_aa9c9e6111de126ec1c3ca4dd17f4091c_icgraph" alt=""/></div>
<map name="circuituse_8h_aa9c9e6111de126ec1c3ca4dd17f4091c_icgraph" id="circuituse_8h_aa9c9e6111de126ec1c3ca4dd17f4091c_icgraph">
<area shape="rect" id="node2" href="circuituse_8h.html#ac0941a9dc5da7825f107d1d4bf028063" title="circuit_remove_handled\l_ports" alt="" coords="212,5,371,47"/>
</map>
</div>

</div>
</div>
<a id="af4abb529971723bed7226e327b8326c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4abb529971723bed7226e327b8326c3">&#9670;&nbsp;</a></span>circuit_try_attaching_streams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void circuit_try_attaching_streams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when a circuit becomes ready for streams to be attached to it. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_af4abb529971723bed7226e327b8326c3_cgraph.png" border="0" usemap="#circuituse_8h_af4abb529971723bed7226e327b8326c3_cgraph" alt=""/></div>
<map name="circuituse_8h_af4abb529971723bed7226e327b8326c3_cgraph" id="circuituse_8h_af4abb529971723bed7226e327b8326c3_cgraph">
<area shape="rect" id="node2" href="connection__edge_8c.html#ab5ca7733ddbd1bd01ea51010bf0b792a" title="connection_ap_attach\l_pending" alt="" coords="192,5,341,47"/>
</map>
</div>

</div>
</div>
<a id="aa95a48009b429befccf14ebce9d13a97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa95a48009b429befccf14ebce9d13a97">&#9670;&nbsp;</a></span>connection_ap_handshake_attach_chosen_circuit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_ap_handshake_attach_chosen_circuit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structentry__connection__t.html">entry_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypt__path__t.html">crypt_path_t</a> *&#160;</td>
          <td class="paramname"><em>cpath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempt to attach the connection <b>conn</b> to <b>circ</b>, and send a begin or resolve cell as appropriate. Return values are as for connection_ap_handshake_attach_circuit. The stream will exit from the hop indicated by <b>cpath</b>, or from the last hop in circ's cpath if <b>cpath</b> is NULL. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_aa95a48009b429befccf14ebce9d13a97_cgraph.png" border="0" usemap="#circuituse_8h_aa95a48009b429befccf14ebce9d13a97_cgraph" alt=""/></div>
<map name="circuituse_8h_aa95a48009b429befccf14ebce9d13a97_cgraph" id="circuituse_8h_aa95a48009b429befccf14ebce9d13a97_cgraph">
<area shape="rect" id="node2" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="252,5,345,32"/>
<area shape="rect" id="node3" href="circpathbias_8c.html#a04c00e2d517558281c27352537222639" title="pathbias_count_use\l_attempt" alt="" coords="229,57,368,98"/>
</map>
</div>

</div>
</div>
<a id="a8d5c81bf7d6238331123b1e8753597f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d5c81bf7d6238331123b1e8753597f1">&#9670;&nbsp;</a></span>connection_ap_handshake_attach_circuit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_ap_handshake_attach_circuit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structentry__connection__t.html">entry_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Try to find a safe live circuit for CONN_TYPE_AP connection conn. If we don't find one: if conn cannot be handled by any known nodes, warn and return -1 (conn needs to die, and is maybe already marked); else launch new circuit (if necessary) and return 0. Otherwise, associate conn with a safe live circuit, do the right next step, and return 1. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_a8d5c81bf7d6238331123b1e8753597f1_cgraph.png" border="0" usemap="#circuituse_8h_a8d5c81bf7d6238331123b1e8753597f1_cgraph" alt=""/></div>
<map name="circuituse_8h_a8d5c81bf7d6238331123b1e8753597f1_cgraph" id="circuituse_8h_a8d5c81bf7d6238331123b1e8753597f1_cgraph">
<area shape="rect" id="node2" href="address_8c.html#a6ecc12236743caf7527376436791c75e" title="tor_addr_is_null" alt="" coords="244,5,357,32"/>
<area shape="rect" id="node3" href="config_8c.html#a7e31046631b0cc0f5d01c8d411b886e6" title="safe_str_client" alt="" coords="247,56,354,83"/>
<area shape="rect" id="node4" href="connection__edge_8c.html#accf4787c953075c4a9aeaab09bb2b3fe" title="connection_edge_is\l_rendezvous_stream" alt="" coords="229,107,372,149"/>
</map>
</div>

</div>
</div>
<a id="a6552c3467492a702a37f75ffd9a7676b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6552c3467492a702a37f75ffd9a7676b">&#9670;&nbsp;</a></span>hostname_in_track_host_exits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hostname_in_track_host_exits </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff <b>address</b> is matched by one of the entries in TrackHostExits. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_a6552c3467492a702a37f75ffd9a7676b_cgraph.png" border="0" usemap="#circuituse_8h_a6552c3467492a702a37f75ffd9a7676b_cgraph" alt=""/></div>
<map name="circuituse_8h_a6552c3467492a702a37f75ffd9a7676b_cgraph" id="circuituse_8h_a6552c3467492a702a37f75ffd9a7676b_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a595e5e722adc3f46c2d27bced61a8a18" title="strcasecmpend" alt="" coords="217,13,328,39"/>
</map>
</div>

</div>
</div>
<a id="adf36645f7a473ad622918668f2f5ba33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf36645f7a473ad622918668f2f5ba33">&#9670;&nbsp;</a></span>mark_circuit_unusable_for_new_conns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mark_circuit_unusable_for_new_conns </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mark <b>circ</b> so that no more connections can be attached to it. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_adf36645f7a473ad622918668f2f5ba33_cgraph.png" border="0" usemap="#circuituse_8h_adf36645f7a473ad622918668f2f5ba33_cgraph" alt=""/></div>
<map name="circuituse_8h_adf36645f7a473ad622918668f2f5ba33_cgraph" id="circuituse_8h_adf36645f7a473ad622918668f2f5ba33_cgraph">
<area shape="rect" id="node2" href="util_8c.html#aca03d8cb6a22d540b13b92ea5945df33" title="approx_time" alt="" coords="205,13,299,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="circuituse_8h_adf36645f7a473ad622918668f2f5ba33_icgraph.png" border="0" usemap="#circuituse_8h_adf36645f7a473ad622918668f2f5ba33_icgraph" alt=""/></div>
<map name="circuituse_8h_adf36645f7a473ad622918668f2f5ba33_icgraph" id="circuituse_8h_adf36645f7a473ad622918668f2f5ba33_icgraph">
<area shape="rect" id="node2" href="circuitlist_8h.html#a52c4991dce45efd8d927b6092e3c85be" title="circuit_mark_all_dirty\l_circs_as_unusable" alt="" coords="205,5,351,47"/>
<area shape="rect" id="node3" href="circuitbuild_8h.html#a9850a0ba60e6a62bc0a7267343418235" title="circuit_note_clock\l_jumped" alt="" coords="399,5,525,47"/>
</map>
</div>

</div>
</div>
<a id="a62c92926e67f1674290aff0d08bac948"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62c92926e67f1674290aff0d08bac948">&#9670;&nbsp;</a></span>reset_bandwidth_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reset_bandwidth_test </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reset have_performed_bandwidth_test, so we'll start building testing circuits again so we can exercise our bandwidth. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
