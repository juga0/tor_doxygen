<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/rendservice.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">rendservice.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The hidden-service side of rendezvous functionality.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;circpathbias.h&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitbuild_8h_source.html">circuitbuild.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitlist_8h_source.html">circuitlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuituse_8h_source.html">circuituse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="control_8h_source.html">control.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__rand_8h_source.html">crypto_rand.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__util_8h_source.html">crypto_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="directory_8h_source.html">directory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hs__common_8h_source.html">hs_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hs__config_8h_source.html">hs_config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="main_8h_source.html">main.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="networkstatus_8h_source.html">networkstatus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nodelist_8h_source.html">nodelist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="policies_8h_source.html">policies.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendclient_8h_source.html">rendclient.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendcommon_8h_source.html">rendcommon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendservice_8h_source.html">rendservice.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="router_8h_source.html">router.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="relay_8h_source.html">relay.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rephist_8h_source.html">rephist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="replaycache_8h_source.html">replaycache.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerlist_8h_source.html">routerlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerparse_8h_source.html">routerparse.h</a>&quot;</code><br />
<code>#include &quot;routerset.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for rendservice.c:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2rendservice_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2rendservice_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2rendservice_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="855,333,899,360"/>
<area shape="rect" id="node19" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="70,408,173,435"/>
<area shape="rect" id="node24" href="circpathbias_8h_source.html" title="circpathbias.h" alt="" coords="337,109,439,136"/>
<area shape="rect" id="node25" href="circuitbuild_8h.html" title="Header file for circuitbuild.c. " alt="" coords="463,109,558,136"/>
<area shape="rect" id="node26" href="circuitlist_8h.html" title="Header file for circuitlist.c. " alt="" coords="1353,109,1439,136"/>
<area shape="rect" id="node28" href="hs__common_8h.html" title="Header file containing common data for the whole HS subsytem. " alt="" coords="1047,259,1151,285"/>
<area shape="rect" id="node30" href="circuituse_8h.html" title="Header file for circuituse.c. " alt="" coords="685,109,774,136"/>
<area shape="rect" id="node31" href="config_8h.html" title="Header file for config.c. " alt="" coords="1979,184,2047,211"/>
<area shape="rect" id="node32" href="control_8h.html" title="Header file for control.c. " alt="" coords="849,109,921,136"/>
<area shape="rect" id="node33" href="crypto__rand_8h.html" title="Common functions for using (pseudo&#45;)random number generators. " alt="" coords="233,483,335,509"/>
<area shape="rect" id="node34" href="crypto__util_8h.html" title="Common functions for cryptographic routines. " alt="" coords="356,259,449,285"/>
<area shape="rect" id="node35" href="directory_8h.html" title="Header file for directory.c. " alt="" coords="1161,109,1244,136"/>
<area shape="rect" id="node36" href="hs__config_8h.html" title="Header file containing configuration ABI/API for the HS subsytem. " alt="" coords="775,184,865,211"/>
<area shape="rect" id="node37" href="main_8h.html" title="Header file for main.c. " alt="" coords="1268,109,1329,136"/>
<area shape="rect" id="node38" href="networkstatus_8h.html" title="Header file for networkstatus.c. " alt="" coords="1659,259,1773,285"/>
<area shape="rect" id="node39" href="nodelist_8h.html" title="Header file for nodelist.c. " alt="" coords="1463,109,1542,136"/>
<area shape="rect" id="node40" href="policies_8h.html" title="Header file for policies.c. " alt="" coords="1567,109,1644,136"/>
<area shape="rect" id="node41" href="rendclient_8h.html" title="Header file for rendclient.c. " alt="" coords="1047,109,1137,136"/>
<area shape="rect" id="node43" href="rendcommon_8h.html" title="Header file for rendcommon.c. " alt="" coords="1475,259,1583,285"/>
<area shape="rect" id="node44" href="rendservice_8h.html" title="Header file for rendservice.c. " alt="" coords="678,259,778,285"/>
<area shape="rect" id="node45" href="router_8h.html" title="Header file for router.c. " alt="" coords="1753,333,1820,360"/>
<area shape="rect" id="node46" href="relay_8h.html" title="Header file for relay.c. " alt="" coords="1871,109,1932,136"/>
<area shape="rect" id="node47" href="rephist_8h.html" title="Header file for rephist.c. " alt="" coords="1956,109,2028,136"/>
<area shape="rect" id="node48" href="routerlist_8h.html" title="Header file for routerlist.c. " alt="" coords="1820,184,1903,211"/>
<area shape="rect" id="node49" href="routerparse_8h.html" title="Header file for routerparse.c. " alt="" coords="2103,109,2201,136"/>
<area shape="rect" id="node50" href="routerset_8h_source.html" title="routerset.h" alt="" coords="2226,109,2310,136"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="562,707,641,733"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="622,632,685,659"/>
<area shape="rect" id="node5" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="521,483,591,509"/>
<area shape="rect" id="node8" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="906,408,1019,435"/>
<area shape="rect" id="node9" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="887,483,1012,509"/>
<area shape="rect" id="node10" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="869,557,1011,584"/>
<area shape="rect" id="node11" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="1469,483,1531,509"/>
<area shape="rect" id="node12" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1555,483,1621,509"/>
<area shape="rect" id="node13" href="container_8h_source.html" title="container.h" alt="" coords="410,483,497,509"/>
<area shape="rect" id="node14" href="compress_8h.html" title="Headers for compress.c. " alt="" coords="403,408,493,435"/>
<area shape="rect" id="node15" href="address_8h.html" title="Headers for address.h. " alt="" coords="687,408,766,435"/>
<area shape="rect" id="node16" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="1392,557,1520,584"/>
<area shape="rect" id="node17" href="ht_8h_source.html" title="ht.h" alt="" coords="619,408,663,435"/>
<area shape="rect" id="node18" href="confline_8h_source.html" title="confline.h" alt="" coords="249,408,327,435"/>
<area shape="rect" id="node20" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="791,408,881,435"/>
<area shape="rect" id="node21" href="token__bucket_8h_source.html" title="token_bucket.h" alt="" coords="1257,557,1367,584"/>
<area shape="rect" id="node22" href="util__format_8h_source.html" title="util_format.h" alt="" coords="1138,557,1233,584"/>
<area shape="rect" id="node23" href="hs__circuitmap_8h.html" title="Header file for hs_circuitmap.c. " alt="" coords="1095,408,1209,435"/>
<area shape="rect" id="node6" href="util_8h.html" title="Headers for util.c. " alt="" coords="489,557,540,584"/>
<area shape="rect" id="node7" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="1457,632,1556,659"/>
<area shape="rect" id="node27" href="hs__ident_8h.html" title="Header file containing circuit and connection identifier data for the whole HS subsytem. " alt="" coords="1260,184,1343,211"/>
<area shape="rect" id="node29" href="ed25519__cert_8h_source.html" title="ed25519_cert.h" alt="" coords="1043,333,1154,360"/>
<area shape="rect" id="node42" href="rendcache_8h.html" title="Header file for rendcache.c. " alt="" coords="1047,184,1140,211"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3954ca70bdb4718adf2ebdcf319ba096"><td class="memItemLeft" align="right" valign="top"><a id="a3954ca70bdb4718adf2ebdcf319ba096"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RENDSERVICE_PRIVATE</b></td></tr>
<tr class="separator:a3954ca70bdb4718adf2ebdcf319ba096"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad33b5d06bdd918433816cf02a2654499"><td class="memItemLeft" align="right" valign="top"><a id="ad33b5d06bdd918433816cf02a2654499"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>INTRO_CIRC_RETRY_PERIOD_SLOP</b>&#160;&#160;&#160;10</td></tr>
<tr class="separator:ad33b5d06bdd918433816cf02a2654499"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a763d9d0b393051ba265a988c00453539"><td class="memItemLeft" align="right" valign="top"><a id="a763d9d0b393051ba265a988c00453539"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIN_REND_INITIAL_POST_DELAY</b>&#160;&#160;&#160;(30)</td></tr>
<tr class="separator:a763d9d0b393051ba265a988c00453539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07383cdb3035f428054285e3fccb5396"><td class="memItemLeft" align="right" valign="top"><a id="a07383cdb3035f428054285e3fccb5396"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIN_REND_INITIAL_POST_DELAY_TESTING</b>&#160;&#160;&#160;(5)</td></tr>
<tr class="separator:a07383cdb3035f428054285e3fccb5396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acc260fb34e6212cf4678ca061bd450"><td class="memItemLeft" align="right" valign="top"><a id="a3acc260fb34e6212cf4678ca061bd450"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_STREAM_WARN_INTERVAL</b>&#160;&#160;&#160;600</td></tr>
<tr class="separator:a3acc260fb34e6212cf4678ca061bd450"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7077632dbb2b5b387c664c6d7fdd4db0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a7077632dbb2b5b387c664c6d7fdd4db0">rend_num_services</a> (void)</td></tr>
<tr class="separator:a7077632dbb2b5b387c664c6d7fdd4db0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28b97923c2477096e6c63d6b2c3ff057"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a28b97923c2477096e6c63d6b2c3ff057">rend_authorized_client_free_</a> (<a class="el" href="structrend__authorized__client__t.html">rend_authorized_client_t</a> *client)</td></tr>
<tr class="separator:a28b97923c2477096e6c63d6b2c3ff057"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c38e8a5780c6512244f0c93a2f9f169"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a7c38e8a5780c6512244f0c93a2f9f169">rend_service_free_</a> (rend_service_t *service)</td></tr>
<tr class="separator:a7c38e8a5780c6512244f0c93a2f9f169"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a450571006504b980626855b4eb67b5df"><td class="memItemLeft" align="right" valign="top"><a id="a450571006504b980626855b4eb67b5df"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_free_staging_list</b> (void)</td></tr>
<tr class="separator:a450571006504b980626855b4eb67b5df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade90973329e24160017a04e0503397bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ade90973329e24160017a04e0503397bd">rend_service_free_all</a> (void)</td></tr>
<tr class="separator:ade90973329e24160017a04e0503397bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cc13d62a007f68f7dc065f5b0eaaf5d"><td class="memItemLeft" align="right" valign="top"><a id="a0cc13d62a007f68f7dc065f5b0eaaf5d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_init</b> (void)</td></tr>
<tr class="separator:a0cc13d62a007f68f7dc065f5b0eaaf5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1afe7b7400e5a9774ed1b43b7c60c51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrend__service__port__config__t.html">rend_service_port_config_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#af1afe7b7400e5a9774ed1b43b7c60c51">rend_service_parse_port_config</a> (const char *string, const char *sep, char **err_msg_out)</td></tr>
<tr class="separator:af1afe7b7400e5a9774ed1b43b7c60c51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa95b57d67357abc95a0d856c454d1d02"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#aa95b57d67357abc95a0d856c454d1d02">rend_service_port_config_free_</a> (<a class="el" href="structrend__service__port__config__t.html">rend_service_port_config_t</a> *p)</td></tr>
<tr class="separator:aa95b57d67357abc95a0d856c454d1d02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa52e7a9e7b547152f477e331250889c1"><td class="memItemLeft" align="right" valign="top"><a id="aa52e7a9e7b547152f477e331250889c1"></a>
STATIC void&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_prune_list_impl_</b> (void)</td></tr>
<tr class="separator:aa52e7a9e7b547152f477e331250889c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa56737a7e6364a33631a4a1e0496d7c"><td class="memItemLeft" align="right" valign="top"><a id="afa56737a7e6364a33631a4a1e0496d7c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_prune_list</b> (void)</td></tr>
<tr class="separator:afa56737a7e6364a33631a4a1e0496d7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd2c49052f802dd0e0259d42f5d04b13"><td class="memItemLeft" align="right" valign="top"><a id="afd2c49052f802dd0e0259d42f5d04b13"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>rend_config_service</b> (const <a class="el" href="structconfig__line__t.html">config_line_t</a> *line_, const <a class="el" href="structor__options__t.html">or_options_t</a> *options, <a class="el" href="strucths__service__config__t.html">hs_service_config_t</a> *config)</td></tr>
<tr class="separator:afd2c49052f802dd0e0259d42f5d04b13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc5e6a4ecf624b494840048295651d03"><td class="memItemLeft" align="right" valign="top"><a class="el" href="hs__common_8h.html#a375d3b5c44c65ad158e30b8f05d74b3b">hs_service_add_ephemeral_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#abc5e6a4ecf624b494840048295651d03">rend_service_add_ephemeral</a> (<a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *pk, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *ports, int max_streams_per_circuit, int max_streams_close_circuit, <a class="el" href="or_8h.html#aafc6920f8a16e10f46703e7819795c74">rend_auth_type_t</a> auth_type, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *auth_clients, char **service_id_out)</td></tr>
<tr class="separator:abc5e6a4ecf624b494840048295651d03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9adfef842de9b8aec233a9046b9faeb2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a9adfef842de9b8aec233a9046b9faeb2">rend_service_del_ephemeral</a> (const char *service_id)</td></tr>
<tr class="separator:a9adfef842de9b8aec233a9046b9faeb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08b3ad283d04bc455030d50e0bcbe49e"><td class="memItemLeft" align="right" valign="top"><a id="a08b3ad283d04bc455030d50e0bcbe49e"></a>
STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_sos_poison_path</b> (const rend_service_t *service)</td></tr>
<tr class="separator:a08b3ad283d04bc455030d50e0bcbe49e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2925d59d4cd16a1b1f5b0ffc9e23ab7b"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a2925d59d4cd16a1b1f5b0ffc9e23ab7b">rend_service_verify_single_onion_poison</a> (const rend_service_t *s, const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:a2925d59d4cd16a1b1f5b0ffc9e23ab7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5402d8d70dfb781694cb76d390beec0"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ac5402d8d70dfb781694cb76d390beec0">rend_service_poison_new_single_onion_dir</a> (const rend_service_t *s, const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:ac5402d8d70dfb781694cb76d390beec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b9ee2cd47bd85d48fd2ef88dcc93334"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a7b9ee2cd47bd85d48fd2ef88dcc93334">rend_service_load_all_keys</a> (const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *service_list)</td></tr>
<tr class="separator:a7b9ee2cd47bd85d48fd2ef88dcc93334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cbc34ae661d9ebfa9dae965021661ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a5cbc34ae661d9ebfa9dae965021661ef">rend_services_add_filenames_to_lists</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *open_lst, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *stat_lst)</td></tr>
<tr class="separator:a5cbc34ae661d9ebfa9dae965021661ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a060371417948bb0cc60be0840ed451"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a6a060371417948bb0cc60be0840ed451">rend_service_receive_introduction</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circuit, const uint8_t *request, size_t request_len)</td></tr>
<tr class="separator:a6a060371417948bb0cc60be0840ed451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad1ab301edd163bf2d73b732b8482b63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#aad1ab301edd163bf2d73b732b8482b63">rend_service_free_intro_</a> (<a class="el" href="structrend__intro__cell__s.html">rend_intro_cell_t</a> *request)</td></tr>
<tr class="separator:aad1ab301edd163bf2d73b732b8482b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf64fba57452d31d318fcf304b160be9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrend__intro__cell__s.html">rend_intro_cell_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#acf64fba57452d31d318fcf304b160be9">rend_service_begin_parse_intro</a> (const uint8_t *request, size_t request_len, uint8_t type, char **err_msg_out)</td></tr>
<tr class="separator:acf64fba57452d31d318fcf304b160be9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96f99a75046c61a5d1477055b53a776c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a96f99a75046c61a5d1477055b53a776c">rend_service_decrypt_intro</a> (<a class="el" href="structrend__intro__cell__s.html">rend_intro_cell_t</a> *intro, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *key, char **err_msg_out)</td></tr>
<tr class="separator:a96f99a75046c61a5d1477055b53a776c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d9a3e309d3b6ee6683f33f9079b913e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a1d9a3e309d3b6ee6683f33f9079b913e">rend_service_parse_intro_plaintext</a> (<a class="el" href="structrend__intro__cell__s.html">rend_intro_cell_t</a> *intro, char **err_msg_out)</td></tr>
<tr class="separator:a1d9a3e309d3b6ee6683f33f9079b913e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c45ef372f52fd082bc4dc9547ff4c7f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a9c45ef372f52fd082bc4dc9547ff4c7f">rend_service_validate_intro_late</a> (const <a class="el" href="structrend__intro__cell__s.html">rend_intro_cell_t</a> *intro, char **err_msg_out)</td></tr>
<tr class="separator:a9c45ef372f52fd082bc4dc9547ff4c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aaefddc359725fc37dddb646455fee2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a6aaefddc359725fc37dddb646455fee2">rend_service_relaunch_rendezvous</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *oldcirc)</td></tr>
<tr class="separator:a6aaefddc359725fc37dddb646455fee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee519379bafaad1bb05d87df7590040c"><td class="memItemLeft" align="right" valign="top"><a id="aee519379bafaad1bb05d87df7590040c"></a>
ssize_t&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_encode_establish_intro_cell</b> (char *cell_body_out, size_t cell_body_out_len, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *intro_key, const char *rend_circ_nonce)</td></tr>
<tr class="separator:aee519379bafaad1bb05d87df7590040c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa80ac6037ad40cfd37531cc52d11a11f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#aa80ac6037ad40cfd37531cc52d11a11f">rend_service_intro_has_opened</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circuit)</td></tr>
<tr class="separator:aa80ac6037ad40cfd37531cc52d11a11f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac20565d148fc4643343b5bc7e691d7d2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ac20565d148fc4643343b5bc7e691d7d2">rend_service_intro_established</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circuit, const uint8_t *request, size_t request_len)</td></tr>
<tr class="separator:ac20565d148fc4643343b5bc7e691d7d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cfdd77e4e98bf6ea995a2e7224a6e83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a1cfdd77e4e98bf6ea995a2e7224a6e83">rend_service_rendezvous_has_opened</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circuit)</td></tr>
<tr class="separator:a1cfdd77e4e98bf6ea995a2e7224a6e83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab506650aa443a97f3932b3f50652c90d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ab506650aa443a97f3932b3f50652c90d">directory_post_to_hs_dir</a> (<a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> *renddesc, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *descs, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *hs_dirs, const char *service_id, int seconds_valid)</td></tr>
<tr class="separator:ab506650aa443a97f3932b3f50652c90d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997bb861be2c92a31dce6015dd5195fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a997bb861be2c92a31dce6015dd5195fc">rend_service_desc_has_uploaded</a> (const <a class="el" href="structrend__data__t.html">rend_data_t</a> *rend_data)</td></tr>
<tr class="separator:a997bb861be2c92a31dce6015dd5195fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad76e8e3624e9242c15ee83597d00edf5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ad76e8e3624e9242c15ee83597d00edf5">rend_consider_services_intro_points</a> (time_t now)</td></tr>
<tr class="separator:ad76e8e3624e9242c15ee83597d00edf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f0a362081b41cf5a76662dc51bfb919"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a2f0a362081b41cf5a76662dc51bfb919">rend_consider_services_upload</a> (time_t now)</td></tr>
<tr class="separator:a2f0a362081b41cf5a76662dc51bfb919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac44e79078bc122e1f77d770919baffa3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ac44e79078bc122e1f77d770919baffa3">rend_hsdir_routers_changed</a> (void)</td></tr>
<tr class="separator:ac44e79078bc122e1f77d770919baffa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5acc6e47c3276ba3b13c64a1506047d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a5acc6e47c3276ba3b13c64a1506047d0">rend_consider_descriptor_republication</a> (void)</td></tr>
<tr class="separator:a5acc6e47c3276ba3b13c64a1506047d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca6ff2c7eb35e708f23676059431fa27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#aca6ff2c7eb35e708f23676059431fa27">rend_service_dump_stats</a> (int severity)</td></tr>
<tr class="separator:aca6ff2c7eb35e708f23676059431fa27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af48c9430694146323aad65c330fd9cb2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#af48c9430694146323aad65c330fd9cb2">rend_service_set_connection_addr_port</a> (<a class="el" href="structedge__connection__t.html">edge_connection_t</a> *conn, <a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:af48c9430694146323aad65c330fd9cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaba4729e2e5d119811388d94576b4a77"><td class="memItemLeft" align="right" valign="top"><a id="aaba4729e2e5d119811388d94576b4a77"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_allow_non_anonymous_connection</b> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:aaba4729e2e5d119811388d94576b4a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec040caddb85cc07e207af54a1cf1628"><td class="memItemLeft" align="right" valign="top"><a id="aec040caddb85cc07e207af54a1cf1628"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_reveal_startup_time</b> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:aec040caddb85cc07e207af54a1cf1628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c999d72b673a80c59da9e17451a7241"><td class="memItemLeft" align="right" valign="top"><a id="a7c999d72b673a80c59da9e17451a7241"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_non_anonymous_mode_enabled</b> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:a7c999d72b673a80c59da9e17451a7241"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The hidden-service side of rendezvous functionality. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab506650aa443a97f3932b3f50652c90d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab506650aa443a97f3932b3f50652c90d">&#9670;&nbsp;</a></span>directory_post_to_hs_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_post_to_hs_dir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> *&#160;</td>
          <td class="paramname"><em>renddesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>descs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>hs_dirs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>service_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seconds_valid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Upload the <a class="el" href="structrend__encoded__v2__service__descriptor__t.html">rend_encoded_v2_service_descriptor_t</a>'s in <b>descs</b> associated with the <a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> <b>renddesc</b> to the responsible hidden service directories OR the hidden service directories specified by <b>hs_dirs</b>; <b>service_id</b> and <b>seconds_valid</b> are only passed for logging purposes. </p>
<p>If any HSDirs are specified, they should be used instead of the responsible directories </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_ab506650aa443a97f3932b3f50652c90d_cgraph.png" border="0" usemap="#rendservice_8c_ab506650aa443a97f3932b3f50652c90d_cgraph" alt=""/></div>
<map name="rendservice_8c_ab506650aa443a97f3932b3f50652c90d_cgraph" id="rendservice_8c_ab506650aa443a97f3932b3f50652c90d_cgraph">
<area shape="rect" id="node2" href="container_8c.html#a5e71fb7bc775f079d9f9d724f0203fc1" title="smartlist_add_all" alt="" coords="242,5,362,32"/>
<area shape="rect" id="node3" href="rendcommon_8c.html#a154a5fdb5490cbf22ae39bff6564bcdf" title="hid_serv_get_responsible\l_directories" alt="" coords="217,57,387,98"/>
</map>
</div>

</div>
</div>
<a id="a28b97923c2477096e6c63d6b2c3ff057"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28b97923c2477096e6c63d6b2c3ff057">&#9670;&nbsp;</a></span>rend_authorized_client_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_authorized_client_free_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__authorized__client__t.html">rend_authorized_client_t</a> *&#160;</td>
          <td class="paramname"><em>client</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: free storage held by a single service authorized client entry. </p>

</div>
</div>
<a id="a5acc6e47c3276ba3b13c64a1506047d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5acc6e47c3276ba3b13c64a1506047d0">&#9670;&nbsp;</a></span>rend_consider_descriptor_republication()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_consider_descriptor_republication </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Consider republication of v2 rendezvous service descriptors that failed previously, but without regenerating descriptor contents. </p>

</div>
</div>
<a id="ad76e8e3624e9242c15ee83597d00edf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad76e8e3624e9242c15ee83597d00edf5">&#9670;&nbsp;</a></span>rend_consider_services_intro_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_consider_services_intro_points </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For every service, check how many intro points it currently has, and:</p><ul>
<li>Invalidate introdution points based on specific criteria, see remove_invalid_intro_points comments.</li>
<li>Pick new intro points as necessary.</li>
<li>Launch circuits to any new intro points.</li>
</ul>
<p>This is called once a second by the main loop. </p>

</div>
</div>
<a id="a2f0a362081b41cf5a76662dc51bfb919"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f0a362081b41cf5a76662dc51bfb919">&#9670;&nbsp;</a></span>rend_consider_services_upload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_consider_services_upload </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Regenerate and upload rendezvous service descriptors for all services, if necessary. If the descriptor has been dirty enough for long enough, definitely upload; else only upload when the periodic timeout has expired.</p>
<p>For the first upload, pick a random time between now and two periods from now, and pick it independently for each service. </p>

</div>
</div>
<a id="ac44e79078bc122e1f77d770919baffa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac44e79078bc122e1f77d770919baffa3">&#9670;&nbsp;</a></span>rend_hsdir_routers_changed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_hsdir_routers_changed </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when our internal view of the directory has changed, so that we might have router descriptors of hidden service directories available that we did not have before. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_ac44e79078bc122e1f77d770919baffa3_icgraph.png" border="0" usemap="#rendservice_8c_ac44e79078bc122e1f77d770919baffa3_icgraph" alt=""/></div>
<map name="rendservice_8c_ac44e79078bc122e1f77d770919baffa3_icgraph" id="rendservice_8c_ac44e79078bc122e1f77d770919baffa3_icgraph">
<area shape="rect" id="node2" href="nodelist_8h.html#a32099caf417dbc0e15ea398b1bc2ea16" title="router_dir_info_changed" alt="" coords="183,31,343,57"/>
<area shape="rect" id="node3" href="routerlist_8h.html#a8c328828cd94c3bb84044c9003f8c78f" title="routerlist_remove" alt="" coords="391,5,513,32"/>
<area shape="rect" id="node4" href="routerlist_8h.html#a9bd4c9992a1cf27e95e2829ae40c7b79" title="dir_server_add" alt="" coords="399,56,505,83"/>
</map>
</div>

</div>
</div>
<a id="a7077632dbb2b5b387c664c6d7fdd4db0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7077632dbb2b5b387c664c6d7fdd4db0">&#9670;&nbsp;</a></span>rend_num_services()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_num_services </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of rendezvous services we have configured. </p>

</div>
</div>
<a id="abc5e6a4ecf624b494840048295651d03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc5e6a4ecf624b494840048295651d03">&#9670;&nbsp;</a></span>rend_service_add_ephemeral()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="hs__common_8h.html#a375d3b5c44c65ad158e30b8f05d74b3b">hs_service_add_ephemeral_status_t</a> rend_service_add_ephemeral </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>ports</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_streams_per_circuit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_streams_close_circuit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#aafc6920f8a16e10f46703e7819795c74">rend_auth_type_t</a>&#160;</td>
          <td class="paramname"><em>auth_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>auth_clients</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>service_id_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add the ephemeral service <b>pk</b>/<b>ports</b> if possible, using client authorization <b>auth_type</b> and an optional list of <a class="el" href="structrend__authorized__client__t.html">rend_authorized_client_t</a> in <b>auth_clients</b>, with <b>max_streams_per_circuit</b> streams allowed per rendezvous circuit, and circuit closure on max streams being exceeded set by <b>max_streams_close_circuit</b>.</p>
<p>Ownership of pk, ports, and auth_clients is passed to this routine. Regardless of success/failure, callers should not touch these values after calling this routine, and may assume that correct cleanup has been done on failure.</p>
<p>Return an appropriate hs_service_add_ephemeral_status_t. </p>

</div>
</div>
<a id="acf64fba57452d31d318fcf304b160be9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf64fba57452d31d318fcf304b160be9">&#9670;&nbsp;</a></span>rend_service_begin_parse_intro()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrend__intro__cell__s.html">rend_intro_cell_t</a>* rend_service_begin_parse_intro </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>request_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>err_msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse an INTRODUCE1 or INTRODUCE2 cell into a newly allocated rend_intro_cell_t structure. Free it with rend_service_free_intro() when finished. The type parameter should be 1 or 2 to indicate whether this is INTRODUCE1 or INTRODUCE2. This parses only the non-encrypted parts; after this, call <a class="el" href="rendservice_8c.html#a96f99a75046c61a5d1477055b53a776c">rend_service_decrypt_intro()</a> with a key, then <a class="el" href="rendservice_8c.html#a1d9a3e309d3b6ee6683f33f9079b913e">rend_service_parse_intro_plaintext()</a> to finish parsing. The optional err_msg_out parameter is set to a string suitable for log output if parsing fails. This function does some validation, but only that which depends solely on the contents of the cell and the key; it can be unit-tested. Further validation is done in rend_service_validate_intro(). </p>

</div>
</div>
<a id="a96f99a75046c61a5d1477055b53a776c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96f99a75046c61a5d1477055b53a776c">&#9670;&nbsp;</a></span>rend_service_decrypt_intro()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_decrypt_intro </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__intro__cell__s.html">rend_intro_cell_t</a> *&#160;</td>
          <td class="paramname"><em>intro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>err_msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt the encrypted part of an INTRODUCE1 or INTRODUCE2 cell, return 0 if successful, or &lt; 0 and write an error message to *err_msg_out if provided. </p>

</div>
</div>
<a id="a9adfef842de9b8aec233a9046b9faeb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9adfef842de9b8aec233a9046b9faeb2">&#9670;&nbsp;</a></span>rend_service_del_ephemeral()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_del_ephemeral </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>service_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove the ephemeral service <b>service_id</b> if possible. Returns 0 on success, and -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_a9adfef842de9b8aec233a9046b9faeb2_cgraph.png" border="0" usemap="#rendservice_8c_a9adfef842de9b8aec233a9046b9faeb2_cgraph" alt=""/></div>
<map name="rendservice_8c_a9adfef842de9b8aec233a9046b9faeb2_cgraph" id="rendservice_8c_a9adfef842de9b8aec233a9046b9faeb2_cgraph">
<area shape="rect" id="node2" href="rendcommon_8c.html#a07d97b83844365f0949fd9998269a5a9" title="rend_valid_v2_service_id" alt="" coords="240,5,408,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_a9adfef842de9b8aec233a9046b9faeb2_icgraph.png" border="0" usemap="#rendservice_8c_a9adfef842de9b8aec233a9046b9faeb2_icgraph" alt=""/></div>
<map name="rendservice_8c_a9adfef842de9b8aec233a9046b9faeb2_icgraph" id="rendservice_8c_a9adfef842de9b8aec233a9046b9faeb2_icgraph">
<area shape="rect" id="node2" href="control_8h.html#a966dc2b23c935600dc1f815fe8e88fda" title="connection_control\l_closed" alt="" coords="240,5,371,47"/>
</map>
</div>

</div>
</div>
<a id="a997bb861be2c92a31dce6015dd5195fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a997bb861be2c92a31dce6015dd5195fc">&#9670;&nbsp;</a></span>rend_service_desc_has_uploaded()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_desc_has_uploaded </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structrend__data__t.html">rend_data_t</a> *&#160;</td>
          <td class="paramname"><em>rend_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A new descriptor has been successfully uploaded for the given <b>rend_data</b>. Remove and free the expiring nodes from the associated service. </p>

</div>
</div>
<a id="aca6ff2c7eb35e708f23676059431fa27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca6ff2c7eb35e708f23676059431fa27">&#9670;&nbsp;</a></span>rend_service_dump_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_dump_stats </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log the status of introduction points for all rendezvous services at log severity <b>severity</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_aca6ff2c7eb35e708f23676059431fa27_cgraph.png" border="0" usemap="#rendservice_8c_aca6ff2c7eb35e708f23676059431fa27_cgraph" alt=""/></div>
<map name="rendservice_8c_aca6ff2c7eb35e708f23676059431fa27_cgraph" id="rendservice_8c_aca6ff2c7eb35e708f23676059431fa27_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="224,5,285,32"/>
</map>
</div>

</div>
</div>
<a id="a7c38e8a5780c6512244f0c93a2f9f169"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c38e8a5780c6512244f0c93a2f9f169">&#9670;&nbsp;</a></span>rend_service_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void rend_service_free_ </td>
          <td>(</td>
          <td class="paramtype">rend_service_t *&#160;</td>
          <td class="paramname"><em>service</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release the storage held by <b>service</b>. </p>

</div>
</div>
<a id="ade90973329e24160017a04e0503397bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade90973329e24160017a04e0503397bd">&#9670;&nbsp;</a></span>rend_service_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all the storage held in both rend_service_list and rend_service_staging_list. </p>

</div>
</div>
<a id="aad1ab301edd163bf2d73b732b8482b63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad1ab301edd163bf2d73b732b8482b63">&#9670;&nbsp;</a></span>rend_service_free_intro_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_free_intro_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__intro__cell__s.html">rend_intro_cell_t</a> *&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free a parsed INTRODUCE1 or INTRODUCE2 cell that was allocated by rend_service_parse_intro(). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_aad1ab301edd163bf2d73b732b8482b63_cgraph.png" border="0" usemap="#rendservice_8c_aad1ab301edd163bf2d73b732b8482b63_cgraph" alt=""/></div>
<map name="rendservice_8c_aad1ab301edd163bf2d73b732b8482b63_cgraph" id="rendservice_8c_aad1ab301edd163bf2d73b732b8482b63_cgraph">
<area shape="rect" id="node2" href="crypto__util_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="217,5,296,32"/>
</map>
</div>

</div>
</div>
<a id="ac20565d148fc4643343b5bc7e691d7d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac20565d148fc4643343b5bc7e691d7d2">&#9670;&nbsp;</a></span>rend_service_intro_established()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_intro_established </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circuit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>request_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we get an INTRO_ESTABLISHED cell; mark the circuit as a live introduction point, and note that the service descriptor is now out-of-date. </p>

</div>
</div>
<a id="aa80ac6037ad40cfd37531cc52d11a11f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa80ac6037ad40cfd37531cc52d11a11f">&#9670;&nbsp;</a></span>rend_service_intro_has_opened()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_intro_has_opened </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circuit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we're done building a circuit to an introduction point: sends a RELAY_ESTABLISH_INTRO cell. </p>

</div>
</div>
<a id="a7b9ee2cd47bd85d48fd2ef88dcc93334"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b9ee2cd47bd85d48fd2ef88dcc93334">&#9670;&nbsp;</a></span>rend_service_load_all_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_load_all_keys </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>service_list</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load and/or generate private keys for all hidden services, possibly including keys for client authorization. If a <b>service_list</b> is provided, treat it as the list of hidden services (used in unittests). Otherwise, require that rend_service_list is not NULL. Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="a1d9a3e309d3b6ee6683f33f9079b913e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d9a3e309d3b6ee6683f33f9079b913e">&#9670;&nbsp;</a></span>rend_service_parse_intro_plaintext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_parse_intro_plaintext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__intro__cell__s.html">rend_intro_cell_t</a> *&#160;</td>
          <td class="paramname"><em>intro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>err_msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the plaintext of the encrypted part of an INTRODUCE1 or INTRODUCE2 cell, return 0 if successful, or &lt; 0 and write an error message to *err_msg_out if provided. </p>
<p>The rendezvous cookie and Diffie-Hellman stuff are version-invariant and at the end of the plaintext of the encrypted part of the cell.</p>

</div>
</div>
<a id="af1afe7b7400e5a9774ed1b43b7c60c51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1afe7b7400e5a9774ed1b43b7c60c51">&#9670;&nbsp;</a></span>rend_service_parse_port_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrend__service__port__config__t.html">rend_service_port_config_t</a>* rend_service_parse_port_config </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>sep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>err_msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parses a virtual-port to real-port/socket mapping separated by the provided separator and returns a new <a class="el" href="structrend__service__port__config__t.html">rend_service_port_config_t</a>, or NULL and an optional error string on failure.</p>
<p>The format is: VirtualPort SEP (IP|RealPort|IP:RealPort|'socket':path)?</p>
<p>IP defaults to 127.0.0.1; RealPort defaults to VirtualPort. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_af1afe7b7400e5a9774ed1b43b7c60c51_cgraph.png" border="0" usemap="#rendservice_8c_af1afe7b7400e5a9774ed1b43b7c60c51_cgraph" alt=""/></div>
<map name="rendservice_8c_af1afe7b7400e5a9774ed1b43b7c60c51_cgraph" id="rendservice_8c_af1afe7b7400e5a9774ed1b43b7c60c51_cgraph">
<area shape="rect" id="node2" href="container_8c.html#a1d75cac5583c66900c032ba972ffabc8" title="smartlist_split_string" alt="" coords="188,13,331,39"/>
</map>
</div>

</div>
</div>
<a id="ac5402d8d70dfb781694cb76d390beec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5402d8d70dfb781694cb76d390beec0">&#9670;&nbsp;</a></span>rend_service_poison_new_single_onion_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int rend_service_poison_new_single_onion_dir </td>
          <td>(</td>
          <td class="paramtype">const rend_service_t *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We just got launched in Single Onion Mode. That's a non-anonymous mode for hidden services. If s is new, we should mark its hidden service directory appropriately so that it is never launched as a location-private hidden service. (New directories don't have private key files.) Return 0 on success, -1 on fail. </p>

</div>
</div>
<a id="aa95b57d67357abc95a0d856c454d1d02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa95b57d67357abc95a0d856c454d1d02">&#9670;&nbsp;</a></span>rend_service_port_config_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_port_config_free_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__service__port__config__t.html">rend_service_port_config_t</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all storage held in a <a class="el" href="structrend__service__port__config__t.html">rend_service_port_config_t</a>. </p>

</div>
</div>
<a id="a6a060371417948bb0cc60be0840ed451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a060371417948bb0cc60be0840ed451">&#9670;&nbsp;</a></span>rend_service_receive_introduction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_receive_introduction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circuit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>request_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Respond to an INTRODUCE2 cell by launching a circuit to the chosen rendezvous point. </p>

</div>
</div>
<a id="a6aaefddc359725fc37dddb646455fee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aaefddc359725fc37dddb646455fee2">&#9670;&nbsp;</a></span>rend_service_relaunch_rendezvous()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_relaunch_rendezvous </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>oldcirc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we fail building a rendezvous circuit at some point other than the last hop: launches a new circuit to the same rendezvous point. </p>

</div>
</div>
<a id="a1cfdd77e4e98bf6ea995a2e7224a6e83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cfdd77e4e98bf6ea995a2e7224a6e83">&#9670;&nbsp;</a></span>rend_service_rendezvous_has_opened()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_rendezvous_has_opened </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circuit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called once a circuit to a rendezvous point is established: sends a RELAY_COMMAND_RENDEZVOUS1 cell. </p>

</div>
</div>
<a id="af48c9430694146323aad65c330fd9cb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af48c9430694146323aad65c330fd9cb2">&#9670;&nbsp;</a></span>rend_service_set_connection_addr_port()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_set_connection_addr_port </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structedge__connection__t.html">edge_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given <b>conn</b>, a rendezvous exit stream, look up the hidden service for <b>circ</b>, and look up the port and address based on conn-&gt;port. Assign the actual conn-&gt;addr and conn-&gt;port. Return -2 on failure for which the circuit should be closed, -1 on other failure, or 0 for success. </p>

</div>
</div>
<a id="a9c45ef372f52fd082bc4dc9547ff4c7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c45ef372f52fd082bc4dc9547ff4c7f">&#9670;&nbsp;</a></span>rend_service_validate_intro_late()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_validate_intro_late </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structrend__intro__cell__s.html">rend_intro_cell_t</a> *&#160;</td>
          <td class="paramname"><em>intro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>err_msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Do validity checks on a parsed intro cell after decryption; some of these are not done in <a class="el" href="rendservice_8c.html#a1d9a3e309d3b6ee6683f33f9079b913e">rend_service_parse_intro_plaintext()</a> itself because they depend on a lot of other state and would make it hard to unit test. Returns &gt;= 0 if successful or &lt; 0 if the intro cell is invalid, and optionally writes out an error message for logging. If an err_msg pointer is provided, it is the caller's responsibility to free any provided message. </p>

</div>
</div>
<a id="a2925d59d4cd16a1b1f5b0ffc9e23ab7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2925d59d4cd16a1b1f5b0ffc9e23ab7b">&#9670;&nbsp;</a></span>rend_service_verify_single_onion_poison()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int rend_service_verify_single_onion_poison </td>
          <td>(</td>
          <td class="paramtype">const rend_service_t *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check the single onion service poison state of the directory for s:</p><ul>
<li>If the service is poisoned, and we are in Single Onion Mode, return 0,</li>
<li>If the service is not poisoned, and we are not in Single Onion Mode, return 0,</li>
<li>Otherwise, the poison state is invalid: the service was created in one mode, and is being used in the other, return -1. Hidden service directories without keys are always considered consistent. They will be poisoned after their directory is created (if needed). </li>
</ul>

</div>
</div>
<a id="a5cbc34ae661d9ebfa9dae965021661ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cbc34ae661d9ebfa9dae965021661ef">&#9670;&nbsp;</a></span>rend_services_add_filenames_to_lists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_services_add_filenames_to_lists </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>open_lst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>stat_lst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add to <b>open_lst</b> every filename used by a configured hidden service, and to <b>stat_lst</b> every directory used by a configured hidden service </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
