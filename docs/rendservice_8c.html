<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/or/rendservice.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_386635fabd7f6c74e9d9c7a8604514a0.html">or</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">rendservice.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The hidden-service side of rendezvous functionality.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="or_8h_source.html">or.h</a>&quot;</code><br />
<code>#include &quot;circpathbias.h&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitbuild_8h_source.html">circuitbuild.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuitlist_8h_source.html">circuitlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="circuituse_8h_source.html">circuituse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="control_8h_source.html">control.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="directory_8h_source.html">directory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="main_8h_source.html">main.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="networkstatus_8h_source.html">networkstatus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nodelist_8h_source.html">nodelist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="policies_8h_source.html">policies.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendclient_8h_source.html">rendclient.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendcommon_8h_source.html">rendcommon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rendservice_8h_source.html">rendservice.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="router_8h_source.html">router.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="relay_8h_source.html">relay.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rephist_8h_source.html">rephist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="replaycache_8h_source.html">replaycache.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerlist_8h_source.html">routerlist.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="routerparse_8h_source.html">routerparse.h</a>&quot;</code><br />
<code>#include &quot;routerset.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for rendservice.c:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2rendservice_8c" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2rendservice_8c" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2or_2rendservice_8c">
<area shape="rect" id="node2" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="1255,259,1299,285"/>
<area shape="rect" id="node27" href="replaycache_8h.html" title="Header file for replaycache.c. " alt="" coords="1747,333,1850,360"/>
<area shape="rect" id="node30" href="circpathbias_8h_source.html" title="circpathbias.h" alt="" coords="2167,109,2270,136"/>
<area shape="rect" id="node31" href="circuitbuild_8h.html" title="Header file for circuitbuild.c. " alt="" coords="2294,109,2389,136"/>
<area shape="rect" id="node32" href="circuitlist_8h.html" title="Header file for circuitlist.c. " alt="" coords="2116,184,2201,211"/>
<area shape="rect" id="node33" href="circuituse_8h.html" title="Header file for circuituse.c. " alt="" coords="2413,109,2502,136"/>
<area shape="rect" id="node34" href="config_8h.html" title="Header file for config.c. " alt="" coords="1594,184,1662,211"/>
<area shape="rect" id="node35" href="control_8h.html" title="Header file for control.c. " alt="" coords="2527,109,2599,136"/>
<area shape="rect" id="node36" href="directory_8h.html" title="Header file for directory.c. " alt="" coords="2623,109,2705,136"/>
<area shape="rect" id="node37" href="main_8h.html" title="Header file for main.c. " alt="" coords="2729,109,2791,136"/>
<area shape="rect" id="node38" href="networkstatus_8h.html" title="Header file for networkstatus.c. " alt="" coords="1877,259,1992,285"/>
<area shape="rect" id="node39" href="nodelist_8h.html" title="Header file for nodelist.c. " alt="" coords="2815,109,2894,136"/>
<area shape="rect" id="node40" href="policies_8h.html" title="Header file for policies.c. " alt="" coords="2919,109,2996,136"/>
<area shape="rect" id="node41" href="rendclient_8h.html" title="Header file for rendclient.c. " alt="" coords="1690,109,1779,136"/>
<area shape="rect" id="node43" href="rendcommon_8h.html" title="Header file for rendcommon.c. " alt="" coords="1694,259,1802,285"/>
<area shape="rect" id="node44" href="rendservice_8h.html" title="Header file for rendservice.c. " alt="" coords="1258,184,1358,211"/>
<area shape="rect" id="node45" href="router_8h.html" title="Header file for router.c. " alt="" coords="1976,408,2043,435"/>
<area shape="rect" id="node46" href="relay_8h.html" title="Header file for relay.c. " alt="" coords="3020,109,3081,136"/>
<area shape="rect" id="node47" href="rephist_8h.html" title="Header file for rephist.c. " alt="" coords="3105,109,3177,136"/>
<area shape="rect" id="node48" href="routerlist_8h.html" title="Header file for routerlist.c. " alt="" coords="2031,557,2113,584"/>
<area shape="rect" id="node49" href="routerparse_8h.html" title="Header file for routerparse.c. " alt="" coords="3201,109,3300,136"/>
<area shape="rect" id="node50" href="routerset_8h_source.html" title="routerset.h" alt="" coords="3325,109,3409,136"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="334,781,413,808"/>
<area shape="rect" id="node4" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="697,707,759,733"/>
<area shape="rect" id="node5" href="crypto_8h.html" title="Headers for crypto.c. " alt="" coords="912,483,981,509"/>
<area shape="rect" id="node13" href="crypto__format_8h_source.html" title="crypto_format.h" alt="" coords="1366,483,1479,509"/>
<area shape="rect" id="node14" href="crypto__ed25519_8h_source.html" title="crypto_ed25519.h" alt="" coords="1395,557,1520,584"/>
<area shape="rect" id="node15" href="crypto__curve25519_8h_source.html" title="crypto_curve25519.h" alt="" coords="1386,632,1529,659"/>
<area shape="rect" id="node16" href="tortls_8h.html" title="Headers for tortls.c. " alt="" coords="1179,408,1242,435"/>
<area shape="rect" id="node18" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="1606,483,1671,509"/>
<area shape="rect" id="node19" href="container_8h_source.html" title="container.h" alt="" coords="815,408,902,435"/>
<area shape="rect" id="node22" href="torgzip_8h.html" title="Headers for torgzip.h. " alt="" coords="984,333,1056,360"/>
<area shape="rect" id="node23" href="address_8h.html" title="Headers for address.h. " alt="" coords="731,333,810,360"/>
<area shape="rect" id="node24" href="compat__libevent_8h_source.html" title="compat_libevent.h" alt="" coords="5,632,133,659"/>
<area shape="rect" id="node26" href="ht_8h_source.html" title="ht.h" alt="" coords="1081,333,1125,360"/>
<area shape="rect" id="node28" href="tor__queue_8h_source.html" title="tor_queue.h" alt="" coords="1149,333,1240,360"/>
<area shape="rect" id="node29" href="util__format_8h_source.html" title="util_format.h" alt="" coords="1553,632,1647,659"/>
<area shape="rect" id="node7" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="1661,707,1760,733"/>
<area shape="rect" id="node8" href="compat_8h_source.html" title="compat.h" alt="" coords="862,557,938,584"/>
<area shape="rect" id="node10" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="466,707,574,733"/>
<area shape="rect" id="node12" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="665,632,791,659"/>
<area shape="rect" id="node17" href="compat__openssl_8h.html" title="compatability definitions for working with different openssl forks " alt="" coords="1147,483,1275,509"/>
<area shape="rect" id="node20" href="util_8h.html" title="Headers for util.c. " alt="" coords="1056,483,1107,509"/>
<area shape="rect" id="node21" href="siphash_8h_source.html" title="siphash.h" alt="" coords="809,483,887,509"/>
<area shape="rect" id="node42" href="rendcache_8h.html" title="Header file for rendcache.c. " alt="" coords="1687,184,1780,211"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrend__service__port__config__s.html">rend_service_port_config_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3954ca70bdb4718adf2ebdcf319ba096"><td class="memItemLeft" align="right" valign="top"><a id="a3954ca70bdb4718adf2ebdcf319ba096"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RENDSERVICE_PRIVATE</b></td></tr>
<tr class="separator:a3954ca70bdb4718adf2ebdcf319ba096"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a98962028a9dabd57becaa32836cc3d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a0a98962028a9dabd57becaa32836cc3d">NUM_INTRO_POINTS_DEFAULT</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a0a98962028a9dabd57becaa32836cc3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed4d99dec0ebe9163bc272a59977b549"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#aed4d99dec0ebe9163bc272a59977b549">NUM_INTRO_POINTS_MAX</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:aed4d99dec0ebe9163bc272a59977b549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73adcc6462df8fca323a20ff9ed1eaad"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a73adcc6462df8fca323a20ff9ed1eaad">NUM_INTRO_POINTS_EXTRA</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a73adcc6462df8fca323a20ff9ed1eaad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab963f65eba52d5384785dbece8f22417"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ab963f65eba52d5384785dbece8f22417">INTRO_CIRC_RETRY_PERIOD</a>&#160;&#160;&#160;(60*5)</td></tr>
<tr class="separator:ab963f65eba52d5384785dbece8f22417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac287fb93b662f1e016f6e67cbf534fe6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ac287fb93b662f1e016f6e67cbf534fe6">MAX_INTRO_CIRCS_PER_PERIOD</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:ac287fb93b662f1e016f6e67cbf534fe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae33ac967c20bec8c9849526ae8e97cd4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ae33ac967c20bec8c9849526ae8e97cd4">MAX_REND_TIMEOUT</a>&#160;&#160;&#160;30</td></tr>
<tr class="separator:ae33ac967c20bec8c9849526ae8e97cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2824e9718bf70be95c337ccebfb09a1"><td class="memItemLeft" align="right" valign="top"><a id="ad2824e9718bf70be95c337ccebfb09a1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_REND_FAILURES_DEFAULT</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ad2824e9718bf70be95c337ccebfb09a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9062121850c27ce15a47bef83c7bc783"><td class="memItemLeft" align="right" valign="top"><a id="a9062121850c27ce15a47bef83c7bc783"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_REND_FAILURES_MIN</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a9062121850c27ce15a47bef83c7bc783"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab449c677d62fe27d8eee3a08afdd23d2"><td class="memItemLeft" align="right" valign="top"><a id="ab449c677d62fe27d8eee3a08afdd23d2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_REND_FAILURES_MAX</b>&#160;&#160;&#160;10</td></tr>
<tr class="separator:ab449c677d62fe27d8eee3a08afdd23d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a763d9d0b393051ba265a988c00453539"><td class="memItemLeft" align="right" valign="top"><a id="a763d9d0b393051ba265a988c00453539"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIN_REND_INITIAL_POST_DELAY</b>&#160;&#160;&#160;(30)</td></tr>
<tr class="separator:a763d9d0b393051ba265a988c00453539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07383cdb3035f428054285e3fccb5396"><td class="memItemLeft" align="right" valign="top"><a id="a07383cdb3035f428054285e3fccb5396"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIN_REND_INITIAL_POST_DELAY_TESTING</b>&#160;&#160;&#160;(5)</td></tr>
<tr class="separator:a07383cdb3035f428054285e3fccb5396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acc260fb34e6212cf4678ca061bd450"><td class="memItemLeft" align="right" valign="top"><a id="a3acc260fb34e6212cf4678ca061bd450"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_STREAM_WARN_INTERVAL</b>&#160;&#160;&#160;600</td></tr>
<tr class="separator:a3acc260fb34e6212cf4678ca061bd450"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a72f50e422d8b75b066d39980c2008ef8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a72f50e422d8b75b066d39980c2008ef8">num_rend_services</a> (void)</td></tr>
<tr class="separator:a72f50e422d8b75b066d39980c2008ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a79f7a8c69ac9e5daf2dbac5e158fbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a3a79f7a8c69ac9e5daf2dbac5e158fbf">rend_authorized_client_free</a> (<a class="el" href="structrend__authorized__client__t.html">rend_authorized_client_t</a> *client)</td></tr>
<tr class="separator:a3a79f7a8c69ac9e5daf2dbac5e158fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cd5cb06a8e03c07ed7d120f90cee388"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a8cd5cb06a8e03c07ed7d120f90cee388">rend_service_free</a> (rend_service_t *service)</td></tr>
<tr class="separator:a8cd5cb06a8e03c07ed7d120f90cee388"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade90973329e24160017a04e0503397bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ade90973329e24160017a04e0503397bd">rend_service_free_all</a> (void)</td></tr>
<tr class="separator:ade90973329e24160017a04e0503397bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1afe7b7400e5a9774ed1b43b7c60c51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrend__service__port__config__s.html">rend_service_port_config_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#af1afe7b7400e5a9774ed1b43b7c60c51">rend_service_parse_port_config</a> (const char *string, const char *sep, char **err_msg_out)</td></tr>
<tr class="separator:af1afe7b7400e5a9774ed1b43b7c60c51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63aef3c4d372dc9252de8d1a082bc6b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a63aef3c4d372dc9252de8d1a082bc6b2">rend_service_port_config_free</a> (<a class="el" href="structrend__service__port__config__s.html">rend_service_port_config_t</a> *p)</td></tr>
<tr class="separator:a63aef3c4d372dc9252de8d1a082bc6b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a432c80cf6973c2f509afaedd661ab4c3"><td class="memItemLeft" align="right" valign="top"><a id="a432c80cf6973c2f509afaedd661ab4c3"></a>
STATIC int&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_check_dir_and_add</b> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *service_list, const <a class="el" href="structor__options__t.html">or_options_t</a> *options, rend_service_t *service, int validate_only)</td></tr>
<tr class="separator:a432c80cf6973c2f509afaedd661ab4c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7094d871cb7d82c4afce315145e68ee2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a7094d871cb7d82c4afce315145e68ee2">rend_config_services</a> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options, int validate_only)</td></tr>
<tr class="separator:a7094d871cb7d82c4afce315145e68ee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8f00f019a925a0202d313aa9b19e918"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rendservice_8h.html#acb105e3bbdf6bdfbc2d58a0a66e942ef">rend_service_add_ephemeral_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#af8f00f019a925a0202d313aa9b19e918">rend_service_add_ephemeral</a> (<a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *pk, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *ports, int max_streams_per_circuit, int max_streams_close_circuit, <a class="el" href="or_8h.html#aafc6920f8a16e10f46703e7819795c74">rend_auth_type_t</a> auth_type, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *auth_clients, char **service_id_out)</td></tr>
<tr class="separator:af8f00f019a925a0202d313aa9b19e918"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9adfef842de9b8aec233a9046b9faeb2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a9adfef842de9b8aec233a9046b9faeb2">rend_service_del_ephemeral</a> (const char *service_id)</td></tr>
<tr class="separator:a9adfef842de9b8aec233a9046b9faeb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08b3ad283d04bc455030d50e0bcbe49e"><td class="memItemLeft" align="right" valign="top"><a id="a08b3ad283d04bc455030d50e0bcbe49e"></a>
STATIC char *&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_sos_poison_path</b> (const rend_service_t *service)</td></tr>
<tr class="separator:a08b3ad283d04bc455030d50e0bcbe49e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2925d59d4cd16a1b1f5b0ffc9e23ab7b"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a2925d59d4cd16a1b1f5b0ffc9e23ab7b">rend_service_verify_single_onion_poison</a> (const rend_service_t *s, const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:a2925d59d4cd16a1b1f5b0ffc9e23ab7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5402d8d70dfb781694cb76d390beec0"><td class="memItemLeft" align="right" valign="top">STATIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ac5402d8d70dfb781694cb76d390beec0">rend_service_poison_new_single_onion_dir</a> (const rend_service_t *s, const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:ac5402d8d70dfb781694cb76d390beec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b9ee2cd47bd85d48fd2ef88dcc93334"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a7b9ee2cd47bd85d48fd2ef88dcc93334">rend_service_load_all_keys</a> (const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *service_list)</td></tr>
<tr class="separator:a7b9ee2cd47bd85d48fd2ef88dcc93334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cbc34ae661d9ebfa9dae965021661ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a5cbc34ae661d9ebfa9dae965021661ef">rend_services_add_filenames_to_lists</a> (<a class="el" href="structsmartlist__t.html">smartlist_t</a> *open_lst, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *stat_lst)</td></tr>
<tr class="separator:a5cbc34ae661d9ebfa9dae965021661ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a060371417948bb0cc60be0840ed451"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a6a060371417948bb0cc60be0840ed451">rend_service_receive_introduction</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circuit, const uint8_t *request, size_t request_len)</td></tr>
<tr class="separator:a6a060371417948bb0cc60be0840ed451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1e1ab28c3798f2915cd7520110b37a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ab1e1ab28c3798f2915cd7520110b37a1">rend_service_free_intro</a> (rend_intro_cell_t *request)</td></tr>
<tr class="separator:ab1e1ab28c3798f2915cd7520110b37a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf64fba57452d31d318fcf304b160be9"><td class="memItemLeft" align="right" valign="top">rend_intro_cell_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#acf64fba57452d31d318fcf304b160be9">rend_service_begin_parse_intro</a> (const uint8_t *request, size_t request_len, uint8_t type, char **err_msg_out)</td></tr>
<tr class="separator:acf64fba57452d31d318fcf304b160be9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96f99a75046c61a5d1477055b53a776c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a96f99a75046c61a5d1477055b53a776c">rend_service_decrypt_intro</a> (rend_intro_cell_t *intro, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *key, char **err_msg_out)</td></tr>
<tr class="separator:a96f99a75046c61a5d1477055b53a776c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d9a3e309d3b6ee6683f33f9079b913e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a1d9a3e309d3b6ee6683f33f9079b913e">rend_service_parse_intro_plaintext</a> (rend_intro_cell_t *intro, char **err_msg_out)</td></tr>
<tr class="separator:a1d9a3e309d3b6ee6683f33f9079b913e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c45ef372f52fd082bc4dc9547ff4c7f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a9c45ef372f52fd082bc4dc9547ff4c7f">rend_service_validate_intro_late</a> (const rend_intro_cell_t *intro, char **err_msg_out)</td></tr>
<tr class="separator:a9c45ef372f52fd082bc4dc9547ff4c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aaefddc359725fc37dddb646455fee2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a6aaefddc359725fc37dddb646455fee2">rend_service_relaunch_rendezvous</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *oldcirc)</td></tr>
<tr class="separator:a6aaefddc359725fc37dddb646455fee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa80ac6037ad40cfd37531cc52d11a11f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#aa80ac6037ad40cfd37531cc52d11a11f">rend_service_intro_has_opened</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circuit)</td></tr>
<tr class="separator:aa80ac6037ad40cfd37531cc52d11a11f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac20565d148fc4643343b5bc7e691d7d2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ac20565d148fc4643343b5bc7e691d7d2">rend_service_intro_established</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circuit, const uint8_t *request, size_t request_len)</td></tr>
<tr class="separator:ac20565d148fc4643343b5bc7e691d7d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cfdd77e4e98bf6ea995a2e7224a6e83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a1cfdd77e4e98bf6ea995a2e7224a6e83">rend_service_rendezvous_has_opened</a> (<a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circuit)</td></tr>
<tr class="separator:a1cfdd77e4e98bf6ea995a2e7224a6e83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab506650aa443a97f3932b3f50652c90d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ab506650aa443a97f3932b3f50652c90d">directory_post_to_hs_dir</a> (<a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> *renddesc, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *descs, <a class="el" href="structsmartlist__t.html">smartlist_t</a> *hs_dirs, const char *service_id, int seconds_valid)</td></tr>
<tr class="separator:ab506650aa443a97f3932b3f50652c90d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997bb861be2c92a31dce6015dd5195fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a997bb861be2c92a31dce6015dd5195fc">rend_service_desc_has_uploaded</a> (const <a class="el" href="structrend__data__t.html">rend_data_t</a> *rend_data)</td></tr>
<tr class="separator:a997bb861be2c92a31dce6015dd5195fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eefb2085950d1a5c417d48058516ccb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a4eefb2085950d1a5c417d48058516ccb">rend_consider_services_intro_points</a> (void)</td></tr>
<tr class="separator:a4eefb2085950d1a5c417d48058516ccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f0a362081b41cf5a76662dc51bfb919"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a2f0a362081b41cf5a76662dc51bfb919">rend_consider_services_upload</a> (time_t now)</td></tr>
<tr class="separator:a2f0a362081b41cf5a76662dc51bfb919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac44e79078bc122e1f77d770919baffa3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#ac44e79078bc122e1f77d770919baffa3">rend_hsdir_routers_changed</a> (void)</td></tr>
<tr class="separator:ac44e79078bc122e1f77d770919baffa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5acc6e47c3276ba3b13c64a1506047d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#a5acc6e47c3276ba3b13c64a1506047d0">rend_consider_descriptor_republication</a> (void)</td></tr>
<tr class="separator:a5acc6e47c3276ba3b13c64a1506047d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca6ff2c7eb35e708f23676059431fa27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#aca6ff2c7eb35e708f23676059431fa27">rend_service_dump_stats</a> (int severity)</td></tr>
<tr class="separator:aca6ff2c7eb35e708f23676059431fa27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af48c9430694146323aad65c330fd9cb2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rendservice_8c.html#af48c9430694146323aad65c330fd9cb2">rend_service_set_connection_addr_port</a> (<a class="el" href="structedge__connection__t.html">edge_connection_t</a> *conn, <a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *circ)</td></tr>
<tr class="separator:af48c9430694146323aad65c330fd9cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaba4729e2e5d119811388d94576b4a77"><td class="memItemLeft" align="right" valign="top"><a id="aaba4729e2e5d119811388d94576b4a77"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_allow_non_anonymous_connection</b> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:aaba4729e2e5d119811388d94576b4a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec040caddb85cc07e207af54a1cf1628"><td class="memItemLeft" align="right" valign="top"><a id="aec040caddb85cc07e207af54a1cf1628"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_reveal_startup_time</b> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:aec040caddb85cc07e207af54a1cf1628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c999d72b673a80c59da9e17451a7241"><td class="memItemLeft" align="right" valign="top"><a id="a7c999d72b673a80c59da9e17451a7241"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>rend_service_non_anonymous_mode_enabled</b> (const <a class="el" href="structor__options__t.html">or_options_t</a> *options)</td></tr>
<tr class="separator:a7c999d72b673a80c59da9e17451a7241"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The hidden-service side of rendezvous functionality. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ab963f65eba52d5384785dbece8f22417"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab963f65eba52d5384785dbece8f22417">&#9670;&nbsp;</a></span>INTRO_CIRC_RETRY_PERIOD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INTRO_CIRC_RETRY_PERIOD&#160;&#160;&#160;(60*5)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If we can't build our intro circuits, don't retry for this long. </p>

</div>
</div>
<a id="ac287fb93b662f1e016f6e67cbf534fe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac287fb93b662f1e016f6e67cbf534fe6">&#9670;&nbsp;</a></span>MAX_INTRO_CIRCS_PER_PERIOD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_INTRO_CIRCS_PER_PERIOD&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Don't try to build more than this many circuits before giving up for a while. </p>

</div>
</div>
<a id="ae33ac967c20bec8c9849526ae8e97cd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae33ac967c20bec8c9849526ae8e97cd4">&#9670;&nbsp;</a></span>MAX_REND_TIMEOUT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_REND_TIMEOUT&#160;&#160;&#160;30</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many seconds should we spend trying to connect to a requested rendezvous point before giving up? </p>

</div>
</div>
<a id="a0a98962028a9dabd57becaa32836cc3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a98962028a9dabd57becaa32836cc3d">&#9670;&nbsp;</a></span>NUM_INTRO_POINTS_DEFAULT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_INTRO_POINTS_DEFAULT&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Try to maintain this many intro points per service by default. </p>

</div>
</div>
<a id="a73adcc6462df8fca323a20ff9ed1eaad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73adcc6462df8fca323a20ff9ed1eaad">&#9670;&nbsp;</a></span>NUM_INTRO_POINTS_EXTRA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_INTRO_POINTS_EXTRA&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of extra intro points we launch if our set of intro nodes is empty. See proposal 155, section 4. </p>

</div>
</div>
<a id="aed4d99dec0ebe9163bc272a59977b549"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed4d99dec0ebe9163bc272a59977b549">&#9670;&nbsp;</a></span>NUM_INTRO_POINTS_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_INTRO_POINTS_MAX&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum number of intro points per service. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab506650aa443a97f3932b3f50652c90d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab506650aa443a97f3932b3f50652c90d">&#9670;&nbsp;</a></span>directory_post_to_hs_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void directory_post_to_hs_dir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> *&#160;</td>
          <td class="paramname"><em>renddesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>descs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>hs_dirs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>service_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seconds_valid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Upload the <a class="el" href="structrend__encoded__v2__service__descriptor__t.html">rend_encoded_v2_service_descriptor_t</a>'s in <b>descs</b> associated with the <a class="el" href="structrend__service__descriptor__t.html">rend_service_descriptor_t</a> <b>renddesc</b> to the responsible hidden service directories OR the hidden service directories specified by <b>hs_dirs</b>; <b>service_id</b> and <b>seconds_valid</b> are only passed for logging purposes. </p>
<p>If any HSDirs are specified, they should be used instead of the responsible directories </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_ab506650aa443a97f3932b3f50652c90d_cgraph.png" border="0" usemap="#rendservice_8c_ab506650aa443a97f3932b3f50652c90d_cgraph" alt=""/></div>
<map name="rendservice_8c_ab506650aa443a97f3932b3f50652c90d_cgraph" id="rendservice_8c_ab506650aa443a97f3932b3f50652c90d_cgraph">
<area shape="rect" id="node2" href="container_8c.html#a5e71fb7bc775f079d9f9d724f0203fc1" title="smartlist_add_all" alt="" coords="242,5,362,32"/>
<area shape="rect" id="node3" href="rendcommon_8c.html#a154a5fdb5490cbf22ae39bff6564bcdf" title="hid_serv_get_responsible\l_directories" alt="" coords="217,57,387,98"/>
</map>
</div>

</div>
</div>
<a id="a72f50e422d8b75b066d39980c2008ef8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72f50e422d8b75b066d39980c2008ef8">&#9670;&nbsp;</a></span>num_rend_services()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int num_rend_services </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of rendezvous services we have configured. </p>

</div>
</div>
<a id="a3a79f7a8c69ac9e5daf2dbac5e158fbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a79f7a8c69ac9e5daf2dbac5e158fbf">&#9670;&nbsp;</a></span>rend_authorized_client_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_authorized_client_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__authorized__client__t.html">rend_authorized_client_t</a> *&#160;</td>
          <td class="paramname"><em>client</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper: free storage held by a single service authorized client entry. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_a3a79f7a8c69ac9e5daf2dbac5e158fbf_cgraph.png" border="0" usemap="#rendservice_8c_a3a79f7a8c69ac9e5daf2dbac5e158fbf_cgraph" alt=""/></div>
<map name="rendservice_8c_a3a79f7a8c69ac9e5daf2dbac5e158fbf_cgraph" id="rendservice_8c_a3a79f7a8c69ac9e5daf2dbac5e158fbf_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a2a5f687763115d7c79f977a0abfddaff" title="crypto_pk_free" alt="" coords="235,5,343,32"/>
<area shape="rect" id="node3" href="crypto_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="249,56,328,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_a3a79f7a8c69ac9e5daf2dbac5e158fbf_icgraph.png" border="0" usemap="#rendservice_8c_a3a79f7a8c69ac9e5daf2dbac5e158fbf_icgraph" alt=""/></div>
<map name="rendservice_8c_a3a79f7a8c69ac9e5daf2dbac5e158fbf_icgraph" id="rendservice_8c_a3a79f7a8c69ac9e5daf2dbac5e158fbf_icgraph">
<area shape="rect" id="node2" href="rendservice_8c.html#a8cd5cb06a8e03c07ed7d120f90cee388" title="rend_service_free" alt="" coords="235,5,360,32"/>
<area shape="rect" id="node3" href="rendservice_8h.html#ade90973329e24160017a04e0503397bd" title="rend_service_free_all" alt="" coords="408,5,553,32"/>
</map>
</div>

</div>
</div>
<a id="a7094d871cb7d82c4afce315145e68ee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7094d871cb7d82c4afce315145e68ee2">&#9670;&nbsp;</a></span>rend_config_services()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_config_services </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>validate_only</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set up rend_service_list, based on the values of HiddenServiceDir and HiddenServicePort in <b>options</b>. Return 0 on success and -1 on failure. (If <b>validate_only</b> is set, parse, warn and return as normal, but don't actually change the configured services.) </p>

</div>
</div>
<a id="a5acc6e47c3276ba3b13c64a1506047d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5acc6e47c3276ba3b13c64a1506047d0">&#9670;&nbsp;</a></span>rend_consider_descriptor_republication()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_consider_descriptor_republication </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Consider republication of v2 rendezvous service descriptors that failed previously, but without regenerating descriptor contents. </p>

</div>
</div>
<a id="a4eefb2085950d1a5c417d48058516ccb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eefb2085950d1a5c417d48058516ccb">&#9670;&nbsp;</a></span>rend_consider_services_intro_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_consider_services_intro_points </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For every service, check how many intro points it currently has, and:</p><ul>
<li>Invalidate introdution points based on specific criteria, see remove_invalid_intro_points comments.</li>
<li>Pick new intro points as necessary.</li>
<li>Launch circuits to any new intro points.</li>
</ul>
<p>This is called once a second by the main loop. </p>

</div>
</div>
<a id="a2f0a362081b41cf5a76662dc51bfb919"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f0a362081b41cf5a76662dc51bfb919">&#9670;&nbsp;</a></span>rend_consider_services_upload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_consider_services_upload </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Regenerate and upload rendezvous service descriptors for all services, if necessary. If the descriptor has been dirty enough for long enough, definitely upload; else only upload when the periodic timeout has expired.</p>
<p>For the first upload, pick a random time between now and two periods from now, and pick it independently for each service. </p>

</div>
</div>
<a id="ac44e79078bc122e1f77d770919baffa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac44e79078bc122e1f77d770919baffa3">&#9670;&nbsp;</a></span>rend_hsdir_routers_changed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_hsdir_routers_changed </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when our internal view of the directory has changed, so that we might have router descriptors of hidden service directories available that we did not have before. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_ac44e79078bc122e1f77d770919baffa3_icgraph.png" border="0" usemap="#rendservice_8c_ac44e79078bc122e1f77d770919baffa3_icgraph" alt=""/></div>
<map name="rendservice_8c_ac44e79078bc122e1f77d770919baffa3_icgraph" id="rendservice_8c_ac44e79078bc122e1f77d770919baffa3_icgraph">
<area shape="rect" id="node2" href="nodelist_8h.html#a32099caf417dbc0e15ea398b1bc2ea16" title="router_dir_info_changed" alt="" coords="183,71,343,98"/>
<area shape="rect" id="node3" href="networkstatus_8h.html#afcfacad25b94db6f21e0df2f7897a3cf" title="routers_update_status\l_from_consensus_networkstatus" alt="" coords="391,5,605,47"/>
<area shape="rect" id="node5" href="routerlist_8h.html#a8c328828cd94c3bb84044c9003f8c78f" title="routerlist_remove" alt="" coords="437,71,559,98"/>
<area shape="rect" id="node6" href="routerlist_8h.html#a9bd4c9992a1cf27e95e2829ae40c7b79" title="dir_server_add" alt="" coords="445,122,551,149"/>
<area shape="rect" id="node4" href="routerlist_8h.html#ae08c5697c58be20a7bb11b34ca9aba5e" title="router_load_routers\l_from_string" alt="" coords="653,5,787,47"/>
</map>
</div>

</div>
</div>
<a id="af8f00f019a925a0202d313aa9b19e918"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8f00f019a925a0202d313aa9b19e918">&#9670;&nbsp;</a></span>rend_service_add_ephemeral()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rendservice_8h.html#acb105e3bbdf6bdfbc2d58a0a66e942ef">rend_service_add_ephemeral_status_t</a> rend_service_add_ephemeral </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>ports</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_streams_per_circuit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_streams_close_circuit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="or_8h.html#aafc6920f8a16e10f46703e7819795c74">rend_auth_type_t</a>&#160;</td>
          <td class="paramname"><em>auth_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>auth_clients</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>service_id_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add the ephemeral service <b>pk</b>/<b>ports</b> if possible, using client authorization <b>auth_type</b> and an optional list of <a class="el" href="structrend__authorized__client__t.html">rend_authorized_client_t</a> in <b>auth_clients</b>, with <b>max_streams_per_circuit</b> streams allowed per rendezvous circuit, and circuit closure on max streams being exceeded set by <b>max_streams_close_circuit</b>.</p>
<p>Ownership of pk, ports, and auth_clients is passed to this routine. Regardless of success/failure, callers should not touch these values after calling this routine, and may assume that correct cleanup has been done on failure.</p>
<p>Return an appropriate rend_service_add_ephemeral_status_t. </p>

</div>
</div>
<a id="acf64fba57452d31d318fcf304b160be9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf64fba57452d31d318fcf304b160be9">&#9670;&nbsp;</a></span>rend_service_begin_parse_intro()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rend_intro_cell_t* rend_service_begin_parse_intro </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>request_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>err_msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse an INTRODUCE1 or INTRODUCE2 cell into a newly allocated rend_intro_cell_t structure. Free it with <a class="el" href="rendservice_8c.html#ab1e1ab28c3798f2915cd7520110b37a1">rend_service_free_intro()</a> when finished. The type parameter should be 1 or 2 to indicate whether this is INTRODUCE1 or INTRODUCE2. This parses only the non-encrypted parts; after this, call <a class="el" href="rendservice_8c.html#a96f99a75046c61a5d1477055b53a776c">rend_service_decrypt_intro()</a> with a key, then <a class="el" href="rendservice_8c.html#a1d9a3e309d3b6ee6683f33f9079b913e">rend_service_parse_intro_plaintext()</a> to finish parsing. The optional err_msg_out parameter is set to a string suitable for log output if parsing fails. This function does some validation, but only that which depends solely on the contents of the cell and the key; it can be unit-tested. Further validation is done in rend_service_validate_intro(). </p>

</div>
</div>
<a id="a96f99a75046c61a5d1477055b53a776c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96f99a75046c61a5d1477055b53a776c">&#9670;&nbsp;</a></span>rend_service_decrypt_intro()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_decrypt_intro </td>
          <td>(</td>
          <td class="paramtype">rend_intro_cell_t *&#160;</td>
          <td class="paramname"><em>intro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>err_msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt the encrypted part of an INTRODUCE1 or INTRODUCE2 cell, return 0 if successful, or &lt; 0 and write an error message to *err_msg_out if provided. </p>

</div>
</div>
<a id="a9adfef842de9b8aec233a9046b9faeb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9adfef842de9b8aec233a9046b9faeb2">&#9670;&nbsp;</a></span>rend_service_del_ephemeral()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_del_ephemeral </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>service_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove the ephemeral service <b>service_id</b> if possible. Returns 0 on success, and -1 on failure. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_a9adfef842de9b8aec233a9046b9faeb2_cgraph.png" border="0" usemap="#rendservice_8c_a9adfef842de9b8aec233a9046b9faeb2_cgraph" alt=""/></div>
<map name="rendservice_8c_a9adfef842de9b8aec233a9046b9faeb2_cgraph" id="rendservice_8c_a9adfef842de9b8aec233a9046b9faeb2_cgraph">
<area shape="rect" id="node2" href="rendcommon_8c.html#a4c98beed11b35d28c3e8fe8249d027c5" title="rend_valid_service_id" alt="" coords="240,5,387,32"/>
</map>
</div>

</div>
</div>
<a id="a997bb861be2c92a31dce6015dd5195fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a997bb861be2c92a31dce6015dd5195fc">&#9670;&nbsp;</a></span>rend_service_desc_has_uploaded()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_desc_has_uploaded </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structrend__data__t.html">rend_data_t</a> *&#160;</td>
          <td class="paramname"><em>rend_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A new descriptor has been successfully uploaded for the given <b>rend_data</b>. Remove and free the expiring nodes from the associated service. </p>

</div>
</div>
<a id="aca6ff2c7eb35e708f23676059431fa27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca6ff2c7eb35e708f23676059431fa27">&#9670;&nbsp;</a></span>rend_service_dump_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_dump_stats </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log the status of introduction points for all rendezvous services at log severity <b>severity</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_aca6ff2c7eb35e708f23676059431fa27_cgraph.png" border="0" usemap="#rendservice_8c_aca6ff2c7eb35e708f23676059431fa27_cgraph" alt=""/></div>
<map name="rendservice_8c_aca6ff2c7eb35e708f23676059431fa27_cgraph" id="rendservice_8c_aca6ff2c7eb35e708f23676059431fa27_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="247,5,308,32"/>
<area shape="rect" id="node3" href="config_8c.html#a7e31046631b0cc0f5d01c8d411b886e6" title="safe_str_client" alt="" coords="224,56,331,83"/>
</map>
</div>

</div>
</div>
<a id="a8cd5cb06a8e03c07ed7d120f90cee388"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cd5cb06a8e03c07ed7d120f90cee388">&#9670;&nbsp;</a></span>rend_service_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void rend_service_free </td>
          <td>(</td>
          <td class="paramtype">rend_service_t *&#160;</td>
          <td class="paramname"><em>service</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release the storage held by <b>service</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_a8cd5cb06a8e03c07ed7d120f90cee388_cgraph.png" border="0" usemap="#rendservice_8c_a8cd5cb06a8e03c07ed7d120f90cee388_cgraph" alt=""/></div>
<map name="rendservice_8c_a8cd5cb06a8e03c07ed7d120f90cee388_cgraph" id="rendservice_8c_a8cd5cb06a8e03c07ed7d120f90cee388_cgraph">
<area shape="rect" id="node2" href="rendservice_8c.html#a63aef3c4d372dc9252de8d1a082bc6b2" title="rend_service_port_config_free" alt="" coords="179,5,375,32"/>
<area shape="rect" id="node3" href="crypto_8c.html#a2a5f687763115d7c79f977a0abfddaff" title="crypto_pk_free" alt="" coords="783,208,891,235"/>
<area shape="rect" id="node4" href="rendcommon_8c.html#a61dd29c390c943442cdd965fa9a31916" title="rend_intro_point_free" alt="" coords="423,259,565,285"/>
<area shape="rect" id="node6" href="replaycache_8c.html#a3820bca2b83e616483e752d3e5adfd92" title="replaycache_free" alt="" coords="613,157,735,184"/>
<area shape="rect" id="node7" href="rendcommon_8c.html#a91927fc14b63a83089d9b0ee22184498" title="rend_service_descriptor_free" alt="" coords="182,309,371,336"/>
<area shape="rect" id="node8" href="rendservice_8c.html#a3a79f7a8c69ac9e5daf2dbac5e158fbf" title="rend_authorized_client_free" alt="" coords="186,157,367,184"/>
<area shape="rect" id="node5" href="circuitbuild_8c.html#a2ee63ec586b7d4f06830954b9aefb037" title="extend_info_free" alt="" coords="615,259,733,285"/>
<area shape="rect" id="node9" href="crypto_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="455,157,533,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_a8cd5cb06a8e03c07ed7d120f90cee388_icgraph.png" border="0" usemap="#rendservice_8c_a8cd5cb06a8e03c07ed7d120f90cee388_icgraph" alt=""/></div>
<map name="rendservice_8c_a8cd5cb06a8e03c07ed7d120f90cee388_icgraph" id="rendservice_8c_a8cd5cb06a8e03c07ed7d120f90cee388_icgraph">
<area shape="rect" id="node2" href="rendservice_8h.html#ade90973329e24160017a04e0503397bd" title="rend_service_free_all" alt="" coords="179,5,324,32"/>
</map>
</div>

</div>
</div>
<a id="ade90973329e24160017a04e0503397bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade90973329e24160017a04e0503397bd">&#9670;&nbsp;</a></span>rend_service_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all the storage held in rend_service_list. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_ade90973329e24160017a04e0503397bd_cgraph.png" border="0" usemap="#rendservice_8c_ade90973329e24160017a04e0503397bd_cgraph" alt=""/></div>
<map name="rendservice_8c_ade90973329e24160017a04e0503397bd_cgraph" id="rendservice_8c_ade90973329e24160017a04e0503397bd_cgraph">
<area shape="rect" id="node2" href="rendservice_8c.html#a8cd5cb06a8e03c07ed7d120f90cee388" title="rend_service_free" alt="" coords="199,183,324,209"/>
<area shape="rect" id="node3" href="rendservice_8c.html#a63aef3c4d372dc9252de8d1a082bc6b2" title="rend_service_port_config_free" alt="" coords="372,5,568,32"/>
<area shape="rect" id="node4" href="crypto_8c.html#a2a5f687763115d7c79f977a0abfddaff" title="crypto_pk_free" alt="" coords="976,208,1084,235"/>
<area shape="rect" id="node5" href="rendcommon_8c.html#a61dd29c390c943442cdd965fa9a31916" title="rend_intro_point_free" alt="" coords="616,259,759,285"/>
<area shape="rect" id="node7" href="replaycache_8c.html#a3820bca2b83e616483e752d3e5adfd92" title="replaycache_free" alt="" coords="807,157,928,184"/>
<area shape="rect" id="node8" href="rendcommon_8c.html#a91927fc14b63a83089d9b0ee22184498" title="rend_service_descriptor_free" alt="" coords="375,309,565,336"/>
<area shape="rect" id="node9" href="rendservice_8c.html#a3a79f7a8c69ac9e5daf2dbac5e158fbf" title="rend_authorized_client_free" alt="" coords="379,157,561,184"/>
<area shape="rect" id="node6" href="circuitbuild_8c.html#a2ee63ec586b7d4f06830954b9aefb037" title="extend_info_free" alt="" coords="808,259,927,285"/>
<area shape="rect" id="node10" href="crypto_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="648,157,727,184"/>
</map>
</div>

</div>
</div>
<a id="ab1e1ab28c3798f2915cd7520110b37a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1e1ab28c3798f2915cd7520110b37a1">&#9670;&nbsp;</a></span>rend_service_free_intro()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_free_intro </td>
          <td>(</td>
          <td class="paramtype">rend_intro_cell_t *&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free a parsed INTRODUCE1 or INTRODUCE2 cell that was allocated by rend_service_parse_intro(). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_ab1e1ab28c3798f2915cd7520110b37a1_cgraph.png" border="0" usemap="#rendservice_8c_ab1e1ab28c3798f2915cd7520110b37a1_cgraph" alt=""/></div>
<map name="rendservice_8c_ab1e1ab28c3798f2915cd7520110b37a1_cgraph" id="rendservice_8c_ab1e1ab28c3798f2915cd7520110b37a1_cgraph">
<area shape="rect" id="node2" href="crypto_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="231,5,309,32"/>
<area shape="rect" id="node3" href="circuitbuild_8c.html#a2ee63ec586b7d4f06830954b9aefb037" title="extend_info_free" alt="" coords="211,56,329,83"/>
<area shape="rect" id="node4" href="crypto_8c.html#a2a5f687763115d7c79f977a0abfddaff" title="crypto_pk_free" alt="" coords="377,56,485,83"/>
</map>
</div>

</div>
</div>
<a id="ac20565d148fc4643343b5bc7e691d7d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac20565d148fc4643343b5bc7e691d7d2">&#9670;&nbsp;</a></span>rend_service_intro_established()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_intro_established </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circuit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>request_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we get an INTRO_ESTABLISHED cell; mark the circuit as a live introduction point, and note that the service descriptor is now out-of-date. </p>

</div>
</div>
<a id="aa80ac6037ad40cfd37531cc52d11a11f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa80ac6037ad40cfd37531cc52d11a11f">&#9670;&nbsp;</a></span>rend_service_intro_has_opened()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_intro_has_opened </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circuit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we're done building a circuit to an introduction point: sends a RELAY_ESTABLISH_INTRO cell. </p>

</div>
</div>
<a id="a7b9ee2cd47bd85d48fd2ef88dcc93334"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b9ee2cd47bd85d48fd2ef88dcc93334">&#9670;&nbsp;</a></span>rend_service_load_all_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_load_all_keys </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>service_list</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load and/or generate private keys for all hidden services, possibly including keys for client authorization. If a <b>service_list</b> is provided, treat it as the list of hidden services (used in unittests). Otherwise, require that rend_service_list is not NULL. Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="a1d9a3e309d3b6ee6683f33f9079b913e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d9a3e309d3b6ee6683f33f9079b913e">&#9670;&nbsp;</a></span>rend_service_parse_intro_plaintext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_parse_intro_plaintext </td>
          <td>(</td>
          <td class="paramtype">rend_intro_cell_t *&#160;</td>
          <td class="paramname"><em>intro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>err_msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse the plaintext of the encrypted part of an INTRODUCE1 or INTRODUCE2 cell, return 0 if successful, or &lt; 0 and write an error message to *err_msg_out if provided. </p>
<p>The rendezvous cookie and Diffie-Hellman stuff are version-invariant and at the end of the plaintext of the encrypted part of the cell.</p>

</div>
</div>
<a id="af1afe7b7400e5a9774ed1b43b7c60c51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1afe7b7400e5a9774ed1b43b7c60c51">&#9670;&nbsp;</a></span>rend_service_parse_port_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrend__service__port__config__s.html">rend_service_port_config_t</a>* rend_service_parse_port_config </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>sep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>err_msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parses a real-port to virtual-port mapping separated by the provided separator and returns a new rend_service_port_config_t, or NULL and an optional error string on failure.</p>
<p>The format is: VirtualPort SEP (IP|RealPort|IP:RealPort|'socket':path)?</p>
<p>IP defaults to 127.0.0.1; RealPort defaults to VirtualPort. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_af1afe7b7400e5a9774ed1b43b7c60c51_cgraph.png" border="0" usemap="#rendservice_8c_af1afe7b7400e5a9774ed1b43b7c60c51_cgraph" alt=""/></div>
<map name="rendservice_8c_af1afe7b7400e5a9774ed1b43b7c60c51_cgraph" id="rendservice_8c_af1afe7b7400e5a9774ed1b43b7c60c51_cgraph">
<area shape="rect" id="node2" href="container_8c.html#a1d75cac5583c66900c032ba972ffabc8" title="smartlist_split_string" alt="" coords="188,13,331,39"/>
</map>
</div>

</div>
</div>
<a id="ac5402d8d70dfb781694cb76d390beec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5402d8d70dfb781694cb76d390beec0">&#9670;&nbsp;</a></span>rend_service_poison_new_single_onion_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int rend_service_poison_new_single_onion_dir </td>
          <td>(</td>
          <td class="paramtype">const rend_service_t *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We just got launched in Single Onion Mode. That's a non-anoymous mode for hidden services. If s is new, we should mark its hidden service directory appropriately so that it is never launched as a location-private hidden service. (New directories don't have private key files.) Return 0 on success, -1 on fail. </p>

</div>
</div>
<a id="a63aef3c4d372dc9252de8d1a082bc6b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63aef3c4d372dc9252de8d1a082bc6b2">&#9670;&nbsp;</a></span>rend_service_port_config_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_port_config_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrend__service__port__config__s.html">rend_service_port_config_t</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release all storage held in a rend_service_port_config_t. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rendservice_8c_a63aef3c4d372dc9252de8d1a082bc6b2_icgraph.png" border="0" usemap="#rendservice_8c_a63aef3c4d372dc9252de8d1a082bc6b2_icgraph" alt=""/></div>
<map name="rendservice_8c_a63aef3c4d372dc9252de8d1a082bc6b2_icgraph" id="rendservice_8c_a63aef3c4d372dc9252de8d1a082bc6b2_icgraph">
<area shape="rect" id="node2" href="rendservice_8c.html#a8cd5cb06a8e03c07ed7d120f90cee388" title="rend_service_free" alt="" coords="249,5,375,32"/>
<area shape="rect" id="node3" href="rendservice_8h.html#ade90973329e24160017a04e0503397bd" title="rend_service_free_all" alt="" coords="423,5,568,32"/>
</map>
</div>

</div>
</div>
<a id="a6a060371417948bb0cc60be0840ed451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a060371417948bb0cc60be0840ed451">&#9670;&nbsp;</a></span>rend_service_receive_introduction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_receive_introduction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circuit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>request_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Respond to an INTRODUCE2 cell by launching a circuit to the chosen rendezvous point. </p>

</div>
</div>
<a id="a6aaefddc359725fc37dddb646455fee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aaefddc359725fc37dddb646455fee2">&#9670;&nbsp;</a></span>rend_service_relaunch_rendezvous()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_relaunch_rendezvous </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>oldcirc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called when we fail building a rendezvous circuit at some point other than the last hop: launches a new circuit to the same rendezvous point. </p>

</div>
</div>
<a id="a1cfdd77e4e98bf6ea995a2e7224a6e83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cfdd77e4e98bf6ea995a2e7224a6e83">&#9670;&nbsp;</a></span>rend_service_rendezvous_has_opened()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_service_rendezvous_has_opened </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circuit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Called once a circuit to a rendezvous point is established: sends a RELAY_COMMAND_RENDEZVOUS1 cell. </p>

</div>
</div>
<a id="af48c9430694146323aad65c330fd9cb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af48c9430694146323aad65c330fd9cb2">&#9670;&nbsp;</a></span>rend_service_set_connection_addr_port()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_set_connection_addr_port </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structedge__connection__t.html">edge_connection_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structorigin__circuit__t.html">origin_circuit_t</a> *&#160;</td>
          <td class="paramname"><em>circ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given <b>conn</b>, a rendezvous exit stream, look up the hidden service for 'circ', and look up the port and address based on conn-&gt;port. Assign the actual conn-&gt;addr and conn-&gt;port. Return -2 on failure for which the circuit should be closed, -1 on other failure, or 0 for success. </p>

</div>
</div>
<a id="a9c45ef372f52fd082bc4dc9547ff4c7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c45ef372f52fd082bc4dc9547ff4c7f">&#9670;&nbsp;</a></span>rend_service_validate_intro_late()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rend_service_validate_intro_late </td>
          <td>(</td>
          <td class="paramtype">const rend_intro_cell_t *&#160;</td>
          <td class="paramname"><em>intro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>err_msg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Do validity checks on a parsed intro cell after decryption; some of these are not done in <a class="el" href="rendservice_8c.html#a1d9a3e309d3b6ee6683f33f9079b913e">rend_service_parse_intro_plaintext()</a> itself because they depend on a lot of other state and would make it hard to unit test. Returns &gt;= 0 if successful or &lt; 0 if the intro cell is invalid, and optionally writes out an error message for logging. If an err_msg pointer is provided, it is the caller's responsibility to free any provided message. </p>

</div>
</div>
<a id="a2925d59d4cd16a1b1f5b0ffc9e23ab7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2925d59d4cd16a1b1f5b0ffc9e23ab7b">&#9670;&nbsp;</a></span>rend_service_verify_single_onion_poison()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC int rend_service_verify_single_onion_poison </td>
          <td>(</td>
          <td class="paramtype">const rend_service_t *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structor__options__t.html">or_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check the single onion service poison state of the directory for s:</p><ul>
<li>If the service is poisoned, and we are in Single Onion Mode, return 0,</li>
<li>If the service is not poisoned, and we are not in Single Onion Mode, return 0,</li>
<li>Otherwise, the poison state is invalid: the service was created in one mode, and is being used in the other, return -1. Hidden service directories without keys are always considered consistent. They will be poisoned after their directory is created (if needed). </li>
</ul>

</div>
</div>
<a id="a5cbc34ae661d9ebfa9dae965021661ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cbc34ae661d9ebfa9dae965021661ef">&#9670;&nbsp;</a></span>rend_services_add_filenames_to_lists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rend_services_add_filenames_to_lists </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>open_lst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsmartlist__t.html">smartlist_t</a> *&#160;</td>
          <td class="paramname"><em>stat_lst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add to <b>open_lst</b> every filename used by a configured hidden service, and to <b>stat_lst</b> every directory used by a configured hidden service </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
