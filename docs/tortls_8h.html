<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tor: /home/user/_my/code/bwauth-related/tor/src/common/tortls.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tor
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97b64286d42c5ef1697cb5f17129db19.html">tor</a></li><li class="navelem"><a class="el" href="dir_3cb0ba3f4b82dbe34a1a06276e96bc8d.html">src</a></li><li class="navelem"><a class="el" href="dir_b7e1585941a202f53e5249c42015d573.html">common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tortls.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Headers for <a class="el" href="tortls_8c.html" title="Wrapper functions to present a consistent interface to TLS, SSL, and X.509 functions from OpenSSL...">tortls.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="crypto__rsa_8h_source.html">crypto_rsa.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="compat__openssl_8h_source.html">compat_openssl.h</a>&quot;</code><br />
<code>#include &quot;compat.h&quot;</code><br />
<code>#include &quot;testsupport.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for tortls.h:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2tortls_8h" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2tortls_8h" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2tortls_8h">
<area shape="rect" id="node2" href="crypto__rsa_8h.html" title="Headers for crypto_rsa.c. " alt="" coords="342,109,437,136"/>
<area shape="rect" id="node10" href="compat_8h_source.html" title="compat.h" alt="" coords="377,483,453,509"/>
<area shape="rect" id="node11" href="testsupport_8h_source.html" title="testsupport.h" alt="" coords="245,632,344,659"/>
<area shape="rect" id="node21" href="compat__openssl_8h.html" title="compatibility definitions for working with different openssl forks " alt="" coords="1337,184,1465,211"/>
<area shape="rect" id="node3" href="orconfig_8h_source.html" title="orconfig.h" alt="" coords="709,707,787,733"/>
<area shape="rect" id="node4" href="crypto__digest_8h.html" title="Headers for crypto_digest.c. " alt="" coords="1054,184,1165,211"/>
<area shape="rect" id="node7" href="util_8h.html" title="Headers for util.c. " alt="" coords="879,333,929,360"/>
<area shape="rect" id="node8" href="torint_8h.html" title="Header file to define uint32_t and friends. " alt="" coords="979,632,1042,659"/>
<area shape="rect" id="node20" href="torlog_8h.html" title="Headers for log.c. " alt="" coords="105,408,170,435"/>
<area shape="rect" id="node6" href="container_8h_source.html" title="container.h" alt="" coords="1019,259,1106,285"/>
<area shape="rect" id="node19" href="siphash_8h_source.html" title="siphash.h" alt="" coords="1023,333,1102,360"/>
<area shape="rect" id="node16" href="di__ops_8h.html" title="Headers for di_ops.c. " alt="" coords="833,557,903,584"/>
<area shape="rect" id="node18" href="util__bug_8h.html" title="Macros to manage assertions, fatal and non&#45;fatal. " alt="" coords="633,408,711,435"/>
<area shape="rect" id="node13" href="compat__time_8h.html" title="Functions and types for monotonic times. " alt="" coords="649,632,757,659"/>
<area shape="rect" id="node15" href="compat__threads_8h_source.html" title="compat_threads.h" alt="" coords="579,557,706,584"/>
<area shape="rect" id="node23" href="crypto__openssl__mgt_8h_source.html" title="crypto_openssl_mgt.h" alt="" coords="1493,259,1643,285"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h__dep__incl.png" border="0" usemap="#_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2tortls_8hdep" alt=""/></div>
<map name="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2tortls_8hdep" id="_2home_2user_2__my_2code_2bwauth-related_2tor_2src_2common_2tortls_8hdep">
<area shape="rect" id="node2" href="tortls_8c.html" title="Wrapper functions to present a consistent interface to TLS, SSL, and X.509 functions from OpenSSL..." alt="" coords="2181,109,2329,165"/>
<area shape="rect" id="node3" href="or_8h.html" title="Master header file for Tor&#45;specific functionality. " alt="" coords="2353,109,2501,165"/>
<area shape="rect" id="node4" href="addressmap_8c.html" title="The addressmap module manages the processes by which we rewrite addresses in client requess..." alt="" coords="5,221,153,277"/>
<area shape="rect" id="node5" href="bridges_8c.html" title="Code to manage bridges and bridge selection. " alt="" coords="177,221,325,277"/>
<area shape="rect" id="node6" href="hs__common_8h.html" title="Header file containing common data for the whole HS subsytem. " alt="" coords="463,339,611,395"/>
<area shape="rect" id="node7" href="circuituse_8c.html" title="Launch the right sort of circuits and attach the right streams to them. " alt="" coords="503,451,651,507"/>
<area shape="rect" id="node8" href="connection_8c.html" title="General high&#45;level functions to handle reading and writing on connections. " alt="" coords="1364,555,1512,611"/>
<area shape="rect" id="node9" href="connection__edge_8c.html" title="Handle edge streams. " alt="" coords="675,451,847,507"/>
<area shape="rect" id="node10" href="control_8c.html" title="Implementation for Tor&#39;s control&#45;socket interface. " alt="" coords="983,555,1131,611"/>
<area shape="rect" id="node11" href="directory_8c.html" title="Code to send and fetch information from directory authorities and caches via HTTP. " alt="" coords="871,451,1019,507"/>
<area shape="rect" id="node12" href="channel_8c.html" title="OR/OP&#45;to&#45;OR channel abstraction layer. A channel&#39;s job is to transfer cells from Tor instance to Tor ..." alt="" coords="2129,555,2277,611"/>
<area shape="rect" id="node13" href="channel_8h.html" title="Header file for channel.c. " alt="" coords="2353,339,2501,395"/>
<area shape="rect" id="node14" href="channeltls_8h.html" title="Header file for channeltls.c. " alt="" coords="1744,451,1892,507"/>
<area shape="rect" id="node15" href="channeltls_8c.html" title="A concrete subclass of channel_t using or_connection_t to transfer cells between Tor instances..." alt="" coords="3501,555,3649,611"/>
<area shape="rect" id="node16" href="connection__or_8c.html" title="Functions to handle OR connections, TLS handshaking, and cells on the network. " alt="" coords="2538,555,2693,611"/>
<area shape="rect" id="node17" href="dirserv_8c.html" title="Directory server core implementation. Manages directory contents and generates directories. " alt="" coords="1688,555,1836,611"/>
<area shape="rect" id="node18" href="scheduler_8h.html" title="Header file for scheduler*.c. " alt="" coords="2841,451,2989,507"/>
<area shape="rect" id="node19" href="config_8c.html" title="Code to interpret the user&#39;s configuration of Tor. " alt="" coords="3203,555,3351,611"/>
<area shape="rect" id="node20" href="circpathbias_8c.html" title="Code to track success/failure rates of circuits built through different tor nodes, in an attempt to detect attacks where an attacker deliberately causes circuits to fail until the client choses a path they like. " alt="" coords="2019,451,2167,507"/>
<area shape="rect" id="node21" href="circuitbuild_8c.html" title="Implements the details of building circuits (by chosing paths, constructing/sending create/extend cel..." alt="" coords="4017,451,4165,507"/>
<area shape="rect" id="node22" href="circuitlist_8c.html" title="Manage global structures that list and index circuits, and look up circuits within them..." alt="" coords="1368,451,1516,507"/>
<area shape="rect" id="node23" href="circuitmux_8c.html" title="Circuit mux/cell selection abstraction. " alt="" coords="3340,451,3488,507"/>
<area shape="rect" id="node24" href="command_8c.html" title="Functions for processing incoming cells. " alt="" coords="2191,451,2339,507"/>
<area shape="rect" id="node25" href="cpuworker_8c.html" title="Uses the workqueue/threadpool code to farm CPU&#45;intensive activities out to subprocesses. " alt="" coords="2567,451,2715,507"/>
<area shape="rect" id="node26" href="entrynodes_8c.html" title="Code to manage our fixed first nodes for various functions. " alt="" coords="3065,451,3213,507"/>
<area shape="rect" id="node27" href="circuitmux_8h.html" title="Header file for circuitmux.c. " alt="" coords="3284,221,3432,277"/>
<area shape="rect" id="node28" href="circuitmux__ewma_8h.html" title="Header file for circuitmux_ewma.c. " alt="" coords="3483,339,3659,395"/>
<area shape="rect" id="node29" href="circuitmux__ewma_8c.html" title="EWMA circuit selection as a circuitmux_t policy. " alt="" coords="3766,451,3942,507"/>
<area shape="rect" id="node30" href="rendservice_8h.html" title="Header file for rendservice.c. " alt="" coords="1185,339,1333,395"/>
<area shape="rect" id="node31" href="circuitstats_8c.html" title="Maintains and analyzes statistics about circuit built times, so we can tell how long we may need to w..." alt="" coords="1196,451,1344,507"/>
<area shape="rect" id="node32" href="hs__descriptor_8h.html" title="Header file for hs_descriptor.c. " alt="" coords="4053,221,4205,277"/>
<area shape="rect" id="node33" href="hs__ntor_8h_source.html" title="/home/user/_my/code\l/bwauth&#45;related/tor\l/src/or/hs_ntor.h" alt="" coords="4068,339,4216,395"/>
<area shape="rect" id="node34" href="hs__circuit_8h.html" title="Header file containing circuit data for the whole HS subsytem. " alt="" coords="687,339,835,395"/>
<area shape="rect" id="node35" href="rendcache_8h.html" title="Header file for rendcache.c. " alt="" coords="4229,221,4377,277"/>
<area shape="rect" id="node36" href="hs__config_8h.html" title="Header file containing configuration ABI/API for the HS subsytem. " alt="" coords="3159,339,3307,395"/>
<area shape="rect" id="node37" href="voting__schedule_8h.html" title="Header file for voting_schedule.c. " alt="" coords="1873,221,2041,277"/>
<area shape="rect" id="node38" href="dirvote_8c.html" title="Functions to compute directory consensus, and schedule voting. " alt="" coords="3785,339,3941,395"/>
<area shape="rect" id="node39" href="shared__random_8c.html" title="Functions and data structure needed to accomplish the shared random protocol as defined in proposal #..." alt="" coords="1445,332,1593,403"/>
<area shape="rect" id="node40" href="shared__random__state_8c.html" title="Functions and data structures for the state of the random protocol as defined in proposal #250..." alt="" coords="1771,332,1919,403"/>
<area shape="rect" id="node41" href="confparse_8c.html" title="Back&#45;end for parsing and generating key&#45;value files, used to implement the torrc file format and the ..." alt="" coords="4401,221,4549,277"/>
<area shape="rect" id="node42" href="consdiff_8c.html" title="Consensus diff implementation, including both the generation and the application of diffs in a minima..." alt="" coords="911,339,1059,395"/>
<area shape="rect" id="node43" href="consdiff_8h_source.html" title="/home/user/_my/code\l/bwauth&#45;related/tor\l/src/or/consdiff.h" alt="" coords="860,221,1008,277"/>
<area shape="rect" id="node44" href="shared__random_8h_source.html" title="/home/user/_my/code\l/bwauth&#45;related/tor\l/src/or/dirauth/shared\l_random.h" alt="" coords="1445,213,1593,284"/>
<area shape="rect" id="node45" href="dircollate_8h.html" title="Header file for dircollate.c. " alt="" coords="3656,221,3825,277"/>
<area shape="rect" id="node46" href="dns_8c.html" title="Implements a local cache for DNS results for Tor servers. This is implemented as a wrapper around Ada..." alt="" coords="4573,221,4721,277"/>
<area shape="rect" id="node47" href="dnsserv_8c.html" title="Implements client&#45;side DNS proxy server code. " alt="" coords="4745,221,4893,277"/>
<area shape="rect" id="node48" href="ext__orport_8c.html" title="Code implementing the Extended ORPort. " alt="" coords="4917,221,5065,277"/>
<area shape="rect" id="node49" href="fp__pair_8c.html" title="Manages data structures for associating pairs of fingerprints. Used to handle combinations of identit..." alt="" coords="5089,221,5237,277"/>
<area shape="rect" id="node50" href="geoip_8c.html" title="Functions related to maintaining an IP&#45;to&#45;country database; to summarizing client connections by coun..." alt="" coords="5261,221,5409,277"/>
</map>
</div>
</div>
<p><a href="tortls_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a066c00924a09fe2e3dac408d1881a521"><td class="memItemLeft" align="right" valign="top"><a id="a066c00924a09fe2e3dac408d1881a521"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIN_TOR_TLS_ERROR_VAL_</b>&#160;&#160;&#160;-9</td></tr>
<tr class="separator:a066c00924a09fe2e3dac408d1881a521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b5cc6b2654dae00401e7e9679dedb12"><td class="memItemLeft" align="right" valign="top"><a id="a2b5cc6b2654dae00401e7e9679dedb12"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_ERROR_MISC</b>&#160;&#160;&#160;-9</td></tr>
<tr class="separator:a2b5cc6b2654dae00401e7e9679dedb12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50fa9b7fc5f3e592b10dc3638fe7958f"><td class="memItemLeft" align="right" valign="top"><a id="a50fa9b7fc5f3e592b10dc3638fe7958f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_ERROR_IO</b>&#160;&#160;&#160;-8</td></tr>
<tr class="separator:a50fa9b7fc5f3e592b10dc3638fe7958f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1430bd7fa80ab7b4652d217f3af790ac"><td class="memItemLeft" align="right" valign="top"><a id="a1430bd7fa80ab7b4652d217f3af790ac"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_ERROR_CONNREFUSED</b>&#160;&#160;&#160;-7</td></tr>
<tr class="separator:a1430bd7fa80ab7b4652d217f3af790ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5abd959aca824a041ce3661464a819c3"><td class="memItemLeft" align="right" valign="top"><a id="a5abd959aca824a041ce3661464a819c3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_ERROR_CONNRESET</b>&#160;&#160;&#160;-6</td></tr>
<tr class="separator:a5abd959aca824a041ce3661464a819c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fe84e34000e2821bb1bfba4a9adafe3"><td class="memItemLeft" align="right" valign="top"><a id="a0fe84e34000e2821bb1bfba4a9adafe3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_ERROR_NO_ROUTE</b>&#160;&#160;&#160;-5</td></tr>
<tr class="separator:a0fe84e34000e2821bb1bfba4a9adafe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d68693137d26a505483478077a2d7e2"><td class="memItemLeft" align="right" valign="top"><a id="a3d68693137d26a505483478077a2d7e2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_ERROR_TIMEOUT</b>&#160;&#160;&#160;-4</td></tr>
<tr class="separator:a3d68693137d26a505483478077a2d7e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2daac2a160809291ab8928c00f9506fb"><td class="memItemLeft" align="right" valign="top"><a id="a2daac2a160809291ab8928c00f9506fb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_CLOSE</b>&#160;&#160;&#160;-3</td></tr>
<tr class="separator:a2daac2a160809291ab8928c00f9506fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16f08209ae0f5f2caf5d1bf554f185d2"><td class="memItemLeft" align="right" valign="top"><a id="a16f08209ae0f5f2caf5d1bf554f185d2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_WANTREAD</b>&#160;&#160;&#160;-2</td></tr>
<tr class="separator:a16f08209ae0f5f2caf5d1bf554f185d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76800e3b80964672451209e8ded98b5d"><td class="memItemLeft" align="right" valign="top"><a id="a76800e3b80964672451209e8ded98b5d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_WANTWRITE</b>&#160;&#160;&#160;-1</td></tr>
<tr class="separator:a76800e3b80964672451209e8ded98b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73c2c729f9f5eba18b52a67c66a247b6"><td class="memItemLeft" align="right" valign="top"><a id="a73c2c729f9f5eba18b52a67c66a247b6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_DONE</b>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a73c2c729f9f5eba18b52a67c66a247b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa557c11767c0a98cbd3980f96164c010"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#aa557c11767c0a98cbd3980f96164c010">CASE_TOR_TLS_ERROR_ANY_NONIO</a></td></tr>
<tr class="separator:aa557c11767c0a98cbd3980f96164c010"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8738263daa338998ad20c7d6810d7f0d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a8738263daa338998ad20c7d6810d7f0d">CASE_TOR_TLS_ERROR_ANY</a></td></tr>
<tr class="separator:a8738263daa338998ad20c7d6810d7f0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a542824e442cb64c903d6ffde614a3340"><td class="memItemLeft" align="right" valign="top"><a id="a542824e442cb64c903d6ffde614a3340"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_IS_ERROR</b>(rv)&#160;&#160;&#160;((rv) &lt; TOR_TLS_CLOSE)</td></tr>
<tr class="separator:a542824e442cb64c903d6ffde614a3340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d868a5c1fa4881104c1bf3535de2ff3"><td class="memItemLeft" align="right" valign="top"><a id="a5d868a5c1fa4881104c1bf3535de2ff3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_CTX_IS_PUBLIC_SERVER</b>&#160;&#160;&#160;(1u&lt;&lt;0)</td></tr>
<tr class="separator:a5d868a5c1fa4881104c1bf3535de2ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a531a3d69b1b2f355240980a3a4423b3a"><td class="memItemLeft" align="right" valign="top"><a id="a531a3d69b1b2f355240980a3a4423b3a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_CTX_USE_ECDHE_P256</b>&#160;&#160;&#160;(1u&lt;&lt;1)</td></tr>
<tr class="separator:a531a3d69b1b2f355240980a3a4423b3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37c4e1ca48ec420cd2b55a80c9a7da70"><td class="memItemLeft" align="right" valign="top"><a id="a37c4e1ca48ec420cd2b55a80c9a7da70"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TOR_TLS_CTX_USE_ECDHE_P224</b>&#160;&#160;&#160;(1u&lt;&lt;2)</td></tr>
<tr class="separator:a37c4e1ca48ec420cd2b55a80c9a7da70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a464540e11d403a1f95269eebfcd7b60f"><td class="memItemLeft" align="right" valign="top"><a id="a464540e11d403a1f95269eebfcd7b60f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>tor_tls_free</b>(tls)&#160;&#160;&#160;FREE_AND_NULL(tor_tls_t, <a class="el" href="tortls_8h.html#a6f5a528cdb3b8cb9ce04b40bb899dbeb">tor_tls_free_</a>, (tls))</td></tr>
<tr class="separator:a464540e11d403a1f95269eebfcd7b60f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3e478ce523f4a34c57d21514ae385b4"><td class="memItemLeft" align="right" valign="top"><a id="ab3e478ce523f4a34c57d21514ae385b4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>check_no_tls_errors</b>()&#160;&#160;&#160;<a class="el" href="tortls_8h.html#a1289d9a4db6778fc2feee7af5301a203">check_no_tls_errors_</a>(__FILE__,__LINE__)</td></tr>
<tr class="separator:ab3e478ce523f4a34c57d21514ae385b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a155deeda561e5dba9fbe2a25c979b5d6"><td class="memItemLeft" align="right" valign="top"><a id="a155deeda561e5dba9fbe2a25c979b5d6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>tor_x509_cert_free</b>(c)&#160;&#160;&#160;FREE_AND_NULL(tor_x509_cert_t, <a class="el" href="tortls_8h.html#af396dc12cfe27527a145727f28bbbe62">tor_x509_cert_free_</a>, (c))</td></tr>
<tr class="separator:a155deeda561e5dba9fbe2a25c979b5d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:af07a295582d3f1c9f5446fff98a3a60e"><td class="memItemLeft" align="right" valign="top"><a id="af07a295582d3f1c9f5446fff98a3a60e"></a>
typedef struct tor_tls_t&#160;</td><td class="memItemRight" valign="bottom"><b>tor_tls_t</b></td></tr>
<tr class="separator:af07a295582d3f1c9f5446fff98a3a60e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab33e2c815969840a66f1f1507ae9c217"><td class="memItemLeft" align="right" valign="top"><a id="ab33e2c815969840a66f1f1507ae9c217"></a>
typedef struct tor_x509_cert_t&#160;</td><td class="memItemRight" valign="bottom"><b>tor_x509_cert_t</b></td></tr>
<tr class="separator:ab33e2c815969840a66f1f1507ae9c217"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a01200614cea5495e3bf7ff1b9157811c"><td class="memItemLeft" align="right" valign="top">tor_x509_cert_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a01200614cea5495e3bf7ff1b9157811c">tor_x509_cert_dup</a> (const tor_x509_cert_t *cert)</td></tr>
<tr class="separator:a01200614cea5495e3bf7ff1b9157811c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab51ce122d6957eed72dfad975600bca7"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#ab51ce122d6957eed72dfad975600bca7">tor_tls_err_to_string</a> (int err)</td></tr>
<tr class="separator:ab51ce122d6957eed72dfad975600bca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefdead64da19ca5d4ee7cb9b60a7ab13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#aefdead64da19ca5d4ee7cb9b60a7ab13">tor_tls_get_state_description</a> (tor_tls_t *tls, char *buf, size_t sz)</td></tr>
<tr class="separator:aefdead64da19ca5d4ee7cb9b60a7ab13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8e5980912c517c20c6b90419ef0c3b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#ae8e5980912c517c20c6b90419ef0c3b6">tor_tls_free_all</a> (void)</td></tr>
<tr class="separator:ae8e5980912c517c20c6b90419ef0c3b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b7b628cbb659c7899ef90e58abb559"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a18b7b628cbb659c7899ef90e58abb559">tor_tls_context_init</a> (unsigned flags, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *client_identity, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *server_identity, unsigned int key_lifetime)</td></tr>
<tr class="separator:a18b7b628cbb659c7899ef90e58abb559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeedb5c29cbd438f005c9193056d30f13"><td class="memItemLeft" align="right" valign="top">tor_tls_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#aeedb5c29cbd438f005c9193056d30f13">tor_tls_new</a> (int sock, int is_server)</td></tr>
<tr class="separator:aeedb5c29cbd438f005c9193056d30f13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e67c6afa29e8932b6908f1e21f5124"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#aa0e67c6afa29e8932b6908f1e21f5124">tor_tls_set_logged_address</a> (tor_tls_t *tls, const char *address)</td></tr>
<tr class="separator:aa0e67c6afa29e8932b6908f1e21f5124"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5823cfa710f0f7987d09dfececae28d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a5823cfa710f0f7987d09dfececae28d0">tor_tls_set_renegotiate_callback</a> (tor_tls_t *tls, void(*cb)(tor_tls_t *, void *arg), void *arg)</td></tr>
<tr class="separator:a5823cfa710f0f7987d09dfececae28d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89dbecf04240626af4b070b1b83c9f56"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a89dbecf04240626af4b070b1b83c9f56">tor_tls_is_server</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a89dbecf04240626af4b070b1b83c9f56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f5a528cdb3b8cb9ce04b40bb899dbeb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a6f5a528cdb3b8cb9ce04b40bb899dbeb">tor_tls_free_</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a6f5a528cdb3b8cb9ce04b40bb899dbeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13025f3a8714b2c00a7b7d0842fc5694"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a13025f3a8714b2c00a7b7d0842fc5694">tor_tls_peer_has_cert</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a13025f3a8714b2c00a7b7d0842fc5694"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b88bad2a294ca519c40a5bc5d731a3e"><td class="memItemLeft" align="right" valign="top"><a id="a3b88bad2a294ca519c40a5bc5d731a3e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MOCK_DECL</b> (tor_x509_cert_t *, tor_tls_get_peer_cert,(tor_tls_t *tls))</td></tr>
<tr class="separator:a3b88bad2a294ca519c40a5bc5d731a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ee1ba2d2c636556f0644b95c74b1fb"><td class="memItemLeft" align="right" valign="top"><a id="a67ee1ba2d2c636556f0644b95c74b1fb"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MOCK_DECL</b> (tor_x509_cert_t *, tor_tls_get_own_cert,(tor_tls_t *tls))</td></tr>
<tr class="separator:a67ee1ba2d2c636556f0644b95c74b1fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ccf351e10a3f3d0a4b616ee33063fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#af9ccf351e10a3f3d0a4b616ee33063fb">tor_tls_verify</a> (int severity, tor_tls_t *tls, <a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> **identity)</td></tr>
<tr class="separator:af9ccf351e10a3f3d0a4b616ee33063fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7493fe8a822f0ef8d46980439882fbb1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a7493fe8a822f0ef8d46980439882fbb1">tor_tls_check_lifetime</a> (int severity, tor_tls_t *tls, time_t now, int past_tolerance, int future_tolerance)</td></tr>
<tr class="separator:a7493fe8a822f0ef8d46980439882fbb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f561bdbcb7811d5ef0509541fe8a763"><td class="memItemLeft" align="right" valign="top"><a id="a5f561bdbcb7811d5ef0509541fe8a763"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MOCK_DECL</b> (int, tor_tls_read,(tor_tls_t *tls, char *cp, size_t len))</td></tr>
<tr class="separator:a5f561bdbcb7811d5ef0509541fe8a763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f79960ae7a36ce6647ceafd36c7e162"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a5f79960ae7a36ce6647ceafd36c7e162">tor_tls_write</a> (tor_tls_t *tls, const char *cp, size_t n)</td></tr>
<tr class="separator:a5f79960ae7a36ce6647ceafd36c7e162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab228adf4f9dbd0f8739a657ea66f389e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#ab228adf4f9dbd0f8739a657ea66f389e">tor_tls_handshake</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:ab228adf4f9dbd0f8739a657ea66f389e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf727dd8275cc9deb3d1b71c110b8d6e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#abf727dd8275cc9deb3d1b71c110b8d6e">tor_tls_finish_handshake</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:abf727dd8275cc9deb3d1b71c110b8d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2daac9018a16ea061a2429f171c25245"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a2daac9018a16ea061a2429f171c25245">tor_tls_unblock_renegotiation</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a2daac9018a16ea061a2429f171c25245"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08342968552b84d5dfbd6493338f6058"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a08342968552b84d5dfbd6493338f6058">tor_tls_block_renegotiation</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a08342968552b84d5dfbd6493338f6058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d9241115f8182cbdb26be9756f25fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a56d9241115f8182cbdb26be9756f25fb">tor_tls_assert_renegotiation_unblocked</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a56d9241115f8182cbdb26be9756f25fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30918c11f14636a0a5027c76a0ae8498"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a30918c11f14636a0a5027c76a0ae8498">tor_tls_shutdown</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a30918c11f14636a0a5027c76a0ae8498"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeaf421de8fd8d7d4d3bad71272bfc4e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#aaeaf421de8fd8d7d4d3bad71272bfc4e">tor_tls_get_pending_bytes</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:aaeaf421de8fd8d7d4d3bad71272bfc4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc7afb97a99f6f7664a9ced2b8baab54"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#afc7afb97a99f6f7664a9ced2b8baab54">tor_tls_get_forced_write_size</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:afc7afb97a99f6f7664a9ced2b8baab54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2052799333f0e6afd56d3a3fc640d879"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a2052799333f0e6afd56d3a3fc640d879">tor_tls_get_n_raw_bytes</a> (tor_tls_t *tls, size_t *n_read, size_t *n_written)</td></tr>
<tr class="separator:a2052799333f0e6afd56d3a3fc640d879"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fef8380f402b3e300d756a828ba9d56"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a6fef8380f402b3e300d756a828ba9d56">tor_tls_get_buffer_sizes</a> (tor_tls_t *tls, size_t *rbuf_capacity, size_t *rbuf_bytes, size_t *wbuf_capacity, size_t *wbuf_bytes)</td></tr>
<tr class="separator:a6fef8380f402b3e300d756a828ba9d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad27785bd1071242c9a6a87353d88fe4a"><td class="memItemLeft" align="right" valign="top"><a id="ad27785bd1071242c9a6a87353d88fe4a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MOCK_DECL</b> (double, tls_get_write_overhead_ratio,(void))</td></tr>
<tr class="separator:ad27785bd1071242c9a6a87353d88fe4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1df770dd394f7ab33f134583c3385cd0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a1df770dd394f7ab33f134583c3385cd0">tor_tls_used_v1_handshake</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a1df770dd394f7ab33f134583c3385cd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a40e31028963e83e7a7b44199432b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#aa1a40e31028963e83e7a7b44199432b1">tor_tls_get_num_server_handshakes</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:aa1a40e31028963e83e7a7b44199432b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02131f4d24082f726fbc9b93a5adcf50"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a02131f4d24082f726fbc9b93a5adcf50">tor_tls_server_got_renegotiate</a> (tor_tls_t *tls)</td></tr>
<tr class="separator:a02131f4d24082f726fbc9b93a5adcf50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f22b12440a222866db919c2124bd7f6"><td class="memItemLeft" align="right" valign="top"><a id="a4f22b12440a222866db919c2124bd7f6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MOCK_DECL</b> (int, tor_tls_get_tlssecrets,(tor_tls_t *tls, uint8_t *secrets_out))</td></tr>
<tr class="separator:a4f22b12440a222866db919c2124bd7f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cc4f18250c921b5ab2c17e2cb1aa5b9"><td class="memItemLeft" align="right" valign="top"><a id="a4cc4f18250c921b5ab2c17e2cb1aa5b9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MOCK_DECL</b> (int, tor_tls_export_key_material,(tor_tls_t *tls, uint8_t *secrets_out, const uint8_t *context, size_t context_len, const char *label))</td></tr>
<tr class="separator:a4cc4f18250c921b5ab2c17e2cb1aa5b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1289d9a4db6778fc2feee7af5301a203"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a1289d9a4db6778fc2feee7af5301a203">check_no_tls_errors_</a> (const char *fname, int line)</td></tr>
<tr class="separator:a1289d9a4db6778fc2feee7af5301a203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9a5eb99512347313d8f3495168a1501"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#ad9a5eb99512347313d8f3495168a1501">tor_tls_log_one_error</a> (tor_tls_t *tls, unsigned long err, int severity, int domain, const char *doing)</td></tr>
<tr class="separator:ad9a5eb99512347313d8f3495168a1501"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af396dc12cfe27527a145727f28bbbe62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#af396dc12cfe27527a145727f28bbbe62">tor_x509_cert_free_</a> (tor_x509_cert_t *cert)</td></tr>
<tr class="separator:af396dc12cfe27527a145727f28bbbe62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea5999c1b596c9c571889386f8bc508c"><td class="memItemLeft" align="right" valign="top">tor_x509_cert_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#aea5999c1b596c9c571889386f8bc508c">tor_x509_cert_decode</a> (const uint8_t *certificate, size_t certificate_len)</td></tr>
<tr class="separator:aea5999c1b596c9c571889386f8bc508c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae138ea45f150f1291b09f0b5dfa34ad4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#ae138ea45f150f1291b09f0b5dfa34ad4">tor_x509_cert_get_der</a> (const tor_x509_cert_t *cert, const uint8_t **encoded_out, size_t *size_out)</td></tr>
<tr class="separator:ae138ea45f150f1291b09f0b5dfa34ad4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb4713a168234b69a9d25312a3a15770"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structcommon__digests__t.html">common_digests_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#aeb4713a168234b69a9d25312a3a15770">tor_x509_cert_get_id_digests</a> (const tor_x509_cert_t *cert)</td></tr>
<tr class="separator:aeb4713a168234b69a9d25312a3a15770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5904272a0bc1d95951b5a0aa4903cc05"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structcommon__digests__t.html">common_digests_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a5904272a0bc1d95951b5a0aa4903cc05">tor_x509_cert_get_cert_digests</a> (const tor_x509_cert_t *cert)</td></tr>
<tr class="separator:a5904272a0bc1d95951b5a0aa4903cc05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aa93459dd4e3641e885932d682db4a0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a7aa93459dd4e3641e885932d682db4a0">tor_tls_get_my_certs</a> (int server, const tor_x509_cert_t **link_cert_out, const tor_x509_cert_t **id_cert_out)</td></tr>
<tr class="separator:a7aa93459dd4e3641e885932d682db4a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cc46ce9e214e2055861f7cacdfdfca2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a7cc46ce9e214e2055861f7cacdfdfca2">tor_tls_get_my_client_auth_key</a> (void)</td></tr>
<tr class="separator:a7cc46ce9e214e2055861f7cacdfdfca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cdf67e68f80f5bef7c52a5964416024"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a4cdf67e68f80f5bef7c52a5964416024">tor_tls_cert_get_key</a> (tor_x509_cert_t *cert)</td></tr>
<tr class="separator:a4cdf67e68f80f5bef7c52a5964416024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4162be19e90ebed5303ac5274379a595"><td class="memItemLeft" align="right" valign="top"><a id="a4162be19e90ebed5303ac5274379a595"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MOCK_DECL</b> (int, tor_tls_cert_matches_key,(const tor_tls_t *tls, const tor_x509_cert_t *cert))</td></tr>
<tr class="separator:a4162be19e90ebed5303ac5274379a595"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a805d08ed945976a2b66c748073be0abc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a805d08ed945976a2b66c748073be0abc">tor_tls_cert_is_valid</a> (int severity, const tor_x509_cert_t *cert, const tor_x509_cert_t *signing_cert, time_t now, int check_rsa_1024)</td></tr>
<tr class="separator:a805d08ed945976a2b66c748073be0abc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85f7685dfbf617b6b763f3895e1fbade"><td class="memItemLeft" align="right" valign="top"><a id="a85f7685dfbf617b6b763f3895e1fbade"></a>
const char *&#160;</td><td class="memItemRight" valign="bottom"><b>tor_tls_get_ciphersuite_name</b> (tor_tls_t *tls)</td></tr>
<tr class="separator:a85f7685dfbf617b6b763f3895e1fbade"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a479756d042d4e4890e403726e0cb2a5b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tortls_8h.html#a479756d042d4e4890e403726e0cb2a5b">evaluate_ecgroup_for_tls</a> (const char *ecgroup)</td></tr>
<tr class="separator:a479756d042d4e4890e403726e0cb2a5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Headers for <a class="el" href="tortls_8c.html" title="Wrapper functions to present a consistent interface to TLS, SSL, and X.509 functions from OpenSSL...">tortls.c</a>. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a8738263daa338998ad20c7d6810d7f0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8738263daa338998ad20c7d6810d7f0d">&#9670;&nbsp;</a></span>CASE_TOR_TLS_ERROR_ANY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CASE_TOR_TLS_ERROR_ANY</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><a class="code" href="tortls_8h.html#aa557c11767c0a98cbd3980f96164c010">CASE_TOR_TLS_ERROR_ANY_NONIO</a>:                 \</div><div class="line">  case TOR_TLS_ERROR_IO</div><div class="ttc" id="tortls_8h_html_aa557c11767c0a98cbd3980f96164c010"><div class="ttname"><a href="tortls_8h.html#aa557c11767c0a98cbd3980f96164c010">CASE_TOR_TLS_ERROR_ANY_NONIO</a></div><div class="ttdeci">#define CASE_TOR_TLS_ERROR_ANY_NONIO</div><div class="ttdef"><b>Definition:</b> tortls.h:41</div></div>
</div><!-- fragment --><p>Use this macro in a switch statement to catch <em>any</em> TLS error. That way, if more errors are added, your switches will still work. </p>

</div>
</div>
<a id="aa557c11767c0a98cbd3980f96164c010"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa557c11767c0a98cbd3980f96164c010">&#9670;&nbsp;</a></span>CASE_TOR_TLS_ERROR_ANY_NONIO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CASE_TOR_TLS_ERROR_ANY_NONIO</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">case</span> TOR_TLS_ERROR_MISC:                      \</div><div class="line">  case TOR_TLS_ERROR_CONNREFUSED:               \</div><div class="line">  case TOR_TLS_ERROR_CONNRESET:                 \</div><div class="line">  case TOR_TLS_ERROR_NO_ROUTE:                  \</div><div class="line">  case TOR_TLS_ERROR_TIMEOUT</div></div><!-- fragment --><p>Collection of case statements for all TLS errors that are not due to underlying IO failure. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1289d9a4db6778fc2feee7af5301a203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1289d9a4db6778fc2feee7af5301a203">&#9670;&nbsp;</a></span>check_no_tls_errors_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_no_tls_errors_ </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Implement check_no_tls_errors: If there are any pending OpenSSL errors, log an error message. </p>

</div>
</div>
<a id="a479756d042d4e4890e403726e0cb2a5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a479756d042d4e4890e403726e0cb2a5b">&#9670;&nbsp;</a></span>evaluate_ecgroup_for_tls()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int evaluate_ecgroup_for_tls </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ecgroup</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether the ECC group requested is supported by the current OpenSSL library instance. Return 1 if the group is supported, and 0 if not. </p>

</div>
</div>
<a id="a56d9241115f8182cbdb26be9756f25fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56d9241115f8182cbdb26be9756f25fb">&#9670;&nbsp;</a></span>tor_tls_assert_renegotiation_unblocked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_assert_renegotiation_unblocked </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assert that the flags that allow legacy renegotiation are still set </p>

</div>
</div>
<a id="a08342968552b84d5dfbd6493338f6058"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08342968552b84d5dfbd6493338f6058">&#9670;&nbsp;</a></span>tor_tls_block_renegotiation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_block_renegotiation </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If this version of openssl supports it, turn off renegotiation on <b>tls</b>. (Our protocol never requires this for security, but it's nice to use belt-and-suspenders here.) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_a08342968552b84d5dfbd6493338f6058_icgraph.png" border="0" usemap="#tortls_8h_a08342968552b84d5dfbd6493338f6058_icgraph" alt=""/></div>
<map name="tortls_8h_a08342968552b84d5dfbd6493338f6058_icgraph" id="tortls_8h_a08342968552b84d5dfbd6493338f6058_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#aecfd6590f4dd5c079f371e48eb1e09f2" title="connection_or_block\l_renegotiation" alt="" coords="231,5,372,47"/>
</map>
</div>

</div>
</div>
<a id="a4cdf67e68f80f5bef7c52a5964416024"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cdf67e68f80f5bef7c52a5964416024">&#9670;&nbsp;</a></span>tor_tls_cert_get_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a>* tor_tls_cert_get_key </td>
          <td>(</td>
          <td class="paramtype">tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a newly allocated copy of the public key that a certificate certifies. Watch out! This returns NULL if the cert's key is not RSA. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_a4cdf67e68f80f5bef7c52a5964416024_cgraph.png" border="0" usemap="#tortls_8h_a4cdf67e68f80f5bef7c52a5964416024_cgraph" alt=""/></div>
<map name="tortls_8h_a4cdf67e68f80f5bef7c52a5964416024_cgraph" id="tortls_8h_a4cdf67e68f80f5bef7c52a5964416024_cgraph">
<area shape="rect" id="node2" href="crypto__rsa_8c.html#a1218ae18907870b5eba2e014006c41e3" title="crypto_new_pk_from_rsa_" alt="" coords="193,5,368,32"/>
</map>
</div>

</div>
</div>
<a id="a805d08ed945976a2b66c748073be0abc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a805d08ed945976a2b66c748073be0abc">&#9670;&nbsp;</a></span>tor_tls_cert_is_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_cert_is_valid </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>signing_cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>check_rsa_1024</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether <b>cert</b> is well-formed, currently live, and correctly signed by the public key in <b>signing_cert</b>. If <b>check_rsa_1024</b>, make sure that it has an RSA key with 1024 bits; otherwise, just check that the key is long enough. Return 1 if the cert is good, and 0 if it's bad or we couldn't check it. </p>

</div>
</div>
<a id="a7493fe8a822f0ef8d46980439882fbb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7493fe8a822f0ef8d46980439882fbb1">&#9670;&nbsp;</a></span>tor_tls_check_lifetime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_check_lifetime </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>past_tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>future_tolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether the certificate set on the connection <b>tls</b> is expired give or take <b>past_tolerance</b> seconds, or not-yet-valid give or take <b>future_tolerance</b> seconds. Return 0 for valid, -1 for failure.</p>
<p>NOTE: you should call tor_tls_verify before tor_tls_check_lifetime. </p>

</div>
</div>
<a id="a18b7b628cbb659c7899ef90e58abb559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18b7b628cbb659c7899ef90e58abb559">&#9670;&nbsp;</a></span>tor_tls_context_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_context_init </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>client_identity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> *&#160;</td>
          <td class="paramname"><em>server_identity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>key_lifetime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create new global client and server TLS contexts.</p>
<p>If <b>server_identity</b> is NULL, this will not generate a server TLS context. If TOR_TLS_CTX_IS_PUBLIC_SERVER is set in <b>flags</b>, use the same TLS context for incoming and outgoing connections, and ignore <b>client_identity</b>. If one of TOR_TLS_CTX_USE_ECDHE_P{224,256} is set in <b>flags</b>, use that ECDHE group if possible; otherwise use the default ECDHE group. </p>

</div>
</div>
<a id="ab51ce122d6957eed72dfad975600bca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab51ce122d6957eed72dfad975600bca7">&#9670;&nbsp;</a></span>tor_tls_err_to_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* tor_tls_err_to_string </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>err</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a TOR_TLS_* error code, return a string equivalent. </p>

</div>
</div>
<a id="abf727dd8275cc9deb3d1b71c110b8d6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf727dd8275cc9deb3d1b71c110b8d6e">&#9670;&nbsp;</a></span>tor_tls_finish_handshake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_finish_handshake </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform the final part of the initial TLS handshake on <b>tls</b>. This should be called for the first handshake only: it determines whether the v1 or the v2 handshake was used, and adjusts things for the renegotiation handshake as appropriate.</p>
<p><a class="el" href="tortls_8c.html#ab228adf4f9dbd0f8739a657ea66f389e">tor_tls_handshake()</a> calls this on its own; you only need to call this if bufferevent is doing the handshake for you. </p>

</div>
</div>
<a id="a6f5a528cdb3b8cb9ce04b40bb899dbeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f5a528cdb3b8cb9ce04b40bb899dbeb">&#9670;&nbsp;</a></span>tor_tls_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_free_ </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release resources associated with a TLS object. Does not close the underlying file descriptor. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_a6f5a528cdb3b8cb9ce04b40bb899dbeb_cgraph.png" border="0" usemap="#tortls_8h_a6f5a528cdb3b8cb9ce04b40bb899dbeb_cgraph" alt=""/></div>
<map name="tortls_8h_a6f5a528cdb3b8cb9ce04b40bb899dbeb_cgraph" id="tortls_8h_a6f5a528cdb3b8cb9ce04b40bb899dbeb_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#a2052799333f0e6afd56d3a3fc640d879" title="tor_tls_get_n_raw_bytes" alt="" coords="148,5,312,32"/>
</map>
</div>

</div>
</div>
<a id="ae8e5980912c517c20c6b90419ef0c3b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8e5980912c517c20c6b90419ef0c3b6">&#9670;&nbsp;</a></span>tor_tls_free_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_free_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all global TLS structures. </p>

</div>
</div>
<a id="a6fef8380f402b3e300d756a828ba9d56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fef8380f402b3e300d756a828ba9d56">&#9670;&nbsp;</a></span>tor_tls_get_buffer_sizes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_get_buffer_sizes </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>rbuf_capacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>rbuf_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>wbuf_capacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>wbuf_bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Examine the amount of memory used and available for buffers in <b>tls</b>. Set *<b>rbuf_capacity</b> to the amount of storage allocated for the read buffer and *<b>rbuf_bytes</b> to the amount actually used. Set *<b>wbuf_capacity</b> to the amount of storage allocated for the write buffer and *<b>wbuf_bytes</b> to the amount actually used.</p>
<p>Return 0 on success, -1 on failure. </p>

</div>
</div>
<a id="afc7afb97a99f6f7664a9ced2b8baab54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc7afb97a99f6f7664a9ced2b8baab54">&#9670;&nbsp;</a></span>tor_tls_get_forced_write_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t tor_tls_get_forced_write_size </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If <b>tls</b> requires that the next write be of a particular size, return that size. Otherwise, return 0. </p>

</div>
</div>
<a id="a7aa93459dd4e3641e885932d682db4a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aa93459dd4e3641e885932d682db4a0">&#9670;&nbsp;</a></span>tor_tls_get_my_certs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_get_my_certs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>server</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tor_x509_cert_t **&#160;</td>
          <td class="paramname"><em>link_cert_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tor_x509_cert_t **&#160;</td>
          <td class="paramname"><em>id_cert_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set *<b>link_cert_out</b> and *<b>id_cert_out</b> to the link certificate and ID certificate that we're currently using for our V3 in-protocol handshake's certificate chain. If <b>server</b> is true, provide the certs that we use in server mode (auth, ID); otherwise, provide the certs that we use in client mode. (link, ID) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_a7aa93459dd4e3641e885932d682db4a0_icgraph.png" border="0" usemap="#tortls_8h_a7aa93459dd4e3641e885932d682db4a0_icgraph" alt=""/></div>
<map name="tortls_8h_a7aa93459dd4e3641e885932d682db4a0_icgraph" id="tortls_8h_a7aa93459dd4e3641e885932d682db4a0_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#a373bc2ce63f7b8a6530d1b16e420f7c4" title="connection_or_send\l_certs_cell" alt="" coords="209,5,348,47"/>
<area shape="rect" id="node3" href="connection__or_8h.html#a299125b246f5c829b4af2cef1efa7378" title="connection_or_compute\l_authenticate_cell_body" alt="" coords="197,71,360,112"/>
<area shape="rect" id="node4" href="routerkeys_8c.html#abebfd6b56ecfb14c8ef132e50485907e" title="generate_ed_link_cert" alt="" coords="204,137,353,163"/>
</map>
</div>

</div>
</div>
<a id="a7cc46ce9e214e2055861f7cacdfdfca2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cc46ce9e214e2055861f7cacdfdfca2">&#9670;&nbsp;</a></span>tor_tls_get_my_client_auth_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a>* tor_tls_get_my_client_auth_key </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the authentication key that we use to authenticate ourselves as a client in the V3 in-protocol handshake. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_a7cc46ce9e214e2055861f7cacdfdfca2_icgraph.png" border="0" usemap="#tortls_8h_a7cc46ce9e214e2055861f7cacdfdfca2_icgraph" alt=""/></div>
<map name="tortls_8h_a7cc46ce9e214e2055861f7cacdfdfca2_icgraph" id="tortls_8h_a7cc46ce9e214e2055861f7cacdfdfca2_icgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a0e89fff0e71d905b83cae2583a7bc49f" title="MOCK_IMPL" alt="" coords="200,13,300,39"/>
</map>
</div>

</div>
</div>
<a id="a2052799333f0e6afd56d3a3fc640d879"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2052799333f0e6afd56d3a3fc640d879">&#9670;&nbsp;</a></span>tor_tls_get_n_raw_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_get_n_raw_bytes </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>n_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>n_written</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets n_read and n_written to the number of bytes read and written, respectively, on the raw socket used by <b>tls</b> since the last time this function was called on <b>tls</b>. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_a2052799333f0e6afd56d3a3fc640d879_icgraph.png" border="0" usemap="#tortls_8h_a2052799333f0e6afd56d3a3fc640d879_icgraph" alt=""/></div>
<map name="tortls_8h_a2052799333f0e6afd56d3a3fc640d879_icgraph" id="tortls_8h_a2052799333f0e6afd56d3a3fc640d879_icgraph">
<area shape="rect" id="node2" href="tortls_8h.html#a6f5a528cdb3b8cb9ce04b40bb899dbeb" title="tor_tls_free_" alt="" coords="217,5,312,32"/>
</map>
</div>

</div>
</div>
<a id="aa1a40e31028963e83e7a7b44199432b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1a40e31028963e83e7a7b44199432b1">&#9670;&nbsp;</a></span>tor_tls_get_num_server_handshakes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_get_num_server_handshakes </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of server handshakes that we've noticed doing on <b>tls</b>. </p>

</div>
</div>
<a id="aaeaf421de8fd8d7d4d3bad71272bfc4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeaf421de8fd8d7d4d3bad71272bfc4e">&#9670;&nbsp;</a></span>tor_tls_get_pending_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_get_pending_bytes </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of bytes available for reading from <b>tls</b>. </p>

</div>
</div>
<a id="aefdead64da19ca5d4ee7cb9b60a7ab13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefdead64da19ca5d4ee7cb9b60a7ab13">&#9670;&nbsp;</a></span>tor_tls_get_state_description()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_get_state_description </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write a description of the current state of <b>tls</b> into the <b>sz</b>-byte buffer at <b>buf</b>. </p>

</div>
</div>
<a id="ab228adf4f9dbd0f8739a657ea66f389e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab228adf4f9dbd0f8739a657ea66f389e">&#9670;&nbsp;</a></span>tor_tls_handshake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_handshake </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform initial handshake on <b>tls</b>. When finished, returns TOR_TLS_DONE. On failure, returns TOR_TLS_ERROR, TOR_TLS_WANTREAD, or TOR_TLS_WANTWRITE. </p>

</div>
</div>
<a id="a89dbecf04240626af4b070b1b83c9f56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89dbecf04240626af4b070b1b83c9f56">&#9670;&nbsp;</a></span>tor_tls_is_server()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_is_server </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return whether this tls initiated the connect (client) or received it (server). </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_a89dbecf04240626af4b070b1b83c9f56_icgraph.png" border="0" usemap="#tortls_8h_a89dbecf04240626af4b070b1b83c9f56_icgraph" alt=""/></div>
<map name="tortls_8h_a89dbecf04240626af4b070b1b83c9f56_icgraph" id="tortls_8h_a89dbecf04240626af4b070b1b83c9f56_icgraph">
<area shape="rect" id="node2" href="connection__or_8c.html#a9874fc9cd6f255b931cbbcfc534702b7" title="connection_or_nonopen\l_was_started_here" alt="" coords="172,5,331,47"/>
</map>
</div>

</div>
</div>
<a id="ad9a5eb99512347313d8f3495168a1501"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9a5eb99512347313d8f3495168a1501">&#9670;&nbsp;</a></span>tor_tls_log_one_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_log_one_error </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>err</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>doing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log a single error <b>err</b> as returned by ERR_get_error(), which was received while performing an operation <b>doing</b> on <b>tls</b>. Log the message at <b>severity</b>, in log domain <b>domain</b>. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_ad9a5eb99512347313d8f3495168a1501_cgraph.png" border="0" usemap="#tortls_8h_ad9a5eb99512347313d8f3495168a1501_cgraph" alt=""/></div>
<map name="tortls_8h_ad9a5eb99512347313d8f3495168a1501_cgraph" id="tortls_8h_ad9a5eb99512347313d8f3495168a1501_cgraph">
<area shape="rect" id="node2" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="196,5,257,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_ad9a5eb99512347313d8f3495168a1501_icgraph.png" border="0" usemap="#tortls_8h_ad9a5eb99512347313d8f3495168a1501_icgraph" alt=""/></div>
<map name="tortls_8h_ad9a5eb99512347313d8f3495168a1501_icgraph" id="tortls_8h_ad9a5eb99512347313d8f3495168a1501_icgraph">
<area shape="rect" id="node2" href="tortls_8c.html#adc2406721ee63472828ecc962767ebe2" title="tls_log_errors" alt="" coords="196,31,296,57"/>
<area shape="rect" id="node3" href="tortls_8h.html#a13025f3a8714b2c00a7b7d0842fc5694" title="tor_tls_peer_has_cert" alt="" coords="344,5,491,32"/>
<area shape="rect" id="node4" href="tortls_8c.html#a631d2a19bd52d1de8194b24da85c3317" title="MOCK_IMPL" alt="" coords="367,56,467,83"/>
</map>
</div>

</div>
</div>
<a id="aeedb5c29cbd438f005c9193056d30f13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeedb5c29cbd438f005c9193056d30f13">&#9670;&nbsp;</a></span>tor_tls_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tor_tls_t* tor_tls_new </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isServer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new TLS object from a file descriptor, and a flag to determine whether it is functioning as a server. </p>

</div>
</div>
<a id="a13025f3a8714b2c00a7b7d0842fc5694"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13025f3a8714b2c00a7b7d0842fc5694">&#9670;&nbsp;</a></span>tor_tls_peer_has_cert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_peer_has_cert </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff this TLS connection is authenticated. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_a13025f3a8714b2c00a7b7d0842fc5694_cgraph.png" border="0" usemap="#tortls_8h_a13025f3a8714b2c00a7b7d0842fc5694_cgraph" alt=""/></div>
<map name="tortls_8h_a13025f3a8714b2c00a7b7d0842fc5694_cgraph" id="tortls_8h_a13025f3a8714b2c00a7b7d0842fc5694_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#adc2406721ee63472828ecc962767ebe2" title="tls_log_errors" alt="" coords="200,5,300,32"/>
<area shape="rect" id="node3" href="tortls_8c.html#ad9a5eb99512347313d8f3495168a1501" title="tor_tls_log_one_error" alt="" coords="348,5,491,32"/>
<area shape="rect" id="node4" href="log_8c.html#a048192107dfd3f8f22b9e599e45d0b34" title="tor_log" alt="" coords="539,5,600,32"/>
</map>
</div>

</div>
</div>
<a id="a02131f4d24082f726fbc9b93a5adcf50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02131f4d24082f726fbc9b93a5adcf50">&#9670;&nbsp;</a></span>tor_tls_server_got_renegotiate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_server_got_renegotiate </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff the server TLS connection <b>tls</b> got the renegotiation request it was waiting for. </p>

</div>
</div>
<a id="aa0e67c6afa29e8932b6908f1e21f5124"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0e67c6afa29e8932b6908f1e21f5124">&#9670;&nbsp;</a></span>tor_tls_set_logged_address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_set_logged_address </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make future log messages about <b>tls</b> display the address <b>address</b>. </p>

</div>
</div>
<a id="a5823cfa710f0f7987d09dfececae28d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5823cfa710f0f7987d09dfececae28d0">&#9670;&nbsp;</a></span>tor_tls_set_renegotiate_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_set_renegotiate_callback </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(tor_tls_t *, void *arg)&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set <b>cb</b> to be called with argument <b>arg</b> whenever <b>tls</b> next gets a client-side renegotiate in the middle of a read. Do not invoke this function until <em>after</em> initial handshaking is done! </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_a5823cfa710f0f7987d09dfececae28d0_cgraph.png" border="0" usemap="#tortls_8h_a5823cfa710f0f7987d09dfececae28d0_cgraph" alt=""/></div>
<map name="tortls_8h_a5823cfa710f0f7987d09dfececae28d0_cgraph" id="tortls_8h_a5823cfa710f0f7987d09dfececae28d0_cgraph">
<area shape="rect" id="node2" href="tortls_8c.html#a3b0c0880a231328e1b5d7faa01fddcd9" title="tor_tls_server_info\l_callback" alt="" coords="211,5,341,47"/>
<area shape="rect" id="node3" href="tortls_8c.html#a6f66b1039c2f3e00e4d4602f19d5ab02" title="tor_tls_debug_state\l_callback" alt="" coords="208,71,344,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_a5823cfa710f0f7987d09dfececae28d0_icgraph.png" border="0" usemap="#tortls_8h_a5823cfa710f0f7987d09dfececae28d0_icgraph" alt=""/></div>
<map name="tortls_8h_a5823cfa710f0f7987d09dfececae28d0_icgraph" id="tortls_8h_a5823cfa710f0f7987d09dfececae28d0_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#aecfd6590f4dd5c079f371e48eb1e09f2" title="connection_or_block\l_renegotiation" alt="" coords="208,5,349,47"/>
</map>
</div>

</div>
</div>
<a id="a30918c11f14636a0a5027c76a0ae8498"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30918c11f14636a0a5027c76a0ae8498">&#9670;&nbsp;</a></span>tor_tls_shutdown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_shutdown </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Shut down an open tls connection <b>tls</b>. When finished, returns TOR_TLS_DONE. On failure, returns TOR_TLS_ERROR, TOR_TLS_WANTREAD, or TOR_TLS_WANTWRITE. </p>

</div>
</div>
<a id="a2daac9018a16ea061a2429f171c25245"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2daac9018a16ea061a2429f171c25245">&#9670;&nbsp;</a></span>tor_tls_unblock_renegotiation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_tls_unblock_renegotiation </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If this version of openssl requires it, turn on renegotiation on <b>tls</b>. </p>

</div>
</div>
<a id="a1df770dd394f7ab33f134583c3385cd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1df770dd394f7ab33f134583c3385cd0">&#9670;&nbsp;</a></span>tor_tls_used_v1_handshake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_used_v1_handshake </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return true iff the initial TLS connection at <b>tls</b> did not use a v2 TLS handshake. Output is undefined if the handshake isn't finished. </p>

</div>
</div>
<a id="af9ccf351e10a3f3d0a4b616ee33063fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ccf351e10a3f3d0a4b616ee33063fb">&#9670;&nbsp;</a></span>tor_tls_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_verify </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcrypto__pk__t.html">crypto_pk_t</a> **&#160;</td>
          <td class="paramname"><em>identity_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If the provided tls connection is authenticated and has a certificate chain that is currently valid and signed, then set *<b>identity_key</b> to the identity certificate's key and return 0. Else, return -1 and log complaints with log-level <b>severity</b>. </p>

</div>
</div>
<a id="a5f79960ae7a36ce6647ceafd36c7e162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f79960ae7a36ce6647ceafd36c7e162">&#9670;&nbsp;</a></span>tor_tls_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tor_tls_write </td>
          <td>(</td>
          <td class="paramtype">tor_tls_t *&#160;</td>
          <td class="paramname"><em>tls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Underlying function for TLS writing. Write up to <b>n</b> characters from <b>cp</b> onto <b>tls</b>. On success, returns the number of characters written. On failure, returns TOR_TLS_ERROR, TOR_TLS_WANTREAD, or TOR_TLS_WANTWRITE. </p>

</div>
</div>
<a id="aea5999c1b596c9c571889386f8bc508c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea5999c1b596c9c571889386f8bc508c">&#9670;&nbsp;</a></span>tor_x509_cert_decode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tor_x509_cert_t* tor_x509_cert_decode </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>certificate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>certificate_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read a DER-encoded X509 cert, of length exactly <b>certificate_len</b>, from a <b>certificate</b>. Return a newly allocated tor_x509_cert_t on success and NULL on failure. </p>

</div>
</div>
<a id="a01200614cea5495e3bf7ff1b9157811c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01200614cea5495e3bf7ff1b9157811c">&#9670;&nbsp;</a></span>tor_x509_cert_dup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tor_x509_cert_t* tor_x509_cert_dup </td>
          <td>(</td>
          <td class="paramtype">const tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a new copy of <b>cert</b>. </p>

</div>
</div>
<a id="af396dc12cfe27527a145727f28bbbe62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af396dc12cfe27527a145727f28bbbe62">&#9670;&nbsp;</a></span>tor_x509_cert_free_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_x509_cert_free_ </td>
          <td>(</td>
          <td class="paramtype">tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all storage held in <b>cert</b> </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_af396dc12cfe27527a145727f28bbbe62_cgraph.png" border="0" usemap="#tortls_8h_af396dc12cfe27527a145727f28bbbe62_cgraph" alt=""/></div>
<map name="tortls_8h_af396dc12cfe27527a145727f28bbbe62_cgraph" id="tortls_8h_af396dc12cfe27527a145727f28bbbe62_cgraph">
<area shape="rect" id="node2" href="crypto__util_8c.html#a955f8d276e5213dd68600bf6dee0b9ae" title="memwipe" alt="" coords="191,5,269,32"/>
</map>
</div>

</div>
</div>
<a id="a5904272a0bc1d95951b5a0aa4903cc05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5904272a0bc1d95951b5a0aa4903cc05">&#9670;&nbsp;</a></span>tor_x509_cert_get_cert_digests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structcommon__digests__t.html">common_digests_t</a>* tor_x509_cert_get_cert_digests </td>
          <td>(</td>
          <td class="paramtype">const tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a set of digests for the public key in <b>cert</b>. </p>

</div>
</div>
<a id="ae138ea45f150f1291b09f0b5dfa34ad4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae138ea45f150f1291b09f0b5dfa34ad4">&#9670;&nbsp;</a></span>tor_x509_cert_get_der()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tor_x509_cert_get_der </td>
          <td>(</td>
          <td class="paramtype">const tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t **&#160;</td>
          <td class="paramname"><em>encoded_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>size_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set *<b>encoded_out</b> and *<b>size_out</b> to <b>cert</b>'s encoded DER representation and length, respectively. </p>

</div>
</div>
<a id="aeb4713a168234b69a9d25312a3a15770"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb4713a168234b69a9d25312a3a15770">&#9670;&nbsp;</a></span>tor_x509_cert_get_id_digests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structcommon__digests__t.html">common_digests_t</a>* tor_x509_cert_get_id_digests </td>
          <td>(</td>
          <td class="paramtype">const tor_x509_cert_t *&#160;</td>
          <td class="paramname"><em>cert</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a set of digests for the public key in <b>cert</b>, or NULL if this cert's public key is not one we know how to take the digest of. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tortls_8h_aeb4713a168234b69a9d25312a3a15770_icgraph.png" border="0" usemap="#tortls_8h_aeb4713a168234b69a9d25312a3a15770_icgraph" alt=""/></div>
<map name="tortls_8h_aeb4713a168234b69a9d25312a3a15770_icgraph" id="tortls_8h_aeb4713a168234b69a9d25312a3a15770_icgraph">
<area shape="rect" id="node2" href="connection__or_8h.html#a299125b246f5c829b4af2cef1efa7378" title="connection_or_compute\l_authenticate_cell_body" alt="" coords="196,5,359,47"/>
<area shape="rect" id="node3" href="torcert_8c.html#acd16d9acb0ee87c596577d7e3c333f39" title="or_handshake_certs\l_check_both" alt="" coords="208,71,347,112"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
